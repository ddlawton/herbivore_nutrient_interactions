<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.5.57">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>Field cage nutrient analysis – Locust Physiology</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>  
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> 2-2 cage - locust physiology anaylses</h6>

            <a href="../../scripts/field_cage_experiment/02_field_cages_locust_physiology_analyses.ipynb" class="btn btn-primary quarto-download-embed" download="02_field_cages_locust_physiology_analyses.ipynb">Download Notebook</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Field cage nutrient analysis – Locust Physiology</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section-1---analyze-locust-weight-surivial-and-adult-in-field-cages" id="toc-section-1---analyze-locust-weight-surivial-and-adult-in-field-cages" class="nav-link active" data-scroll-target="#section-1---analyze-locust-weight-surivial-and-adult-in-field-cages">Section 1 - analyze locust weight, surivial, and # adult in field cages</a>
  <ul class="collapse">
  <li><a href="#read-in-data" id="toc-read-in-data" class="nav-link" data-scroll-target="#read-in-data">read in data</a></li>
  </ul></li>
  <li><a href="#now-create-two-dataframes" id="toc-now-create-two-dataframes" class="nav-link" data-scroll-target="#now-create-two-dataframes">Now create two dataframes</a></li>
  <li><a href="#save-to-disk-for-figure-construction" id="toc-save-to-disk-for-figure-construction" class="nav-link" data-scroll-target="#save-to-disk-for-figure-construction">save to disk for figure construction</a></li>
  <li><a href="#section-2---analyze-locust-nutrient-rebalancing-through-time" id="toc-section-2---analyze-locust-nutrient-rebalancing-through-time" class="nav-link" data-scroll-target="#section-2---analyze-locust-nutrient-rebalancing-through-time">Section 2 - analyze locust nutrient rebalancing through time</a>
  <ul class="collapse">
  <li><a href="#read-in-data-1" id="toc-read-in-data-1" class="nav-link" data-scroll-target="#read-in-data-1">read in data</a></li>
  </ul></li>
  <li><a href="#data-management-step-1" id="toc-data-management-step-1" class="nav-link" data-scroll-target="#data-management-step-1">data management step 1</a></li>
  <li><a href="#data-management-step-2" id="toc-data-management-step-2" class="nav-link" data-scroll-target="#data-management-step-2">data management step 2</a></li>
  <li><a href="#raw-data-visualization" id="toc-raw-data-visualization" class="nav-link" data-scroll-target="#raw-data-visualization">raw data visualization</a></li>
  <li><a href="#treatment-raw-plot" id="toc-treatment-raw-plot" class="nav-link" data-scroll-target="#treatment-raw-plot">treatment raw plot</a></li>
  <li><a href="#sex-raw-plot" id="toc-sex-raw-plot" class="nav-link" data-scroll-target="#sex-raw-plot">sex raw plot</a></li>
  <li><a href="#save-plots-to-disk" id="toc-save-plots-to-disk" class="nav-link" data-scroll-target="#save-plots-to-disk">save plots to disk</a></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#model-comparison-overview-locust-nutrient-consumption" id="toc-model-comparison-overview-locust-nutrient-consumption" class="nav-link" data-scroll-target="#model-comparison-overview-locust-nutrient-consumption">Model Comparison Overview: Locust Nutrient Consumption</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a></li>
  <li><a href="#section-3---final-locust-mass-analysis" id="toc-section-3---final-locust-mass-analysis" class="nav-link" data-scroll-target="#section-3---final-locust-mass-analysis">Section 3 - Final locust mass analysis</a></li>
  <li><a href="#building-model" id="toc-building-model" class="nav-link" data-scroll-target="#building-model">Building model</a></li>
  <li><a href="#model-appraisal" id="toc-model-appraisal" class="nav-link" data-scroll-target="#model-appraisal">Model appraisal</a></li>
  <li><a href="#model-summary" id="toc-model-summary" class="nav-link" data-scroll-target="#model-summary">Model summary</a></li>
  <li><a href="#key-findings-1" id="toc-key-findings-1" class="nav-link" data-scroll-target="#key-findings-1">Key Findings</a></li>
  <li><a href="#model-outputs-1" id="toc-model-outputs-1" class="nav-link" data-scroll-target="#model-outputs-1">Model outputs</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div id="fab2b47b-776e-469f-a50e-e983d2b7bdcc" class="cell markdown">
<p>This script analyzes the locust data (protein and carbohydrates) for the field cage experiments</p>
<p>Please see manuscript for specific methodology.</p>
<p>This script does the following:</p>
<ol type="1">
<li>analyze locust weight, surivial, and # adult in field cages</li>
<li>analyze locust nutrient rebalancing through time</li>
</ol>
<p>Manuscript figure preparation happens in the <code>03_field_cages_intake_target_mauscript_figure_code.ipynb</code> file</p>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div id="7606c69a-0e6e-4433-9278-da23a69b67a0" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>load_packages <span class="ot">&lt;-</span> <span class="cf">function</span>(packages) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for uninstalled packages</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  uninstalled <span class="ot">&lt;-</span> packages[<span class="sc">!</span>packages <span class="sc">%in%</span> <span class="fu">installed.packages</span>()[,<span class="st">"Package"</span>]]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Install uninstalled packages</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(uninstalled)) <span class="fu">install.packages</span>(uninstalled, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Load all packages</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Failed to load package:"</span>, pkg))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># List of packages to check, install, and load</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mgcv"</span>, <span class="st">"MuMIn"</span>, <span class="st">"multcomp"</span>, <span class="st">"gratia"</span>, </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ggpubr"</span>, <span class="st">"patchwork"</span>, <span class="st">"broom"</span>, <span class="st">"knitr"</span>, <span class="st">"janitor"</span>, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>              <span class="st">"here"</span>,<span class="st">"ggpubr"</span>,<span class="st">"MetBrewer"</span>,<span class="st">"GGally"</span>,<span class="st">"tidyverse"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">load_packages</span>(packages)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">i_am</span>(<span class="st">'README.md'</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Functions</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Standard error</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>std <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting R options for jupyterlab</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">10</span>, <span class="at">repr.plot.height =</span> <span class="dv">10</span>,<span class="at">repr.matrix.max.rows=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /home/datascience/herbivore_nutrient_interactions
</code></pre>
</div>
</div></div>
<div id="f165cd48-e9ea-4f73-ad02-3e51bc5d1e5e" class="cell markdown">
<section id="section-1---analyze-locust-weight-surivial-and-adult-in-field-cages" class="level1">
<h1>Section 1 - analyze locust weight, surivial, and # adult in field cages</h1>
<section id="read-in-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-data">read in data</h2>
</section>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div id="72dd8935-790b-4f76-85d6-94e67d87ee86" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>adult_survival_prop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/raw/field_cage_experiment/LocustCageData_v02.xlsx - by cage.csv"</span>),<span class="at">show_col_types =</span> <span class="cn">FALSE</span>) </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>final_mass <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/raw/field_cage_experiment/LocustCageData.csv"</span>),<span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_recode</span>(Treatment, <span class="st">"None"</span> <span class="ot">=</span> <span class="st">"0N"</span>, <span class="st">"Medium"</span> <span class="ot">=</span> <span class="st">"MedH"</span>, <span class="st">"High"</span> <span class="ot">=</span> <span class="st">"HighN"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...24`
• `` -&gt; `...25`
• `` -&gt; `...26`
• `` -&gt; `...27`
• `` -&gt; `...28`</code></pre>
</div>
</div></div>
<div id="f48f40e3-1ed3-4adc-9e80-7f7dcc14431b" class="cell markdown">
<section id="now-create-two-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="now-create-two-dataframes">Now create two dataframes</h2>
<ul>
<li>survival and adult proporation at end of field cage experiment</li>
<li>final mass of all surviving locusts at end of experiment</li>
</ul>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div id="a7775117-ac39-430f-8d05-b7e10f1f7da1" class="cell" data-scrolled="true" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>adult_survival_prop2 <span class="ot">&lt;-</span> adult_survival_prop <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">N level</span><span class="st">`</span>,cageNum,AdultProportion,SurviveProportion) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">n_level =</span> <span class="fu">factor</span>(n_level),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">treatment =</span> <span class="fu">fct_recode</span>(n_level, <span class="st">"None"</span> <span class="ot">=</span> <span class="st">'0'</span>, <span class="st">"Medium"</span> <span class="ot">=</span> <span class="st">'87.5'</span>, <span class="st">"High"</span> <span class="ot">=</span> <span class="st">'175'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">!</span>n_level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div id="01e520d9-cf4a-4363-a9dc-a96694ace703" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>final_mass2 <span class="ot">&lt;-</span> final_mass <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(oedaleus_australis)) <span class="sc">|&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(treatment,mass_g,sex) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="16edc6eb-3688-4e2c-a500-ffb8a2180944" class="cell markdown">
<section id="save-to-disk-for-figure-construction" class="level2">
<h2 class="anchored" data-anchor-id="save-to-disk-for-figure-construction">save to disk for figure construction</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div id="d10b9b8e-c317-480b-b1ad-23ef65d5c837" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(adult_survival_prop2, <span class="fu">here</span>(<span class="st">"data/raw/field_cage_experiment/adult_locust_proportion_survival_by_treatment.csv"</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(final_mass2, <span class="fu">here</span>(<span class="st">"data/raw/field_cage_experiment/adult_locust_final_mass_by_treatment.csv"</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="aa0a9d72-9097-4f25-a71d-cac99a502293" class="cell markdown">
<section id="section-2---analyze-locust-nutrient-rebalancing-through-time" class="level1">
<h1>Section 2 - analyze locust nutrient rebalancing through time</h1>
<section id="read-in-data-1" class="level2">
<h2 class="anchored" data-anchor-id="read-in-data-1">read in data</h2>
<p>We need to read in the data and conduct some significant management</p>
</section>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div id="27ce4f71-c48c-46e1-979c-d055df6c717f" class="cell" data-scrolled="true" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and clean the names</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data/raw/field_cage_experiment/Field_Cage_IT.csv"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, <span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>())</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A tibble: 6 × 53</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">locust_id_num</th>
<th data-quarto-table-cell-role="th" scope="col">field_plot</th>
<th data-quarto-table-cell-role="th" scope="col">field_cage_num</th>
<th data-quarto-table-cell-role="th" scope="col">date_collected_from_field</th>
<th data-quarto-table-cell-role="th" scope="col">color</th>
<th data-quarto-table-cell-role="th" scope="col">sex</th>
<th data-quarto-table-cell-role="th" scope="col">locust_initialmass_g</th>
<th data-quarto-table-cell-role="th" scope="col">locusts_final_mass_g</th>
<th data-quarto-table-cell-role="th" scope="col">notes</th>
<th data-quarto-table-cell-role="th" scope="col">molt_date</th>
<th data-quarto-table-cell-role="th" scope="col">⋯</th>
<th data-quarto-table-cell-role="th" scope="col">high_prot_final_g_44</th>
<th data-quarto-table-cell-role="th" scope="col">x45</th>
<th data-quarto-table-cell-role="th" scope="col">diet_change5_start_time</th>
<th data-quarto-table-cell-role="th" scope="col">diet_change5_end_time</th>
<th data-quarto-table-cell-role="th" scope="col">high_carb_dish_num_48</th>
<th data-quarto-table-cell-role="th" scope="col">high_carb_initial_g_49</th>
<th data-quarto-table-cell-role="th" scope="col">high_carb_final_g_50</th>
<th data-quarto-table-cell-role="th" scope="col">high_prot_dish_num_51</th>
<th data-quarto-table-cell-role="th" scope="col">high_prot_initial_g_52</th>
<th data-quarto-table-cell-role="th" scope="col">high_prot_final_g_53</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">⋯</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;lgl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td>C1</td>
<td>5</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.353</td>
<td>0.330</td>
<td>NA</td>
<td>Nov 30, 2015</td>
<td>⋯</td>
<td>2.888</td>
<td>NA</td>
<td>Nov 29, 2015 8:00 PM</td>
<td>Dec 2, 2015</td>
<td>123</td>
<td>2.954</td>
<td>2.941</td>
<td>90</td>
<td>2.924</td>
<td>2.9250</td>
</tr>
<tr class="even">
<td>102</td>
<td>C1</td>
<td>5</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>M</td>
<td>0.167</td>
<td>0.165</td>
<td>NA</td>
<td>Dec 1, 2015</td>
<td>⋯</td>
<td>2.887</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>146</td>
<td>2.868</td>
<td>2.868</td>
<td>85</td>
<td>2.856</td>
<td>2.8540</td>
</tr>
<tr class="odd">
<td>103</td>
<td>C1</td>
<td>6</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.300</td>
<td>NA</td>
<td>Dead2nd day; prob no eat</td>
<td>NA</td>
<td>⋯</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr class="even">
<td>104</td>
<td>C1</td>
<td>7</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>G</td>
<td>F</td>
<td>0.262</td>
<td>NA</td>
<td>Died 1 Dec</td>
<td>NA</td>
<td>⋯</td>
<td>2.932</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>106</td>
<td>2.841</td>
<td>2.839</td>
<td>101</td>
<td>2.852</td>
<td>2.8532</td>
</tr>
<tr class="odd">
<td>105</td>
<td>H1</td>
<td>1</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.156</td>
<td>NA</td>
<td>Dead2nd day; prob no eat</td>
<td>NA</td>
<td>⋯</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr class="even">
<td>106</td>
<td>H1</td>
<td>2</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.211</td>
<td>0.328</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>2.905</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>116</td>
<td>2.894</td>
<td>2.858</td>
<td>58</td>
<td>2.906</td>
<td>2.8680</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div id="8179add8-a4e6-4521-9a48-b82c16ac92c1" class="cell markdown">
<section id="data-management-step-1" class="level2">
<h2 class="anchored" data-anchor-id="data-management-step-1">data management step 1</h2>
<ul>
<li>dropping NAs</li>
<li>identifying treatments based on cage number</li>
<li>creating time series for locust IT (step 1-5)</li>
</ul>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div id="638f947c-f7d7-4ed2-8dd1-b4aeee8896e1" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(locusts_final_mass_g) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">if_else</span>(sex <span class="sc">==</span> <span class="st">'B'</span>, <span class="st">'M'</span>, sex),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>      field_cage_num <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">21</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">29</span><span class="sc">:</span><span class="dv">32</span>) <span class="sc">~</span> <span class="st">"High"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>      field_cage_num <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">25</span><span class="sc">:</span><span class="dv">28</span>) <span class="sc">~</span> <span class="st">"Med"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>      field_cage_num <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">33</span><span class="sc">:</span><span class="dv">36</span>) <span class="sc">~</span> <span class="st">"none"</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_c_step1 =</span> (<span class="st">`</span><span class="at">high_carb_initial_g_14</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_carb_final_g_15</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_p_step1 =</span> (<span class="st">`</span><span class="at">high_prot_initial_g_17</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_prot_final_g_18</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_c_step2 =</span> (<span class="st">`</span><span class="at">high_carb_initial_g_22</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_carb_final_g_23</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_p_step2 =</span> (<span class="st">`</span><span class="at">high_prot_initial_g_25</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_prot_final_g_26</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_c_step3 =</span> (<span class="st">`</span><span class="at">high_carb_initial_g_31</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_carb_final_g_32</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_p_step3 =</span> (<span class="st">`</span><span class="at">high_prot_initial_g_34</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_prot_final_g_35</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_c_step4 =</span> (<span class="st">`</span><span class="at">high_carb_initial_g_40</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_carb_final_g_41</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_p_step4 =</span> (<span class="st">`</span><span class="at">high_prot_initial_g_43</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_prot_final_g_44</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_c_step5 =</span> (<span class="st">`</span><span class="at">high_carb_initial_g_49</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_carb_final_g_50</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_p_step5 =</span> (<span class="st">`</span><span class="at">high_prot_initial_g_52</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">high_prot_final_g_53</span><span class="st">`</span>) <span class="sc">*</span> <span class="fl">0.42</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div id="f404fc4f-a87f-4365-b50b-e2f4915584c0" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dat2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A tibble: 30 × 64</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">locust_id_num</th>
<th data-quarto-table-cell-role="th" scope="col">field_plot</th>
<th data-quarto-table-cell-role="th" scope="col">field_cage_num</th>
<th data-quarto-table-cell-role="th" scope="col">date_collected_from_field</th>
<th data-quarto-table-cell-role="th" scope="col">color</th>
<th data-quarto-table-cell-role="th" scope="col">sex</th>
<th data-quarto-table-cell-role="th" scope="col">locust_initialmass_g</th>
<th data-quarto-table-cell-role="th" scope="col">locusts_final_mass_g</th>
<th data-quarto-table-cell-role="th" scope="col">notes</th>
<th data-quarto-table-cell-role="th" scope="col">molt_date</th>
<th data-quarto-table-cell-role="th" scope="col">⋯</th>
<th data-quarto-table-cell-role="th" scope="col">total_c_step1</th>
<th data-quarto-table-cell-role="th" scope="col">total_p_step1</th>
<th data-quarto-table-cell-role="th" scope="col">total_c_step2</th>
<th data-quarto-table-cell-role="th" scope="col">total_p_step2</th>
<th data-quarto-table-cell-role="th" scope="col">total_c_step3</th>
<th data-quarto-table-cell-role="th" scope="col">total_p_step3</th>
<th data-quarto-table-cell-role="th" scope="col">total_c_step4</th>
<th data-quarto-table-cell-role="th" scope="col">total_p_step4</th>
<th data-quarto-table-cell-role="th" scope="col">total_c_step5</th>
<th data-quarto-table-cell-role="th" scope="col">total_p_step5</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">⋯</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>101</td>
<td>C1</td>
<td>5</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.353</td>
<td>0.330</td>
<td>NA</td>
<td>Nov 30, 2015</td>
<td>⋯</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.01848</td>
<td>0.00168</td>
<td>0.00840</td>
<td>0.00252</td>
<td>0.00042</td>
<td>0.00126</td>
<td>0.00546</td>
<td>-0.00042</td>
</tr>
<tr class="even">
<td>102</td>
<td>C1</td>
<td>5</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>M</td>
<td>0.167</td>
<td>0.165</td>
<td>NA</td>
<td>Dec 1, 2015</td>
<td>⋯</td>
<td>0.00000</td>
<td>0.00042</td>
<td>0.00756</td>
<td>0.00000</td>
<td>0.00966</td>
<td>0.00252</td>
<td>0.00000</td>
<td>0.00420</td>
<td>0.00000</td>
<td>0.00084</td>
</tr>
<tr class="odd">
<td>106</td>
<td>H1</td>
<td>2</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.211</td>
<td>0.328</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>0.00798</td>
<td>0.00000</td>
<td>0.01050</td>
<td>0.00000</td>
<td>0.03738</td>
<td>0.00882</td>
<td>0.02478</td>
<td>0.01512</td>
<td>0.01512</td>
<td>0.01596</td>
</tr>
<tr class="even">
<td>107</td>
<td>H1</td>
<td>2</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>G</td>
<td>F</td>
<td>0.216</td>
<td>0.313</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>0.01764</td>
<td>0.00042</td>
<td>0.01512</td>
<td>0.00168</td>
<td>0.01974</td>
<td>0.01218</td>
<td>0.02226</td>
<td>0.01680</td>
<td>0.00084</td>
<td>0.00000</td>
</tr>
<tr class="odd">
<td>108</td>
<td>H1</td>
<td>3</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.192</td>
<td>0.252</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>0.01344</td>
<td>0.00000</td>
<td>0.01008</td>
<td>0.00168</td>
<td>0.01176</td>
<td>0.00336</td>
<td>0.02016</td>
<td>0.00336</td>
<td>0.01764</td>
<td>0.00168</td>
</tr>
<tr class="even">
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋱</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
</tr>
<tr class="odd">
<td>133</td>
<td>C3</td>
<td>34</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>M</td>
<td>M</td>
<td>0.121</td>
<td>0.138</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>0.00252</td>
<td>0.00000</td>
<td>0.00420</td>
<td>0</td>
<td>0.00714</td>
<td>0.00168</td>
<td>0.00672</td>
<td>0.00126</td>
<td>0.00336</td>
<td>0.00420</td>
</tr>
<tr class="even">
<td>134</td>
<td>C3</td>
<td>34</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.293</td>
<td>0.213</td>
<td>Wing buds separating</td>
<td>Nov 30, 2015</td>
<td>⋯</td>
<td>0.00546</td>
<td>0.00000</td>
<td>0.00336</td>
<td>0</td>
<td>0.00252</td>
<td>0.00042</td>
<td>0.00126</td>
<td>0.00084</td>
<td>-0.83664</td>
<td>0.00084</td>
</tr>
<tr class="odd">
<td>136</td>
<td>C3</td>
<td>36</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>F</td>
<td>0.231</td>
<td>0.225</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>-0.00126</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0</td>
<td>0.01764</td>
<td>0.00168</td>
<td>0.00588</td>
<td>0.00126</td>
<td>0.00042</td>
<td>0.00042</td>
</tr>
<tr class="even">
<td>137</td>
<td>H3</td>
<td>31</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>G</td>
<td>F</td>
<td>0.215</td>
<td>0.336</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>0.00294</td>
<td>0.00042</td>
<td>0.00588</td>
<td>0</td>
<td>0.00714</td>
<td>0.00210</td>
<td>0.01302</td>
<td>0.01050</td>
<td>0.02142</td>
<td>0.01680</td>
</tr>
<tr class="odd">
<td>138</td>
<td>H3</td>
<td>32</td>
<td>Nov 23, 2015 7:00 PM</td>
<td>B</td>
<td>M</td>
<td>0.134</td>
<td>0.135</td>
<td>NA</td>
<td>NA</td>
<td>⋯</td>
<td>0.00126</td>
<td>0.00000</td>
<td>0.00462</td>
<td>0</td>
<td>0.00630</td>
<td>0.00168</td>
<td>0.00462</td>
<td>0.00252</td>
<td>0.00924</td>
<td>0.00336</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div id="f2198b46-d4ec-48e5-8883-66ff657805df" class="cell markdown">
<section id="data-management-step-2" class="level2">
<h2 class="anchored" data-anchor-id="data-management-step-2">data management step 2</h2>
<ul>
<li>filter consumption step for negative numbers</li>
<li>creating a row ID</li>
<li>collasping the time steps into a longer format</li>
<li>recoding the time step into a simple number</li>
</ul>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div id="d58a645f-34f5-40f9-b489-2caa82e70bc6" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> dat2<span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    total_c_step1 <span class="sc">&gt;=</span> <span class="dv">0</span>, total_p_step1 <span class="sc">&gt;=</span> <span class="dv">0</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    total_c_step2 <span class="sc">&gt;=</span> <span class="dv">0</span>, total_p_step2 <span class="sc">&gt;=</span> <span class="dv">0</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    total_c_step3 <span class="sc">&gt;=</span> <span class="dv">0</span>, total_p_step3 <span class="sc">&gt;=</span> <span class="dv">0</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    total_c_step4 <span class="sc">&gt;=</span> <span class="dv">0</span>, total_p_step4 <span class="sc">&gt;=</span> <span class="dv">0</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    total_c_step5 <span class="sc">&gt;=</span> <span class="dv">0</span>, total_p_step5 <span class="sc">&gt;=</span> <span class="dv">0</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="fu">starts_with</span>(<span class="st">"total_c_"</span>), <span class="fu">starts_with</span>(<span class="st">"total_p_"</span>)),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"interval"</span>), </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">"(.*)_(.*)"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(field_plot,field_cage_num, sex,locust_initialmass_g,locusts_final_mass_g, treatment,id,interval,total_c,total_p) <span class="sc">|&gt;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">interval =</span> <span class="fu">recode</span>(interval, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">step1 =</span> <span class="st">"1"</span>, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">step2 =</span> <span class="st">"2"</span>, </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">step3 =</span> <span class="st">"3"</span>, </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">step4 =</span> <span class="st">"4"</span>, </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">step5 =</span> <span class="st">"5"</span>),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="fu">factor</span>(id),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="fu">factor</span>(treatment),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval =</span> <span class="fu">factor</span>(interval))  <span class="sc">|&gt;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(id) <span class="sc">|&gt;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(id,interval) <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_total_c =</span> <span class="fu">cumsum</span>(total_c),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">cumulative_total_p =</span> <span class="fu">cumsum</span>(total_p),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">day_interval =</span> <span class="fu">case_when</span>(interval <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span><span class="st">'Day 1'</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                             interval <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span><span class="st">'Day 2'</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                             interval <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span><span class="st">'Day 3-4'</span>,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                             interval <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span><span class="st">'Day 5-6'</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                             interval <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span><span class="st">'Day 7-9'</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="93a1c969-1f53-4bf1-a406-81c616f15a14" class="cell markdown">
<section id="raw-data-visualization" class="level2">
<h2 class="anchored" data-anchor-id="raw-data-visualization">raw data visualization</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div id="1b662bc7-badf-4568-8f4b-4c24758a187f" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>treatment_raw_plot <span class="ot">&lt;-</span> dat3 <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>total_p,<span class="at">y=</span>total_c,<span class="at">color=</span>treatment)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_equal</span>(<span class="at">ratio=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">"Protein consumed (g)"</span>) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"Carbohydrates consumed (g)"</span>) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">2</span>,<span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span>day_interval) <span class="sc">+</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#4daf4a"</span>,<span class="st">"#984ea3"</span>)) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.04</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.04</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>sex_raw_plot <span class="ot">&lt;-</span> dat3 <span class="sc">|&gt;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>total_p,<span class="at">y=</span>total_c,<span class="at">color=</span>sex)) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_equal</span>(<span class="at">ratio=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlab</span>(<span class="st">"Protein consumed (g)"</span>) <span class="sc">+</span> </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"Carbohydrates consumed (g)"</span>) <span class="sc">+</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_pubr</span>() <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>,<span class="at">linetype=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">2</span>,<span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span>day_interval) <span class="sc">+</span> </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#dd5129"</span>,<span class="st">"#0f7ba2"</span>)) <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.04</span>) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.04</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="6f1022b3-8e61-494b-9ba5-6c4d0521d157" class="cell markdown">
<section id="treatment-raw-plot" class="level3">
<h3 class="anchored" data-anchor-id="treatment-raw-plot">treatment raw plot</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div id="55248f19-6d1c-4946-9ff5-aa8381417318" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>treatment_raw_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="02_field_cages_locust_physiology_analyses_files/figure-html/cell-12-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="02_field_cages_locust_physiology_analyses_files/figure-html/cell-12-output-1.png" width="600" height="600" class="figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div id="796afbae-297f-46f1-9e76-78904c8e9ed7" class="cell markdown">
<section id="sex-raw-plot" class="level3">
<h3 class="anchored" data-anchor-id="sex-raw-plot">sex raw plot</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div id="079cde43-a4b2-4d8e-8abe-01f4ea5a362a" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sex_raw_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="02_field_cages_locust_physiology_analyses_files/figure-html/cell-13-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="02_field_cages_locust_physiology_analyses_files/figure-html/cell-13-output-1.png" width="600" height="600" class="figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div id="5e46f484-176d-4510-81b1-8c3ec443104f" class="cell markdown">
<section id="save-plots-to-disk" class="level3">
<h3 class="anchored" data-anchor-id="save-plots-to-disk">save plots to disk</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div id="423a7a3b-89d9-4432-ae3e-698eed3c698f" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the output directory</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">'output/field_cage_experiment/raw_visualization/'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List of plots and their corresponding file names</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"intake_target_treatment_raw_graph"</span> <span class="ot">=</span> treatment_raw_plot,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"intake_target_sex_raw_graph"</span> <span class="ot">=</span> sex_raw_plot</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each plot and save it</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(plots)) {</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">filename =</span> <span class="fu">file.path</span>(output_dir, <span class="fu">paste0</span>(name, <span class="st">".png"</span>)),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> plots[[name]],</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">15</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="e247d2df-94a9-443b-9128-62d34feb34df" class="cell markdown">
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<section id="model-comparison-overview-locust-nutrient-consumption" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-overview-locust-nutrient-consumption">Model Comparison Overview: Locust Nutrient Consumption</h3>
<p>This analysis focuses on the nutrient cimulative consumption of carbohydrates (cumulative_total_c) and proteins (cumulative_total_p) by locusts over time (interval), with key predictors such as sex, treatment, and other covariates. The following six Generalized Additive Models (GAMs) are used to assess the impact of these factors:</p>
<section id="model-1-full-model-with-random-effects-for-repeated-measures" class="level4">
<h4 class="anchored" data-anchor-id="model-1-full-model-with-random-effects-for-repeated-measures">Model 1: Full Model with Random Effects for Repeated Measures</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span> sex <span class="sc">+</span> interval <span class="sc">+</span> treatment <span class="sc">+</span> <span class="fu">s</span>(id, <span class="at">bs=</span><span class="st">"re"</span>),  </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span> sex <span class="sc">+</span> interval <span class="sc">+</span> treatment <span class="sc">+</span> <span class="fu">s</span>(id, <span class="at">bs=</span><span class="st">"re"</span>)),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>), <span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Fixed Effects</strong>: Includes <code>sex</code>, <code>interval</code>, and <code>treatment</code>.</li>
<li><strong>Random Effects</strong>:
<ul>
<li><code>s(id, bs="re")</code>: Random effect to account for repeated measures on individual locusts (<code>id</code>), but note the sample size may not be sufficient for this structure.</li>
</ul></li>
<li><strong>Purpose</strong>: This model captures the effects of sex, time, and treatment while accounting for individual locust variability.</li>
</ul>
</section>
<section id="model-2-interaction-between-interval-and-treatment-no-smooth-terms" class="level4">
<h4 class="anchored" data-anchor-id="model-2-interaction-between-interval-and-treatment-no-smooth-terms">Model 2: Interaction Between Interval and Treatment, No Smooth Terms</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span> sex <span class="sc">+</span> (interval) <span class="sc">*</span> treatment,   </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span> sex <span class="sc">+</span> (interval) <span class="sc">*</span> treatment),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>), <span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Fixed Effects</strong>: Includes <code>sex</code>, <code>interval</code>, <code>treatment</code>, and their interaction.</li>
<li><strong>Purpose</strong>: Simplifies the model by removing the smooth term for initial mass, focusing solely on the interaction between time and treatment.</li>
</ul>
</section>
<section id="model-3-fixed-effects-for-sex-only" class="level4">
<h4 class="anchored" data-anchor-id="model-3-fixed-effects-for-sex-only">Model 3: Fixed Effects for Sex Only</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span> sex,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  cumulative_otal_p <span class="sc">~</span> sex),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>), <span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Fixed Effects</strong>: Only includes <code>sex</code>.</li>
<li><strong>Purpose</strong>: This model isolates the effect of sex on nutrient consumption without considering time, treatment, or mass.</li>
</ul>
</section>
<section id="model-4-fixed-effects-for-treatment-only" class="level4">
<h4 class="anchored" data-anchor-id="model-4-fixed-effects-for-treatment-only">Model 4: Fixed Effects for Treatment Only</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span> treatment,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span> treatment),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>), <span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Fixed Effects</strong>: Only includes <code>treatment</code>.</li>
<li><strong>Purpose</strong>: This model tests the direct effect of treatment on nutrient consumption without accounting for sex, time, or mass.</li>
</ul>
</section>
<section id="model-5-intercept-only-model-null-model" class="level4">
<h4 class="anchored" data-anchor-id="model-5-intercept-only-model-null-model">Model 5: Intercept-Only Model (Null Model)</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod5 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>), <span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Fixed Effects</strong>: Only includes an intercept term.</li>
<li><strong>Purpose</strong>: Serves as a null model, estimating the overall mean of carbohydrate and protein consumption without considering any predictors.</li>
</ul>
</section>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p>By comparing these models, we can assess the influence of sex, treatment, interval, and initial mass on locust nutrient consumption. The models range from full random effects models (Model 1) to simplified intercept-only models (Model 6), allowing for a thorough exploration of the factors driving nutrient consumption.</p>
</section>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div id="49843240-2199-4a89-b3ea-044e9542f374" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span>  sex  <span class="sc">+</span>  interval <span class="sc">+</span> treatment <span class="sc">+</span> <span class="fu">s</span>(id, <span class="at">bs=</span><span class="st">"re"</span>), </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span>  sex <span class="sc">+</span> interval <span class="sc">+</span> treatment  <span class="sc">+</span> <span class="fu">s</span>(id, <span class="at">bs=</span><span class="st">"re"</span>)),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>),<span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span>  sex <span class="sc">+</span> interval <span class="sc">*</span> treatment,   </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span>  sex <span class="sc">+</span> interval <span class="sc">*</span> treatment),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>),<span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span>  sex ,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span>  sex),</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>),<span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span>   treatment,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span>   treatment),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>),<span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>mod5 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">list</span>( </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  cumulative_total_c <span class="sc">~</span>   <span class="dv">1</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  cumulative_total_p <span class="sc">~</span>   <span class="dv">1</span>),</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">family=</span><span class="fu">mvn</span>(<span class="at">d=</span><span class="dv">2</span>),<span class="at">select=</span><span class="cn">TRUE</span>, <span class="at">data=</span>dat3</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="d117d593-564a-4aa0-b01f-50ae1f98af94" class="cell markdown">
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [19]:</pre></div><div id="605271d9-0f66-4371-8827-3b4c77107dbb" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gam.check</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Method: REML   Optimizer: outer newton
full convergence after 6 iterations.
Gradient range [-0.000203556,0.0005737438]
(score -954.8838 &amp; scale 1).
Hessian positive definite, eigenvalue range [1.80807,7.847553].
Model rank =  63 / 63 

Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
indicate that k is too low, especially if edf is close to k'.

          k'  edf k-index p-value
s(id)   23.0 17.6      NA      NA
s.1(id) 23.0 10.6      NA      NA</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="02_field_cages_locust_physiology_analyses_files/figure-html/cell-16-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="02_field_cages_locust_physiology_analyses_files/figure-html/cell-16-output-2.png" width="600" height="600" class="figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div id="f706c068-a0f3-4a6a-baf9-8525467b0f56" class="cell markdown">
<p>These diagnostic plots indicate these models could be improved. I think for descriptive uses these models are okay.</p>
<p>Assuming a gaussian distribution is probably limiting here.</p>
<section id="model-selection-criteria" class="level3">
<h3 class="anchored" data-anchor-id="model-selection-criteria">Model selection criteria</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div id="07bf0a70-cc86-49cc-b818-e78c55561b8f" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model selection using AIC, BIC, and AICc</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>bic <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod1, mod2, mod3, mod4, mod5) <span class="sc">|&gt;</span>  <span class="co"># Bayesian Information Criterion</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">deltaBIC =</span> BIC <span class="sc">-</span> <span class="fu">min</span>(BIC)) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">'model'</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(model,BIC,deltaBIC)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(mod1, mod2, mod3, mod4, mod5)  <span class="sc">|&gt;</span>  <span class="co"># Akaike Information Criterion</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">deltaAIC =</span> AIC <span class="sc">-</span> <span class="fu">min</span>(AIC)) <span class="sc">|&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">'model'</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(model,AIC,deltaAIC)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>aicc <span class="ot">&lt;-</span> <span class="fu">AICc</span>(mod1, mod2, mod3, mod4, mod5)  <span class="sc">|&gt;</span>  <span class="co"># AIC adjusted for small sample size</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">deltaAICc =</span> AICc <span class="sc">-</span> <span class="fu">min</span>(AICc)) <span class="sc">|&gt;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">'model'</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(model,AICc,deltaAICc)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>model_selection_tables <span class="ot">&lt;-</span> bic <span class="sc">|&gt;</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(aic,<span class="at">by=</span><span class="st">'model'</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(aicc,<span class="at">by=</span><span class="st">'model'</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">experiment =</span> <span class="st">'locust_intake_target_through_time'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [21]:</pre></div><div id="3a9617c4-7233-4423-ae64-dfc5c9643d28" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>model_selection_tables <span class="sc">|&gt;</span> <span class="fu">arrange</span>(deltaAIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 5 × 8</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">model</th>
<th data-quarto-table-cell-role="th" scope="col">BIC</th>
<th data-quarto-table-cell-role="th" scope="col">deltaBIC</th>
<th data-quarto-table-cell-role="th" scope="col">AIC</th>
<th data-quarto-table-cell-role="th" scope="col">deltaAIC</th>
<th data-quarto-table-cell-role="th" scope="col">AICc</th>
<th data-quarto-table-cell-role="th" scope="col">deltaAICc</th>
<th data-quarto-table-cell-role="th" scope="col">experiment</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;chr&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mod1</td>
<td>-1959.594</td>
<td>0.00000</td>
<td>-2086.993</td>
<td>0.0000</td>
<td>-2021.876</td>
<td>0.00000</td>
<td>locust_intake_target_through_time</td>
</tr>
<tr class="even">
<td>mod2</td>
<td>-1907.268</td>
<td>52.32555</td>
<td>-1975.891</td>
<td>111.1021</td>
<td>-1961.285</td>
<td>60.59134</td>
<td>locust_intake_target_through_time</td>
</tr>
<tr class="odd">
<td>mod3</td>
<td>-1900.026</td>
<td>59.56801</td>
<td>-1919.240</td>
<td>167.7533</td>
<td>-1918.193</td>
<td>103.68257</td>
<td>locust_intake_target_through_time</td>
</tr>
<tr class="even">
<td>mod4</td>
<td>-1895.604</td>
<td>63.98977</td>
<td>-1914.818</td>
<td>172.1751</td>
<td>-1913.772</td>
<td>108.10433</td>
<td>locust_intake_target_through_time</td>
</tr>
<tr class="odd">
<td>mod5</td>
<td>-1898.807</td>
<td>60.78667</td>
<td>-1912.532</td>
<td>174.4619</td>
<td>-1911.981</td>
<td>109.89482</td>
<td>locust_intake_target_through_time</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div id="72e17ed8-b262-43de-be1b-6e276b538012" class="cell markdown">
<p>All model selection criteria agreed that <code>mod1</code> was the best model</p>
<section id="final-model-summary" class="level3">
<h3 class="anchored" data-anchor-id="final-model-summary">Final Model Summary</h3>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div id="5fc6af52-99ef-47bf-8f70-f8ecc70689e0" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Family: Multivariate normal 
Link function: 

Formula:
cumulative_total_c ~ sex + interval + treatment + s(id, bs = "re")
cumulative_total_p ~ sex + interval + treatment + s(id, bs = "re")

Parametric coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.0125868  0.0036504   3.448 0.000565 ***
sexM            -0.0108931  0.0041592  -2.619 0.008818 ** 
interval2        0.0066835  0.0025232   2.649 0.008077 ** 
interval3        0.0160330  0.0025232   6.354 2.09e-10 ***
interval4        0.0259670  0.0025232  10.291  &lt; 2e-16 ***
interval5        0.0350061  0.0025232  13.874  &lt; 2e-16 ***
treatmentnone   -0.0061015  0.0040947  -1.490 0.136202    
(Intercept).1    0.0022792  0.0014613   1.560 0.118829    
sexM.1          -0.0036943  0.0014086  -2.623 0.008726 ** 
interval2.1      0.0005296  0.0014992   0.353 0.723909    
interval3.1      0.0034148  0.0014992   2.278 0.022739 *  
interval4.1      0.0071035  0.0014992   4.738 2.16e-06 ***
interval5.1      0.0125817  0.0014992   8.392  &lt; 2e-16 ***
treatmentnone.1 -0.0009902  0.0013868  -0.714 0.475224    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
          edf Ref.df Chi.sq p-value    
s(id)   17.59     20  484.7  &lt;2e-16 ***
s.1(id) 10.61     20  110.7   0.381    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Deviance explained = 73.4%
-REML = -954.88  Scale est. = 1         n = 115</code></pre>
</div>
</div></div>
<div id="b331a7a4-2a0c-450d-939d-64cf693a7efd" class="cell markdown">
<section id="key-findings" class="level3">
<h3 class="anchored" data-anchor-id="key-findings">Key Findings</h3>
<ul>
<li><strong>Sex Effect</strong>: Males consumed significantly less protein and carbohydrates than females.</li>
<li><strong>Time (Interval) Effect</strong>:
<ul>
<li>Protein consumption increased significantly in later intervals, especially interval 5 (<code>p &lt; 0.001</code>).</li>
<li>Carbohydrate consumption also showed increases in later intervals, notably in intervals 3, 4, and 5.</li>
</ul></li>
<li><strong>Fertilization Treatment</strong>: Locusts in plots without nitrogen fertilization consumed less protein (<code>p = 0.0285</code>), but the effect was not significant for carbohydrates.</li>
<li><strong>Random Effect</strong>: There was no significant individual effect (<code>s(id)</code>), indicating individual locusts did not contribute heavily to variation.</li>
<li><strong>Deviance Explained</strong>: The model explained 20.5% of the variation in nutrient consumption.</li>
</ul>
</section>
<section id="model-outputs" class="level3">
<h3 class="anchored" data-anchor-id="model-outputs">Model outputs</h3>
<p>I am going to get the estimated marginal means for <code>inter</code>,<code>date</code>, and <code>treatment:date</code> and output as a dataframe</p>
<p>I will write out the transformed raw data to disk</p>
<p>I will also write out to disk the model object</p>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [23]:</pre></div><div id="f2a589d4-5a2f-4b23-8a93-adc04279c11d" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>intake_target_exp_preds <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">unique</span>(dat3<span class="sc">$</span>sex),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">interval =</span> <span class="fu">unique</span>(dat3<span class="sc">$</span>interval),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">unique</span>(dat3<span class="sc">$</span>treatment),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">id=</span> <span class="fu">unique</span>(dat3<span class="sc">$</span>id)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict carbohydrate consumption</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>intake_target_exp_preds<span class="sc">$</span>pred_carb <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, <span class="at">newdata =</span> intake_target_exp_preds, <span class="at">type =</span> <span class="st">"response"</span>)[, <span class="dv">1</span>]</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict protein consumption</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>intake_target_exp_preds<span class="sc">$</span>pred_protein <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod1, <span class="at">newdata =</span> intake_target_exp_preds, <span class="at">type =</span> <span class="st">"response"</span>)[, <span class="dv">2</span>]</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>intake_target_exp_preds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A data.frame: 460 × 6</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">sex</th>
<th data-quarto-table-cell-role="th" scope="col">interval</th>
<th data-quarto-table-cell-role="th" scope="col">treatment</th>
<th data-quarto-table-cell-role="th" scope="col">id</th>
<th data-quarto-table-cell-role="th" scope="col">pred_carb</th>
<th data-quarto-table-cell-role="th" scope="col">pred_protein</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>M</td>
<td>1</td>
<td>none</td>
<td>1</td>
<td>0.005251196</td>
<td>0.002089128</td>
</tr>
<tr class="even">
<td>F</td>
<td>1</td>
<td>none</td>
<td>1</td>
<td>-0.005641895</td>
<td>-0.001605175</td>
</tr>
<tr class="odd">
<td>M</td>
<td>2</td>
<td>none</td>
<td>1</td>
<td>0.011934674</td>
<td>0.002618693</td>
</tr>
<tr class="even">
<td>F</td>
<td>2</td>
<td>none</td>
<td>1</td>
<td>0.001041583</td>
<td>-0.001075610</td>
</tr>
<tr class="odd">
<td>M</td>
<td>3</td>
<td>none</td>
<td>1</td>
<td>0.021284240</td>
<td>0.005503910</td>
</tr>
<tr class="even">
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
<td>⋮</td>
</tr>
<tr class="odd">
<td>F</td>
<td>3</td>
<td>High</td>
<td>23</td>
<td>0.01278549</td>
<td>0.001897175</td>
</tr>
<tr class="even">
<td>M</td>
<td>4</td>
<td>High</td>
<td>23</td>
<td>0.03361250</td>
<td>0.009280174</td>
</tr>
<tr class="odd">
<td>F</td>
<td>4</td>
<td>High</td>
<td>23</td>
<td>0.02271940</td>
<td>0.005585871</td>
</tr>
<tr class="even">
<td>M</td>
<td>5</td>
<td>High</td>
<td>23</td>
<td>0.04265163</td>
<td>0.014758435</td>
</tr>
<tr class="odd">
<td>F</td>
<td>5</td>
<td>High</td>
<td>23</td>
<td>0.03175854</td>
<td>0.011064132</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div id="ab4e089a-248d-4c37-8814-fd228f1a22f9" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now averaging arcoss species, plot, and cage</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>intake_target_exp_preds2 <span class="ot">&lt;-</span> intake_target_exp_preds <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(treatment,interval) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">pred_carb =</span> <span class="fu">mean</span>(pred_carb),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">pred_protein =</span> <span class="fu">mean</span>(pred_protein))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>intake_target_exp_preds2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>A grouped_df: 10 × 4</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" scope="col">treatment</th>
<th data-quarto-table-cell-role="th" scope="col">interval</th>
<th data-quarto-table-cell-role="th" scope="col">pred_carb</th>
<th data-quarto-table-cell-role="th" scope="col">pred_protein</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;fct&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
<th data-quarto-table-cell-role="th" scope="col">&lt;dbl&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>High</td>
<td>1</td>
<td>0.007140269</td>
<td>4.320264e-04</td>
</tr>
<tr class="even">
<td>High</td>
<td>2</td>
<td>0.013823747</td>
<td>9.615916e-04</td>
</tr>
<tr class="odd">
<td>High</td>
<td>3</td>
<td>0.023173312</td>
<td>3.846809e-03</td>
</tr>
<tr class="even">
<td>High</td>
<td>4</td>
<td>0.033107225</td>
<td>7.535505e-03</td>
</tr>
<tr class="odd">
<td>High</td>
<td>5</td>
<td>0.042146356</td>
<td>1.301377e-02</td>
</tr>
<tr class="even">
<td>none</td>
<td>1</td>
<td>0.001038814</td>
<td>-5.581555e-04</td>
</tr>
<tr class="odd">
<td>none</td>
<td>2</td>
<td>0.007722292</td>
<td>-2.859025e-05</td>
</tr>
<tr class="even">
<td>none</td>
<td>3</td>
<td>0.017071858</td>
<td>2.856627e-03</td>
</tr>
<tr class="odd">
<td>none</td>
<td>4</td>
<td>0.027005771</td>
<td>6.545323e-03</td>
</tr>
<tr class="even">
<td>none</td>
<td>5</td>
<td>0.036044901</td>
<td>1.202358e-02</td>
</tr>
</tbody>
</table>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [26]:</pre></div><div id="7cf99827-605e-4d5c-9dec-cb8c60e3d991" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(intake_target_exp_preds2,<span class="fu">here</span>(<span class="st">'data/processed/field_cage_experiment/intake_target_through_time_predictions.csv'</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dat3,<span class="fu">here</span>(<span class="st">'data/processed/field_cage_experiment/intake_target_through_time_predictions_raw_data.csv'</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(model_selection_tables, <span class="fu">here</span>(<span class="st">"output/field_cage_experiment/intake_target_through_time_model_selection_criteria_results.csv"</span>),<span class="at">row.names=</span><span class="cn">FALSE</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the lists into a single list</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">'mod1'</span><span class="ot">=</span> mod1, <span class="st">'mod2'</span> <span class="ot">=</span> mod2, <span class="st">'mod3'</span><span class="ot">=</span> mod3, <span class="st">'mod4'</span><span class="ot">=</span> mod4, <span class="st">'mod5'</span><span class="ot">=</span> mod5)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the combined list to an RDS file</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(models, <span class="fu">here</span>(<span class="st">"output/field_cage_experiment/model_objects/intake_target_through_time_models.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="b97f2c69-6245-4cf7-af5b-7959565ec765" class="cell markdown">
<section id="section-3---final-locust-mass-analysis" class="level1">
<h1>Section 3 - Final locust mass analysis</h1>
<p>This model looks to see if the final mass of locusts differed between treatments.</p>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [27]:</pre></div><div id="8c6f865f-026a-489a-930a-ebf0cf99e171" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>locust_dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">'data/raw/field_cage_experiment/LocustCageData.csv'</span>),<span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(oedaleus_australis)) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(treatment,cage_num,mass_g,carb_mg_mg,protein_mg_mg,sex) <span class="sc">|&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(sex,cage_num),<span class="sc">~</span><span class="fu">factor</span>(.)),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(treatment <span class="sc">==</span> <span class="st">'HighN'</span> <span class="sc">~</span> <span class="st">'high'</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                                treatment <span class="sc">==</span> <span class="st">'MedH'</span> <span class="sc">~</span> <span class="st">'medium'</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'none'</span>), <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">'none'</span>,<span class="st">'medium'</span>,<span class="st">'high'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...24`
• `` -&gt; `...25`
• `` -&gt; `...26`
• `` -&gt; `...27`
• `` -&gt; `...28`</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [28]:</pre></div><div id="ef033270-5d84-4fb5-a6a1-c2773009c698" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>locust_dat <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(locust_dat<span class="sc">$</span>sex)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(locust_dat<span class="sc">$</span>treatment)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(locust_dat<span class="sc">$</span>cage_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 292
Columns: 6
$ treatment     &lt;fct&gt; high, high, high, high, high, high, high, high, high, hi…
$ cage_num      &lt;fct&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
$ mass_g        &lt;dbl&gt; 0.242, 0.314, 0.288, 0.257, 0.181, 0.115, 0.132, 0.336, …
$ carb_mg_mg    &lt;dbl&gt; 0.1210000, 0.1210000, 0.1210000, 0.1210000, 0.1210000, 0…
$ protein_mg_mg &lt;dbl&gt; 0.1729659, 0.1729659, 0.1729659, 0.1729659, 0.1729659, 0…
$ sex           &lt;fct&gt; F, F, F, F, M, M, M, F, F, M, M, M, F, F, F, F, F, F, F,…</code></pre>
</div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>F</li><li>M</li></ol>

<details>
    <summary style="display:list-item;cursor:pointer">
        <strong>Levels</strong>:
    </summary>
    <style>
    .list-inline {list-style: none; margin:0; padding: 0}
    .list-inline>li {display: inline-block}
    .list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
    </style>
    <ol class="list-inline"><li>'F'</li><li>'M'</li></ol>
</details>
</div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>high</li><li>none</li><li>medium</li></ol>

<details>
    <summary style="display:list-item;cursor:pointer">
        <strong>Levels</strong>:
    </summary>
    <style>
    .list-inline {list-style: none; margin:0; padding: 0}
    .list-inline>li {display: inline-block}
    .list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
    </style>
    <ol class="list-inline"><li>'none'</li><li>'medium'</li><li>'high'</li></ol>
</details>
</div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li></ol>

<details>
    <summary style="display:list-item;cursor:pointer">
        <strong>Levels</strong>:
    </summary>
    <style>
    .list-inline {list-style: none; margin:0; padding: 0}
    .list-inline>li {display: inline-block}
    .list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
    </style>
    <ol class="list-inline"><li>'1'</li><li>'2'</li><li>'3'</li><li>'4'</li><li>'5'</li><li>'6'</li><li>'7'</li><li>'8'</li><li>'9'</li><li>'10'</li><li>'11'</li><li>'12'</li><li>'13'</li><li>'14'</li><li>'15'</li><li>'16'</li><li>'17'</li><li>'18'</li><li>'19'</li><li>'20'</li><li>'21'</li><li>'22'</li><li>'23'</li><li>'24'</li><li>'25'</li><li>'26'</li><li>'27'</li><li>'28'</li><li>'29'</li><li>'30'</li><li>'31'</li><li>'32'</li><li>'33'</li><li>'34'</li><li>'35'</li><li>'36'</li></ol>
</details>
</div>
</div></div>
<div id="b4675ee3-f08b-41f5-84a5-a23e25c28e2a" class="cell markdown">
<section id="building-model" class="level2">
<h2 class="anchored" data-anchor-id="building-model">Building model</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [29]:</pre></div><div id="91eed4d7-74ea-4488-afbe-f9c11c3e9d00" class="cell" data-scrolled="true" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gam</span>(mass_g <span class="sc">~</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>               sex <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>               treatment <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">s</span>(carb_mg_mg,protein_mg_mg) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">s</span>(cage_num,<span class="at">bs=</span><span class="st">'re'</span>),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span><span class="fu">scat</span>(),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">select=</span><span class="cn">TRUE</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>locust_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div id="9c3df201-7702-402d-af5f-a2c2a283f158" class="cell markdown">
<section id="model-appraisal" class="level2">
<h2 class="anchored" data-anchor-id="model-appraisal">Model appraisal</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [30]:</pre></div><div id="dec76fb4-9740-4de3-b354-9367ebd252cb" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gratia<span class="sc">::</span><span class="fu">appraise</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="02_field_cages_locust_physiology_analyses_files/figure-html/cell-26-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="02_field_cages_locust_physiology_analyses_files/figure-html/cell-26-output-1.png" width="600" height="600" class="figure-img"></a></p>
</figure>
</div>
</div>
</div></div>
<div id="d0760b9d-34b7-445f-8b4d-a96247458dd7" class="cell markdown">
<section id="model-summary" class="level2">
<h2 class="anchored" data-anchor-id="model-summary">Model summary</h2>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [31]:</pre></div><div id="b345db67-6a8c-4992-a216-e0c473d04f7d" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Family: Scaled t(3.062,0.036) 
Link function: identity 

Formula:
mass_g ~ sex + treatment + s(carb_mg_mg, protein_mg_mg) + s(cage_num, 
    bs = "re")

Parametric coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.326188   0.007210  45.243   &lt;2e-16 ***
sexM            -0.147694   0.005507 -26.820   &lt;2e-16 ***
treatmentmedium  0.014935   0.009518   1.569    0.117    
treatmenthigh   -0.011055   0.010095  -1.095    0.273    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
                                  edf Ref.df Chi.sq  p-value    
s(carb_mg_mg,protein_mg_mg)  0.001665     29  0.002    0.416    
s(cage_num)                 17.399299     33 42.160 1.78e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) =  0.617   Deviance explained = 61.6%
-REML = -427.13  Scale est. = 1         n = 292</code></pre>
</div>
</div></div>
<div id="0dcacec3-595b-48da-965c-952c76782afd" class="cell markdown">
<section id="key-findings-1" class="level2">
<h2 class="anchored" data-anchor-id="key-findings-1">Key Findings</h2>
<ul>
<li><strong>Sex Effect</strong>: Males are significantly lighter than females (<code>p &lt; 0.001</code>).</li>
<li><strong>Fertilization Treatment</strong>:
<ul>
<li>No significant effect of medium or high fertilization treatments on locust mass (<code>p &gt; 0.1</code>).</li>
</ul></li>
<li><strong>Nutrient Content</strong>: The interaction between carbohydrate and protein content did not significantly affect locust mass (<code>p = 0.416</code>).</li>
<li><strong>Cage Effect</strong>: Significant variability in mass was attributed to differences between cages (<code>p = 1.78e-05</code>).</li>
<li><strong>Deviance Explained</strong>: The model explains 61.6% of the variance in locust mass.</li>
</ul>
</section>
</div>
<div id="7ccdaeef-afa4-4bf0-81d6-e7ec74d467cc" class="cell markdown">
<section id="model-outputs-1" class="level2">
<h2 class="anchored" data-anchor-id="model-outputs-1">Model outputs</h2>
<p>I dont need the estimated marginal means since there was no difference. I will just save the model to disk?</p>
</section>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [32]:</pre></div><div id="045954fb-6182-4dc3-958a-3464c241fdb4" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(mod, <span class="fu">here</span>(<span class="st">"output/field_cage_experiment/model_objects/final_locust_weight_by_field_cage_treatment_models.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","openEffect":"zoom","descPosition":"bottom","loop":false,"selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>