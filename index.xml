<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>


<article-meta>


<title-group>
<article-title>Exploring Nutrient Availability and Herbivorous Insect
Population Dynamics Across Multiple Scales</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Lawton</surname>
<given-names>Douglas</given-names>
</name>
<string-name>Douglas Lawton</string-name>

<email>douglas@douglaslawton.com</email>
<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<role>data analysis</role>
<role vocab="https://credit.niso.org" vocab-term="methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology/">methodology</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Learned</surname>
<given-names>Jenni</given-names>
</name>
<string-name>Jenni Learned</string-name>

<role>data collection</role>
<role vocab="https://credit.niso.org" vocab-term="methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology/">methodology</role>
<xref ref-type="aff" rid="aff-2">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Waters</surname>
<given-names>Cathy</given-names>
</name>
<string-name>Cathy Waters</string-name>

<role>experimental design</role>
<role>data collection</role>
<role vocab="https://credit.niso.org" vocab-term="methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology/">methodology</role>
<xref ref-type="aff" rid="aff-3">c</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Toole</surname>
<given-names>Ian</given-names>
</name>
<string-name>Ian Toole</string-name>

<role>data collection</role>
<role>logistical support</role>
<xref ref-type="aff" rid="aff-4">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Thompson</surname>
<given-names>Natalia</given-names>
</name>
<string-name>Natalia Thompson</string-name>

<role>data collection</role>
<role>chemical analyses</role>
<xref ref-type="aff" rid="aff-5">e</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hales</surname>
<given-names>Chase</given-names>
</name>
<string-name>Chase Hales</string-name>

<role>GIS analyses</role>
<role>remote sensing data extraction</role>
<xref ref-type="aff" rid="aff-6">f</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Adriaansen</surname>
<given-names>Chris</given-names>
</name>
<string-name>Chris Adriaansen</string-name>

<role>logistical support</role>
<xref ref-type="aff" rid="aff-7">g</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Deveson</surname>
<given-names>Ted</given-names>
</name>
<string-name>Ted Deveson</string-name>

<role>logistical support</role>
<xref ref-type="aff" rid="aff-7">g</xref>
<xref ref-type="aff" rid="aff-8">h</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Simpson</surname>
<given-names>Stephen J.</given-names>
</name>
<string-name>Stephen J. Simpson</string-name>

<role>logistical support</role>
<role>experimental design</role>
<xref ref-type="aff" rid="aff-9">i</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Cease</surname>
<given-names>Arianne</given-names>
</name>
<string-name>Arianne Cease</string-name>

<role>logistical support</role>
<role>experimental design</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="aff" rid="aff-10">j</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>School of Sustainability, Arizona State University, Tempe,
AZ, USA</institution>
</institution-wrap>







</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Mau Nui Seabird Recovery Project, Makawao, HI,
USA</institution>
</institution-wrap>







</aff>
<aff id="aff-3">
<institution-wrap>
<institution>GreenCollar, 3 Hickson Road, The Rocks, Sydney, NSW,
Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-4">
<institution-wrap>
<institution>NSW Department of Primary Industries, Trangie, NSW,
Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-5">
<institution-wrap>
<institution>School of Molecular Sciences, Arizona State University,
Tempe, AZ, USA</institution>
</institution-wrap>







</aff>
<aff id="aff-6">
<institution-wrap>
<institution>School of Geographical Sciences &amp; Urban Planning,
Arizona State University, Tempe, AZ, USA</institution>
</institution-wrap>







</aff>
<aff id="aff-7">
<institution-wrap>
<institution>Australian Plague Locust Commission, Fyshwick, ACT,
Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-8">
<institution-wrap>
<institution>Fenner School of Environment and Society, Australian
National University, ACT, Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-9">
<institution-wrap>
<institution>School of Life and Environmental Science Charles Perkins
Centre, University of Sydney, Sydney, Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-10">
<institution-wrap>
<institution>School of Life Sciences, Arizona State University, Tempe,
AZ, USA</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">douglas@douglaslawton.com</corresp>
</author-notes>









<history></history>


<abstract>
<list list-type="order">
  <list-item>
    <p>Nutrient composition varies greatly across landscapes, which in
    turn influences the spatiotemporal variation and dynamics of
    populations. Yet few studies have investigated this pattern on
    multiple scales.</p>
  </list-item>
  <list-item>
    <p>We tested how nutrient limitation affects herbivore populations
    across spatial scales from individual behavior to landscape level
    population dynamics using Australian plague locust,
    <bold>Chortoicetes terminifera</bold> (Walker), field populations
    and long-term survey data from across their range.</p>
  </list-item>
  <list-item>
    <p>At the individual level, juvenile locusts selected for a
    carbohydrate-biased intake target of 1 protein (p) 2 carbohydrate
    (c) and had the highest growth and shortest development time when
    fed artificial diets with that same 1p:2c ratio over the duration of
    the 5th (final) juvenile instar.</p>
  </list-item>
  <list-item>
    <p>At the field level, locusts kept in field cages with
    protein-biased plants redressed their nutritional imbalance by
    selecting very carbohydrate-biased diets (up to a 1p:20c ratio) for
    more than a week after being removed from the protein-biased
    environment. Once the deficiency was met, locusts returned to the
    1p:2c intake target.</p>
  </list-item>
  <list-item>
    <p>Going up to the landscape level, outbreaks were negatively
    correlated with soil nitrogen and showed a non-linear relationship
    with soil phosphorus peaking at approximately 4% soil phosphorus. We
    disentangled the relationship between mean annual precipitation and
    soil nitrogen through leveraging both comprehensive locust surveys
    and remotely sensed soil and weather data that spanned decades.</p>
  </list-item>
  <list-item>
    <p>This paper is the first to integrate lab, field, and remote
    sensing approaches to demonstrate the importance of nutrient
    balancing and acquisition across scales for herbivores. Specifically
    for locusts, we show that low nitrogen environments promote
    outbreaks, likely by reducing plant protein to carbohydrate ratios.
    Incorporating soil quality data into locust plague forecasting
    models can help increase accuracy of predictions.</p>
  </list-item>
</list>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>nitrogen</kwd>
<kwd>phosphorus</kwd>
<kwd>grasshoppers</kwd>
<kwd>population dynamics</kwd>
<kwd>non-linear modeling</kwd>
<kwd>nutrient limitation</kwd>
<kwd>remote sensing</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1. INTRODUCTION</title>
  <p>Plant nutrients are usually more variable than animal body
  composition, which can make it challenging for herbivores to acquire
  an optimal nutritional balance
  (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000" ref-type="bibr">Elser
  et al., 2000</xref>). Nutrient balance affects individual performance
  (<xref alt="Batzli, 1986" rid="ref-batzli_nutritional_1986" ref-type="bibr">Batzli,
  1986</xref>;
  <xref alt="Bernays et al., 1994" rid="ref-bernays_dietary_1994" ref-type="bibr">Bernays
  et al., 1994</xref>) and, by extension, influences population dynamics
  (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000" ref-type="bibr">Elser
  et al., 2000</xref>). One way many primary consumers achieve an
  optimal blend of nutrients is through selecting different host plants
  or plant parts to reach a specific amount and ratio, termed the intake
  target, IT
  (<xref alt="Simpson &amp; Raubenheimer, 2012a" rid="ref-simpson2012" ref-type="bibr">Simpson
  &amp; Raubenheimer, 2012a</xref>). For example, giant pandas
  (Ailuropoda melanoleuca) synchronize their migration and reproduction
  cycles with seasonal nutrient availability between different bamboo
  species
  (<xref alt="Nie et al., 2015" rid="ref-nie_obligate_2015" ref-type="bibr">Nie
  et al., 2015</xref>). While studies have investigated this trend
  between available nutrients and animal populations, they usually
  happen at one scale and biological level. For example, much
  grasshopper nutrition research has been done at the organismal or
  local population level using lab and/or field studies
  (<xref alt="Behmer, 2009" rid="ref-behmer_insect_2009" ref-type="bibr">Behmer,
  2009</xref>;
  <xref alt="Cease, 2024" rid="ref-cease_how_2024" ref-type="bibr">Cease,
  2024</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019" ref-type="bibr">Le
  Gall et al., 2019</xref>), with a few separate larger scale modeling
  endeavors
  (<xref alt="Welti, Roeder, et al., 2020" rid="ref-welti_nutrient_2020" ref-type="bibr">Welti,
  Roeder, et al., 2020</xref>;
  <xref alt="Zhou et al., 2019" rid="ref-zhou_increased_2019" ref-type="bibr">Zhou
  et al., 2019</xref>). To our knowledge, no study has integrated
  individual herbivorous animal nutrition to continental level patterns
  in nutrient availability. Here we work across spatial scales, bridging
  field observations and cage manipulations with continental-scale
  insect pest outbreak modeling to see how the animal-nutrient
  relationship changes across multiple scales.</p>
  <p>Food quality has long been considered an important predictor of
  animal population dynamics
  (<xref alt="Andersen et al., 2004" rid="ref-andersen_stoichiometry_2004" ref-type="bibr">Andersen
  et al., 2004</xref>;
  <xref alt="White, 1993" rid="ref-white_inadequate_1993" ref-type="bibr">White,
  1993</xref>). Phosphorus and nitrogen commonly limit primary
  production in ecosystems, either separately or as co-limiting factors
  Vitousek et al.
  (<xref alt="2010" rid="ref-vitousek_terrestrial_2010" ref-type="bibr">2010</xref>),
  and are often investigated as limiting factors for higher trophic
  levels to determine the consequences to animal growth and reproduction
  (<xref alt="Andersen et al., 2004" rid="ref-andersen_stoichiometry_2004" ref-type="bibr">Andersen
  et al., 2004</xref>). For example, bluegrass fields supplemented with
  high quality (e.g. increased nitrogen) food pellets increase vole
  (Microtus ochmgaster) densities compared to control fields by
  supporting higher adult survival, increased breeding, and growth rate
  (<xref alt="Cole &amp; Batzli, 1978" rid="ref-cole_influence_1978" ref-type="bibr">Cole
  &amp; Batzli, 1978</xref>). Less phosphorus in a dryland insect
  herbivore’s (Sabinia setosa) host plant, velvet mesquite (Prosopis
  velutina), leads to individuals having decreased RNA content (slower
  growth) and lower abundance
  (<xref alt="Schade et al., 2003" rid="ref-schade_stoichiometric_2003" ref-type="bibr">Schade
  et al., 2003</xref>). More broadly, nitrogen and phosphorus limitation
  has been shown in mammals
  (<xref alt="Randolph et al., 1995" rid="ref-randolph_nutritional_1995" ref-type="bibr">Randolph
  et al., 1995</xref>;
  <xref alt="White, 1993" rid="ref-white_inadequate_1993" ref-type="bibr">White,
  1993</xref>), birds
  (<xref alt="Forero et al., 2002" rid="ref-forero_conspecific_2002" ref-type="bibr">Forero
  et al., 2002</xref>;
  <xref alt="Granbom &amp; Smith, 2006" rid="ref-granbom_food_2006" ref-type="bibr">Granbom
  &amp; Smith, 2006</xref>), and insects
  (<xref alt="Floyd, 1996" rid="ref-floyd_frontiers_1996" ref-type="bibr">Floyd,
  1996</xref>;
  <xref alt="Huberty &amp; Denno, 2006" rid="ref-huberty_consequences_2006" ref-type="bibr">Huberty
  &amp; Denno, 2006</xref>;
  <xref alt="Marsh &amp; Adams, 1995" rid="ref-marsh_decline_1995" ref-type="bibr">Marsh
  &amp; Adams, 1995</xref>;
  <xref alt="Perkins et al., 2004" rid="ref-perkins_dietary_2004" ref-type="bibr">Perkins
  et al., 2004</xref>) which is discussed further in White
  (<xref alt="2008" rid="ref-white_role_2008" ref-type="bibr">2008</xref>)
  and Andersen et al.
  (<xref alt="2004" rid="ref-andersen_stoichiometry_2004" ref-type="bibr">2004</xref>).
  However, not all animal populations respond positively to increasing
  environmental nutrients. For example, studies from across the globe
  reveal that the abundances of many grasshopper species are positively
  (<xref alt="Joern et al., 2012" rid="ref-joern_not_2012" ref-type="bibr">Joern
  et al., 2012</xref>;
  <xref alt="Ozment et al., 2021" rid="ref-ozment_tracking_2021" ref-type="bibr">Ozment
  et al., 2021</xref>;
  <xref alt="Welti, Prather, et al., 2020" rid="ref-welti_bottomup_2020" ref-type="bibr">Welti,
  Prather, et al., 2020</xref>;
  <xref alt="Welti, Roeder, et al., 2020" rid="ref-welti_nutrient_2020" ref-type="bibr">Welti,
  Roeder, et al., 2020</xref>;
  <xref alt="H. Zhu et al., 2020" rid="ref-zhu_effects_2020" ref-type="bibr">H.
  Zhu et al., 2020</xref>;
  <xref alt="Y. Zhu et al., 2019" rid="ref-zhu_negative_2019" ref-type="bibr">Y.
  Zhu et al., 2019</xref>), or not related
  (<xref alt="Heidorn &amp; Joern, 1987" rid="ref-heidorn_feeding_1987" ref-type="bibr">Heidorn
  &amp; Joern, 1987</xref>;
  <xref alt="Jonas &amp; Joern, 2008" rid="ref-jonas_hostplant_2008" ref-type="bibr">Jonas
  &amp; Joern, 2008</xref>;
  <xref alt="Lenhart et al., 2015" rid="ref-lenhart_water_2015" ref-type="bibr">Lenhart
  et al., 2015</xref>;
  <xref alt="Ozment et al., 2021" rid="ref-ozment_tracking_2021" ref-type="bibr">Ozment
  et al., 2021</xref>) to plant nitrogen concentrations as reviewed in
  Cease
  (<xref alt="2024" rid="ref-cease_how_2024" ref-type="bibr">2024</xref>).
  Can the relationship between herbivore abundance and environmental
  nutrients be explained by approaches that consider nutritional
  physiology at the organismal level, in addition to population and
  landscape ecology?</p>
  <p>One excellent study system to understand the complex relationship
  of nutrient availability and population dynamics is a subset of
  grasshoppers called locusts
  (<xref alt="Cullen et al., 2017" rid="ref-cullen_molecules_2017" ref-type="bibr">Cullen
  et al., 2017</xref>;
  <xref alt="Uvarov, 1977" rid="ref-uvarov_grasshoppers_1977" ref-type="bibr">Uvarov,
  1977</xref>). Locusts undergo massive population irruptions known as
  plagues that pose significant issues for global food security
  (<xref alt="Cease et al., 2015" rid="ref-cease_living_2015" ref-type="bibr">Cease
  et al., 2015</xref>). For example, the 2010-2011 Australian plague
  locust (Chortoicetes terminifera) plague could have caused AUD$963
  million in crop damage if not controlled
  (<xref alt="Millist, 2011" rid="ref-millist_nicola_benefitcost_nodate" ref-type="bibr">Millist,
  2011</xref>). In contrast to the nitrogen limitation paradigm (White
  1993), locusts frequently show carbohydrate limitation. Many locust
  species, including C. terminifera, will select plants with a low
  protein:carbohydrate ratio and eat about double the amount of
  carbohydrate relative to protein when given a choice of artificial
  diets
  (<xref alt="Behmer, 2009" rid="ref-behmer_insect_2009" ref-type="bibr">Behmer,
  2009</xref>;
  <xref alt="Brosemann et al., 2023" rid="ref-brosemann_nutrient_2023" ref-type="bibr">Brosemann
  et al., 2023</xref>;
  <xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021" ref-type="bibr">Lawton
  et al., 2021</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019" ref-type="bibr">Le
  Gall et al., 2019</xref>). Their high energy, relative to protein,
  demand is heightened by their impressive long-distance migration.
  Marching bands of South American locusts (Schistocerca cancellata) eat
  predominantly from dishes containing carbohydrates and largely ignore
  dishes containing protein
  (<xref alt="Cease et al., 2023" rid="ref-cease_field_2023" ref-type="bibr">Cease
  et al., 2023</xref>), and have the highest survival and lipid gain
  when eating carbohydrate-biased plants
  (<xref alt="Talal et al., 2020" rid="ref-talal_plant_2020" ref-type="bibr">Talal
  et al., 2020</xref>). As adults, flight increases carbohydrate, but
  not protein, consumption in migratory locusts (Locusta migratoria) and
  locusts eating carbohydrate-biased diets fly for longer times
  (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023" ref-type="bibr">Talal
  et al., 2023</xref>). At a local scale, high-use agricultural areas
  that decrease soil and plant nitrogen promote Oedaleus locust
  outbreaks in Senegal and China
  (<xref alt="Cease et al., 2012" rid="ref-cease_heavy_2012" ref-type="bibr">Cease
  et al., 2012</xref>;
  <xref alt="Giese et al., 2013" rid="ref-giese_n_2013" ref-type="bibr">Giese
  et al., 2013</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019" ref-type="bibr">Le
  Gall et al., 2019</xref>;
  <xref alt="Word et al., 2019" rid="ref-word_soil-targeted_2019" ref-type="bibr">Word
  et al., 2019</xref>). Less is known about the relationship between
  plant phosphorus and locust populations, but grasshoppers and locusts
  can detect and regulate phosphorus during ingestion and
  post-ingestively to maintain homeostasis
  (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016" ref-type="bibr">Cease
  et al., 2016</xref>;
  <xref alt="Zhang et al., 2014" rid="ref-zhang_grasshoppers_2014" ref-type="bibr">Zhang
  et al., 2014</xref>). Long-term laboratory rearing studies show
  negative effects of too little or excess dietary phosphorus, though
  short-term restrictions to low or high phosphorus diets appear to have
  no effects
  (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016" ref-type="bibr">Cease
  et al., 2016</xref>). Field measurements of Oedaleus decorus asiaticus
  in China show that locusts increase phosphorus excretion with
  increasing plant phosphorus content, suggesting that phosphorus may
  not be limiting in the Inner Mongolian Steppe for this species
  (<xref alt="Zhang et al., 2014" rid="ref-zhang_grasshoppers_2014" ref-type="bibr">Zhang
  et al., 2014</xref>). Understanding the multi-scale flow of nitrogen
  and phosphorus from soils to continental scale population dynamics may
  reveal a connection between soil quality and locust plagues in
  Australia and further elucidate the pattern globally
  (<xref alt="Cease, 2024" rid="ref-cease_how_2024" ref-type="bibr">Cease,
  2024</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019" ref-type="bibr">Le
  Gall et al., 2019</xref>).</p>
  <p>The arid interior of Australia is a highly variable environment
  (<xref alt="Morton et al., 2011" rid="ref-morton_fresh_2011" ref-type="bibr">Morton
  et al., 2011</xref>) characterized by the Resource-Pulse Paradigm
  (<xref alt="Noy-Meir, 1974" rid="ref-noy-meir_desert_1974" ref-type="bibr">Noy-Meir,
  1974</xref>;
  <xref alt="Whitford, 2002" rid="ref-whitford_ecology_2002" ref-type="bibr">Whitford,
  2002</xref>). Many Australian animal and plant populations irrupt
  following periods of favorable climatic conditions. For example,
  preceding vegetation growth is an important factor for Australian
  plague locust population outbreaks
  (<xref alt="Lawton et al., 2022" rid="ref-lawton_seeing_2022" ref-type="bibr">Lawton
  et al., 2022</xref>). In addition to climatic variability, Australia
  is marked by poor natural soil fertility
  (<xref alt="Morton et al., 2011" rid="ref-morton_fresh_2011" ref-type="bibr">Morton
  et al., 2011</xref>;
  <xref alt="Orians &amp; Milewski, 2007" rid="ref-orians_ecology_2007" ref-type="bibr">Orians
  &amp; Milewski, 2007</xref>). Nutrients such as nitrogen and
  phosphorus are in short supply in unmodified soils. Subsequently, many
  native animals and plants are adapted to environments low in soil
  nutrients
  (<xref alt="Orians &amp; Milewski, 2007" rid="ref-orians_ecology_2007" ref-type="bibr">Orians
  &amp; Milewski, 2007</xref>). Australia has several locust species,
  but the Australian plague locust is the most widespread and
  economically damaging
  (<xref alt="Hunter et al., 2001" rid="ref-hunter_adaptations_2001" ref-type="bibr">Hunter
  et al., 2001</xref>). As with many dryland animals, numerous studies
  have shown the relationship between climatic conditions and Australian
  plague locust population outbreaks
  (<xref alt="Clark, 1974" rid="ref-clark_influence_1974" ref-type="bibr">Clark,
  1974</xref>;
  <xref alt="Deveson &amp; Walker, 2005" rid="ref-deveson_not_2005" ref-type="bibr">Deveson
  &amp; Walker, 2005</xref>;
  <xref alt="Farrow, 1982" rid="ref-farrow_population_1982" ref-type="bibr">Farrow,
  1982</xref>;
  <xref alt="Key, 1945" rid="ref-key_general_1945" ref-type="bibr">Key,
  1945</xref>), however few have investigated the relationship between
  soil and plant nutrients and this species’ outbreaks.</p>
  <p>In this study, we investigate the across scale relationship between
  soil and plant nutrients and animal populations using Australian
  plague locusts. We have three specific questions and subsequent
  predictions across scales:</p>
  <list list-type="order">
    <list-item>
      <label>1)</label>
      <p>What are the nutritional preferences of individuals from
      gregarious Australian plague locust field populations? We expect
      individuals to be carbohydrate biased based on their active
      lifestyle, and to keep a constant intake target between
      populations.</p>
    </list-item>
    <list-item>
      <label>2)</label>
      <p>What happens to Australian plague locusts when constrained to
      high nitrogen environments? We expect locusts to select
      particularly carbohydrate biased diets to redress a protein :
      carbohydrate imbalance in their local environment.</p>
    </list-item>
    <list-item>
      <label>3)</label>
      <p>Can we use soil nutrients as a predictor of Australian plague
      locust nymph outbreaks at the continental scale?</p>
    </list-item>
  </list>
  <p>At larger scales, and accounting for climatic factors, we expect
  outbreaks to be associated with low nitrogen areas. Since terrestrial
  herbivores can require 5-50 times more nitrogen than phosphorus
  (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000" ref-type="bibr">Elser
  et al., 2000</xref>) and locusts likely have a higher capacity to
  post-ingestively regulate phosphorus in ranges found in nature
  (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016" ref-type="bibr">Cease
  et al., 2016</xref>;
  <xref alt="Zhang et al., 2014" rid="ref-zhang_grasshoppers_2014" ref-type="bibr">Zhang
  et al., 2014</xref>), we expect nitrogen to be a stronger predictor of
  populations at a continental scale as compared to phosphorus.</p>
</sec>
<sec id="methods">
  <title>2. METHODS</title>
  <sec id="field-site-and-animals">
    <title>2.1 Field site and animals</title>
    <p>Lab-based and field cage experiments were conducted at the
    Trangie Agricultural Research Centre of the Department of Primary
    Industries in Trangie, New South Wales, Australia. We used field
    populations of the Australian plague locust, which prefers open
    grassy areas and is a grass generalist
    (<xref alt="Key, 1945" rid="ref-key_general_1945" ref-type="bibr">Key,
    1945</xref>). Solitarious populations of this locust species
    maintain their intake target closely regardless of spatiotemporal
    changes
    (<xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021" ref-type="bibr">Lawton
    et al., 2021</xref>). We carried out these studies in
    November-December 2015, during the final nymphal and early adult
    stages of the spring Australian plague locust generation.</p>
  </sec>
  <sec id="nutritional-target-and-performance-curve-using-synthetic-diets">
    <title>2.2 Nutritional target and performance curve using synthetic
    diets</title>
    <p>To control the nutrient availability within the experiments, we
    used isocaloric artificial diets made up of 42% macronutrients
    (differing ratios of protein and carbohydrates), 32% cellulose, and
    4% of salt, sterols and vitamins. This artificial diet mixture has
    been used with this species
    (<xref alt="Clissold et al., 2014" rid="ref-clissold_regulation_2014" ref-type="bibr">Clissold
    et al., 2014</xref>) and was developed by Simpson &amp; Abisgold
    (<xref alt="1985" rid="ref-simpson_compensation_1985" ref-type="bibr">1985</xref>)
    from Dadd
    (<xref alt="1961" rid="ref-dadd_nutritional_1961" ref-type="bibr">1961</xref>).
    We dried diets to a constant mass at 60°C before weighing the diets
    before and after all experiments.</p>
    <p>We collected fourth and fifth instar nymphs from outbreaking
    populations on Nov. 12, 2015 from two locations: near Mendooran
    (31°40.791’ S, 149°04.209’ E) and Guntawang (32°23.988’ S,
    149°28.649’ E), New South Wales. The Mendooran population was
    forming marching bands while the Guntawang population was at high
    density but was not actively marching during the collection period.
    Both populations were collected along dirt roads flanked by
    livestock grazing pastures containing a mix of grasses and forbs. We
    transported locusts back to the Trangie Agricultural Research Centre
    and kept them in large plastic bins with holes along with an
    assortment of grasses and forbs cut from the same field locusts were
    collected until experiments were started. For both experiments,
    locusts were housed individually in plastic cages (ca. 18 cm L x 12
    cm W x 4 cm H) with small holes for ventilation. Each cage had two
    (nutritional target) or one (performance curve) artificial diets, a
    water tube capped with cotton, and a perch.</p>
    <sec id="nutrition-target-choice-diets">
      <title>2.2.1 Nutrition target (choice diets)</title>
      <p>We ran this experiment to determine the preferred dietary p:c
      ratio of Australian plague locust field populations. We selected
      equal numbers of males and females from both Mendooran and
      Guntawang populations and individuals that had no visible wing bud
      separation to ensure they were early in the fifth instar. Locusts
      were heated with incandescent light bulbs on a 14:10 light:dark
      cycle. The average daytime and nighttime temperatures in the cages
      were 25.5°C and 23.4°C respectively, recorded from an iButton
      (Maxim). We randomly assigned 80 locusts (20 individuals per diet
      pair per population) to one of two treatment groups receiving
      pairs of either 7p:35c &amp; 28p:14c or 7p:35c &amp; 35p:7c (% p :
      % c by dry mass). We used two different pairs to ensure that the
      selected p:c ratio was not the result of eating randomly between
      the two dishes. We let locusts eat from the dishes for three days
      (Nov. 12-15, 2015) and calculated the mass of protein and
      carbohydrate each locust ate by subtracting the final dish weights
      from the initial dish weights.</p>
    </sec>
    <sec id="performance-curve-no-choice-diets">
      <title>2.2.2 Performance curve (no-choice diets)</title>
      <p>We ran this experiment to determine the growth rate and
      development time to adulthood of Australian plague locust
      juveniles in response to different dietary p:c ratios. We isolated
      fourth instar nymphs from the Mendooran population and housed them
      in individual cages. Each day, we retrieved individuals that had
      molted into the fifth (final) stadium to incorporate into the
      experiment. We added an assortment of grasses and forbs collected
      from grazing pastures in the Research Centre to the cage of fourth
      instars daily. On day one of the fifth instar, locusts were
      randomly assigned to one of four artificial diet treatment groups:
      (7p:35c, 14p:28c, 21p:21c, or 35p:7c), with 18 locusts per
      treatment (similar numbers of males and females for each group).
      Fifth instar locusts were started on diets between Nov. 15-19 and
      we ended the experiment on Dec. 3, 2017. If locusts molted to
      adults before that point, we recorded the adult mass on the day
      they molted and ended that individual trial. We fed locusts their
      assigned diet ad lib such that there was always food available. We
      changed diets every three days until locusts molted to adults or
      until the experiment ended. Locusts were heated with incandescent
      light bulbs on a 14:10 Light:Dark cycle. The average daytime and
      nighttime temperatures in the cages were 26.2°C and 23.9°C,
      respectively, recorded from an iButton.</p>
    </sec>
  </sec>
  <sec id="field-cage-experiments">
    <title>2.3 Field cage experiments</title>
    <p>We ran this experiment to test the effects of different host
    plant nitrogen contents on locust nutrient balancing, growth, and
    survival. This experiment was conducted in a research field at the
    Trangie Research Centre that is used mainly for livestock grazing
    and had no history of fertilization. We marked nine 7 m x 7 m plots
    with 2 m alleyways between each plot. Each of the three nitrogen
    addition levels (0, 87.5, and 175 kg N/ha) was randomly assigned to
    three of the nine plots. We chose 175 kg N/ha as the upper range
    because this is similar to the fertilization rates of most crops. We
    added the fertilization treatment one time, on Nov. 2, 2015, in the
    form of urea, two weeks before a significant rainfall (ca. 60 mm).
    This treatment regime allowed us to see how increasing levels of
    nitrogen affected nutrient redressing and overall performance of
    locust populations through time.</p>
    <p>We built 0.75 x 0.75 x 0.75 m cages with four steel fence posts
    and aluminum mesh. We secured the mesh to the ground by partially
    burying it and nailing thin slats of wood over the mesh edges.
    Before adding locusts to the cages, we removed any plant litter and
    arthropods (mostly spiders and locusts) so we could more easily
    count the locusts and limit predation. We added 20 4th instar locust
    nymphs to each field cage on the evening of November 13th and
    morning of November 14th. We randomly selected these nymphs from the
    Mendooran population we collected on November 12th (see synthetic
    diet methods section above). Each fertilized plot had four cages,
    for a total of 12 cages per fertilization level, and 36 cages and
    720 locusts in total. We checked the cages every 4-5 days and
    removed any spiders.</p>
    <p>We measured plant diversity and abundance in each locust cage and
    outside the cage within each fertilized plot. We also measured
    ground, litter, manure, and plant cover in each of the nine plots by
    randomly tossing three 0.25 x 0.25 m quadrats within each of the
    nine plots. We took these ground cover and biodiversity measurements
    at the beginning and end of the experiment. We took plant leaf
    samples for nutrient analyses from each cage three times during the
    experiment on November 11th, November 25th, and December 1st, 2015.
    Plant species with resulting carbon, nitrogen, digestible
    carbohydrate and protein content as well as soil nitrogen (from 0-10
    cm cores) can be seen in
    <xref alt="Table 6" rid="tbl-field-cage-plant-soil-nutrients">Table 6</xref>.
    Plant species ground cover for each cage can be seen in
    <xref alt="Table 7" rid="tbl-field-cage-plant-ground-cover">Table 7</xref>.
    The relationship between soil NO3 and NO4 within cage plots and cage
    plant carbohydrates and proteins are visualized in
    <xref alt="Supplementary Figure 1" rid="suppfig-field-cage-plant-soil-nutrient-correlations">Supplementary Figure 1</xref>.</p>
    <p>To test how the nitrogen fertilization treatments affected the
    nutritional status of the locusts, we collected 20 locusts from
    control and high N treatment cages (40 individuals in total) on
    November 23, 2015. We housed them in individual cages and gave them
    the choice of a low protein: carbohydrate diet and a high protein:
    carbohydrate diet. We changed their diets on days one, two, four,
    and six and ended the experiment at day nine. To ensure an adequate
    sample size, we included data from any individuals that died
    (approximately 60% mortality) before the experiment was completed
    and individuals which molted during the experiment. We calculated
    the mass of protein and carbohydrate locusts ate over each interval.
    This allowed us to see the nutritional redressing of
    individuals.</p>
    <p>We collected all remaining field-cage locusts on Nov. 28, 2015
    and recorded developmental stage and body mass. We calculated
    surviving proportion for each cage accounting for the locusts we
    removed for the nutritional status experiments (surviving proportion
    = # live locusts/(initial # added-# locusts removed for secondary
    experiment)). We calculated the proportion molted to adult of the
    surviving locusts (# adults/# live locusts).</p>
  </sec>
  <sec id="correlating-historical-nymphal-outbreaks-with-soil-nitrogen-and-phosphorus">
    <title>2.4 Correlating historical nymphal outbreaks with soil
    nitrogen and phosphorus</title>
    <p>To understand the relationship between soil nutrients and locust
    outbreaks, we used the Australian Plague Locust Commission’s (APLC)
    long-term locust survey dataset
    (<xref alt="T. Deveson &amp; Hunter, 2002" rid="ref-deveson_operation_2002" ref-type="bibr">T.
    Deveson &amp; Hunter, 2002</xref>) and the Soil and Landscape Grid
    Australia-Wide 3D Soil Property Maps
    (<xref alt="Grundy et al., 2015" rid="ref-grundy_soil_2015" ref-type="bibr">Grundy
    et al., 2015</xref>).</p>
    <sec id="locust-outbreak-data">
      <title>2.4.1 Locust outbreak data</title>
      <p>Australian plague locust data from 2000 - 2017 (~ 190,000
      records) were used in this study. This database contains
      georeferenced points with a categorical ordinal variable 0-4 to
      represent approximate nymph densities. The value ranges for nymphs
      are: 0 = nil, 1 = &lt; 5 m2, 2 = 5-30 m2, 3 = 31-80 m2, and 4 =
      &gt; 80 m2. Population outbreaks are characterized by very high
      densities of gregarious nymphs (up to 1000 m2). We focused on
      nymphs as this life stage cannot fly and can be used to assess
      prior local habitat conditions. While the database extends into
      the 1980s, we only used data collected between 2000-2017 as this
      period overlapped with the soil grid data which was released in
      2015. Since climatic conditions and migration patterns are drivers
      in outbreak occurrence
      (<xref alt="Lawton et al., 2022" rid="ref-lawton_seeing_2022" ref-type="bibr">Lawton
      et al., 2022</xref>;
      <xref alt="Veran et al., 2015" rid="ref-veran_modeling_2015" ref-type="bibr">Veran
      et al., 2015</xref>) they likely mask the relationship between
      static environmental variables like soil nutrients. To account for
      this variability, we spatially aggregated the survey dataset to a
      1 km2 x 1 km2 grid as can be seen in
      <xref alt="Supplementary Figure 2" rid="suppfig-grid-example">Supplementary Figure 2</xref>.
      This allowed us to model how often locust outbreaks occur in grid
      cells rather than the actual outbreak. We used a 1 km2 x 1 km2
      grid as this reflects the estimated maximum dispersal distance
      from hatching to 5th instar
      (<xref alt="Hunter et al., 2008" rid="ref-hunter_aerial_2008" ref-type="bibr">Hunter
      et al., 2008</xref>). We counted the number of outbreaks (APLC
      nymph density code 4), the number of nil records (APLC nymph
      density code 0), and total number of survey observations. This
      resulted in approximately 12,000 grid cells for the final dataset.
      Overall APLC survey point distribution can be seen in
      <xref alt="Figure 1" rid="fig-spatial-modeling-env-map">Figure 1</xref>
      A.</p>
    </sec>
    <sec id="soil-grid-of-australia-data">
      <title>2.4.2 Soil grid of Australia data</title>
      <p>The soil and landscape grid of Australia is a modeled raster of
      12 soil variables at a 90 m2 resolution. These soil
      characteristics are available at multiple depths from surface to
      two meters below the surface. These depths and methodology are
      consistent with the specifications of the Global Soil Map project
      (http://www.globalsoilmap.net)
      (<xref alt="Grundy et al., 2015" rid="ref-grundy_soil_2015" ref-type="bibr">Grundy
      et al., 2015</xref>). We extracted this data from Google Earth
      Engine
      (<xref alt="Gorelick et al., 2017" rid="ref-gorelick_google_2017" ref-type="bibr">Gorelick
      et al., 2017</xref>). In this data set both phosphorus and
      nitrogen units are the mass fraction of total nutrient in the soil
      by weight. We took the average of nitrogen and phosphorus of the
      top two depths (0 cm – 5 cm and 5 cm and 15 cm) as these are most
      relevant to nutrient content of grasses and forbs. Then, for each
      APLC survey grid we calculated the mean mass fraction of nitrogen
      and phosphorus in the soil by weight to a 15 cm depth. Spatial
      distribution of soil nitrogen and phosphorus can be seen in
      <xref alt="Figure 1" rid="fig-spatial-modeling-env-map">Figure 1</xref>
      B and
      <xref alt="Figure 1" rid="fig-spatial-modeling-env-map">Figure 1</xref>
      C respectively.</p>
      <fig id="fig-spatial-modeling-env-map">
        <caption><p>Figure 1: Locust survey data map and soil nutrients
        throughout the Australian plague locust distribution. A: APLC
        survey dataset, B: mean proportion phosphorous at 0-15cm deep,
        C: mean proportion of nitrogen at 0-15 cm deep.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/spatial_modeling_locust_env_map.png" />
      </fig>
    </sec>
  </sec>
  <sec id="statistics">
    <title>2.5 Statistics</title>
    <p>All statistics were conducted with a generalized additive mixed
    modeling (GAMM) approach when possible. This allowed us to test for
    non-linear and linear trends in the dataset and specify the
    hierarchical nature of the data. All statistics were conducted in R
    and python. All scripts and packages used can be seen within the
    project code repository:
    <ext-link ext-link-type="uri" xlink:href="./path/to/repo">github
    repo</ext-link></p>
    <sec id="intake-targets">
      <title>2.5.1 Intake Targets</title>
      <p>To determine intake targets, we constructed GAM (family:
      Multivariate Normal Distribution, Link: Identity) with the
      following variables when possible: diet pairing (factor), locust
      sex (factor), time period interval (integer), locust initial
      weight (numeric) following roughly the procedure found in Lawton
      et al.
      (<xref alt="2021" rid="ref-lawton_mismatched_2021" ref-type="bibr">2021</xref>).
      We selected the inclusion of locust weight as either a non-linear
      or linear effect via Akaike information criterion (AIC), AIC
      adjusted for small sample size (AICc), and Bayesian information
      criterion (BIC). If weight was not an important variable, it was
      removed entirely from the model.</p>
    </sec>
    <sec id="field-population">
      <title>2.5.2 Field population</title>
      <p>We calculated intake targets as discussed above. To see the
      impact of confined diet treatments, we constructed GAMs (family:
      gaussian, link: identity) with the following variables: treatment
      (factor), locust sex (factor), population (factor), and locust
      initial weight (numeric).</p>
    </sec>
    <sec id="field-cage">
      <title>2.5.3 Field Cage</title>
      <p>We assessed plant nutrients with a GAMM (family: Multivariate
      Normal Distribution, link: identity) and included the following
      variables: plant carbohydrate (numeric, dependent), plant protein
      (numeric, dependent), treatment (factor, independent), cage
      (factor, random effect), plot (factor, random effect), and plant
      species (random effect). Redressing intake targets were conducted
      as discussed above (section 2.5.1). To see the difference between
      physiological performance and fertilizer treatments, we
      constructed GAMMs (family: Scaled T distribution, link: identity)
      for final locust mass. The independent variables in all models
      were treatment (factor), sex (factor), a two-dimensional smoother
      of available protein and carbohydrate, and cage number as a random
      effect. For both final adult proportion and survival proportion,
      we constructed a GAM (Family: Beta, Link: identity) and included
      the following variables: treatment (factor) and a two-dimensional
      smoother of available protein and carbohydrate.</p>
    </sec>
    <sec id="historical-outbreaks-and-soil-nutrient-grid-modeling">
      <title>2.5.4 Historical outbreaks and soil nutrient grid
      modeling</title>
      <p>To relate nymph survey grids to soil nitrogen and phosphorus,
      we constructed two GAMMs (family: tweedie, link: log) predicting
      the number of outbreaks (APLC Survey Category 4) and nil
      observations (category 0). Since both soil nitrogen and mean
      annual precipitation are highly correlated (Pearson correlation =
      0.93) with both variables decreasing going into the arid interior
      of Australia, we are unable to add precipitation directly to the
      model as it would bias the results. Instead, we built a comparison
      model with mean annual precipitation between 2000 and 2017
      switched for soil nitrogen. To do this, we calculated the average
      precipitation between 2000 and 2017 for all survey grids using the
      European Centre for Medium-Range Weather Forecasts’ ERA5
      reanalysis dataset
      (<xref alt="Muñoz-Sabater et al., 2021" rid="ref-munoz-sabater_era5-land_2021" ref-type="bibr">Muñoz-Sabater
      et al., 2021</xref>). This allowed us to visually compare the
      effect differences of soil nitrogen and mean annual precipitation
      on locust outbreaks. In other words, if soil nitrogen and mean
      annual precipitation were so tightly correlated that the effects
      are indistinguishable, the modeled results should look very
      similar. The soil models had the following independent variables:
      soil nitrogen, phosphorus, latitude / longitude, bioregion, and
      the number of observations within each grid. For the precipitation
      model, all variables were the same except mean annual
      precipitation replaced soil nitrogen and phosphorus. The inclusion
      of bioregions as a random effect allowed us to account for
      variation due to vegetation community and soil characteristics.
      The inclusion of latitude and longitude allowed us to account for
      spatial autocorrelation
      (<xref alt="Clayton et al., 1993" rid="ref-clayton_spatial_1993" ref-type="bibr">Clayton
      et al., 1993</xref>). Lastly, the inclusion of the total number of
      observations allowed us to account for sampling intensity
      biases.</p>
    </sec>
  </sec>
</sec>
<sec id="results">
  <title>3. RESULTS</title>
  <sec id="field-population-1">
    <title>3.1 Field population</title>
    <sec id="choice-experiment-nutritional-target">
      <title>3.1.1 Choice experiment (nutritional target)</title>
      <p>Australian plague locust individuals from the two outbreaking
      populations regulated to a specific ratio of 1 protein : 2
      carbohydrate
      (<xref alt="Figure 2" rid="fig-field-pop-it-results">Figure 2</xref>
      A,<xref alt="Table 1" rid="tbl-field-population-it-model">Table 1</xref>).
      Model selection can be seen in
      <xref alt="Table 8" rid="tbl-field-population-choice-experiment-model-selection-criteria">Table 8</xref>.
      Consumption in the two diet pairings did not differ, indicating
      non-random feeding
      (<xref alt="Supplementary Figure 3" rid="suppfig-field-pop-nutrients">Supplementary Figure 3</xref>
      A,
      <xref alt="Table 1" rid="tbl-field-population-it-model">Table 1</xref>).
      While the protein : carbohydrate ratio did not change, females
      consumed more food than males, likely due to being bigger overall
      (<xref alt="Supplementary Figure 3" rid="suppfig-field-pop-nutrients">Supplementary Figure 3</xref>
      B,
      <xref alt="Table 1" rid="tbl-field-population-it-model">Table 1</xref>).</p>
      <fig id="tbl-field-population-it-model">
        <caption><p>Table 1: Generalized additive model results for
        macronutrient consumption (carbohydrate and protein) of two
        outbreaking populations of Australian plague locust in Mendooran
        and Guntawang. Models were selected via AIC, AICc and BIC which
        can be seen in
        <xref alt="Table 8" rid="tbl-field-population-choice-experiment-model-selection-criteria">Table 8</xref>.
        Family: multivariate gaussian distribution, link: identity, SE:
        standard error.</p></caption>
        <table-wrap>
          <table>
            <colgroup>
              <col width="100%" />
            </colgroup>
            <tbody>
              <tr>
                <td align="center"><p specific-use="wrapper">
                  <table-wrap>
                    <table>
                      <colgroup>
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th id="macronutrient" scope="col">macronutrient</th>
                          <th id="variable" scope="col">variable</th>
                          <th id="estimate" scope="col">estimate</th>
                          <th id="SE" scope="col">SE</th>
                          <th id="statistic" scope="col">statistic</th>
                          <th id="p-value" scope="col">p-value</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td headers="macronutrient">carbohydrate</td>
                          <td headers="variable">Intercept</td>
                          <td headers="estimate">0.013</td>
                          <td headers="SE">0.004</td>
                          <td headers="statistic"><break/></td>
                          <td headers="p-value">0.001</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">male</td>
                          <td headers="estimate">-0.011</td>
                          <td headers="SE">0.004</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.009</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 2</td>
                          <td headers="estimate">0.007</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.008</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 3-4</td>
                          <td headers="estimate">0.016</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 5-6</td>
                          <td headers="estimate">0.026</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 7-9</td>
                          <td headers="estimate">0.035</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">none</td>
                          <td headers="estimate">-0.006</td>
                          <td headers="SE">0.004</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.136</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">s(id)</td>
                          <td headers="estimate"><break/></td>
                          <td headers="SE"><break/></td>
                          <td headers="statistic">484.706</td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient">protein</td>
                          <td headers="variable">Intercept</td>
                          <td headers="estimate">0.002</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.119</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">male</td>
                          <td headers="estimate">-0.004</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.009</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 2</td>
                          <td headers="estimate">0.001</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.724</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 3-4</td>
                          <td headers="estimate">0.003</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.023</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 5-6</td>
                          <td headers="estimate"></td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 7-9</td>
                          <td headers="estimate"></td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">none</td>
                          <td headers="estimate">-0.001</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.475</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">s(id)</td>
                          <td headers="estimate"></td>
                          <td headers="SE"><break/></td>
                          <td headers="statistic">110.728</td>
                          <td headers="p-value">0.381</td>
                        </tr>
                      </tbody>
                    </table>
                  </table-wrap>
                </p></td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </fig>
    </sec>
    <sec id="no-choice-experiment-performance-curves">
      <title>3.1.2 No choice experiment (performance curves)</title>
      <p>Australian plague locusts had higher specific mass growth rates
      and shorter development times on the 1 protein : 2 carbohydrate
      (14 protein : 28 carbohydrate) diet as compared to the other diets
      (<xref alt="Figure 2" rid="fig-field-pop-it-results">Figure 2</xref>
      B &amp; C,
      <xref alt="Table 2" rid="tbl-field-population-no-choice-model">Table 2</xref>,
      <xref alt="Table 9" rid="tbl-field-population-no-choice-experiment-phys-post-hoc">Table 9</xref>).
      Development time and specific growth rate did not different
      between male and female locusts
      (<xref alt="Supplementary Figure 3" rid="suppfig-field-pop-nutrients">Supplementary Figure 3</xref>
      C &amp; D,
      <xref alt="Table 2" rid="tbl-field-population-no-choice-model">Table 2</xref>).</p>
      <fig id="fig-field-pop-it-results">
        <caption><p>Figure 2: The nutritional preference (A) and
        physiological performance (B &amp; C) of C. terminifera
        individuals were collected from two marching bands of 5th
        instars.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_population_intake_target_figure.png" />
      </fig>
      <fig id="tbl-field-population-no-choice-model">
        <caption><p>Table 2: Australian plague locust physiological
        performance (specific growth rate and development time) when
        constrained to specific diets with varying protein and
        carbohydrate content. SE: standard error. Posthoc comparisons
        for both physiological performance metrics can be seen in
        <xref alt="Table 9" rid="tbl-field-population-no-choice-experiment-phys-post-hoc">Table 9</xref>.</p></caption>
        <table-wrap>
          <table>
            <colgroup>
              <col width="100%" />
            </colgroup>
            <tbody>
              <tr>
                <td align="center"><p specific-use="wrapper">
                  <table-wrap>
                    <table>
                      <colgroup>
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th rowspan="2" id="variable" scope="col">variable</th>
                          <th colspan="3" id="SpecificU0020GrowthU0020Rate" scope="colgroup"><named-content content-type="gt_column_spanner">Specific
                          Growth Rate</named-content></th>
                          <th colspan="3" id="DevelopmentU0020Time" scope="colgroup"><named-content content-type="gt_column_spanner">Development
                          Time</named-content></th>
                        </tr>
                        <tr>
                          <th id="estimate" scope="col">estimate</th>
                          <th id="SE" scope="col">SE</th>
                          <th id="p-value" scope="col">p-value</th>
                          <th id="estimate" scope="col">estimate</th>
                          <th id="SE" scope="col">SE</th>
                          <th id="p-value" scope="col">p-value</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td headers="variable">Intercept</td>
                          <td headers="estimate_specific growth rate">0.061</td>
                          <td headers="SE_specific growth rate">0.004</td>
                          <td headers="p-value_specific growth rate">0.000</td>
                          <td headers="estimate_development time">15.780</td>
                          <td headers="SE_development time">1.555</td>
                          <td headers="p-value_development time">0.000</td>
                        </tr>
                        <tr>
                          <td headers="variable">21p:21c</td>
                          <td headers="estimate_specific growth rate">-0.011</td>
                          <td headers="SE_specific growth rate">0.005</td>
                          <td headers="p-value_specific growth rate">0.040</td>
                          <td headers="estimate_development time">0.917</td>
                          <td headers="SE_development time">0.624</td>
                          <td headers="p-value_development time">0.149</td>
                        </tr>
                        <tr>
                          <td headers="variable">35p:7c</td>
                          <td headers="estimate_specific growth rate">-0.010</td>
                          <td headers="SE_specific growth rate">0.006</td>
                          <td headers="p-value_specific growth rate">0.091</td>
                          <td headers="estimate_development time">1.709</td>
                          <td headers="SE_development time">0.665</td>
                          <td headers="p-value_development time">0.013</td>
                        </tr>
                        <tr>
                          <td headers="variable">7p:35c</td>
                          <td headers="estimate_specific growth rate">-0.026</td>
                          <td headers="SE_specific growth rate">0.005</td>
                          <td headers="p-value_specific growth rate">0.000</td>
                          <td headers="estimate_development time">2.716</td>
                          <td headers="SE_development time">0.603</td>
                          <td headers="p-value_development time">0.000</td>
                        </tr>
                        <tr>
                          <td headers="variable">male</td>
                          <td headers="estimate_specific growth rate">-0.003</td>
                          <td headers="SE_specific growth rate">0.004</td>
                          <td headers="p-value_specific growth rate">0.398</td>
                          <td headers="estimate_development time">-1.615</td>
                          <td headers="SE_development time">0.829</td>
                          <td headers="p-value_development time">0.057</td>
                        </tr>
                        <tr>
                          <td headers="variable">initial weight (g)</td>
                          <td headers="estimate_specific growth rate"><break/></td>
                          <td headers="SE_specific growth rate"><break/></td>
                          <td headers="p-value_specific growth rate"><break/></td>
                          <td headers="estimate_development time">-21.048</td>
                          <td headers="SE_development time">10.407</td>
                          <td headers="p-value_development time">0.049</td>
                        </tr>
                      </tbody>
                    </table>
                  </table-wrap>
                </p></td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </fig>
    </sec>
  </sec>
  <sec id="field-cage-1">
    <title>3.2 Field Cage</title>
    <p>For the first 11 days of the 14 day field cage experiment, plant
    protein and carbohydrate contents remained consistently
    protein-biased for all treatments
    (<xref alt="Figure 3" rid="fig-field-cage-time-results">Figure 3</xref>
    A-C,
    <xref alt="Table 3" rid="tbl-field-cage-plant-nutrients">Table 3</xref>),
    and only showed differences in protein content by the last sample
    period on December 1, which was after the end of the locust cage
    experiment. Accordingly, there was no effect of fertilizer on locust
    survival and adult proportion, though locusts in the medium level
    nitrogen fertilizer treatment were heavier than locusts in the high
    nitrogen fertilizer treatment (TukeyHSD: difference: -0.043,
    p-value: &lt; 0.001)
    ((<xref alt="Figure 3" rid="fig-field-cage-time-results">Figure 3</xref>
    D-F,
    <xref alt="Table 4" rid="tbl-field-cage-locust-mass">Table 4</xref>).
    Locusts that were retrieved from field cages after nine days and
    were given a choice to regulate protein and carbohydrate intake
    showed a pattern consistent with rebalancing a shortage of
    carbohydrates
    (<xref alt="Figure 4" rid="fig-field-cage-it-rebalancing">Figure 4</xref>,
    <xref alt="Table 5" rid="tbl-field-cage-rebalancing">Table 5</xref>,
    <xref alt="Supplementary Figure 4" rid="suppfig-field-cage-rebalancing-facet">Supplementary Figure 4</xref>).
    Irrespective of fertilizer treatment group, locusts initially
    selected very carbohydrate biased diets, but gradually, after 9
    days, their trajectory returned close to the predicted intake target
    of 1p : 2c
    (<xref alt="Figure 4" rid="fig-field-cage-it-rebalancing">Figure 4</xref>,
    <xref alt="Supplementary Figure 4" rid="suppfig-field-cage-rebalancing-facet">Supplementary Figure 4</xref>).</p>
    <fig id="fig-field-cage-time-results">
      <caption><p>Figure 3: Nitrogen addition field cage experiments
      with plant nutrient change through time (A-C) and grasshopper
      performance metrics (D-F) are shown. Dashed line represents a 1p :
      2c ratio, the solid line represents a 1p : 1c ratio.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_plant_locust_figure.png" />
    </fig>
    <fig id="fig-field-cage-it-rebalancing">
      <caption><p>Figure 4: Nutrient imbalance redressing with
      artificial diet mixing of C. terminifera individuals taken from
      fertilized treatment cages. Colors represent treatment with large
      lines and points representing overall means. Individual time step
      targets can be seen in
      <xref alt="Supplementary Figure 4" rid="suppfig-field-cage-rebalancing-facet">Supplementary Figure 4</xref>.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_locust_intake_target_rebalancing.png" />
    </fig>
    <fig id="tbl-field-cage-plant-nutrients">
      <caption><p>Table 3: Generalized additive model results for plant
      macronutrient (carbohydrate and protein) differences between
      fertilization treatment. Family: multivariate gaussian
      distribution, link: identity, SE: standard error, significance
      indicated in bold.</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="100%" />
          </colgroup>
          <tbody>
            <tr>
              <td align="center"><p specific-use="wrapper">
                <table-wrap>
                  <table>
                    <colgroup>
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                    </colgroup>
                    <thead>
                      <tr>
                        <th id="macronutrient" scope="col">macronutrient</th>
                        <th id="variable" scope="col">variable</th>
                        <th id="estimate" scope="col">estimate</th>
                        <th id="SE" scope="col">SE</th>
                        <th id="statistic" scope="col">statistic</th>
                        <th id="p-value" scope="col">p-value</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td headers="macronutrient">carbohydrate</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.127</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium</td>
                        <td headers="estimate">-0.020</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.005</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High</td>
                        <td headers="estimate">-0.011</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.121</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-11-25</td>
                        <td headers="estimate">-0.009</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.181</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-12-01</td>
                        <td headers="estimate">-0.012</td>
                        <td headers="SE">0.006</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.033</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-11-25</td>
                        <td headers="estimate">0.019</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.063</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-11-25</td>
                        <td headers="estimate">0.004</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.656</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-12-01</td>
                        <td headers="estimate">0.019</td>
                        <td headers="SE">0.008</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.017</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-12-01</td>
                        <td headers="estimate">0.010</td>
                        <td headers="SE">0.008</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.222</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(species)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">67.305</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(plot)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">1.643</td>
                        <td headers="p-value">0.207</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(cage)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">3.442</td>
                        <td headers="p-value">0.130</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient">protein</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.209</td>
                        <td headers="SE">0.017</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium</td>
                        <td headers="estimate">-0.001</td>
                        <td headers="SE">0.014</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.928</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High</td>
                        <td headers="estimate">-0.034</td>
                        <td headers="SE">0.014</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.014</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-11-25</td>
                        <td headers="estimate">0.026</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.014</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-12-01</td>
                        <td headers="estimate">-0.049</td>
                        <td headers="SE">0.009</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-11-25</td>
                        <td headers="estimate">-0.012</td>
                        <td headers="SE">0.015</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.422</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-11-25</td>
                        <td headers="estimate">-0.023</td>
                        <td headers="SE">0.015</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.123</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-12-01</td>
                        <td headers="estimate">0.008</td>
                        <td headers="SE">0.013</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.516</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-12-01</td>
                        <td headers="estimate">0.056</td>
                        <td headers="SE">0.013</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(species)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">307.929</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(plot)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">214.489</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(cage)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">89.944</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                    </tbody>
                  </table>
                </table-wrap>
              </p></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    <fig id="tbl-field-cage-locust-mass">
      <caption><p>Table 4: Generalized additive model results for
      differences between final locust mass after the nitrogen
      fertilization experiment finished. Family: scaled T, link:
      identity, SE: standard error.</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="100%" />
          </colgroup>
          <tbody>
            <tr>
              <td align="center"><p specific-use="wrapper">
                <table-wrap>
                  <table>
                    <colgroup>
                      <col width="20%" />
                      <col width="20%" />
                      <col width="20%" />
                      <col width="20%" />
                      <col width="20%" />
                    </colgroup>
                    <thead>
                      <tr>
                        <th id="variable" scope="col">variable</th>
                        <th id="estimate" scope="col">estimate</th>
                        <th id="SE" scope="col">SE</th>
                        <th id="statistic" scope="col">statistic</th>
                        <th id="p-value" scope="col">p-value</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.326</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="variable">male</td>
                        <td headers="estimate">-0.148</td>
                        <td headers="SE">0.006</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="variable">medium</td>
                        <td headers="estimate">0.015</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.117</td>
                      </tr>
                      <tr>
                        <td headers="variable">high</td>
                        <td headers="estimate">-0.011</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.273</td>
                      </tr>
                      <tr>
                        <td headers="variable">s(carb_mg_mg,protein_mg_mg)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">0.002</td>
                        <td headers="p-value">0.416</td>
                      </tr>
                      <tr>
                        <td headers="variable">s(cage_num)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">42.160</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                    </tbody>
                  </table>
                </table-wrap>
              </p></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    <fig id="tbl-field-cage-rebalancing">
      <caption><p>Table 5: Generalized additive model results for
      nutrient imbalance dressing of field cage Australian plague locust
      in the control and high fertilization treatments. Model also
      included interactive terms; however, none were significant and
      left out. SE: standard error</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="100%" />
          </colgroup>
          <tbody>
            <tr>
              <td align="center"><p specific-use="wrapper">
                <table-wrap>
                  <table>
                    <colgroup>
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                    </colgroup>
                    <thead>
                      <tr>
                        <th id="macronutrient" scope="col">macronutrient</th>
                        <th id="variable" scope="col">variable</th>
                        <th id="estimate" scope="col">estimate</th>
                        <th id="SE" scope="col">SE</th>
                        <th id="statistic" scope="col">statistic</th>
                        <th id="p-value" scope="col">p-value</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td headers="macronutrient">carbohydrate</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.013</td>
                        <td headers="SE">0.004</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.001</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">male</td>
                        <td headers="estimate">-0.011</td>
                        <td headers="SE">0.004</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.009</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 2</td>
                        <td headers="estimate">0.007</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.008</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 3-4</td>
                        <td headers="estimate">0.016</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 5-6</td>
                        <td headers="estimate">0.026</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 7-9</td>
                        <td headers="estimate">0.035</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">none</td>
                        <td headers="estimate">-0.006</td>
                        <td headers="SE">0.004</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.136</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(id)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">484.706</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient">protein</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.002</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.119</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">male</td>
                        <td headers="estimate">-0.004</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.009</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 2</td>
                        <td headers="estimate">0.001</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.724</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 3-4</td>
                        <td headers="estimate">0.003</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.023</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 5-6</td>
                        <td headers="estimate">0.007</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 7-9</td>
                        <td headers="estimate">0.013</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">none</td>
                        <td headers="estimate">-0.001</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.475</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(id)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">110.728</td>
                        <td headers="p-value">0.381</td>
                      </tr>
                    </tbody>
                  </table>
                </table-wrap>
              </p></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
  </sec>
  <sec id="locust-outbreaks">
    <title>3.3 Locust outbreaks</title>
    <p>Australian plague locust outbreaks were negatively associated
    with soil nitrogen, which supports the hypothesis that nitrogen (in
    excess) acts as a limiting factor for population upsurges (Table 6,
    Fig. 5A). Australian plague locusts had a nonlinear relationship
    with soil phosphorus with outbreaks occurring more often in areas
    with approximately 4% soil phosphorus and were strongly negatively
    associated with increasing phosphorus afterwards (Fig. 5B). For both
    nutrients, the absence models had a very weak relationship with soil
    nutrient in comparison to the outbreak models, demonstrating little
    model bias due to APLC survey protocol. There were significant
    nonlinear relationships between coordinates and the total number of
    observations in all models (Supplementary Figs. 5 &amp; 6). The
    relationship between locust outbreaks and mean annual precipitation
    (e.g. nonlinear) was very different from the relationship with soil
    nitrogen (e.g. linear; Fig. 5, Supplementary Fig. 7). Soil nitrogen
    and phosphorus show weak positive correlations with woody vegetation
    cover, while mean annual precipitation exhibits high variation in
    its relationship with soil nitrogen and weak correlation with soil
    phosphorus (Supplementary Figure 8). Thus, the relationship between
    soil nitrogen and locust outbreaks cannot be fully explained by
    differences in woody vegetation.</p>
  </sec>
</sec>
<sec id="discussion">
  <title>4. DISCUSSION</title>
  <p>We show that herbivore diet preferences remain consistent between
  spatial levels, from individual foraging behavior and physiology to
  large scale population dynamics, with locust populations negatively
  related to environmental nitrogen. Thus by going across scales, this
  study shows a consistent pattern of excess nitrogen limiting a pest
  herbivore and introduces a more nuanced view of phosphorus limitation
  on herbivore populations. Instead of the broad generalization that
  animals are always negatively or positively associated with certain
  nutrients, specific life history traits, such as energetically-costly
  migration, as well as organism-environment interactions should be
  considered. For forecasting pest populations dynamics, adding
  variables describing the nutritional quality of landscapes can inform
  seasonal scouting surveys. We hope that this study spurs future
  interest in multi-scale experiments and modeling of nutrient
  availability with animal population dynamics.</p>
  <sec id="field-populations">
    <title>4.1 Field populations</title>
    <p>Field populations of final instar Australian plague locusts
    behaviorally regulated to a 1 protein (p) : 2 carbohydrate (c)
    nutrient ratio, which supported the fastest nymphal growth and the
    lowest development time to adulthood (Fig. 2B &amp; C), consistent
    with previous studies
    (<xref alt="Clissold et al., 2014" rid="ref-clissold_regulation_2014" ref-type="bibr">Clissold
    et al., 2014</xref>;
    <xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021" ref-type="bibr">Lawton
    et al., 2021</xref>). Locusts are highly mobile (Australian plague
    locusts can fly up to 500 km in a single night,
    (<xref alt="Deveson &amp; Walker, 2005" rid="ref-deveson_not_2005" ref-type="bibr">Deveson
    &amp; Walker, 2005</xref>)) and the demand for energy via
    carbohydrates and lipids likely increases relative to protein demand
    during the later life stages of these animals.</p>
    <p>Plant nutrient content in the nitrogen fertilization treatments
    was not significantly different until the last sample period, which
    likely explains the small effect on locust growth (Fig. 3A-C). Over
    the experimental period, protein content decreased in unfertilized
    treatments while both plant protein and carbohydrate remained
    constant in the fertilized treatments. If we prolonged the
    experiment, there might have been a noticeable difference in locust
    survivorship, weight gain, and adult proportion given the shift in
    nutrients among treatments (Fig. 3D-F).</p>
    <p>Importantly, all field cage plants were protein biased (roughly
    1p : 1c to 2p : 1c ) as compared to the desired locust intake target
    of 1p : 2c. When locusts were subsampled from the field cages
    mid-experiment and given the opportunity to select carbohydrate or
    protein diets, they selected extremely carbohydrate-biased diets for
    more than a week. This behavior indicated that locusts in the small
    field cages were highly carbohydrate-limited, driving them to
    overeat carbohydrates to redress the imbalance. Interestingly,
    multiple studies have shown that the Australian nutritional
    landscape is often too protein-biased relative to what the
    Australian plague locust prefers
    (<xref alt="Lawton et al., 2020" rid="ref-lawton_woody_2020" ref-type="bibr">Lawton
    et al., 2020</xref>,
    <xref alt="2021" rid="ref-lawton_mismatched_2021" ref-type="bibr">2021</xref>).
    Regardless, populations are still persistent and outbreaks can occur
    at lower frequencies in these areas
    (<xref alt="Deveson, 2013" rid="ref-deveson_satellite_2013" ref-type="bibr">Deveson,
    2013</xref>;
    <xref alt="Key, 1945" rid="ref-key_general_1945" ref-type="bibr">Key,
    1945</xref>). How this species can achieve the optimal balance of
    nutrients within an unfavorable nutritional environment merits
    further investigation, but may include postingestive regulation
    and/or large-range foraging. Migratory locusts (Locusta migratoria)
    can choose microclimates that favor higher efficiency of
    carbohydrate or protein absorption depending on their host plant and
    nutritional status
    (<xref alt="Clissold et al., 2013" rid="ref-clissold_insect_2013" ref-type="bibr">Clissold
    et al., 2013</xref>). For this study, we collected free-living
    locusts from the same region and a similar environment as where we
    built the field cages, yet those confined to field cages selected a
    10 x decrease in p:c (1p : 20c vs 1p : 2c). This result suggests
    that free-living locusts are able to persist in high protein regions
    by foraging over a larger range to seek out pockets of
    carbohydrate-rich plants and that the limited foraging range of the
    field cages precluded field-cage locusts from finding sufficient
    carbohydrates. Similarly, these results suggest that, while
    Australian plague locusts can persist in low numbers in nitrogen
    rich regions, those environments are unlikely to support extreme
    outbreaks due to a limitation of carbohydrate-rich resources. We
    tested this prediction using historical outbreak and large-scale
    soil nutrient modeling.</p>
  </sec>
  <sec id="historical-outbreak-modeling">
    <title>4.2 Historical outbreak modeling</title>
    <p>This is the first time to our knowledge that terrestrial animal
    population dynamics have been modeled with nutrients at the
    continental level, allowing nutrient limitation to be tested at a
    scale not previously investigated. Locust outbreaks are associated
    with decreasing soil nitrogen (Fig. 5A), suggesting that nitrogen
    acts as a limiting factor not due to its deficit
    (<xref alt="White, 1993" rid="ref-white_inadequate_1993" ref-type="bibr">White,
    1993</xref>) but its excess. Plants growing in high nitrogen
    environments tend to have high p:c ratios, which force locusts to
    either undereat carbohydrates (limiting their energy to support
    growth and migration) or overeat protein (which can be toxic) to
    acquire sufficient carbohydrates
    (<xref alt="Behmer, 2009" rid="ref-behmer_insect_2009" ref-type="bibr">Behmer,
    2009</xref>;
    <xref alt="Cease, 2024" rid="ref-cease_how_2024" ref-type="bibr">Cease,
    2024</xref>). On the other end of the performance curve, Australian
    plague locusts do have a lower p:c range that limits performance, as
    shown using artificial diets (Fig. 2B-C). However, our outbreak
    models found no lower limit (Fig 5A), suggesting that locusts do not
    often encounter environments where protein deficit limits their
    growth. This result is consistent with other research that found
    most grasses across New South Wales tend to have higher p:c ratios
    than locusts require
    (<xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021" ref-type="bibr">Lawton
    et al., 2021</xref>). Even when locusts have access to low p:c
    plants it is more difficult for them to extract carbohydrate than
    protein
    (<xref alt="Clissold et al., 2006" rid="ref-clissold_paradoxical_2006" ref-type="bibr">Clissold
    et al., 2006</xref>), further exacerbating the problem of relative
    protein excess. Interestingly, this relationship between nitrogen
    and locusts stays consistent throughout multiple spatial levels
    which suggests that it scales linearly; an uncommon characteristic
    in ecology
    (<xref alt="Levin, 1992" rid="ref-levin_problem_1992" ref-type="bibr">Levin,
    1992</xref>;
    <xref alt="Wiens, 1989" rid="ref-wiens_spatial_1989" ref-type="bibr">Wiens,
    1989</xref>). We also show that outbreaks are correlated with a low
    level of soil phosphorus, however, outbreaks peak at approximately
    4%, suggesting that while locusts generally do well in low
    phosphorus environments, phosphorus deficit can be limiting for
    locusts in extremely phosphorus poor soils (Fig. 5B). Because
    Australian soils are characteristically phosphorus poor
    (<xref alt="Donald, 1964" rid="ref-donald_colin_phosphorus_1964" ref-type="bibr">Donald,
    1964</xref>), Australian animals like this locust are adapted to
    phosphorus poor environments and potentially having too much
    phosphorus is deleterious
    (<xref alt="Morton et al., 2011" rid="ref-morton_fresh_2011" ref-type="bibr">Morton
    et al., 2011</xref>). Locust populations may be more tightly
    correlated with soil nitrogen than phosphorus because terrestrial
    herbivores require 5-50 times more nitrogen than phosphorus
    (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000" ref-type="bibr">Elser
    et al., 2000</xref>), meaning they can more readily balance
    phosphorus by eating a few foods rich or poor in phosphorus but
    cannot as quickly regulate protein and carbohydrate energy because
    they make up the bulk of their required nutrients. Indeed,
    laboratory studies have revealed that short-term limitations in
    dietary phosphorus have no apparent impact on grasshopper growth
    (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016" ref-type="bibr">Cease
    et al., 2016</xref>), suggesting that these mobile herbivores could
    seek out phosphorus-rich diets intermittently to overcome potential
    phosphorus limitation in field environments. However, in this study,
    we only tested this relationship with phosphorus at the continental
    level; further field and laboratory experiments are needed to
    explore this non-linear relationship between locust outbreaks and
    soil phosphorus. While we only looked at nitrogen and phosphorus, it
    is also important to note that animals require a suite of nutrients.
    Other nutrients such as potassium and sodium
    (<xref alt="Joern et al., 2012" rid="ref-joern_not_2012" ref-type="bibr">Joern
    et al., 2012</xref>) warrant further investigation. Comparing locust
    outbreaks between continents would further show the relationship
    between nutrient availability and animal population dynamics. One
    excellent dataset for this would be SoilGrids
    (https://www.isric.org/explore/soilgrids) which provides soil
    nitrogen estimates globally at a 250-meter resolution.</p>
    <p>Lastly, our results suggest that forecasting efforts for locusts
    should consider the inclusion of a nutritional landscape quality
    metric like soil nitrogen. Current forecasting models use climatic
    data (e.g. rainfall and soil moisture) or vegetation growth data
    (e.g. normalized difference vegetation index, NDVI) as the major
    predictors of outbreaks
    (<xref alt="Cressman, 2013" rid="ref-cressman_role_2013" ref-type="bibr">Cressman,
    2013</xref>). While these climatic variables are clearly important,
    adding metrics to quantify the nutritional landscape can help
    increase forecasting model accuracy in environments with highly
    variable climates.</p>
  </sec>
  <sec id="locusts-are-more-likely-to-be-limited-by-high-nitrogen-environments-than-other-grasshoppers">
    <title>4.3 Locusts are more likely to be limited by high nitrogen
    environments than other grasshoppers</title>
    <p>A five-decade review of grasshopper responses to plant nitrogen
    content showed that grasshoppers not classified as locusts have a
    variation of negative, neutral, and positive responses to increasing
    plant nitrogen
    (<xref alt="Cease, 2024" rid="ref-cease_how_2024" ref-type="bibr">Cease,
    2024</xref>). Looking just at field surveys, there are more reports
    of a negative correlation between plant nitrogen and non-locust
    grasshopper abundance (17 reports) relative to neutral (6 reports)
    or positive (9 reports). This pattern corroborates long-term studies
    showing that dilution of plant nitrogen is correlated with declines
    of North American grasshopper populations
    (<xref alt="Welti, Roeder, et al., 2020" rid="ref-welti_nutrient_2020" ref-type="bibr">Welti,
    Roeder, et al., 2020</xref>). Of the studies that report
    correlations between individual grasshopper species abundance and
    plant nitrogen, most are from graminivorous (grass-feeding) species
    (11 reports), with 7 reports from mixed (grasses and forbs) or forb
    feeders
    (<xref alt="Cease, 2024" rid="ref-cease_how_2024" ref-type="bibr">Cease,
    2024</xref>). The abundance of non-locust graminivorous species
    tended to be more positively correlated with plant nitrogen, which
    would support the hypothesis that grass-feeders are more likely to
    be nitrogen-limited because grasses tend to have lower p:c ratios
    than forbs; although this trend was not significant and
    grass-feeders also regularly showed negative responses to high plant
    nitrogen. In contrast, there was a consistent negative effect of
    high plant nitrogen on locust species, regardless of whether they
    were graminivorous or mixed feeders. Because mass specific protein
    consumption is highly correlated with growth rate in both lab and
    field populations, but carbohydrate consumption is highly influenced
    by the environment
    (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023" ref-type="bibr">Talal
    et al., 2023</xref>), it is most likely that locusts have similar
    protein requirements as other non-locust grasshopper species, but
    have much higher carbohydrate demands, potentially to support
    migration
    (<xref alt="Raubenheimer &amp; Simpson, 1997" rid="ref-raubenheimer_integrative_1997" ref-type="bibr">Raubenheimer
    &amp; Simpson, 1997</xref>;
    <xref alt="Talal et al., 2021" rid="ref-talal_high_2021" ref-type="bibr">Talal
    et al., 2021</xref>,
    <xref alt="2023" rid="ref-talal_body_2023" ref-type="bibr">2023</xref>).
    Locusts are able to meet this increased demand for carbohydrate,
    while keeping protein consumption constant, by eating larger amounts
    of low p:c plants found in low nitrogen environments. In summary,
    these studies suggest that nymphal outbreaks of all locust species
    may be negatively correlated with soil nitrogen across continental
    scales, but that the correlation between plant nitrogen and
    non-locust grasshoppers may not be significant or consistent through
    space and time.</p>
  </sec>
  <sec id="comparing-the-relationship-between-plant-macronutrients-and-herbivore-abundance-in-other-taxa">
    <title>4.4 Comparing the relationship between plant macronutrients
    and herbivore abundance in other taxa</title>
    <p>The effect of plant protein and carbohydrate on herbivore
    populations is predicted to depend on the herbivore’s p:c intake
    target (IT) relative to its nutritional landscape (Le Gall et al.,
    2020). If there are sufficient plants on either side of the IT,
    herbivores can select from between them to achieve their IT. This
    complementary feeding has been recorded for field populations of
    blue sheep (<italic>Psuedois nayaur</italic>) in the Himalayan
    Mountains
    (<xref alt="Aryal et al., 2015" rid="ref-aryal_foods_2015" ref-type="bibr">Aryal
    et al., 2015</xref>), Black Howler Monkeys (<italic>Alouatta
    pigra</italic>) in Yucatán (Bridgeman, 2012), and other primates
    (<xref alt="Raubenheimer &amp; Rothman, 2013" rid="ref-raubenheimer_nutritional_2013" ref-type="bibr">Raubenheimer
    &amp; Rothman, 2013</xref>). There would be a predicted impact on
    populations if the nutritional landscape were to become more
    constricted or not overlap with the IT. For example, lab colonies of
    tobacco hornworms (Manduca sexta larvae) have an IT around 1:1 or
    sometimes slightly carbohydrate-biased
    (<xref alt="Wilson, Ruiz, &amp; Davidowitz, 2019" rid="ref-wilson_dietary_2019" ref-type="bibr">Wilson,
    Ruiz, &amp; Davidowitz, 2019</xref>) and their host plants tend to
    be carbohydrate-biased relative to their IT Wilson, Ruiz, Duarte, et
    al.
    (<xref alt="2019" rid="ref-wilson_nutritional_2019" ref-type="bibr">2019</xref>)].
    However, this does not seem to translate to population level
    effects, potentially due to secondary metabolites affecting growth
    more strongly than macronutrient balance and/or larvae may be able
    to compensate by overeating carbohydrates to acquire sufficient
    protein
    (<xref alt="Wilson, Ruiz, &amp; Davidowitz, 2019" rid="ref-wilson_dietary_2019" ref-type="bibr">Wilson,
    Ruiz, &amp; Davidowitz, 2019</xref>). Overeating carbohydrates is
    not as detrimental as overeating protein, at least in the short
    term, and animals tend to be willing to overeat carbohydrates to a
    greater extent than protein
    (<xref alt="Cheng et al., 2008" rid="ref-cheng_geometry_2008" ref-type="bibr">Cheng
    et al., 2008</xref>;
    <xref alt="Simpson &amp; Raubenheimer, 2012b" rid="ref-simpson_nature_2012" ref-type="bibr">Simpson
    &amp; Raubenheimer, 2012b</xref>). Therefore, herbivores facing a
    nutritional landscape with a p:c generally lower than their IT
    (i.e., carbohydrate excess) may not be as negatively impacted as
    herbivores facing one higher than their IT (i.e., protein excess).
    However, there are several examples of higher localized densities of
    herbivores in response to higher plant nitrogen and protein contents
    with thrips
    (<xref alt="Brown et al., 2002" rid="ref-brown_relationship_2002" ref-type="bibr">Brown
    et al., 2002</xref>) and spruce budworm (Choristoneura)
    (<xref alt="De Grandpré et al., 2022" rid="ref-de_grandpre_defoliation-induced_2022" ref-type="bibr">De
    Grandpré et al., 2022</xref>) being two examples. These examples
    suggest that low p:c diets limit population growth of some
    herbivores, but more studies are needed to determine if this
    relationship is only localized or if it scales up. It may be that
    herbivore populations with lower numbers are not limited by a
    nutritional landscape at a large scale because they can
    differentially disperse locally among optimal patches, whereas
    herbivore populations with extreme numbers (i.e., irruptions) may be
    more limited by nutritionally unfavorable environments across
    scales.</p>
    <p>There is evidence for phosphorus limitation in some species, but
    limited research showing a detrimental effect of excess phosphorus
    (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016" ref-type="bibr">Cease
    et al., 2016</xref>). In aquatic insects such as
    <italic>Daphnia</italic> species, there is a strong positive
    association with phosphorus available and population dynamics
    (Andersen et al., 2004). However this trend is not seen in field
    cricket populations (<italic>Gryllus veletis</italic>)
    (<xref alt="Harrison et al., 2014" rid="ref-harrison_synthesis_2014" ref-type="bibr">Harrison
    et al., 2014</xref>) and other terrestrial insects. Loaiza et al.
    (<xref alt="2011" rid="ref-loaiza2011" ref-type="bibr">2011</xref>)
    found no effect of phosphorus fertilization (but a positive effect
    of N fertilization) on Kansas tallgrass prairie grasshopper
    population distributions, whereas Joern et al.
    (<xref alt="2012" rid="ref-joern_not_2012" ref-type="bibr">2012</xref>)
    found consistent positive correlations between plant phosphorus and
    Nebraskan grassland grasshopper populations.</p>
    <p>Making predictions about a population’s nutritional demands can
    aid in making predictions about the relationship between nutritional
    landscapes and population dynamics. Across taxa, including fish,
    chickens, rats, cats, caribou, pigs, and dairy cattle, mass specific
    protein consumption is highly correlated with growth rate and
    decreases with age and body size
    (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023" ref-type="bibr">Talal
    et al., 2023</xref>). In contrast, energy demand (carbohydrates and
    lipids) does not show a clear relationship with growth rate and
    instead is more affected by environment and activity
    (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023" ref-type="bibr">Talal
    et al., 2023</xref>). Therefore, an animal’s IT is predicted to be
    affected by the contrasting effects of growth (increases dietary
    p:c) and activity or stress (increases carbohydrate demand and
    therefore decreases dietary p:c), although other physiological and
    environmental factors affect p:c demand as well (see Table 1 in
    Cease
    (<xref alt="2024" rid="ref-cease_how_2024" ref-type="bibr">2024</xref>)).
    For example, monarch butterflies have been gradually increasing
    their already-high daily energy expenditure during migration due to
    warmer temperatures caused by climate change
    (<xref alt="Parlin et al., 2023" rid="ref-parlin_cost_2023" ref-type="bibr">Parlin
    et al., 2023</xref>). Young and fast growing herbivores with low
    activity levels would be predicted to have a high p:c IT, whereas
    older juveniles and adults (slower mass specific growth) with high
    activity levels would be predicted to have a low p:c IT. Comparative
    studies with herbivores grouped functionally, such as other highly
    migratory animals (e.g. across insects, birds, mammals, and fish),
    or by growth rate or developmental stage, would likely provide
    interesting parallels that would assist in disentangling the
    complexities of plant macronutrient-herbivore relationships.</p>
  </sec>
  <sec id="synthesis-and-application">
    <title>4.5 Synthesis and Application</title>
    <p>Acquiring the right amount of nutrients is a critical component
    for animal growth, reproduction, and population dynamics
    (<xref alt="Doonan &amp; Slade, 1995" rid="ref-doonan_effects_1995" ref-type="bibr">Doonan
    &amp; Slade, 1995</xref>;
    <xref alt="Hansson, 1979" rid="ref-hansson_food_1979" ref-type="bibr">Hansson,
    1979</xref>;
    <xref alt="Keith, 1983" rid="ref-keith_role_1983" ref-type="bibr">Keith,
    1983</xref>). However, in contrast to the conventional hypotheses
    that predict a broad positive linear relationship between
    herbivorous populations and nitrogen and phosphorus
    (<xref alt="Huberty &amp; Denno, 2006" rid="ref-huberty_consequences_2006" ref-type="bibr">Huberty
    &amp; Denno, 2006</xref>;
    <xref alt="Mattson, 1980" rid="ref-mattson_herbivory_1980" ref-type="bibr">Mattson,
    1980</xref>;
    <xref alt="White, 1978" rid="ref-white_importance_1978" ref-type="bibr">White,
    1978</xref>;
    <xref alt="White, 1993" rid="ref-white_inadequate_1993" ref-type="bibr">White,
    1993</xref>), the story is nuanced and probably most often
    non-linear. For some species, especially those with high energy
    requirements, the relationship is the opposite (negatively
    associated with nitrogen) like many locust species and the effects
    can be seen at the continental scale. Land use and Land Cover Change
    (LULCC) impact on nutritional environments has important
    implications for animal population dynamics from conservation to
    pest management. While we did not make an explicit connection
    between LULCC and locust outbreaks in Australia, our results are
    consistent with previous research showing that LULCC that decreases
    soil quality and creates low nitrogen environments increases
    physiological performance and outbreaks of locusts (reviewed in Le
    Gall et al.
    (<xref alt="2019" rid="ref-le_gall_global_2019" ref-type="bibr">2019</xref>)).
    Most importantly, we show that this relationship is consistent
    between scales from the individual locust to continental wide
    outbreaks. As such, proper management of soil nutrients can help
    keep locust populations from reaching outbreak sizes and should be
    considered across scales, from individual locust behavior to
    continental wide plagues.</p>
  </sec>
</sec>
<sec id="references">
  <title>5. REFERENCES</title>
</sec>
<sec id="supplementary">
  <title>6. SUPPLEMENTARY</title>
  <fig id="suppfig-field-cage-plant-soil-nutrient-correlations">
    <caption><p>Supplementary Figure 1: Field cage soil nitrogen content
    by treatment (A &amp; B) and regressed with plant carbohydrates and
    protein (C-F).</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_plant_and_soil_nutrient_correlations.png" />
  </fig>
  <fig id="suppfig-grid-example">
    <caption><p>Supplementary Figure 2: Map showing how we summarized
    point observation data to a fishnet grid throughout eastern
    Australia. Entire extent can be seen in the inlet map. We summed the
    number of 4 (outbreak) observations, low presence observations
    (1-3), nil observations (0), and the total observations. Grid not at
    a 1 km2 x 1 km2 scale in this figure for demonstration purposes as
    the cells would be too small to see.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/spatial_modeling_grid_example_map.png" />
  </fig>
  <fig id="suppfig-field-pop-nutrients">
    <caption><p>Supplementary Figure 3: Nutrient consumption for
    outbreaking field populations of C. terminifera by diet pair (A) and
    sex (B) and development time (C) specific growth rate (D) by sex.
    The P:C ratio did not differ between diet pairing and sex. Females
    consumed more diet (but kept the same ratio) than males. Big circles
    represent mean while little circles represent raw
    data.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/supplement_figure_3.png" />
  </fig>
  <fig id="suppfig-field-cage-rebalancing-facet">
    <caption><p>Supplementary Figure 4: Individual time step intake
    targets for grasshoppers kept in both high nitrogen fertilization
    and control cages. Blue dots represent overall mean while blacks
    dots represent individual intake targets.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_locust_intake_rebalance_day_facet_plot.png" />
  </fig>
  <fig id="suppfig-spatial-modeling-env-corr">
    <caption><p>Supplementary Figure 5: Environmental variable
    correlations between mean annual precipitation, soil nitrogen, soil
    phosphorus, and woody vegetation pixel coverage. Mean annual
    precipitation was sourced from WorldClim V1 Bioclim, soil nitrogen
    and phosphorus was sourced from Soil and Landscape Grid of
    Australia, and woody vegetation pixel coverage was sourced from
    Global Forest Cover Change dataset. We averaged woody coverage for
    each pixel between the years 2000 and 2017. For all rasters, we
    randomly sampled 100,000 georeferenced points and extracted values.
    All values have been scaled and min-max normalized (to fall within
    [0,1]) for visual clarity. Dashed line represents a 1:1 slope and
    the blue line is a cubic spline with 10 knots.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/spatial_modeling_environment_correlation_figure.png" />
  </fig>
  <fig id="tbl-field-cage-plant-soil-nutrients">
    <caption><p>Table 6: Field plot nutrient content for plant species
    collected from within the treatment plots but outside of the locust
    cages for three time points during the experiment. Soil nitrogen is
    also shown per each treatment. Trt = Treatment, C = carbon, N =
    Nitrogen, Prot = protein, Carb = Carbohydrates.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th id="treatment" scope="col">treatment</th>
                      <th id="species" scope="col">species</th>
                      <th id="date" scope="col">date</th>
                      <th id="PlantU0020C" scope="col">Plant C</th>
                      <th id="PlantU0020N" scope="col">Plant N</th>
                      <th id="PlantU0020Protein" scope="col">Plant
                      Protein</th>
                      <th id="PlantU0020Carbohydrate" scope="col">Plant
                      Carbohydrate</th>
                      <th id="SoilU0020NO3" scope="col">Soil NO3</th>
                      <th id="SoilU0020NO4" scope="col">Soil NO4</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="treatment">High</td>
                      <td headers="species" style="font-style: italic">Digitaria
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.419</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.182</td>
                      <td headers="Plant Carbohydrate">0.108</td>
                      <td headers="Soil NO3">3.238</td>
                      <td headers="Soil NO4">4.207</td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.425</td>
                      <td headers="Plant N">0.030</td>
                      <td headers="Plant Protein">0.199</td>
                      <td headers="Plant Carbohydrate">0.128</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.028</td>
                      <td headers="Plant Protein">0.180</td>
                      <td headers="Plant Carbohydrate">0.120</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.024</td>
                      <td headers="Plant Protein">0.163</td>
                      <td headers="Plant Carbohydrate">0.125</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.423</td>
                      <td headers="Plant N">0.030</td>
                      <td headers="Plant Protein">0.228</td>
                      <td headers="Plant Carbohydrate">0.125</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.415</td>
                      <td headers="Plant N">0.032</td>
                      <td headers="Plant Protein">0.220</td>
                      <td headers="Plant Carbohydrate">0.131</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.227</td>
                      <td headers="Plant Carbohydrate">0.126</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Plaspladium
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.400</td>
                      <td headers="Plant N">0.029</td>
                      <td headers="Plant Protein">0.233</td>
                      <td headers="Plant Carbohydrate">0.120</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.424</td>
                      <td headers="Plant N">0.023</td>
                      <td headers="Plant Protein">0.206</td>
                      <td headers="Plant Carbohydrate">0.125</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.422</td>
                      <td headers="Plant N">0.029</td>
                      <td headers="Plant Protein">0.243</td>
                      <td headers="Plant Carbohydrate">0.112</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.419</td>
                      <td headers="Plant N">0.025</td>
                      <td headers="Plant Protein">0.217</td>
                      <td headers="Plant Carbohydrate">0.117</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment">Medium</td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.431</td>
                      <td headers="Plant N">0.042</td>
                      <td headers="Plant Protein">0.209</td>
                      <td headers="Plant Carbohydrate">0.126</td>
                      <td headers="Soil NO3">2.831</td>
                      <td headers="Soil NO4">3.385</td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.026</td>
                      <td headers="Plant Protein">0.210</td>
                      <td headers="Plant Carbohydrate">0.137</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.415</td>
                      <td headers="Plant N">0.022</td>
                      <td headers="Plant Protein">0.146</td>
                      <td headers="Plant Carbohydrate">0.124</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.424</td>
                      <td headers="Plant N">0.038</td>
                      <td headers="Plant Protein">0.213</td>
                      <td headers="Plant Carbohydrate">0.119</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.420</td>
                      <td headers="Plant N">0.029</td>
                      <td headers="Plant Protein">0.239</td>
                      <td headers="Plant Carbohydrate">0.127</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.418</td>
                      <td headers="Plant N">0.022</td>
                      <td headers="Plant Protein">0.188</td>
                      <td headers="Plant Carbohydrate">0.135</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Plaspladium
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.020</td>
                      <td headers="Plant Protein">0.243</td>
                      <td headers="Plant Carbohydrate">0.094</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.422</td>
                      <td headers="Plant N">0.037</td>
                      <td headers="Plant Protein">0.227</td>
                      <td headers="Plant Carbohydrate">0.106</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.420</td>
                      <td headers="Plant N">0.028</td>
                      <td headers="Plant Protein">0.242</td>
                      <td headers="Plant Carbohydrate">0.115</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.422</td>
                      <td headers="Plant N">0.021</td>
                      <td headers="Plant Protein">0.181</td>
                      <td headers="Plant Carbohydrate">0.116</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment">None</td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.432</td>
                      <td headers="Plant N">0.031</td>
                      <td headers="Plant Protein">0.164</td>
                      <td headers="Plant Carbohydrate">0.145</td>
                      <td headers="Soil NO3">1.387</td>
                      <td headers="Soil NO4">0.331</td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.021</td>
                      <td headers="Plant Protein">0.194</td>
                      <td headers="Plant Carbohydrate">0.115</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.405</td>
                      <td headers="Plant N">0.023</td>
                      <td headers="Plant Protein">0.114</td>
                      <td headers="Plant Carbohydrate">0.130</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.425</td>
                      <td headers="Plant N">0.032</td>
                      <td headers="Plant Protein">0.228</td>
                      <td headers="Plant Carbohydrate">0.144</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.232</td>
                      <td headers="Plant Carbohydrate">0.137</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.408</td>
                      <td headers="Plant N">0.026</td>
                      <td headers="Plant Protein">0.154</td>
                      <td headers="Plant Carbohydrate">0.126</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Plaspladium
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.399</td>
                      <td headers="Plant N">0.028</td>
                      <td headers="Plant Protein">0.183</td>
                      <td headers="Plant Carbohydrate">0.095</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Austrostipa
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.416</td>
                      <td headers="Plant N">0.013</td>
                      <td headers="Plant Protein">0.150</td>
                      <td headers="Plant Carbohydrate">0.104</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.420</td>
                      <td headers="Plant N">0.026</td>
                      <td headers="Plant Protein">0.190</td>
                      <td headers="Plant Carbohydrate">0.124</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.232</td>
                      <td headers="Plant Carbohydrate">0.133</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.418</td>
                      <td headers="Plant N">0.022</td>
                      <td headers="Plant Protein">0.142</td>
                      <td headers="Plant Carbohydrate">0.121</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species">unknown</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.413</td>
                      <td headers="Plant N">0.031</td>
                      <td headers="Plant Protein">0.168</td>
                      <td headers="Plant Carbohydrate">0.101</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  <fig id="tbl-field-cage-plant-ground-cover">
    <caption><p>Table 7: Averaged plant ground cover (%) across all
    cages per treatment. Ground cover was estimated on November 11th,
    2015.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th id="plant" scope="col">plant</th>
                      <th id="None" scope="col">None</th>
                      <th id="Medium" scope="col">Medium</th>
                      <th id="High" scope="col">High</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="plant">plant cover</td>
                      <td headers="None">35.48</td>
                      <td headers="Medium">35.24</td>
                      <td headers="High">27.38</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Urochloa
                      panicoides</td>
                      <td headers="None">13.33</td>
                      <td headers="Medium">15.00</td>
                      <td headers="High">47.50</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Enteropogon
                      acicularis</td>
                      <td headers="None">60.12</td>
                      <td headers="Medium">65.48</td>
                      <td headers="High">67.38</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Austrodanthonia
                      caespitosa</td>
                      <td headers="None">15.36</td>
                      <td headers="Medium">18.33</td>
                      <td headers="High">15.24</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Cyperus
                      rotundus</td>
                      <td headers="None">19.33</td>
                      <td headers="Medium">17.29</td>
                      <td headers="High">15.00</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">stipa
                      species</td>
                      <td headers="None">0.00</td>
                      <td headers="Medium">5.00</td>
                      <td headers="High">0.00</td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  <fig id="tbl-field-population-choice-experiment-model-selection-criteria">
    <caption><p>Table 8: Model selection criteria via Akaike information
    criterion (AIC), AIC corrected for small sample size (AICc), and
    bayesian information criterion. Model formula with the dependent
    variable on the left side and independent variables on the right
    side of the equation. s() denotes a smoothing parameter was
    estimated. For all criteria, the lower the number, more negative in
    this case, the better fit model.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th id="model" scope="col">model</th>
                      <th id="deltaBIC" scope="col">deltaBIC</th>
                      <th id="deltaAIC" scope="col">deltaAIC</th>
                      <th id="deltaAICc" scope="col">deltaAICc</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="model">macronutrient ~ population +
                      diet_pair + sex + s(initial_mass_g, k=30)</td>
                      <td headers="deltaBIC">0.01</td>
                      <td headers="deltaAIC">0.00</td>
                      <td headers="deltaAICc">0.01</td>
                    </tr>
                    <tr>
                      <td headers="model">macronutrient ~ population +
                      diet_pair + sex + initial_mass_g</td>
                      <td headers="deltaBIC">7.28</td>
                      <td headers="deltaAIC">2.81</td>
                      <td headers="deltaAICc">4.80</td>
                    </tr>
                    <tr>
                      <td headers="model">macronutrient ~ population +
                      diet_pair + sex</td>
                      <td headers="deltaBIC">0.00</td>
                      <td headers="deltaAIC">0.00</td>
                      <td headers="deltaAICc">0.00</td>
                    </tr>
                    <tr>
                      <td headers="model">macronutrient ~ 1</td>
                      <td headers="deltaBIC">2.56</td>
                      <td headers="deltaAIC">15.96</td>
                      <td headers="deltaAICc">12.28</td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  <fig id="tbl-field-population-no-choice-experiment-phys-post-hoc">
    <caption><p>Table 9: Posthoc comparisons for diet treatments for C.
    terminifera individual specific growth rate and development time. SE
    = standard error.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th rowspan="2" id="comparisons" scope="col">comparisons</th>
                      <th colspan="3" id="DevelopmentU0020Time" scope="colgroup"><named-content content-type="gt_column_spanner">Development
                      Time</named-content></th>
                      <th colspan="3" id="SpecificU0020GrowthU0020Rate" scope="colgroup"><named-content content-type="gt_column_spanner">Specific
                      Growth Rate</named-content></th>
                    </tr>
                    <tr>
                      <th id="estimate" scope="col">estimate</th>
                      <th id="SE" scope="col">SE</th>
                      <th id="adjustedU0020p-value" scope="col">adjusted
                      p-value</th>
                      <th id="estimate" scope="col">estimate</th>
                      <th id="SE" scope="col">SE</th>
                      <th id="adjustedU0020p-value" scope="col">adjusted
                      p-value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="comparisons">14p:28c - 21p:21c</td>
                      <td headers="estimate_development time">−0.917</td>
                      <td headers="SE_development time">0.624</td>
                      <td headers="adjusted p-value_development time">0.465</td>
                      <td headers="estimate_specific growth rate">0.011</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.164</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">14p:28c - 35p:7c</td>
                      <td headers="estimate_development time">−1.709</td>
                      <td headers="SE_development time">0.664</td>
                      <td headers="adjusted p-value_development time">0.062</td>
                      <td headers="estimate_specific growth rate">0.010</td>
                      <td headers="SE_specific growth rate">0.006</td>
                      <td headers="adjusted p-value_specific growth rate">0.322</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">14p:28c - 7p:35c</td>
                      <td headers="estimate_development time">−2.716</td>
                      <td headers="SE_development time">0.603</td>
                      <td headers="adjusted p-value_development time">0.000</td>
                      <td headers="estimate_specific growth rate">0.026</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.000</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">21p:21c - 35p:7c</td>
                      <td headers="estimate_development time">−0.792</td>
                      <td headers="SE_development time">0.609</td>
                      <td headers="adjusted p-value_development time">0.567</td>
                      <td headers="estimate_specific growth rate">−0.001</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.997</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">21p:21c - 7p:35c</td>
                      <td headers="estimate_development time">−1.799</td>
                      <td headers="SE_development time">0.571</td>
                      <td headers="adjusted p-value_development time">0.014</td>
                      <td headers="estimate_specific growth rate">0.015</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.020</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">35p:7c - 7p:35c</td>
                      <td headers="estimate_development time">−1.007</td>
                      <td headers="SE_development time">0.619</td>
                      <td headers="adjusted p-value_development time">0.374</td>
                      <td headers="estimate_specific growth rate">0.016</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.029</td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
</sec>
</body>

<back>
<ref-list>
  <title></title>
  <ref id="ref-andersen_stoichiometry_2004">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Andersen</surname><given-names>Tom</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Hessen</surname><given-names>Dag O.</given-names></name>
      </person-group>
      <article-title>Stoichiometry and population dynamics</article-title>
      <source>Ecology Letters</source>
      <year iso-8601-date="2004-09">2004</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issue>9</issue>
      <issn>1461-023X, 1461-0248</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1461-0248.2004.00646.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1461-0248.2004.00646.x</pub-id>
      <fpage>884</fpage>
      <lpage>900</lpage>
    </element-citation>
  </ref>
  <ref id="ref-aryal_foods_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Aryal</surname><given-names>Achyut</given-names></name>
        <name><surname>Coogan</surname><given-names>Sean C. P.</given-names></name>
        <name><surname>Ji</surname><given-names>Weihong</given-names></name>
        <name><surname>Rothman</surname><given-names>Jessica M.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>Foods, macronutrients and fibre in the diet of blue sheep ( Psuedois nayaur ) in the Annapurna Conservation Area of Nepal</article-title>
      <source>Ecology and Evolution</source>
      <year iso-8601-date="2015-09">2015</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>5</volume>
      <issue>18</issue>
      <issn>2045-7758, 2045-7758</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/ece3.1661</uri>
      <pub-id pub-id-type="doi">10.1002/ece3.1661</pub-id>
      <fpage>4006</fpage>
      <lpage>4017</lpage>
    </element-citation>
  </ref>
  <ref id="ref-harrison_synthesis_2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harrison</surname><given-names>Sarah J.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Godin</surname><given-names>Jean-Guy J.</given-names></name>
        <name><surname>Bertram</surname><given-names>Susan M.</given-names></name>
      </person-group>
      <article-title>Towards a synthesis of frameworks in nutritional ecology: Interacting effects of protein, carbohydrate and phosphorus on field cricket fitness</article-title>
      <source>Proceedings of the Royal Society B: Biological Sciences</source>
      <publisher-name>The Royal Society</publisher-name>
      <year iso-8601-date="2014">2014</year>
      <volume>281</volume>
      <issue>1792</issue>
      <uri>https://doi.org/10.1098/rspb.2014.0539</uri>
      <pub-id pub-id-type="doi">10.1098/rspb.2014.0539</pub-id>
      <fpage>20140539</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-raubenheimer_nutritional_2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
        <name><surname>Rothman</surname><given-names>Jessica M.</given-names></name>
      </person-group>
      <article-title>Nutritional Ecology of Entomophagy in Humans and Other Primates</article-title>
      <source>Annual Review of Entomology</source>
      <year iso-8601-date="2013-01">2013</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>58</volume>
      <issue>1</issue>
      <issn>0066-4170, 1545-4487</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev-ento-120710-100713</uri>
      <pub-id pub-id-type="doi">10.1146/annurev-ento-120710-100713</pub-id>
      <fpage>141</fpage>
      <lpage>160</lpage>
    </element-citation>
  </ref>
  <ref id="ref-batzli_nutritional_1986">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Batzli</surname><given-names>George O.</given-names></name>
      </person-group>
      <article-title>Nutritional Ecology of the California Vole: Effects of Food Quality on Reproduction</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1986-04">1986</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>67</volume>
      <issue>2</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.2307/1938583</uri>
      <pub-id pub-id-type="doi">10.2307/1938583</pub-id>
      <fpage>406</fpage>
      <lpage>412</lpage>
    </element-citation>
  </ref>
  <ref id="ref-behmer_insect_2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Behmer</surname><given-names>Spencer T.</given-names></name>
      </person-group>
      <article-title>Insect Herbivore Nutrient Regulation</article-title>
      <source>Annual Review of Entomology</source>
      <year iso-8601-date="2009-01">2009</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>54</volume>
      <issue>1</issue>
      <issn>0066-4170, 1545-4487</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev.ento.54.110807.090537</uri>
      <pub-id pub-id-type="doi">10.1146/annurev.ento.54.110807.090537</pub-id>
      <fpage>165</fpage>
      <lpage>187</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bernays_dietary_1994">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bernays</surname><given-names>E. A.</given-names></name>
        <name><surname>Bright</surname><given-names>K. L.</given-names></name>
        <name><surname>Gonzalez</surname><given-names>N.</given-names></name>
        <name><surname>Angel</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>Dietary Mixing in a Generalist Herbivore: Tests of Two Hypotheses</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1994-10">1994</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>75</volume>
      <issue>7</issue>
      <issn>00129658</issn>
      <uri>http://doi.wiley.com/10.2307/1941604</uri>
      <pub-id pub-id-type="doi">10.2307/1941604</pub-id>
      <fpage>1997</fpage>
      <lpage>2006</lpage>
    </element-citation>
  </ref>
  <ref id="ref-brosemann_nutrient_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brosemann</surname><given-names>Jonah</given-names></name>
        <name><surname>Overson</surname><given-names>Rick</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Millerwise</surname><given-names>Sydney</given-names></name>
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
      </person-group>
      <article-title>Nutrient supply and accessibility in plants: Effect of protein and carbohydrates on Australian plague locust (Chortoicetes terminifera) preference and performance</article-title>
      <source>Frontiers in Insect Science</source>
      <year iso-8601-date="2023-07">2023</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>3</volume>
      <issn>2673-8600</issn>
      <uri>https://www.frontiersin.org/articles/10.3389/finsc.2023.1110518/full</uri>
      <pub-id pub-id-type="doi">10.3389/finsc.2023.1110518</pub-id>
      <fpage>1110518</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-brown_relationship_2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brown</surname><given-names>Alison S. Scott</given-names></name>
        <name><surname>Simmonds</surname><given-names>Monique S. J.</given-names></name>
        <name><surname>Blaney</surname><given-names>Walter M.</given-names></name>
      </person-group>
      <article-title>Relationship between nutritional composition of plant species and infestation levels of thrips</article-title>
      <source>Journal of Chemical Ecology</source>
      <year iso-8601-date="2002">2002</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>28</volume>
      <issue>12</issue>
      <issn>00980331</issn>
      <uri>http://link.springer.com/10.1023/A:1021471732625</uri>
      <pub-id pub-id-type="doi">10.1023/A:1021471732625</pub-id>
      <fpage>2399</fpage>
      <lpage>2409</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_how_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>How Nutrients Mediate the Impacts of Global Change on Locust Outbreaks</article-title>
      <source>Annual Review of Entomology</source>
      <year iso-8601-date="2024-01">2024</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>69</volume>
      <issue>1</issue>
      <issn>0066-4170, 1545-4487</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev-ento-120220-110415</uri>
      <pub-id pub-id-type="doi">10.1146/annurev-ento-120220-110415</pub-id>
      <fpage>527</fpage>
      <lpage>550</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_living_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Fenichel</surname><given-names>Eli P.</given-names></name>
        <name><surname>Hadrich</surname><given-names>Joleen C.</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
        <name><surname>Robinson</surname><given-names>Brian E.</given-names></name>
      </person-group>
      <article-title>Living With Locusts: Connecting Soil Nitrogen, Locust Outbreaks, Livelihoods, and Livestock Markets</article-title>
      <source>BioScience</source>
      <year iso-8601-date="2015-06">2015</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>65</volume>
      <issue>6</issue>
      <issn>1525-3244, 0006-3568</issn>
      <uri>http://academic.oup.com/bioscience/article/65/6/551/303376/Living-With-Locusts-Connecting-Soil-Nitrogen</uri>
      <pub-id pub-id-type="doi">10.1093/biosci/biv048</pub-id>
      <fpage>551</fpage>
      <lpage>558</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_heavy_2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Ford</surname><given-names>Colleen F.</given-names></name>
        <name><surname>Hao</surname><given-names>Shuguang</given-names></name>
        <name><surname>Kang</surname><given-names>Le</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
      </person-group>
      <article-title>Heavy Livestock Grazing Promotes Locust Outbreaks by Lowering Plant Nitrogen Content</article-title>
      <source>Science</source>
      <year iso-8601-date="2012-01">2012</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>335</volume>
      <issue>6067</issue>
      <issn>0036-8075, 1095-9203</issn>
      <uri>https://www.science.org/doi/10.1126/science.1214433</uri>
      <pub-id pub-id-type="doi">10.1126/science.1214433</pub-id>
      <fpage>467</fpage>
      <lpage>469</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_dietary_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Fay</surname><given-names>Michelle</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
      </person-group>
      <article-title>Dietary phosphate affects food selection, post-ingestive P fate, and performance of a polyphagous herbivore</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2016-01">2016</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <issn>1477-9145, 0022-0949</issn>
      <uri>https://journals.biologists.com/jeb/article/doi/10.1242/jeb.126847/262050/Dietary-phosphate-affects-food-selection-post</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.126847</pub-id>
      <fpage>jeb.126847</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_field_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Trumper</surname><given-names>Eduardo V.</given-names></name>
        <name><surname>Medina</surname><given-names>Héctor</given-names></name>
        <name><surname>Bazán</surname><given-names>Fernando Copa</given-names></name>
        <name><surname>Frana</surname><given-names>Jorge</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon</given-names></name>
        <name><surname>Joaquin</surname><given-names>Nelson</given-names></name>
        <name><surname>Learned</surname><given-names>Jennifer</given-names></name>
        <name><surname>Roca</surname><given-names>Mónica</given-names></name>
        <name><surname>Rojas</surname><given-names>Julio E.</given-names></name>
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Overson</surname><given-names>Rick P.</given-names></name>
      </person-group>
      <article-title>Field bands of marching locust juveniles show carbohydrate, not protein, limitation</article-title>
      <source>Current Research in Insect Science</source>
      <year iso-8601-date="2023">2023</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>4</volume>
      <issn>26665158</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S2666515823000185</uri>
      <pub-id pub-id-type="doi">10.1016/j.cris.2023.100069</pub-id>
      <fpage>100069</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cheng_geometry_2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cheng</surname><given-names>Ken</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>A Geometry of Regulatory Scaling</article-title>
      <source>The American Naturalist</source>
      <year iso-8601-date="2008-11">2008</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>172</volume>
      <issue>5</issue>
      <issn>0003-0147, 1537-5323</issn>
      <uri>https://www.journals.uchicago.edu/doi/10.1086/591686</uri>
      <pub-id pub-id-type="doi">10.1086/591686</pub-id>
      <fpage>681</fpage>
      <lpage>693</lpage>
    </element-citation>
  </ref>
  <ref id="ref-clark_influence_1974">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clark</surname><given-names>Dp</given-names></name>
      </person-group>
      <article-title>The Influence of Rainfall on the Densities of Adult Chlortoicetes Terminifera (Walker) in Central Western New South Wales, 1965-73.</article-title>
      <source>Australian Journal of Zoology</source>
      <year iso-8601-date="1974">1974</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>22</volume>
      <issue>3</issue>
      <issn>0004-959X</issn>
      <uri>http://www.publish.csiro.au/?paper=ZO9740365</uri>
      <pub-id pub-id-type="doi">10.1071/ZO9740365</pub-id>
      <fpage>365</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-clayton_spatial_1993">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clayton</surname><given-names>D G</given-names></name>
        <name><surname>Bernardinelli</surname><given-names>L</given-names></name>
        <name><surname>Montomoli</surname><given-names>C</given-names></name>
      </person-group>
      <article-title>Spatial Correlation in Ecological Analysis</article-title>
      <source>International Journal of Epidemiology</source>
      <year iso-8601-date="1993">1993</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>22</volume>
      <issue>6</issue>
      <issn>0300-5771, 1464-3685</issn>
      <uri>https://academic.oup.com/ije/article-lookup/doi/10.1093/ije/22.6.1193</uri>
      <pub-id pub-id-type="doi">10.1093/ije/22.6.1193</pub-id>
      <fpage>1193</fpage>
      <lpage>1202</lpage>
    </element-citation>
  </ref>
  <ref id="ref-clissold_insect_2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clissold</surname><given-names>Fiona J.</given-names></name>
        <name><surname>Coggan</surname><given-names>Nicole</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
      </person-group>
      <article-title>Insect herbivores can choose microclimates to achieve nutritional homeostasis</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2013-01">2013</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <issn>1477-9145, 0022-0949</issn>
      <uri>https://journals.biologists.com/jeb/article/doi/10.1242/jeb.078782/258075/Insect-herbivores-can-choose-microclimates-to</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.078782</pub-id>
      <fpage>jeb.078782</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-clissold_regulation_2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clissold</surname><given-names>Fiona J.</given-names></name>
        <name><surname>Kertesz</surname><given-names>Helena</given-names></name>
        <name><surname>Saul</surname><given-names>Amelia M.</given-names></name>
        <name><surname>Sheehan</surname><given-names>Julia L.</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
      </person-group>
      <article-title>Regulation of water and macronutrients by the Australian plague locust, Chortoicetes terminifera</article-title>
      <source>Journal of Insect Physiology</source>
      <year iso-8601-date="2014-10">2014</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>69</volume>
      <issn>00221910</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0022191014001267</uri>
      <pub-id pub-id-type="doi">10.1016/j.jinsphys.2014.06.011</pub-id>
      <fpage>35</fpage>
      <lpage>40</lpage>
    </element-citation>
  </ref>
  <ref id="ref-clissold_paradoxical_2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clissold</surname><given-names>F. J.</given-names></name>
        <name><surname>Sanson</surname><given-names>G. D.</given-names></name>
        <name><surname>Read</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>The paradoxical effects of nutrient ratios and supply rates on an outbreaking insect herbivore, the Australian plague locust</article-title>
      <source>Journal of Animal Ecology</source>
      <year iso-8601-date="2006-07">2006</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>75</volume>
      <issue>4</issue>
      <issn>0021-8790, 1365-2656</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-2656.2006.01122.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-2656.2006.01122.x</pub-id>
      <fpage>1000</fpage>
      <lpage>1013</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cole_influence_1978">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cole</surname><given-names>F. R.</given-names></name>
        <name><surname>Batzli</surname><given-names>G. O.</given-names></name>
      </person-group>
      <article-title>Influence of Supplemental Feeding on a Vole Population</article-title>
      <source>Journal of Mammalogy</source>
      <year iso-8601-date="1978-11">1978</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>59</volume>
      <issue>4</issue>
      <issn>1545-1542, 0022-2372</issn>
      <uri>https://academic.oup.com/jmammal/article-lookup/doi/10.2307/1380145</uri>
      <pub-id pub-id-type="doi">10.2307/1380145</pub-id>
      <fpage>809</fpage>
      <lpage>819</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cressman_role_2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cressman</surname><given-names>Keith</given-names></name>
      </person-group>
      <article-title>Role of remote sensing in desert locust early warning</article-title>
      <source>Journal of Applied Remote Sensing</source>
      <year iso-8601-date="2013-05">2013</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issue>1</issue>
      <issn>1931-3195</issn>
      <uri>http://remotesensing.spiedigitallibrary.org/article.aspx?doi=10.1117/1.JRS.7.075098</uri>
      <pub-id pub-id-type="doi">10.1117/1.JRS.7.075098</pub-id>
      <fpage>075098</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cullen_molecules_2017">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Cullen</surname><given-names>Darron A.</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Latchininsky</surname><given-names>Alexandre V.</given-names></name>
        <name><surname>Ayali</surname><given-names>Amir</given-names></name>
        <name><surname>Berry</surname><given-names>Kevin</given-names></name>
        <name><surname>Buhl</surname><given-names>Camille</given-names></name>
        <name><surname>De Keyser</surname><given-names>Rien</given-names></name>
        <name><surname>Foquet</surname><given-names>Bert</given-names></name>
        <name><surname>Hadrich</surname><given-names>Joleen C.</given-names></name>
        <name><surname>Matheson</surname><given-names>Tom</given-names></name>
        <name><surname>Ott</surname><given-names>Swidbert R.</given-names></name>
        <name><surname>Poot-Pech</surname><given-names>Mario A.</given-names></name>
        <name><surname>Robinson</surname><given-names>Brian E.</given-names></name>
        <name><surname>Smith</surname><given-names>Jonathan M.</given-names></name>
        <name><surname>Song</surname><given-names>Hojun</given-names></name>
        <name><surname>Sword</surname><given-names>Gregory A.</given-names></name>
        <name><surname>Vanden Broeck</surname><given-names>Jozef</given-names></name>
        <name><surname>Verdonck</surname><given-names>Rik</given-names></name>
        <name><surname>Verlinden</surname><given-names>Heleen</given-names></name>
        <name><surname>Rogers</surname><given-names>Stephen M.</given-names></name>
      </person-group>
      <article-title>From Molecules to Management: Mechanisms and Consequences of Locust Phase Polyphenism</article-title>
      <source>Advances in Insect Physiology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>53</volume>
      <isbn>978-0-12-811833-7</isbn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0065280617300231</uri>
      <pub-id pub-id-type="doi">10.1016/bs.aiip.2017.06.002</pub-id>
      <fpage>167</fpage>
      <lpage>285</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dadd_nutritional_1961">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dadd</surname><given-names>R. H.</given-names></name>
      </person-group>
      <article-title>The nutritional requirements of locusts—IV. Requirements for vitamins of the B complex</article-title>
      <source>Journal of Insect Physiology</source>
      <year iso-8601-date="1961-02">1961</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>6</volume>
      <issue>1</issue>
      <issn>00221910</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/0022191061900865</uri>
      <pub-id pub-id-type="doi">10.1016/0022-1910(61)90086-5</pub-id>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-de_grandpre_defoliation-induced_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>De Grandpré</surname><given-names>Louis</given-names></name>
        <name><surname>Marchand</surname><given-names>Maryse</given-names></name>
        <name><surname>Kneeshaw</surname><given-names>Daniel D.</given-names></name>
        <name><surname>Paré</surname><given-names>David</given-names></name>
        <name><surname>Boucher</surname><given-names>Dominique</given-names></name>
        <name><surname>Bourassa</surname><given-names>Stéphane</given-names></name>
        <name><surname>Gervais</surname><given-names>David</given-names></name>
        <name><surname>Simard</surname><given-names>Martin</given-names></name>
        <name><surname>Griffin</surname><given-names>Jacob M.</given-names></name>
        <name><surname>Pureswaran</surname><given-names>Deepa S.</given-names></name>
      </person-group>
      <article-title>Defoliation-induced changes in foliage quality may trigger broad-scale insect outbreaks</article-title>
      <source>Communications Biology</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>5</volume>
      <issue>1</issue>
      <issn>2399-3642</issn>
      <uri>https://www.nature.com/articles/s42003-022-03407-8</uri>
      <pub-id pub-id-type="doi">10.1038/s42003-022-03407-8</pub-id>
      <fpage>463</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deveson_satellite_2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Deveson</surname><given-names>Edward D.</given-names></name>
      </person-group>
      <article-title>Satellite normalized difference vegetation index data used in managing Australian plague locusts</article-title>
      <source>Journal of Applied Remote Sensing</source>
      <year iso-8601-date="2013-07">2013</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issue>1</issue>
      <issn>1931-3195</issn>
      <uri>http://remotesensing.spiedigitallibrary.org/article.aspx?doi=10.1117/1.JRS.7.075096</uri>
      <pub-id pub-id-type="doi">10.1117/1.JRS.7.075096</pub-id>
      <fpage>075096</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deveson_not_2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Deveson</surname><given-names>E. D.</given-names></name>
        <name><surname>Walker</surname><given-names>P. W.</given-names></name>
      </person-group>
      <article-title>Not a one-way trip: Historical distribution data for Australian plague locusts support frequent seasonal exchange migrations</article-title>
      <source>Journal of Orthoptera Research</source>
      <year iso-8601-date="2005-01">2005</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>14</volume>
      <issue>1</issue>
      <issn>1082-6467, 1937-2426</issn>
      <uri>http://www.bioone.org/doi/abs/10.1665/1082-6467%282005%2914%5B91%3ANAOTHD%5D2.0.CO%3B2</uri>
      <pub-id pub-id-type="doi">10.1665/1082-6467(2005)14[91:NAOTHD]2.0.CO;2</pub-id>
      <fpage>91</fpage>
      <lpage>105</lpage>
    </element-citation>
  </ref>
  <ref id="ref-deveson_operation_2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Deveson</surname><given-names>Ted</given-names></name>
        <name><surname>Hunter</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>THE OPERATION OF A GIS‐BASED DECISION SUPPORT SYSTEM FOR AUSTRALIAN LOCUST MANAGEMENT</article-title>
      <source>Insect Science</source>
      <year iso-8601-date="2002-12">2002</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>4</issue>
      <issn>1672-9609, 1744-7917</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1744-7917.2002.tb00167.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1744-7917.2002.tb00167.x</pub-id>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-donald_colin_phosphorus_1964">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Donald</surname><given-names>Colin</given-names></name>
      </person-group>
      <article-title>Phosphorus in Australian agriculture.</article-title>
      <source>Journal of the Australian Institute of Agricultural Science</source>
      <year iso-8601-date="1964">1964</year>
      <volume>30</volume>
      <issue>75</issue>
      <fpage>195</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-doonan_effects_1995">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Doonan</surname><given-names>Terry J.</given-names></name>
        <name><surname>Slade</surname><given-names>Norman A.</given-names></name>
      </person-group>
      <article-title>Effects of Supplemental Food on Population Dynamics of Cotton Rats, Sigmodon Hispidus</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1995-04">1995</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>76</volume>
      <issue>3</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.2307/1939347</uri>
      <pub-id pub-id-type="doi">10.2307/1939347</pub-id>
      <fpage>814</fpage>
      <lpage>826</lpage>
    </element-citation>
  </ref>
  <ref id="ref-elser_nutritional_2000">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Fagan</surname><given-names>William F.</given-names></name>
        <name><surname>Denno</surname><given-names>Robert F.</given-names></name>
        <name><surname>Dobberfuhl</surname><given-names>Dean R.</given-names></name>
        <name><surname>Folarin</surname><given-names>Ayoola</given-names></name>
        <name><surname>Huberty</surname><given-names>Andrea</given-names></name>
        <name><surname>Interlandi</surname><given-names>Sebastian</given-names></name>
        <name><surname>Kilham</surname><given-names>Susan S.</given-names></name>
        <name><surname>McCauley</surname><given-names>Edward</given-names></name>
        <name><surname>Schulz</surname><given-names>Kimberly L.</given-names></name>
        <name><surname>Siemann</surname><given-names>Evan H.</given-names></name>
        <name><surname>Sterner</surname><given-names>Robert W.</given-names></name>
      </person-group>
      <article-title>Nutritional constraints in terrestrial and freshwater food webs</article-title>
      <source>Nature</source>
      <year iso-8601-date="2000-11">2000</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>408</volume>
      <issue>6812</issue>
      <issn>0028-0836, 1476-4687</issn>
      <uri>https://www.nature.com/articles/35046058</uri>
      <pub-id pub-id-type="doi">10.1038/35046058</pub-id>
      <fpage>578</fpage>
      <lpage>580</lpage>
    </element-citation>
  </ref>
  <ref id="ref-farrow_population_1982">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Farrow</surname><given-names>Ra</given-names></name>
      </person-group>
      <article-title>Population Dynamics of the Australian Plague Locust, Chortoicetes Terminifera (Walker) in Central Western New South Wales Iii. Analysis of Population Processes.</article-title>
      <source>Australian Journal of Zoology</source>
      <year iso-8601-date="1982">1982</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>30</volume>
      <issue>4</issue>
      <issn>0004-959X</issn>
      <uri>http://www.publish.csiro.au/?paper=ZO9820569</uri>
      <pub-id pub-id-type="doi">10.1071/ZO9820569</pub-id>
      <fpage>569</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-floyd_frontiers_1996">
    <element-citation publication-type="book">
      <source>Frontiers of population ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Floyd</surname><given-names>R. B.</given-names></name>
      </person-group>
      <publisher-name>CSIRO Pub</publisher-name>
      <publisher-loc>Collingwood, VIC, Australia</publisher-loc>
      <year iso-8601-date="1996">1996</year>
      <isbn>978-0-643-05781-4</isbn>
    </element-citation>
  </ref>
  <ref id="ref-forero_conspecific_2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Forero</surname><given-names>M. G.</given-names></name>
        <name><surname>Tella</surname><given-names>J. L.</given-names></name>
        <name><surname>Hobson</surname><given-names>K. A.</given-names></name>
        <name><surname>Bertellotti</surname><given-names>M.</given-names></name>
        <name><surname>Blanco</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>Conspecific food competition explains variability in colony size: a test in Magellanic penguins</article-title>
      <source>Ecology</source>
      <year iso-8601-date="2002-12">2002</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>83</volume>
      <issue>12</issue>
      <issn>0012-9658</issn>
      <uri>http://doi.wiley.com/10.1890/0012-9658(2002)083[3466:CFCEVI]2.0.CO;2</uri>
      <pub-id pub-id-type="doi">10.1890/0012-9658(2002)083[3466:CFCEVI]2.0.CO;2</pub-id>
      <fpage>3466</fpage>
      <lpage>3475</lpage>
    </element-citation>
  </ref>
  <ref id="ref-giese_n_2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Giese</surname><given-names>M.</given-names></name>
        <name><surname>Brueck</surname><given-names>H.</given-names></name>
        <name><surname>Gao</surname><given-names>Y. Z.</given-names></name>
        <name><surname>Lin</surname><given-names>S.</given-names></name>
        <name><surname>Steffens</surname><given-names>M.</given-names></name>
        <name><surname>Kögel-Knabner</surname><given-names>I.</given-names></name>
        <name><surname>Glindemann</surname><given-names>T.</given-names></name>
        <name><surname>Susenbeth</surname><given-names>A.</given-names></name>
        <name><surname>Taube</surname><given-names>F.</given-names></name>
        <name><surname>Butterbach-Bahl</surname><given-names>K.</given-names></name>
        <name><surname>Zheng</surname><given-names>X. H.</given-names></name>
        <name><surname>Hoffmann</surname><given-names>C.</given-names></name>
        <name><surname>Bai</surname><given-names>Y. F.</given-names></name>
        <name><surname>Han</surname><given-names>X. G.</given-names></name>
      </person-group>
      <article-title>N balance and cycling of Inner Mongolia typical steppe: A comprehensive case study of grazing effects</article-title>
      <source>Ecological Monographs</source>
      <year iso-8601-date="2013-05">2013</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>83</volume>
      <issue>2</issue>
      <issn>0012-9615, 1557-7015</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/12-0114.1</uri>
      <pub-id pub-id-type="doi">10.1890/12-0114.1</pub-id>
      <fpage>195</fpage>
      <lpage>219</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gorelick_google_2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gorelick</surname><given-names>Noel</given-names></name>
        <name><surname>Hancher</surname><given-names>Matt</given-names></name>
        <name><surname>Dixon</surname><given-names>Mike</given-names></name>
        <name><surname>Ilyushchenko</surname><given-names>Simon</given-names></name>
        <name><surname>Thau</surname><given-names>David</given-names></name>
        <name><surname>Moore</surname><given-names>Rebecca</given-names></name>
      </person-group>
      <article-title>Google Earth Engine: Planetary-scale geospatial analysis for everyone</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2017-12">2017</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>202</volume>
      <issn>00344257</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0034425717302900</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2017.06.031</pub-id>
      <fpage>18</fpage>
      <lpage>27</lpage>
    </element-citation>
  </ref>
  <ref id="ref-granbom_food_2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Granbom</surname><given-names>Martin</given-names></name>
        <name><surname>Smith</surname><given-names>Henrik G.</given-names></name>
      </person-group>
      <article-title>Food Limitation During Breeding in a Heterogeneous Landscape</article-title>
      <source>The Auk</source>
      <person-group person-group-type="editor">
        <name><surname>Murphy</surname><given-names>M. T.</given-names></name>
      </person-group>
      <year iso-8601-date="2006-01">2006</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>123</volume>
      <issue>1</issue>
      <issn>1938-4254, 0004-8038</issn>
      <uri>https://academic.oup.com/auk/article/123/1/97/5562605</uri>
      <pub-id pub-id-type="doi">10.1093/auk/123.1.97</pub-id>
      <fpage>97</fpage>
      <lpage>107</lpage>
    </element-citation>
  </ref>
  <ref id="ref-grundy_soil_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Grundy</surname><given-names>M. J.</given-names></name>
        <name><surname>Rossel</surname><given-names>R. A. Viscarra</given-names></name>
        <name><surname>Searle</surname><given-names>R. D.</given-names></name>
        <name><surname>Wilson</surname><given-names>P. L.</given-names></name>
        <name><surname>Chen</surname><given-names>C.</given-names></name>
        <name><surname>Gregory</surname><given-names>L. J.</given-names></name>
      </person-group>
      <article-title>Soil and Landscape Grid of Australia</article-title>
      <source>Soil Research</source>
      <year iso-8601-date="2015">2015</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>53</volume>
      <issue>8</issue>
      <issn>1838-675X</issn>
      <uri>http://www.publish.csiro.au/?paper=SR15191</uri>
      <pub-id pub-id-type="doi">10.1071/SR15191</pub-id>
      <fpage>835</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-hansson_food_1979">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hansson</surname><given-names>Lennart</given-names></name>
      </person-group>
      <article-title>Food as a limiting factor for small rodent numbers: Tests of two hypotheses</article-title>
      <source>Oecologia</source>
      <year iso-8601-date="1979-01">1979</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>37</volume>
      <issue>3</issue>
      <issn>0029-8549, 1432-1939</issn>
      <uri>http://link.springer.com/10.1007/BF00347907</uri>
      <pub-id pub-id-type="doi">10.1007/BF00347907</pub-id>
      <fpage>297</fpage>
      <lpage>314</lpage>
    </element-citation>
  </ref>
  <ref id="ref-heidorn_feeding_1987">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Heidorn</surname><given-names>T. J.</given-names></name>
        <name><surname>Joern</surname><given-names>A.</given-names></name>
      </person-group>
      <article-title>Feeding Preference and Spatial Distribution of Grasshoppers (Acrididae) in Response to Nitrogen Fertilization of Calamovilfa longifolia</article-title>
      <source>Functional Ecology</source>
      <year iso-8601-date="1987">1987</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>1</volume>
      <issue>4</issue>
      <issn>02698463</issn>
      <uri>https://www.jstor.org/stable/2389793?origin=crossref</uri>
      <pub-id pub-id-type="doi">10.2307/2389793</pub-id>
      <fpage>369</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-huberty_consequences_2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Huberty</surname><given-names>Andrea F.</given-names></name>
        <name><surname>Denno</surname><given-names>Robert F.</given-names></name>
      </person-group>
      <article-title>Consequences of nitrogen and phosphorus limitation for the performance of two planthoppers with divergent life-history strategies</article-title>
      <source>Oecologia</source>
      <year iso-8601-date="2006-09">2006</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>149</volume>
      <issue>3</issue>
      <issn>0029-8549, 1432-1939</issn>
      <uri>http://link.springer.com/10.1007/s00442-006-0462-8</uri>
      <pub-id pub-id-type="doi">10.1007/s00442-006-0462-8</pub-id>
      <fpage>444</fpage>
      <lpage>455</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hunter_aerial_2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hunter</surname><given-names>D. M.</given-names></name>
        <name><surname>McCulloch</surname><given-names>L.</given-names></name>
        <name><surname>Spurgin</surname><given-names>P. A.</given-names></name>
      </person-group>
      <article-title>Aerial detection of nymphal bands of the Australian plague locust (Chortoicetes terminifera (Walker)) (Orthoptera: Acrididae)</article-title>
      <source>Crop Protection</source>
      <year iso-8601-date="2008-01">2008</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>27</volume>
      <issue>1</issue>
      <issn>02612194</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0261219407001159</uri>
      <pub-id pub-id-type="doi">10.1016/j.cropro.2007.04.016</pub-id>
      <fpage>118</fpage>
      <lpage>123</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hunter_adaptations_2001">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hunter</surname><given-names>D. M.</given-names></name>
        <name><surname>Walker</surname><given-names>P. W.</given-names></name>
        <name><surname>Elder</surname><given-names>R. J.</given-names></name>
      </person-group>
      <article-title>Adaptations of locusts and grasshoppers to the low and variable rainfall of Australia</article-title>
      <source>Journal of Orthoptera Research</source>
      <year iso-8601-date="2001-12">2001</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>10</volume>
      <issue>2</issue>
      <issn>1082-6467, 1937-2426</issn>
      <uri>http://www.bioone.org/doi/abs/10.1665/1082-6467%282001%29010%5B0347%3AAOLAGT%5D2.0.CO%3B2</uri>
      <pub-id pub-id-type="doi">10.1665/1082-6467(2001)010[0347:AOLAGT]2.0.CO;2</pub-id>
      <fpage>347</fpage>
      <lpage>351</lpage>
    </element-citation>
  </ref>
  <ref id="ref-joern_not_2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
        <name><surname>Provin</surname><given-names>Tony</given-names></name>
        <name><surname>Behmer</surname><given-names>Spencer T.</given-names></name>
      </person-group>
      <article-title>Not just the usual suspects: Insect herbivore populations and communities are associated with multiple plant nutrients</article-title>
      <source>Ecology</source>
      <year iso-8601-date="2012-05">2012</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>93</volume>
      <issue>5</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/11-1142.1</uri>
      <pub-id pub-id-type="doi">10.1890/11-1142.1</pub-id>
      <fpage>1002</fpage>
      <lpage>1015</lpage>
    </element-citation>
  </ref>
  <ref id="ref-jonas_hostplant_2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jonas</surname><given-names>Jayne L.</given-names></name>
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
      </person-group>
      <article-title>Host‐plant quality alters grass/forb consumption by a mixed‐feeding insect herbivore, Melanoplus bivittatus (Orthoptera: Acrididae)</article-title>
      <source>Ecological Entomology</source>
      <year iso-8601-date="2008-08">2008</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>33</volume>
      <issue>4</issue>
      <issn>0307-6946, 1365-2311</issn>
      <uri>https://resjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-2311.2008.01004.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-2311.2008.01004.x</pub-id>
      <fpage>546</fpage>
      <lpage>554</lpage>
    </element-citation>
  </ref>
  <ref id="ref-keith_role_1983">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Keith</surname><given-names>Lloyd B.</given-names></name>
      </person-group>
      <article-title>Role of Food in Hare Population Cycles</article-title>
      <source>Oikos</source>
      <year iso-8601-date="1983-05">1983</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>40</volume>
      <issue>3</issue>
      <issn>00301299</issn>
      <uri>https://www.jstor.org/stable/3544311?origin=crossref</uri>
      <pub-id pub-id-type="doi">10.2307/3544311</pub-id>
      <fpage>385</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-key_general_1945">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Key</surname><given-names>K. H. L.</given-names></name>
      </person-group>
      <article-title>The general ecological characteristics of the outbreak areas and outbreak years of the Australian plague locust (Chortoicetes terminifera Walk.)</article-title>
      <year iso-8601-date="1945">1945</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <uri>https://publications.csiro.au/publications/publication/PIprocite:8058408f-539f-4540-b888-0dda1e0c113d</uri>
      <pub-id pub-id-type="doi">10.25919/RTPX-F935</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-lawton_mismatched_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lawton</surname><given-names>Douglas</given-names></name>
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
        <name><surname>Waters</surname><given-names>Cathy</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Mismatched diets: Defining the nutritional landscape of grasshopper communities in a variable environment</article-title>
      <source>Ecosphere</source>
      <year iso-8601-date="2021-03">2021</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>12</volume>
      <issue>3</issue>
      <issn>2150-8925, 2150-8925</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3409</uri>
      <pub-id pub-id-type="doi">10.1002/ecs2.3409</pub-id>
      <fpage>e03409</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lawton_seeing_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lawton</surname><given-names>Douglas</given-names></name>
        <name><surname>Scarth</surname><given-names>Peter</given-names></name>
        <name><surname>Deveson</surname><given-names>Edward</given-names></name>
        <name><surname>Piou</surname><given-names>Cyril</given-names></name>
        <name><surname>Spessa</surname><given-names>Allan</given-names></name>
        <name><surname>Waters</surname><given-names>Cathy</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Seeing the locust in the swarm: Accounting for spatiotemporal hierarchy improves ecological models of insect populations</article-title>
      <source>Ecography</source>
      <year iso-8601-date="2022-02">2022</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>2022</volume>
      <issue>2</issue>
      <issn>0906-7590, 1600-0587</issn>
      <uri>https://nsojournals.onlinelibrary.wiley.com/doi/10.1111/ecog.05763</uri>
      <pub-id pub-id-type="doi">10.1111/ecog.05763</pub-id>
      <fpage>ecog.05763</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lawton_woody_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lawton</surname><given-names>Douglas</given-names></name>
        <name><surname>Waters</surname><given-names>Cathy</given-names></name>
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne</given-names></name>
      </person-group>
      <article-title>Woody vegetation remnants within pastures influence locust distribution: Testing bottom-up and top-down control</article-title>
      <source>Agriculture, Ecosystems &amp; Environment</source>
      <year iso-8601-date="2020-07">2020</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>296</volume>
      <issn>01678809</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S016788092030116X</uri>
      <pub-id pub-id-type="doi">10.1016/j.agee.2020.106931</pub-id>
      <fpage>106931</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-le_gall_global_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
        <name><surname>Overson</surname><given-names>Rick</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne</given-names></name>
      </person-group>
      <article-title>A Global Review on Locusts (Orthoptera: Acrididae) and Their Interactions With Livestock Grazing Practices</article-title>
      <source>Frontiers in Ecology and Evolution</source>
      <year iso-8601-date="2019-07">2019</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issn>2296-701X</issn>
      <uri>https://www.frontiersin.org/article/10.3389/fevo.2019.00263/full</uri>
      <pub-id pub-id-type="doi">10.3389/fevo.2019.00263</pub-id>
      <fpage>263</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lenhart_water_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lenhart</surname><given-names>Paul A.</given-names></name>
        <name><surname>Eubanks</surname><given-names>Micky D.</given-names></name>
        <name><surname>Behmer</surname><given-names>Spencer T.</given-names></name>
      </person-group>
      <article-title>Water stress in grasslands: Dynamic responses of plants and insect herbivores</article-title>
      <source>Oikos</source>
      <year iso-8601-date="2015-03">2015</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>124</volume>
      <issue>3</issue>
      <issn>0030-1299, 1600-0706</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/oik.01370</uri>
      <pub-id pub-id-type="doi">10.1111/oik.01370</pub-id>
      <fpage>381</fpage>
      <lpage>390</lpage>
    </element-citation>
  </ref>
  <ref id="ref-levin_problem_1992">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Levin</surname><given-names>Simon A.</given-names></name>
      </person-group>
      <article-title>The Problem of Pattern and Scale in Ecology: The Robert H. MacArthur Award Lecture</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1992-12">1992</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>73</volume>
      <issue>6</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.2307/1941447</uri>
      <pub-id pub-id-type="doi">10.2307/1941447</pub-id>
      <fpage>1943</fpage>
      <lpage>1967</lpage>
    </element-citation>
  </ref>
  <ref id="ref-marsh_decline_1995">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Marsh</surname><given-names>Nr</given-names></name>
        <name><surname>Adams</surname><given-names>Ma</given-names></name>
      </person-group>
      <article-title>Decline of Eucalyptus tereticornis Near Bairnsdale, Victoria: Insect Herbivory and Nitrogen Fractions in Sap and Foliage</article-title>
      <source>Australian Journal of Botany</source>
      <year iso-8601-date="1995">1995</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>43</volume>
      <issue>1</issue>
      <issn>0067-1924</issn>
      <uri>http://www.publish.csiro.au/?paper=BT9950039</uri>
      <pub-id pub-id-type="doi">10.1071/BT9950039</pub-id>
      <fpage>39</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-mattson_herbivory_1980">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mattson</surname><given-names>William J.</given-names></name>
      </person-group>
      <article-title>Herbivory in Relation to Plant Nitrogen Content</article-title>
      <source>Annual Review of Ecology and Systematics</source>
      <year iso-8601-date="1980-11">1980</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>11</volume>
      <issue>1</issue>
      <issn>0066-4162</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev.es.11.110180.001003</uri>
      <pub-id pub-id-type="doi">10.1146/annurev.es.11.110180.001003</pub-id>
      <fpage>119</fpage>
      <lpage>161</lpage>
    </element-citation>
  </ref>
  <ref id="ref-millist_nicola_benefitcost_nodate">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Millist</surname><given-names>Ali</given-names><suffix>Nicola</suffix></name>
      </person-group>
      <article-title>Benefit–cost analysis of Australian plague locust control operations for 2010–11</article-title>
      <publisher-name>ABARES Report Prepared for the Australian Plague Locust Commission.</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <uri>https://www.agriculture.gov.au/sites/default/files/sitecollectiondocuments/animal-plant/aplc/research-papers/locust-control-11.pdf</uri>
    </element-citation>
  </ref>
  <ref id="ref-morton_fresh_2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Morton</surname><given-names>S. R.</given-names></name>
        <name><surname>Stafford Smith</surname><given-names>D. M.</given-names></name>
        <name><surname>Dickman</surname><given-names>C. R.</given-names></name>
        <name><surname>Dunkerley</surname><given-names>D. L.</given-names></name>
        <name><surname>Friedel</surname><given-names>M. H.</given-names></name>
        <name><surname>McAllister</surname><given-names>R. R. J.</given-names></name>
        <name><surname>Reid</surname><given-names>J. R. W.</given-names></name>
        <name><surname>Roshier</surname><given-names>D. A.</given-names></name>
        <name><surname>Smith</surname><given-names>M. A.</given-names></name>
        <name><surname>Walsh</surname><given-names>F. J.</given-names></name>
        <name><surname>Wardle</surname><given-names>G. M.</given-names></name>
        <name><surname>Watson</surname><given-names>I. W.</given-names></name>
        <name><surname>Westoby</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>A fresh framework for the ecology of arid Australia</article-title>
      <source>Journal of Arid Environments</source>
      <year iso-8601-date="2011-04">2011</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>75</volume>
      <issue>4</issue>
      <issn>01401963</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0140196310003010</uri>
      <pub-id pub-id-type="doi">10.1016/j.jaridenv.2010.11.001</pub-id>
      <fpage>313</fpage>
      <lpage>329</lpage>
    </element-citation>
  </ref>
  <ref id="ref-munoz-sabater_era5-land_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Muñoz-Sabater</surname><given-names>Joaquín</given-names></name>
        <name><surname>Dutra</surname><given-names>Emanuel</given-names></name>
        <name><surname>Agustí-Panareda</surname><given-names>Anna</given-names></name>
        <name><surname>Albergel</surname><given-names>Clément</given-names></name>
        <name><surname>Arduini</surname><given-names>Gabriele</given-names></name>
        <name><surname>Balsamo</surname><given-names>Gianpaolo</given-names></name>
        <name><surname>Boussetta</surname><given-names>Souhail</given-names></name>
        <name><surname>Choulga</surname><given-names>Margarita</given-names></name>
        <name><surname>Harrigan</surname><given-names>Shaun</given-names></name>
        <name><surname>Hersbach</surname><given-names>Hans</given-names></name>
        <name><surname>Martens</surname><given-names>Brecht</given-names></name>
        <name><surname>Miralles</surname><given-names>Diego G.</given-names></name>
        <name><surname>Piles</surname><given-names>María</given-names></name>
        <name><surname>Rodríguez-Fernández</surname><given-names>Nemesio J.</given-names></name>
        <name><surname>Zsoter</surname><given-names>Ervin</given-names></name>
        <name><surname>Buontempo</surname><given-names>Carlo</given-names></name>
        <name><surname>Thépaut</surname><given-names>Jean-Noël</given-names></name>
      </person-group>
      <article-title>ERA5-Land: A state-of-the-art global reanalysis dataset for land applications</article-title>
      <source>Earth System Science Data</source>
      <year iso-8601-date="2021-09">2021</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>13</volume>
      <issue>9</issue>
      <issn>1866-3516</issn>
      <uri>https://essd.copernicus.org/articles/13/4349/2021/</uri>
      <pub-id pub-id-type="doi">10.5194/essd-13-4349-2021</pub-id>
      <fpage>4349</fpage>
      <lpage>4383</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nie_obligate_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nie</surname><given-names>Yonggang</given-names></name>
        <name><surname>Zhang</surname><given-names>Zejun</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Wei</surname><given-names>Wei</given-names></name>
        <name><surname>Wei</surname><given-names>Fuwen</given-names></name>
      </person-group>
      <article-title>Obligate herbivory in an ancestrally carnivorous lineage: The giant panda and bamboo from the perspective of nutritional geometry</article-title>
      <source>Functional Ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Kay</surname><given-names>Adam</given-names></name>
      </person-group>
      <year iso-8601-date="2015-01">2015</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>29</volume>
      <issue>1</issue>
      <issn>0269-8463, 1365-2435</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2435.12302</uri>
      <pub-id pub-id-type="doi">10.1111/1365-2435.12302</pub-id>
      <fpage>26</fpage>
      <lpage>34</lpage>
    </element-citation>
  </ref>
  <ref id="ref-noy-meir_desert_1974">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Noy-Meir</surname><given-names>Imanuel</given-names></name>
      </person-group>
      <article-title>Desert Ecosystems: Higher Trophic Levels</article-title>
      <source>Annual Review of Ecology and Systematics</source>
      <year iso-8601-date="1974-11">1974</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>5</volume>
      <issue>1</issue>
      <issn>0066-4162</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev.es.05.110174.001211</uri>
      <pub-id pub-id-type="doi">10.1146/annurev.es.05.110174.001211</pub-id>
      <fpage>195</fpage>
      <lpage>214</lpage>
    </element-citation>
  </ref>
  <ref id="ref-orians_ecology_2007">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Orians</surname><given-names>Gordon H.</given-names></name>
        <name><surname>Milewski</surname><given-names>Antoni V.</given-names></name>
      </person-group>
      <article-title>Ecology of Australia: The effects of nutrient‐poor soils and intense fires</article-title>
      <source>Biological Reviews</source>
      <year iso-8601-date="2007-08">2007</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>82</volume>
      <issue>3</issue>
      <issn>1464-7931, 1469-185X</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1469-185X.2007.00017.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1469-185X.2007.00017.x</pub-id>
      <fpage>393</fpage>
      <lpage>423</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ozment_tracking_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ozment</surname><given-names>Katerina A.</given-names></name>
        <name><surname>Welti</surname><given-names>Ellen A. R.</given-names></name>
        <name><surname>Shaffer</surname><given-names>Monica</given-names></name>
        <name><surname>Kaspari</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Tracking nutrients in space and time: Interactions between grazing lawns and drought drive abundances of tallgrass prairie grasshoppers</article-title>
      <source>Ecology and Evolution</source>
      <year iso-8601-date="2021-05">2021</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>11</volume>
      <issue>10</issue>
      <issn>2045-7758, 2045-7758</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/ece3.7435</uri>
      <pub-id pub-id-type="doi">10.1002/ece3.7435</pub-id>
      <fpage>5413</fpage>
      <lpage>5423</lpage>
    </element-citation>
  </ref>
  <ref id="ref-parlin_cost_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Parlin</surname><given-names>Adam F.</given-names></name>
        <name><surname>Kendzel</surname><given-names>Mitchell J.</given-names></name>
        <name><surname>Taylor</surname><given-names>Orley R.</given-names></name>
        <name><surname>Culley</surname><given-names>Theresa M.</given-names></name>
        <name><surname>Matter</surname><given-names>Stephen F.</given-names></name>
        <name><surname>Guerra</surname><given-names>Patrick A.</given-names></name>
      </person-group>
      <article-title>The cost of movement: Assessing energy expenditure in a long-distant ectothermic migrant under climate change</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2023-11">2023</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>226</volume>
      <issue>21</issue>
      <issn>0022-0949, 1477-9145</issn>
      <uri>https://journals.biologists.com/jeb/article/226/21/jeb245296/334654/The-cost-of-movement-assessing-energy-expenditure</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.245296</pub-id>
      <fpage>jeb245296</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-perkins_dietary_2004">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perkins</surname><given-names>Marc C.</given-names></name>
        <name><surname>Woods</surname><given-names>H. Arthur</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
      </person-group>
      <article-title>Dietary phosphorus affects the growth of larval Manduca sexta</article-title>
      <source>Archives of Insect Biochemistry and Physiology</source>
      <year iso-8601-date="2004-03">2004</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>55</volume>
      <issue>3</issue>
      <issn>0739-4462, 1520-6327</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/arch.10133</uri>
      <pub-id pub-id-type="doi">10.1002/arch.10133</pub-id>
      <fpage>153</fpage>
      <lpage>168</lpage>
    </element-citation>
  </ref>
  <ref id="ref-randolph_nutritional_1995">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Randolph</surname><given-names>J. C.</given-names></name>
        <name><surname>Cameron</surname><given-names>G. N.</given-names></name>
        <name><surname>McClure</surname><given-names>P. A.</given-names></name>
      </person-group>
      <article-title>Nutritional Requirements for Reproduction in the Hispid Cotton Rat, Sigmodon hispidus</article-title>
      <source>Journal of Mammalogy</source>
      <year iso-8601-date="1995-12">1995</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>76</volume>
      <issue>4</issue>
      <issn>1545-1542, 0022-2372</issn>
      <uri>https://academic.oup.com/jmammal/article-lookup/doi/10.2307/1382603</uri>
      <pub-id pub-id-type="doi">10.2307/1382603</pub-id>
      <fpage>1113</fpage>
      <lpage>1126</lpage>
    </element-citation>
  </ref>
  <ref id="ref-raubenheimer_integrative_1997">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Raubenheimer</surname><given-names>D.</given-names></name>
        <name><surname>Simpson</surname><given-names>S. J.</given-names></name>
      </person-group>
      <article-title>Integrative models of nutrient balancing: Application to insects and vertebrates</article-title>
      <source>Nutrition Research Reviews</source>
      <year iso-8601-date="1997-01">1997</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>10</volume>
      <issue>1</issue>
      <issn>0954-4224, 1475-2700</issn>
      <uri>https://www.cambridge.org/core/product/identifier/S0954422497000103/type/journal_article</uri>
      <pub-id pub-id-type="doi">10.1079/NRR19970009</pub-id>
      <fpage>151</fpage>
      <lpage>179</lpage>
    </element-citation>
  </ref>
  <ref id="ref-schade_stoichiometric_2003">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schade</surname><given-names>John D.</given-names></name>
        <name><surname>Kyle</surname><given-names>Marcia</given-names></name>
        <name><surname>Hobbie</surname><given-names>S. E.</given-names></name>
        <name><surname>Fagan</surname><given-names>W. F.</given-names></name>
        <name><surname>Elser</surname><given-names>J. J.</given-names></name>
      </person-group>
      <article-title>Stoichiometric tracking of soil nutrients by a desert insect herbivore</article-title>
      <source>Ecology Letters</source>
      <year iso-8601-date="2003-02">2003</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>6</volume>
      <issue>2</issue>
      <issn>1461-023X, 1461-0248</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1046/j.1461-0248.2003.00409.x</uri>
      <pub-id pub-id-type="doi">10.1046/j.1461-0248.2003.00409.x</pub-id>
      <fpage>96</fpage>
      <lpage>101</lpage>
    </element-citation>
  </ref>
  <ref id="ref-simpson_compensation_1985">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Simpson</surname><given-names>S. J.</given-names></name>
        <name><surname>Abisgold</surname><given-names>J. D.</given-names></name>
      </person-group>
      <article-title>Compensation by locusts for changes in dietary nutrients: Behavioural mechanisms</article-title>
      <source>Physiological Entomology</source>
      <year iso-8601-date="1985-12">1985</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>10</volume>
      <issue>4</issue>
      <issn>0307-6962, 1365-3032</issn>
      <uri>https://resjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-3032.1985.tb00066.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-3032.1985.tb00066.x</pub-id>
      <fpage>443</fpage>
      <lpage>452</lpage>
    </element-citation>
  </ref>
  <ref id="ref-simpson_nature_2012">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <source>The Nature of Nutrition: A Unifying Framework from Animal Adaptation to Human Obesity</source>
      <publisher-name>Princeton University Press</publisher-name>
      <year iso-8601-date="2012-07">2012</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <edition>1</edition>
      <isbn>978-0-691-14565-5 978-1-4008-4280-3</isbn>
      <uri>https://academic.oup.com/princeton-scholarship-online/book/23993</uri>
      <pub-id pub-id-type="doi">10.23943/princeton/9780691145655.001.0001</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-talal_high_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne</given-names></name>
        <name><surname>Farington</surname><given-names>Ruth</given-names></name>
        <name><surname>Medina</surname><given-names>Hector E.</given-names></name>
        <name><surname>Rojas</surname><given-names>Julio</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon</given-names></name>
      </person-group>
      <article-title>High carbohydrate diet ingestion increases post-meal lipid synthesis and drives respiratory exchange ratios above 1</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2021-02">2021</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>224</volume>
      <issue>4</issue>
      <issn>0022-0949, 1477-9145</issn>
      <uri>https://journals.biologists.com/jeb/article/224/4/jeb240010/237230/High-carbohydrate-diet-ingestion-increases-post</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.240010</pub-id>
      <fpage>jeb240010</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-talal_plant_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Youngblood</surname><given-names>Jacob P.</given-names></name>
        <name><surname>Farington</surname><given-names>Ruth</given-names></name>
        <name><surname>Trumper</surname><given-names>Eduardo V.</given-names></name>
        <name><surname>Medina</surname><given-names>Hector E.</given-names></name>
        <name><surname>Rojas</surname><given-names>Julio E.</given-names></name>
        <name><surname>Fernando Copa</surname><given-names>A.</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
      </person-group>
      <article-title>Plant carbohydrate content limits performance and lipid accumulation of an outbreaking herbivore</article-title>
      <source>Proceedings of the Royal Society B: Biological Sciences</source>
      <year iso-8601-date="2020-12">2020</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>287</volume>
      <issue>1940</issue>
      <issn>0962-8452, 1471-2954</issn>
      <uri>https://royalsocietypublishing.org/doi/10.1098/rspb.2020.2500</uri>
      <pub-id pub-id-type="doi">10.1098/rspb.2020.2500</pub-id>
      <fpage>20202500</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-talal_body_2023">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
        <name><surname>Farington</surname><given-names>Ruth</given-names></name>
        <name><surname>Youngblood</surname><given-names>Jacob P.</given-names></name>
        <name><surname>Medina</surname><given-names>Hector E.</given-names></name>
        <name><surname>Overson</surname><given-names>Rick</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Body mass and growth rates predict protein intake across animals</article-title>
      <year iso-8601-date="2023-06">2023</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <uri>http://biorxiv.org/lookup/doi/10.1101/2023.06.20.545784</uri>
      <pub-id pub-id-type="doi">10.1101/2023.06.20.545784</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-tyrrell_relative_1999">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tyrrell</surname><given-names>Toby</given-names></name>
      </person-group>
      <article-title>The relative influences of nitrogen and phosphorus on oceanic primary production</article-title>
      <source>Nature</source>
      <year iso-8601-date="1999-08">1999</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>400</volume>
      <issue>6744</issue>
      <issn>0028-0836, 1476-4687</issn>
      <uri>https://www.nature.com/articles/22941</uri>
      <pub-id pub-id-type="doi">10.1038/22941</pub-id>
      <fpage>525</fpage>
      <lpage>531</lpage>
    </element-citation>
  </ref>
  <ref id="ref-uvarov_grasshoppers_1977">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Uvarov</surname><given-names>Boris Petrovič</given-names></name>
      </person-group>
      <source>Grasshoppers and locusts. 2: Behaviour, ecology, biogeography population dynamics</source>
      <publisher-name>Univ. Press</publisher-name>
      <publisher-loc>Cambridge</publisher-loc>
      <year iso-8601-date="1977">1977</year>
      <isbn>978-0-85135-072-1</isbn>
    </element-citation>
  </ref>
  <ref id="ref-veran_modeling_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Veran</surname><given-names>Sophie</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Sword</surname><given-names>Gregory A.</given-names></name>
        <name><surname>Deveson</surname><given-names>Edward</given-names></name>
        <name><surname>Piry</surname><given-names>Sylvain</given-names></name>
        <name><surname>Hines</surname><given-names>James E.</given-names></name>
        <name><surname>Berthier</surname><given-names>Karine</given-names></name>
      </person-group>
      <article-title>Modeling spatiotemporal dynamics of outbreaking species: Influence of environment and migration in a locust</article-title>
      <source>Ecology</source>
      <year iso-8601-date="2015-03">2015</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>96</volume>
      <issue>3</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/14-0183.1</uri>
      <pub-id pub-id-type="doi">10.1890/14-0183.1</pub-id>
      <fpage>737</fpage>
      <lpage>748</lpage>
    </element-citation>
  </ref>
  <ref id="ref-vitousek_terrestrial_2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vitousek</surname><given-names>Peter M.</given-names></name>
        <name><surname>Porder</surname><given-names>Stephen</given-names></name>
        <name><surname>Houlton</surname><given-names>Benjamin Z.</given-names></name>
        <name><surname>Chadwick</surname><given-names>Oliver A.</given-names></name>
      </person-group>
      <article-title>Terrestrial phosphorus limitation: Mechanisms, implications, and nitrogen–phosphorus interactions</article-title>
      <source>Ecological Applications</source>
      <year iso-8601-date="2010-01">2010</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>20</volume>
      <issue>1</issue>
      <issn>1051-0761, 1939-5582</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/08-0127.1</uri>
      <pub-id pub-id-type="doi">10.1890/08-0127.1</pub-id>
      <fpage>5</fpage>
      <lpage>15</lpage>
    </element-citation>
  </ref>
  <ref id="ref-welti_bottomup_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Welti</surname><given-names>Ellen A. R.</given-names></name>
        <name><surname>Prather</surname><given-names>Rebecca M.</given-names></name>
        <name><surname>Sanders</surname><given-names>Nathan J.</given-names></name>
        <name><surname>De Beurs</surname><given-names>Kirsten M.</given-names></name>
        <name><surname>Kaspari</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Bottom‐up when it is not top‐down: Predators and plants control biomass of grassland arthropods</article-title>
      <source>Journal of Animal Ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Morris</surname><given-names>Rebecca</given-names></name>
      </person-group>
      <year iso-8601-date="2020-05">2020</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>89</volume>
      <issue>5</issue>
      <issn>0021-8790, 1365-2656</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2656.13191</uri>
      <pub-id pub-id-type="doi">10.1111/1365-2656.13191</pub-id>
      <fpage>1286</fpage>
      <lpage>1294</lpage>
    </element-citation>
  </ref>
  <ref id="ref-welti_nutrient_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Welti</surname><given-names>Ellen A. R.</given-names></name>
        <name><surname>Roeder</surname><given-names>Karl A.</given-names></name>
        <name><surname>De Beurs</surname><given-names>Kirsten M.</given-names></name>
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
        <name><surname>Kaspari</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Nutrient dilution and climate cycles underlie declines in a dominant insect herbivore</article-title>
      <source>Proceedings of the National Academy of Sciences</source>
      <year iso-8601-date="2020-03">2020</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>117</volume>
      <issue>13</issue>
      <issn>0027-8424, 1091-6490</issn>
      <uri>https://pnas.org/doi/full/10.1073/pnas.1920012117</uri>
      <pub-id pub-id-type="doi">10.1073/pnas.1920012117</pub-id>
      <fpage>7271</fpage>
      <lpage>7275</lpage>
    </element-citation>
  </ref>
  <ref id="ref-white_importance_1978">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>White</surname><given-names>T. C. R.</given-names></name>
      </person-group>
      <article-title>The importance of a relative shortage of food in animal ecology</article-title>
      <source>Oecologia</source>
      <year iso-8601-date="1978">1978</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>33</volume>
      <issue>1</issue>
      <issn>0029-8549, 1432-1939</issn>
      <uri>http://link.springer.com/10.1007/BF00376997</uri>
      <pub-id pub-id-type="doi">10.1007/BF00376997</pub-id>
      <fpage>71</fpage>
      <lpage>86</lpage>
    </element-citation>
  </ref>
  <ref id="ref-white_inadequate_1993">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>White</surname><given-names>Thomas C. R.</given-names></name>
      </person-group>
      <source>The Inadequate Environment</source>
      <publisher-name>Springer Berlin Heidelberg</publisher-name>
      <publisher-loc>Berlin, Heidelberg</publisher-loc>
      <year iso-8601-date="1993">1993</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <isbn>978-3-642-78301-2 978-3-642-78299-2</isbn>
      <uri>http://link.springer.com/10.1007/978-3-642-78299-2</uri>
      <pub-id pub-id-type="doi">10.1007/978-3-642-78299-2</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-white_role_2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>White</surname><given-names>T. C. R.</given-names></name>
      </person-group>
      <article-title>The role of food, weather and climate in limiting the abundance of animals</article-title>
      <source>Biological Reviews</source>
      <year iso-8601-date="2008-08">2008</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>83</volume>
      <issue>3</issue>
      <issn>1464-7931, 1469-185X</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1469-185X.2008.00041.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1469-185X.2008.00041.x</pub-id>
      <fpage>227</fpage>
      <lpage>248</lpage>
    </element-citation>
  </ref>
  <ref id="ref-whitford_ecology_2002">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Whitford</surname><given-names>W. G.</given-names></name>
      </person-group>
      <source>Ecology of desert systems</source>
      <publisher-name>Academic Press</publisher-name>
      <publisher-loc>San Diego</publisher-loc>
      <year iso-8601-date="2002">2002</year>
      <isbn>978-0-12-747261-4</isbn>
    </element-citation>
  </ref>
  <ref id="ref-wiens_spatial_1989">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wiens</surname><given-names>J. A.</given-names></name>
      </person-group>
      <article-title>Spatial Scaling in Ecology</article-title>
      <source>Functional Ecology</source>
      <year iso-8601-date="1989">1989</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>3</volume>
      <issue>4</issue>
      <issn>02698463</issn>
      <uri>https://www.jstor.org/stable/2389612?origin=crossref</uri>
      <pub-id pub-id-type="doi">10.2307/2389612</pub-id>
      <fpage>385</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wilson_dietary_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wilson</surname><given-names>J. Keaton</given-names></name>
        <name><surname>Ruiz</surname><given-names>L.</given-names></name>
        <name><surname>Davidowitz</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>Dietary Protein and Carbohydrates Affect Immune Function and Performance in a Specialist Herbivore Insect ( Manduca sexta )</article-title>
      <source>Physiological and Biochemical Zoology</source>
      <year iso-8601-date="2019-01">2019</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>92</volume>
      <issue>1</issue>
      <issn>1522-2152, 1537-5293</issn>
      <uri>https://www.journals.uchicago.edu/doi/10.1086/701196</uri>
      <pub-id pub-id-type="doi">10.1086/701196</pub-id>
      <fpage>58</fpage>
      <lpage>70</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wilson_nutritional_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wilson</surname><given-names>Jerome Keaton</given-names></name>
        <name><surname>Ruiz</surname><given-names>Laura</given-names></name>
        <name><surname>Duarte</surname><given-names>Jesse</given-names></name>
        <name><surname>Davidowitz</surname><given-names>Goggy</given-names></name>
      </person-group>
      <article-title>The nutritional landscape of host plants for a specialist insect herbivore</article-title>
      <source>Ecology and Evolution</source>
      <year iso-8601-date="2019-12">2019</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>23</issue>
      <issn>2045-7758, 2045-7758</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/ece3.5730</uri>
      <pub-id pub-id-type="doi">10.1002/ece3.5730</pub-id>
      <fpage>13104</fpage>
      <lpage>13113</lpage>
    </element-citation>
  </ref>
  <ref id="ref-word_soil-targeted_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Word</surname><given-names>Mira L.</given-names></name>
        <name><surname>Hall</surname><given-names>Sharon J.</given-names></name>
        <name><surname>Robinson</surname><given-names>Brian E.</given-names></name>
        <name><surname>Manneh</surname><given-names>Balanding</given-names></name>
        <name><surname>Beye</surname><given-names>Alioune</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Soil-targeted interventions could alleviate locust and grasshopper pest pressure in West Africa</article-title>
      <source>Science of The Total Environment</source>
      <year iso-8601-date="2019-05">2019</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>663</volume>
      <issn>00489697</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0048969719303560</uri>
      <pub-id pub-id-type="doi">10.1016/j.scitotenv.2019.01.313</pub-id>
      <fpage>632</fpage>
      <lpage>643</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhang_grasshoppers_2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Zijia</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Zhang</surname><given-names>Ximei</given-names></name>
        <name><surname>Yu</surname><given-names>Qiang</given-names></name>
        <name><surname>Han</surname><given-names>Xingguo</given-names></name>
        <name><surname>Zhang</surname><given-names>Guangming</given-names></name>
      </person-group>
      <article-title>Grasshoppers Regulate N:P Stoichiometric Homeostasis by Changing Phosphorus Contents in Their Frass</article-title>
      <source>PLoS ONE</source>
      <person-group person-group-type="editor">
        <name><surname>Wicker-Thomas</surname><given-names>Claude</given-names></name>
      </person-group>
      <year iso-8601-date="2014-08">2014</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>8</issue>
      <issn>1932-6203</issn>
      <uri>https://dx.plos.org/10.1371/journal.pone.0103697</uri>
      <pub-id pub-id-type="doi">10.1371/journal.pone.0103697</pub-id>
      <fpage>e103697</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhou_increased_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhou</surname><given-names>Xiaolong</given-names></name>
        <name><surname>Liu</surname><given-names>Xudong</given-names></name>
        <name><surname>Zhang</surname><given-names>Pengfei</given-names></name>
        <name><surname>Guo</surname><given-names>Zhi</given-names></name>
        <name><surname>Du</surname><given-names>Guozhen</given-names></name>
      </person-group>
      <article-title>Increased community compositional dissimilarity alleviates species loss following nutrient enrichment at large spatial scales</article-title>
      <source>Journal of Plant Ecology</source>
      <year iso-8601-date="2019-03">2019</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>12</volume>
      <issue>2</issue>
      <issn>1752-993X</issn>
      <uri>https://academic.oup.com/jpe/article/12/2/376/5096732</uri>
      <pub-id pub-id-type="doi">10.1093/jpe/rty035</pub-id>
      <fpage>376</fpage>
      <lpage>386</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhu_effects_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhu</surname><given-names>Hui</given-names></name>
        <name><surname>Nkurunziza</surname><given-names>Venuste</given-names></name>
        <name><surname>Wang</surname><given-names>Jingting</given-names></name>
        <name><surname>Guo</surname><given-names>Qinfeng</given-names></name>
        <name><surname>Ruan</surname><given-names>Hang</given-names></name>
        <name><surname>Wang</surname><given-names>Deli</given-names></name>
      </person-group>
      <article-title>Effects of large herbivore grazing on grasshopper behaviour and abundance in a meadow steppe</article-title>
      <source>Ecological Entomology</source>
      <year iso-8601-date="2020-12">2020</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>45</volume>
      <issue>6</issue>
      <issn>0307-6946, 1365-2311</issn>
      <uri>https://resjournals.onlinelibrary.wiley.com/doi/10.1111/een.12919</uri>
      <pub-id pub-id-type="doi">10.1111/een.12919</pub-id>
      <fpage>1357</fpage>
      <lpage>1366</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhu_negative_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhu</surname><given-names>Yu</given-names></name>
        <name><surname>Zhong</surname><given-names>Zhiwei</given-names></name>
        <name><surname>Pagès</surname><given-names>Jordi F.</given-names></name>
        <name><surname>Finke</surname><given-names>Deborah</given-names></name>
        <name><surname>Wang</surname><given-names>Deli</given-names></name>
        <name><surname>Ma</surname><given-names>Quanhui</given-names></name>
        <name><surname>Hassan</surname><given-names>Nazim</given-names></name>
        <name><surname>Zhu</surname><given-names>Hui</given-names></name>
        <name><surname>Wang</surname><given-names>Ling</given-names></name>
      </person-group>
      <article-title>Negative effects of vertebrate on invertebrate herbivores mediated by enhanced plant nitrogen content</article-title>
      <source>Journal of Ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Chapman</surname><given-names>Samantha</given-names></name>
      </person-group>
      <year iso-8601-date="2019-03">2019</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>107</volume>
      <issue>2</issue>
      <issn>0022-0477, 1365-2745</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2745.13100</uri>
      <pub-id pub-id-type="doi">10.1111/1365-2745.13100</pub-id>
      <fpage>901</fpage>
      <lpage>912</lpage>
    </element-citation>
  </ref>
  <ref id="ref-simpson2012">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Simpson</surname><given-names>Stephen J</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <source>The nature of nutrition: A unifying framework from animal adaptation to human obesity</source>
      <publisher-name>Princeton university press</publisher-name>
      <year iso-8601-date="2012">2012</year>
    </element-citation>
  </ref>
  <ref id="ref-loaiza2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Loaiza</surname><given-names>Viviana</given-names></name>
        <name><surname>Jonas</surname><given-names>Jayne L.</given-names></name>
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
      </person-group>
      <article-title>Grasshoppers (Orthoptera: Acrididae) select vegetation patches in local-scale responses to foliar nitrogen but not phosphorus in native grassland: Grasshopper distribution and food quality</article-title>
      <source>Insect Science</source>
      <year iso-8601-date="2011-10">2011</year><month>10</month>
      <volume>18</volume>
      <issue>5</issue>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1744-7917.2010.01376.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1744-7917.2010.01376.x</pub-id>
      <fpage>533</fpage>
      <lpage>540</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

<sub-article article-type="notebook" id="nb-40-nb-article">
<front-stub>
<title-group>
<article-title>Exploring Nutrient Availability and Herbivorous Insect
Population Dynamics Across Multiple Scales</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Lawton</surname>
<given-names>Douglas</given-names>
</name>
<string-name>Douglas Lawton</string-name>

<email>douglas@douglaslawton.com</email>
<role vocab="https://credit.niso.org" vocab-term="writing – original
draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft/">writing</role>
<role>data analysis</role>
<role vocab="https://credit.niso.org" vocab-term="methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology/">methodology</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="corresp" rid="cor-1-nb-article">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Learned</surname>
<given-names>Jenni</given-names>
</name>
<string-name>Jenni Learned</string-name>

<role>data collection</role>
<role vocab="https://credit.niso.org" vocab-term="methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology/">methodology</role>
<xref ref-type="aff" rid="aff-2-nb-article">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Waters</surname>
<given-names>Cathy</given-names>
</name>
<string-name>Cathy Waters</string-name>

<role>experimental design</role>
<role>data collection</role>
<role vocab="https://credit.niso.org" vocab-term="methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology/">methodology</role>
<xref ref-type="aff" rid="aff-3-nb-article">c</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Toole</surname>
<given-names>Ian</given-names>
</name>
<string-name>Ian Toole</string-name>

<role>data collection</role>
<role>logistical support</role>
<xref ref-type="aff" rid="aff-4-nb-article">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Thompson</surname>
<given-names>Natalia</given-names>
</name>
<string-name>Natalia Thompson</string-name>

<role>data collection</role>
<role>chemical analyses</role>
<xref ref-type="aff" rid="aff-5-nb-article">e</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hales</surname>
<given-names>Chase</given-names>
</name>
<string-name>Chase Hales</string-name>

<role>GIS analyses</role>
<role>remote sensing data extraction</role>
<xref ref-type="aff" rid="aff-6-nb-article">f</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Adriaansen</surname>
<given-names>Chris</given-names>
</name>
<string-name>Chris Adriaansen</string-name>

<role>logistical support</role>
<xref ref-type="aff" rid="aff-7-nb-article">g</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Deveson</surname>
<given-names>Ted</given-names>
</name>
<string-name>Ted Deveson</string-name>

<role>logistical support</role>
<xref ref-type="aff" rid="aff-7-nb-article">g</xref>
<xref ref-type="aff" rid="aff-8-nb-article">h</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Simpson</surname>
<given-names>Stephen J.</given-names>
</name>
<string-name>Stephen J. Simpson</string-name>

<role>logistical support</role>
<role>experimental design</role>
<xref ref-type="aff" rid="aff-9-nb-article">i</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Cease</surname>
<given-names>Arianne</given-names>
</name>
<string-name>Arianne Cease</string-name>

<role>logistical support</role>
<role>experimental design</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="aff" rid="aff-10-nb-article">j</xref>
</contrib>
</contrib-group>
<aff id="aff-1-nb-article">
<institution-wrap>
<institution>School of Sustainability, Arizona State University, Tempe,
AZ, USA</institution>
</institution-wrap>







</aff>
<aff id="aff-2-nb-article">
<institution-wrap>
<institution>Mau Nui Seabird Recovery Project, Makawao, HI,
USA</institution>
</institution-wrap>







</aff>
<aff id="aff-3-nb-article">
<institution-wrap>
<institution>GreenCollar, 3 Hickson Road, The Rocks, Sydney, NSW,
Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-4-nb-article">
<institution-wrap>
<institution>NSW Department of Primary Industries, Trangie, NSW,
Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-5-nb-article">
<institution-wrap>
<institution>School of Molecular Sciences, Arizona State University,
Tempe, AZ, USA</institution>
</institution-wrap>







</aff>
<aff id="aff-6-nb-article">
<institution-wrap>
<institution>School of Geographical Sciences &amp; Urban Planning,
Arizona State University, Tempe, AZ, USA</institution>
</institution-wrap>







</aff>
<aff id="aff-7-nb-article">
<institution-wrap>
<institution>Australian Plague Locust Commission, Fyshwick, ACT,
Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-8-nb-article">
<institution-wrap>
<institution>Fenner School of Environment and Society, Australian
National University, ACT, Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-9-nb-article">
<institution-wrap>
<institution>School of Life and Environmental Science Charles Perkins
Centre, University of Sydney, Sydney, Australia</institution>
</institution-wrap>







</aff>
<aff id="aff-10-nb-article">
<institution-wrap>
<institution>School of Life Sciences, Arizona State University, Tempe,
AZ, USA</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1-nb-article">douglas@douglaslawton.com</corresp>
</author-notes>
<abstract>
<list list-type="order">
  <list-item>
    <p>Nutrient composition varies greatly across landscapes, which in
    turn influences the spatiotemporal variation and dynamics of
    populations. Yet few studies have investigated this pattern on
    multiple scales.</p>
  </list-item>
  <list-item>
    <p>We tested how nutrient limitation affects herbivore populations
    across spatial scales from individual behavior to landscape level
    population dynamics using Australian plague locust,
    <bold>Chortoicetes terminifera</bold> (Walker), field populations
    and long-term survey data from across their range.</p>
  </list-item>
  <list-item>
    <p>At the individual level, juvenile locusts selected for a
    carbohydrate-biased intake target of 1 protein (p) 2 carbohydrate
    (c) and had the highest growth and shortest development time when
    fed artificial diets with that same 1p:2c ratio over the duration of
    the 5th (final) juvenile instar.</p>
  </list-item>
  <list-item>
    <p>At the field level, locusts kept in field cages with
    protein-biased plants redressed their nutritional imbalance by
    selecting very carbohydrate-biased diets (up to a 1p:20c ratio) for
    more than a week after being removed from the protein-biased
    environment. Once the deficiency was met, locusts returned to the
    1p:2c intake target.</p>
  </list-item>
  <list-item>
    <p>Going up to the landscape level, outbreaks were negatively
    correlated with soil nitrogen and showed a non-linear relationship
    with soil phosphorus peaking at approximately 4% soil phosphorus. We
    disentangled the relationship between mean annual precipitation and
    soil nitrogen through leveraging both comprehensive locust surveys
    and remotely sensed soil and weather data that spanned decades.</p>
  </list-item>
  <list-item>
    <p>This paper is the first to integrate lab, field, and remote
    sensing approaches to demonstrate the importance of nutrient
    balancing and acquisition across scales for herbivores. Specifically
    for locusts, we show that low nitrogen environments promote
    outbreaks, likely by reducing plant protein to carbohydrate ratios.
    Incorporating soil quality data into locust plague forecasting
    models can help increase accuracy of predictions.</p>
  </list-item>
</list>
</abstract>
</front-stub>

<body>
<sec id="introduction-nb-article">
  <title>1. INTRODUCTION</title>
  <p>Plant nutrients are usually more variable than animal body
  composition, which can make it challenging for herbivores to acquire
  an optimal nutritional balance
  (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000-nb-article" ref-type="bibr">Elser
  et al., 2000</xref>). Nutrient balance affects individual performance
  (<xref alt="Batzli, 1986" rid="ref-batzli_nutritional_1986-nb-article" ref-type="bibr">Batzli,
  1986</xref>;
  <xref alt="Bernays et al., 1994" rid="ref-bernays_dietary_1994-nb-article" ref-type="bibr">Bernays
  et al., 1994</xref>) and, by extension, influences population dynamics
  (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000-nb-article" ref-type="bibr">Elser
  et al., 2000</xref>). One way many primary consumers achieve an
  optimal blend of nutrients is through selecting different host plants
  or plant parts to reach a specific amount and ratio, termed the intake
  target, IT
  (<xref alt="Simpson &amp; Raubenheimer, 2012a" rid="ref-simpson2012-nb-article" ref-type="bibr">Simpson
  &amp; Raubenheimer, 2012a</xref>). For example, giant pandas
  (Ailuropoda melanoleuca) synchronize their migration and reproduction
  cycles with seasonal nutrient availability between different bamboo
  species
  (<xref alt="Nie et al., 2015" rid="ref-nie_obligate_2015-nb-article" ref-type="bibr">Nie
  et al., 2015</xref>). While studies have investigated this trend
  between available nutrients and animal populations, they usually
  happen at one scale and biological level. For example, much
  grasshopper nutrition research has been done at the organismal or
  local population level using lab and/or field studies
  (<xref alt="Behmer, 2009" rid="ref-behmer_insect_2009-nb-article" ref-type="bibr">Behmer,
  2009</xref>;
  <xref alt="Cease, 2024" rid="ref-cease_how_2024-nb-article" ref-type="bibr">Cease,
  2024</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019-nb-article" ref-type="bibr">Le
  Gall et al., 2019</xref>), with a few separate larger scale modeling
  endeavors
  (<xref alt="Welti, Roeder, et al., 2020" rid="ref-welti_nutrient_2020-nb-article" ref-type="bibr">Welti,
  Roeder, et al., 2020</xref>;
  <xref alt="Zhou et al., 2019" rid="ref-zhou_increased_2019-nb-article" ref-type="bibr">Zhou
  et al., 2019</xref>). To our knowledge, no study has integrated
  individual herbivorous animal nutrition to continental level patterns
  in nutrient availability. Here we work across spatial scales, bridging
  field observations and cage manipulations with continental-scale
  insect pest outbreak modeling to see how the animal-nutrient
  relationship changes across multiple scales.</p>
  <p>Food quality has long been considered an important predictor of
  animal population dynamics
  (<xref alt="Andersen et al., 2004" rid="ref-andersen_stoichiometry_2004-nb-article" ref-type="bibr">Andersen
  et al., 2004</xref>;
  <xref alt="White, 1993" rid="ref-white_inadequate_1993-nb-article" ref-type="bibr">White,
  1993</xref>). Phosphorus and nitrogen commonly limit primary
  production in ecosystems, either separately or as co-limiting factors
  Vitousek et al.
  (<xref alt="2010" rid="ref-vitousek_terrestrial_2010-nb-article" ref-type="bibr">2010</xref>),
  and are often investigated as limiting factors for higher trophic
  levels to determine the consequences to animal growth and reproduction
  (<xref alt="Andersen et al., 2004" rid="ref-andersen_stoichiometry_2004-nb-article" ref-type="bibr">Andersen
  et al., 2004</xref>). For example, bluegrass fields supplemented with
  high quality (e.g. increased nitrogen) food pellets increase vole
  (Microtus ochmgaster) densities compared to control fields by
  supporting higher adult survival, increased breeding, and growth rate
  (<xref alt="Cole &amp; Batzli, 1978" rid="ref-cole_influence_1978-nb-article" ref-type="bibr">Cole
  &amp; Batzli, 1978</xref>). Less phosphorus in a dryland insect
  herbivore’s (Sabinia setosa) host plant, velvet mesquite (Prosopis
  velutina), leads to individuals having decreased RNA content (slower
  growth) and lower abundance
  (<xref alt="Schade et al., 2003" rid="ref-schade_stoichiometric_2003-nb-article" ref-type="bibr">Schade
  et al., 2003</xref>). More broadly, nitrogen and phosphorus limitation
  has been shown in mammals
  (<xref alt="Randolph et al., 1995" rid="ref-randolph_nutritional_1995-nb-article" ref-type="bibr">Randolph
  et al., 1995</xref>;
  <xref alt="White, 1993" rid="ref-white_inadequate_1993-nb-article" ref-type="bibr">White,
  1993</xref>), birds
  (<xref alt="Forero et al., 2002" rid="ref-forero_conspecific_2002-nb-article" ref-type="bibr">Forero
  et al., 2002</xref>;
  <xref alt="Granbom &amp; Smith, 2006" rid="ref-granbom_food_2006-nb-article" ref-type="bibr">Granbom
  &amp; Smith, 2006</xref>), and insects
  (<xref alt="Floyd, 1996" rid="ref-floyd_frontiers_1996-nb-article" ref-type="bibr">Floyd,
  1996</xref>;
  <xref alt="Huberty &amp; Denno, 2006" rid="ref-huberty_consequences_2006-nb-article" ref-type="bibr">Huberty
  &amp; Denno, 2006</xref>;
  <xref alt="Marsh &amp; Adams, 1995" rid="ref-marsh_decline_1995-nb-article" ref-type="bibr">Marsh
  &amp; Adams, 1995</xref>;
  <xref alt="Perkins et al., 2004" rid="ref-perkins_dietary_2004-nb-article" ref-type="bibr">Perkins
  et al., 2004</xref>) which is discussed further in White
  (<xref alt="2008" rid="ref-white_role_2008-nb-article" ref-type="bibr">2008</xref>)
  and Andersen et al.
  (<xref alt="2004" rid="ref-andersen_stoichiometry_2004-nb-article" ref-type="bibr">2004</xref>).
  However, not all animal populations respond positively to increasing
  environmental nutrients. For example, studies from across the globe
  reveal that the abundances of many grasshopper species are positively
  (<xref alt="Joern et al., 2012" rid="ref-joern_not_2012-nb-article" ref-type="bibr">Joern
  et al., 2012</xref>;
  <xref alt="Ozment et al., 2021" rid="ref-ozment_tracking_2021-nb-article" ref-type="bibr">Ozment
  et al., 2021</xref>;
  <xref alt="Welti, Prather, et al., 2020" rid="ref-welti_bottomup_2020-nb-article" ref-type="bibr">Welti,
  Prather, et al., 2020</xref>;
  <xref alt="Welti, Roeder, et al., 2020" rid="ref-welti_nutrient_2020-nb-article" ref-type="bibr">Welti,
  Roeder, et al., 2020</xref>;
  <xref alt="H. Zhu et al., 2020" rid="ref-zhu_effects_2020-nb-article" ref-type="bibr">H.
  Zhu et al., 2020</xref>;
  <xref alt="Y. Zhu et al., 2019" rid="ref-zhu_negative_2019-nb-article" ref-type="bibr">Y.
  Zhu et al., 2019</xref>), or not related
  (<xref alt="Heidorn &amp; Joern, 1987" rid="ref-heidorn_feeding_1987-nb-article" ref-type="bibr">Heidorn
  &amp; Joern, 1987</xref>;
  <xref alt="Jonas &amp; Joern, 2008" rid="ref-jonas_hostplant_2008-nb-article" ref-type="bibr">Jonas
  &amp; Joern, 2008</xref>;
  <xref alt="Lenhart et al., 2015" rid="ref-lenhart_water_2015-nb-article" ref-type="bibr">Lenhart
  et al., 2015</xref>;
  <xref alt="Ozment et al., 2021" rid="ref-ozment_tracking_2021-nb-article" ref-type="bibr">Ozment
  et al., 2021</xref>) to plant nitrogen concentrations as reviewed in
  Cease
  (<xref alt="2024" rid="ref-cease_how_2024-nb-article" ref-type="bibr">2024</xref>).
  Can the relationship between herbivore abundance and environmental
  nutrients be explained by approaches that consider nutritional
  physiology at the organismal level, in addition to population and
  landscape ecology?</p>
  <p>One excellent study system to understand the complex relationship
  of nutrient availability and population dynamics is a subset of
  grasshoppers called locusts
  (<xref alt="Cullen et al., 2017" rid="ref-cullen_molecules_2017-nb-article" ref-type="bibr">Cullen
  et al., 2017</xref>;
  <xref alt="Uvarov, 1977" rid="ref-uvarov_grasshoppers_1977-nb-article" ref-type="bibr">Uvarov,
  1977</xref>). Locusts undergo massive population irruptions known as
  plagues that pose significant issues for global food security
  (<xref alt="Cease et al., 2015" rid="ref-cease_living_2015-nb-article" ref-type="bibr">Cease
  et al., 2015</xref>). For example, the 2010-2011 Australian plague
  locust (Chortoicetes terminifera) plague could have caused AUD$963
  million in crop damage if not controlled
  (<xref alt="Millist, 2011" rid="ref-millist_nicola_benefitcost_nodate-nb-article" ref-type="bibr">Millist,
  2011</xref>). In contrast to the nitrogen limitation paradigm (White
  1993), locusts frequently show carbohydrate limitation. Many locust
  species, including C. terminifera, will select plants with a low
  protein:carbohydrate ratio and eat about double the amount of
  carbohydrate relative to protein when given a choice of artificial
  diets
  (<xref alt="Behmer, 2009" rid="ref-behmer_insect_2009-nb-article" ref-type="bibr">Behmer,
  2009</xref>;
  <xref alt="Brosemann et al., 2023" rid="ref-brosemann_nutrient_2023-nb-article" ref-type="bibr">Brosemann
  et al., 2023</xref>;
  <xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021-nb-article" ref-type="bibr">Lawton
  et al., 2021</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019-nb-article" ref-type="bibr">Le
  Gall et al., 2019</xref>). Their high energy, relative to protein,
  demand is heightened by their impressive long-distance migration.
  Marching bands of South American locusts (Schistocerca cancellata) eat
  predominantly from dishes containing carbohydrates and largely ignore
  dishes containing protein
  (<xref alt="Cease et al., 2023" rid="ref-cease_field_2023-nb-article" ref-type="bibr">Cease
  et al., 2023</xref>), and have the highest survival and lipid gain
  when eating carbohydrate-biased plants
  (<xref alt="Talal et al., 2020" rid="ref-talal_plant_2020-nb-article" ref-type="bibr">Talal
  et al., 2020</xref>). As adults, flight increases carbohydrate, but
  not protein, consumption in migratory locusts (Locusta migratoria) and
  locusts eating carbohydrate-biased diets fly for longer times
  (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023-nb-article" ref-type="bibr">Talal
  et al., 2023</xref>). At a local scale, high-use agricultural areas
  that decrease soil and plant nitrogen promote Oedaleus locust
  outbreaks in Senegal and China
  (<xref alt="Cease et al., 2012" rid="ref-cease_heavy_2012-nb-article" ref-type="bibr">Cease
  et al., 2012</xref>;
  <xref alt="Giese et al., 2013" rid="ref-giese_n_2013-nb-article" ref-type="bibr">Giese
  et al., 2013</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019-nb-article" ref-type="bibr">Le
  Gall et al., 2019</xref>;
  <xref alt="Word et al., 2019" rid="ref-word_soil-targeted_2019-nb-article" ref-type="bibr">Word
  et al., 2019</xref>). Less is known about the relationship between
  plant phosphorus and locust populations, but grasshoppers and locusts
  can detect and regulate phosphorus during ingestion and
  post-ingestively to maintain homeostasis
  (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016-nb-article" ref-type="bibr">Cease
  et al., 2016</xref>;
  <xref alt="Zhang et al., 2014" rid="ref-zhang_grasshoppers_2014-nb-article" ref-type="bibr">Zhang
  et al., 2014</xref>). Long-term laboratory rearing studies show
  negative effects of too little or excess dietary phosphorus, though
  short-term restrictions to low or high phosphorus diets appear to have
  no effects
  (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016-nb-article" ref-type="bibr">Cease
  et al., 2016</xref>). Field measurements of Oedaleus decorus asiaticus
  in China show that locusts increase phosphorus excretion with
  increasing plant phosphorus content, suggesting that phosphorus may
  not be limiting in the Inner Mongolian Steppe for this species
  (<xref alt="Zhang et al., 2014" rid="ref-zhang_grasshoppers_2014-nb-article" ref-type="bibr">Zhang
  et al., 2014</xref>). Understanding the multi-scale flow of nitrogen
  and phosphorus from soils to continental scale population dynamics may
  reveal a connection between soil quality and locust plagues in
  Australia and further elucidate the pattern globally
  (<xref alt="Cease, 2024" rid="ref-cease_how_2024-nb-article" ref-type="bibr">Cease,
  2024</xref>;
  <xref alt="Le Gall et al., 2019" rid="ref-le_gall_global_2019-nb-article" ref-type="bibr">Le
  Gall et al., 2019</xref>).</p>
  <p>The arid interior of Australia is a highly variable environment
  (<xref alt="Morton et al., 2011" rid="ref-morton_fresh_2011-nb-article" ref-type="bibr">Morton
  et al., 2011</xref>) characterized by the Resource-Pulse Paradigm
  (<xref alt="Noy-Meir, 1974" rid="ref-noy-meir_desert_1974-nb-article" ref-type="bibr">Noy-Meir,
  1974</xref>;
  <xref alt="Whitford, 2002" rid="ref-whitford_ecology_2002-nb-article" ref-type="bibr">Whitford,
  2002</xref>). Many Australian animal and plant populations irrupt
  following periods of favorable climatic conditions. For example,
  preceding vegetation growth is an important factor for Australian
  plague locust population outbreaks
  (<xref alt="Lawton et al., 2022" rid="ref-lawton_seeing_2022-nb-article" ref-type="bibr">Lawton
  et al., 2022</xref>). In addition to climatic variability, Australia
  is marked by poor natural soil fertility
  (<xref alt="Morton et al., 2011" rid="ref-morton_fresh_2011-nb-article" ref-type="bibr">Morton
  et al., 2011</xref>;
  <xref alt="Orians &amp; Milewski, 2007" rid="ref-orians_ecology_2007-nb-article" ref-type="bibr">Orians
  &amp; Milewski, 2007</xref>). Nutrients such as nitrogen and
  phosphorus are in short supply in unmodified soils. Subsequently, many
  native animals and plants are adapted to environments low in soil
  nutrients
  (<xref alt="Orians &amp; Milewski, 2007" rid="ref-orians_ecology_2007-nb-article" ref-type="bibr">Orians
  &amp; Milewski, 2007</xref>). Australia has several locust species,
  but the Australian plague locust is the most widespread and
  economically damaging
  (<xref alt="Hunter et al., 2001" rid="ref-hunter_adaptations_2001-nb-article" ref-type="bibr">Hunter
  et al., 2001</xref>). As with many dryland animals, numerous studies
  have shown the relationship between climatic conditions and Australian
  plague locust population outbreaks
  (<xref alt="Clark, 1974" rid="ref-clark_influence_1974-nb-article" ref-type="bibr">Clark,
  1974</xref>;
  <xref alt="Deveson &amp; Walker, 2005" rid="ref-deveson_not_2005-nb-article" ref-type="bibr">Deveson
  &amp; Walker, 2005</xref>;
  <xref alt="Farrow, 1982" rid="ref-farrow_population_1982-nb-article" ref-type="bibr">Farrow,
  1982</xref>;
  <xref alt="Key, 1945" rid="ref-key_general_1945-nb-article" ref-type="bibr">Key,
  1945</xref>), however few have investigated the relationship between
  soil and plant nutrients and this species’ outbreaks.</p>
  <p>In this study, we investigate the across scale relationship between
  soil and plant nutrients and animal populations using Australian
  plague locusts. We have three specific questions and subsequent
  predictions across scales:</p>
  <list list-type="order">
    <list-item>
      <label>1)</label>
      <p>What are the nutritional preferences of individuals from
      gregarious Australian plague locust field populations? We expect
      individuals to be carbohydrate biased based on their active
      lifestyle, and to keep a constant intake target between
      populations.</p>
    </list-item>
    <list-item>
      <label>2)</label>
      <p>What happens to Australian plague locusts when constrained to
      high nitrogen environments? We expect locusts to select
      particularly carbohydrate biased diets to redress a protein :
      carbohydrate imbalance in their local environment.</p>
    </list-item>
    <list-item>
      <label>3)</label>
      <p>Can we use soil nutrients as a predictor of Australian plague
      locust nymph outbreaks at the continental scale?</p>
    </list-item>
  </list>
  <p>At larger scales, and accounting for climatic factors, we expect
  outbreaks to be associated with low nitrogen areas. Since terrestrial
  herbivores can require 5-50 times more nitrogen than phosphorus
  (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000-nb-article" ref-type="bibr">Elser
  et al., 2000</xref>) and locusts likely have a higher capacity to
  post-ingestively regulate phosphorus in ranges found in nature
  (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016-nb-article" ref-type="bibr">Cease
  et al., 2016</xref>;
  <xref alt="Zhang et al., 2014" rid="ref-zhang_grasshoppers_2014-nb-article" ref-type="bibr">Zhang
  et al., 2014</xref>), we expect nitrogen to be a stronger predictor of
  populations at a continental scale as compared to phosphorus.</p>
</sec>
<sec id="methods-nb-article">
  <title>2. METHODS</title>
  <sec id="field-site-and-animals-nb-article">
    <title>2.1 Field site and animals</title>
    <p>Lab-based and field cage experiments were conducted at the
    Trangie Agricultural Research Centre of the Department of Primary
    Industries in Trangie, New South Wales, Australia. We used field
    populations of the Australian plague locust, which prefers open
    grassy areas and is a grass generalist
    (<xref alt="Key, 1945" rid="ref-key_general_1945-nb-article" ref-type="bibr">Key,
    1945</xref>). Solitarious populations of this locust species
    maintain their intake target closely regardless of spatiotemporal
    changes
    (<xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021-nb-article" ref-type="bibr">Lawton
    et al., 2021</xref>). We carried out these studies in
    November-December 2015, during the final nymphal and early adult
    stages of the spring Australian plague locust generation.</p>
  </sec>
  <sec id="nutritional-target-and-performance-curve-using-synthetic-diets-nb-article">
    <title>2.2 Nutritional target and performance curve using synthetic
    diets</title>
    <p>To control the nutrient availability within the experiments, we
    used isocaloric artificial diets made up of 42% macronutrients
    (differing ratios of protein and carbohydrates), 32% cellulose, and
    4% of salt, sterols and vitamins. This artificial diet mixture has
    been used with this species
    (<xref alt="Clissold et al., 2014" rid="ref-clissold_regulation_2014-nb-article" ref-type="bibr">Clissold
    et al., 2014</xref>) and was developed by Simpson &amp; Abisgold
    (<xref alt="1985" rid="ref-simpson_compensation_1985-nb-article" ref-type="bibr">1985</xref>)
    from Dadd
    (<xref alt="1961" rid="ref-dadd_nutritional_1961-nb-article" ref-type="bibr">1961</xref>).
    We dried diets to a constant mass at 60°C before weighing the diets
    before and after all experiments.</p>
    <p>We collected fourth and fifth instar nymphs from outbreaking
    populations on Nov. 12, 2015 from two locations: near Mendooran
    (31°40.791’ S, 149°04.209’ E) and Guntawang (32°23.988’ S,
    149°28.649’ E), New South Wales. The Mendooran population was
    forming marching bands while the Guntawang population was at high
    density but was not actively marching during the collection period.
    Both populations were collected along dirt roads flanked by
    livestock grazing pastures containing a mix of grasses and forbs. We
    transported locusts back to the Trangie Agricultural Research Centre
    and kept them in large plastic bins with holes along with an
    assortment of grasses and forbs cut from the same field locusts were
    collected until experiments were started. For both experiments,
    locusts were housed individually in plastic cages (ca. 18 cm L x 12
    cm W x 4 cm H) with small holes for ventilation. Each cage had two
    (nutritional target) or one (performance curve) artificial diets, a
    water tube capped with cotton, and a perch.</p>
    <sec id="nutrition-target-choice-diets-nb-article">
      <title>2.2.1 Nutrition target (choice diets)</title>
      <p>We ran this experiment to determine the preferred dietary p:c
      ratio of Australian plague locust field populations. We selected
      equal numbers of males and females from both Mendooran and
      Guntawang populations and individuals that had no visible wing bud
      separation to ensure they were early in the fifth instar. Locusts
      were heated with incandescent light bulbs on a 14:10 light:dark
      cycle. The average daytime and nighttime temperatures in the cages
      were 25.5°C and 23.4°C respectively, recorded from an iButton
      (Maxim). We randomly assigned 80 locusts (20 individuals per diet
      pair per population) to one of two treatment groups receiving
      pairs of either 7p:35c &amp; 28p:14c or 7p:35c &amp; 35p:7c (% p :
      % c by dry mass). We used two different pairs to ensure that the
      selected p:c ratio was not the result of eating randomly between
      the two dishes. We let locusts eat from the dishes for three days
      (Nov. 12-15, 2015) and calculated the mass of protein and
      carbohydrate each locust ate by subtracting the final dish weights
      from the initial dish weights.</p>
    </sec>
    <sec id="performance-curve-no-choice-diets-nb-article">
      <title>2.2.2 Performance curve (no-choice diets)</title>
      <p>We ran this experiment to determine the growth rate and
      development time to adulthood of Australian plague locust
      juveniles in response to different dietary p:c ratios. We isolated
      fourth instar nymphs from the Mendooran population and housed them
      in individual cages. Each day, we retrieved individuals that had
      molted into the fifth (final) stadium to incorporate into the
      experiment. We added an assortment of grasses and forbs collected
      from grazing pastures in the Research Centre to the cage of fourth
      instars daily. On day one of the fifth instar, locusts were
      randomly assigned to one of four artificial diet treatment groups:
      (7p:35c, 14p:28c, 21p:21c, or 35p:7c), with 18 locusts per
      treatment (similar numbers of males and females for each group).
      Fifth instar locusts were started on diets between Nov. 15-19 and
      we ended the experiment on Dec. 3, 2017. If locusts molted to
      adults before that point, we recorded the adult mass on the day
      they molted and ended that individual trial. We fed locusts their
      assigned diet ad lib such that there was always food available. We
      changed diets every three days until locusts molted to adults or
      until the experiment ended. Locusts were heated with incandescent
      light bulbs on a 14:10 Light:Dark cycle. The average daytime and
      nighttime temperatures in the cages were 26.2°C and 23.9°C,
      respectively, recorded from an iButton.</p>
    </sec>
  </sec>
  <sec id="field-cage-experiments-nb-article">
    <title>2.3 Field cage experiments</title>
    <p>We ran this experiment to test the effects of different host
    plant nitrogen contents on locust nutrient balancing, growth, and
    survival. This experiment was conducted in a research field at the
    Trangie Research Centre that is used mainly for livestock grazing
    and had no history of fertilization. We marked nine 7 m x 7 m plots
    with 2 m alleyways between each plot. Each of the three nitrogen
    addition levels (0, 87.5, and 175 kg N/ha) was randomly assigned to
    three of the nine plots. We chose 175 kg N/ha as the upper range
    because this is similar to the fertilization rates of most crops. We
    added the fertilization treatment one time, on Nov. 2, 2015, in the
    form of urea, two weeks before a significant rainfall (ca. 60 mm).
    This treatment regime allowed us to see how increasing levels of
    nitrogen affected nutrient redressing and overall performance of
    locust populations through time.</p>
    <p>We built 0.75 x 0.75 x 0.75 m cages with four steel fence posts
    and aluminum mesh. We secured the mesh to the ground by partially
    burying it and nailing thin slats of wood over the mesh edges.
    Before adding locusts to the cages, we removed any plant litter and
    arthropods (mostly spiders and locusts) so we could more easily
    count the locusts and limit predation. We added 20 4th instar locust
    nymphs to each field cage on the evening of November 13th and
    morning of November 14th. We randomly selected these nymphs from the
    Mendooran population we collected on November 12th (see synthetic
    diet methods section above). Each fertilized plot had four cages,
    for a total of 12 cages per fertilization level, and 36 cages and
    720 locusts in total. We checked the cages every 4-5 days and
    removed any spiders.</p>
    <p>We measured plant diversity and abundance in each locust cage and
    outside the cage within each fertilized plot. We also measured
    ground, litter, manure, and plant cover in each of the nine plots by
    randomly tossing three 0.25 x 0.25 m quadrats within each of the
    nine plots. We took these ground cover and biodiversity measurements
    at the beginning and end of the experiment. We took plant leaf
    samples for nutrient analyses from each cage three times during the
    experiment on November 11th, November 25th, and December 1st, 2015.
    Plant species with resulting carbon, nitrogen, digestible
    carbohydrate and protein content as well as soil nitrogen (from 0-10
    cm cores) can be seen in
    <xref alt="Table 6" rid="tbl-field-cage-plant-soil-nutrients-nb-article">Table 6</xref>.
    Plant species ground cover for each cage can be seen in
    <xref alt="Table 7" rid="tbl-field-cage-plant-ground-cover-nb-article">Table 7</xref>.
    The relationship between soil NO3 and NO4 within cage plots and cage
    plant carbohydrates and proteins are visualized in
    <xref alt="Supplementary Figure 1" rid="suppfig-field-cage-plant-soil-nutrient-correlations-nb-article">Supplementary Figure 1</xref>.</p>
    <p>To test how the nitrogen fertilization treatments affected the
    nutritional status of the locusts, we collected 20 locusts from
    control and high N treatment cages (40 individuals in total) on
    November 23, 2015. We housed them in individual cages and gave them
    the choice of a low protein: carbohydrate diet and a high protein:
    carbohydrate diet. We changed their diets on days one, two, four,
    and six and ended the experiment at day nine. To ensure an adequate
    sample size, we included data from any individuals that died
    (approximately 60% mortality) before the experiment was completed
    and individuals which molted during the experiment. We calculated
    the mass of protein and carbohydrate locusts ate over each interval.
    This allowed us to see the nutritional redressing of
    individuals.</p>
    <p>We collected all remaining field-cage locusts on Nov. 28, 2015
    and recorded developmental stage and body mass. We calculated
    surviving proportion for each cage accounting for the locusts we
    removed for the nutritional status experiments (surviving proportion
    = # live locusts/(initial # added-# locusts removed for secondary
    experiment)). We calculated the proportion molted to adult of the
    surviving locusts (# adults/# live locusts).</p>
  </sec>
  <sec id="correlating-historical-nymphal-outbreaks-with-soil-nitrogen-and-phosphorus-nb-article">
    <title>2.4 Correlating historical nymphal outbreaks with soil
    nitrogen and phosphorus</title>
    <p>To understand the relationship between soil nutrients and locust
    outbreaks, we used the Australian Plague Locust Commission’s (APLC)
    long-term locust survey dataset
    (<xref alt="T. Deveson &amp; Hunter, 2002" rid="ref-deveson_operation_2002-nb-article" ref-type="bibr">T.
    Deveson &amp; Hunter, 2002</xref>) and the Soil and Landscape Grid
    Australia-Wide 3D Soil Property Maps
    (<xref alt="Grundy et al., 2015" rid="ref-grundy_soil_2015-nb-article" ref-type="bibr">Grundy
    et al., 2015</xref>).</p>
    <sec id="locust-outbreak-data-nb-article">
      <title>2.4.1 Locust outbreak data</title>
      <p>Australian plague locust data from 2000 - 2017 (~ 190,000
      records) were used in this study. This database contains
      georeferenced points with a categorical ordinal variable 0-4 to
      represent approximate nymph densities. The value ranges for nymphs
      are: 0 = nil, 1 = &lt; 5 m2, 2 = 5-30 m2, 3 = 31-80 m2, and 4 =
      &gt; 80 m2. Population outbreaks are characterized by very high
      densities of gregarious nymphs (up to 1000 m2). We focused on
      nymphs as this life stage cannot fly and can be used to assess
      prior local habitat conditions. While the database extends into
      the 1980s, we only used data collected between 2000-2017 as this
      period overlapped with the soil grid data which was released in
      2015. Since climatic conditions and migration patterns are drivers
      in outbreak occurrence
      (<xref alt="Lawton et al., 2022" rid="ref-lawton_seeing_2022-nb-article" ref-type="bibr">Lawton
      et al., 2022</xref>;
      <xref alt="Veran et al., 2015" rid="ref-veran_modeling_2015-nb-article" ref-type="bibr">Veran
      et al., 2015</xref>) they likely mask the relationship between
      static environmental variables like soil nutrients. To account for
      this variability, we spatially aggregated the survey dataset to a
      1 km2 x 1 km2 grid as can be seen in
      <xref alt="Supplementary Figure 2" rid="suppfig-grid-example-nb-article">Supplementary Figure 2</xref>.
      This allowed us to model how often locust outbreaks occur in grid
      cells rather than the actual outbreak. We used a 1 km2 x 1 km2
      grid as this reflects the estimated maximum dispersal distance
      from hatching to 5th instar
      (<xref alt="Hunter et al., 2008" rid="ref-hunter_aerial_2008-nb-article" ref-type="bibr">Hunter
      et al., 2008</xref>). We counted the number of outbreaks (APLC
      nymph density code 4), the number of nil records (APLC nymph
      density code 0), and total number of survey observations. This
      resulted in approximately 12,000 grid cells for the final dataset.
      Overall APLC survey point distribution can be seen in
      <xref alt="Figure 1" rid="fig-spatial-modeling-env-map-nb-article">Figure 1</xref>
      A.</p>
    </sec>
    <sec id="soil-grid-of-australia-data-nb-article">
      <title>2.4.2 Soil grid of Australia data</title>
      <p>The soil and landscape grid of Australia is a modeled raster of
      12 soil variables at a 90 m2 resolution. These soil
      characteristics are available at multiple depths from surface to
      two meters below the surface. These depths and methodology are
      consistent with the specifications of the Global Soil Map project
      (http://www.globalsoilmap.net)
      (<xref alt="Grundy et al., 2015" rid="ref-grundy_soil_2015-nb-article" ref-type="bibr">Grundy
      et al., 2015</xref>). We extracted this data from Google Earth
      Engine
      (<xref alt="Gorelick et al., 2017" rid="ref-gorelick_google_2017-nb-article" ref-type="bibr">Gorelick
      et al., 2017</xref>). In this data set both phosphorus and
      nitrogen units are the mass fraction of total nutrient in the soil
      by weight. We took the average of nitrogen and phosphorus of the
      top two depths (0 cm – 5 cm and 5 cm and 15 cm) as these are most
      relevant to nutrient content of grasses and forbs. Then, for each
      APLC survey grid we calculated the mean mass fraction of nitrogen
      and phosphorus in the soil by weight to a 15 cm depth. Spatial
      distribution of soil nitrogen and phosphorus can be seen in
      <xref alt="Figure 1" rid="fig-spatial-modeling-env-map-nb-article">Figure 1</xref>
      B and
      <xref alt="Figure 1" rid="fig-spatial-modeling-env-map-nb-article">Figure 1</xref>
      C respectively.</p>
      <fig id="fig-spatial-modeling-env-map-nb-article">
        <caption><p>Figure 1: Locust survey data map and soil nutrients
        throughout the Australian plague locust distribution. A: APLC
        survey dataset, B: mean proportion phosphorous at 0-15cm deep,
        C: mean proportion of nitrogen at 0-15 cm deep.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/spatial_modeling_locust_env_map.png" />
      </fig>
    </sec>
  </sec>
  <sec id="statistics-nb-article">
    <title>2.5 Statistics</title>
    <p>All statistics were conducted with a generalized additive mixed
    modeling (GAMM) approach when possible. This allowed us to test for
    non-linear and linear trends in the dataset and specify the
    hierarchical nature of the data. All statistics were conducted in R
    and python. All scripts and packages used can be seen within the
    project code repository:
    <ext-link ext-link-type="uri" xlink:href="./path/to/repo">github
    repo</ext-link></p>
    <sec id="intake-targets-nb-article">
      <title>2.5.1 Intake Targets</title>
      <p>To determine intake targets, we constructed GAM (family:
      Multivariate Normal Distribution, Link: Identity) with the
      following variables when possible: diet pairing (factor), locust
      sex (factor), time period interval (integer), locust initial
      weight (numeric) following roughly the procedure found in Lawton
      et al.
      (<xref alt="2021" rid="ref-lawton_mismatched_2021-nb-article" ref-type="bibr">2021</xref>).
      We selected the inclusion of locust weight as either a non-linear
      or linear effect via Akaike information criterion (AIC), AIC
      adjusted for small sample size (AICc), and Bayesian information
      criterion (BIC). If weight was not an important variable, it was
      removed entirely from the model.</p>
    </sec>
    <sec id="field-population-nb-article">
      <title>2.5.2 Field population</title>
      <p>We calculated intake targets as discussed above. To see the
      impact of confined diet treatments, we constructed GAMs (family:
      gaussian, link: identity) with the following variables: treatment
      (factor), locust sex (factor), population (factor), and locust
      initial weight (numeric).</p>
    </sec>
    <sec id="field-cage-nb-article">
      <title>2.5.3 Field Cage</title>
      <p>We assessed plant nutrients with a GAMM (family: Multivariate
      Normal Distribution, link: identity) and included the following
      variables: plant carbohydrate (numeric, dependent), plant protein
      (numeric, dependent), treatment (factor, independent), cage
      (factor, random effect), plot (factor, random effect), and plant
      species (random effect). Redressing intake targets were conducted
      as discussed above (section 2.5.1). To see the difference between
      physiological performance and fertilizer treatments, we
      constructed GAMMs (family: Scaled T distribution, link: identity)
      for final locust mass. The independent variables in all models
      were treatment (factor), sex (factor), a two-dimensional smoother
      of available protein and carbohydrate, and cage number as a random
      effect. For both final adult proportion and survival proportion,
      we constructed a GAM (Family: Beta, Link: identity) and included
      the following variables: treatment (factor) and a two-dimensional
      smoother of available protein and carbohydrate.</p>
    </sec>
    <sec id="historical-outbreaks-and-soil-nutrient-grid-modeling-nb-article">
      <title>2.5.4 Historical outbreaks and soil nutrient grid
      modeling</title>
      <p>To relate nymph survey grids to soil nitrogen and phosphorus,
      we constructed two GAMMs (family: tweedie, link: log) predicting
      the number of outbreaks (APLC Survey Category 4) and nil
      observations (category 0). Since both soil nitrogen and mean
      annual precipitation are highly correlated (Pearson correlation =
      0.93) with both variables decreasing going into the arid interior
      of Australia, we are unable to add precipitation directly to the
      model as it would bias the results. Instead, we built a comparison
      model with mean annual precipitation between 2000 and 2017
      switched for soil nitrogen. To do this, we calculated the average
      precipitation between 2000 and 2017 for all survey grids using the
      European Centre for Medium-Range Weather Forecasts’ ERA5
      reanalysis dataset
      (<xref alt="Muñoz-Sabater et al., 2021" rid="ref-munoz-sabater_era5-land_2021-nb-article" ref-type="bibr">Muñoz-Sabater
      et al., 2021</xref>). This allowed us to visually compare the
      effect differences of soil nitrogen and mean annual precipitation
      on locust outbreaks. In other words, if soil nitrogen and mean
      annual precipitation were so tightly correlated that the effects
      are indistinguishable, the modeled results should look very
      similar. The soil models had the following independent variables:
      soil nitrogen, phosphorus, latitude / longitude, bioregion, and
      the number of observations within each grid. For the precipitation
      model, all variables were the same except mean annual
      precipitation replaced soil nitrogen and phosphorus. The inclusion
      of bioregions as a random effect allowed us to account for
      variation due to vegetation community and soil characteristics.
      The inclusion of latitude and longitude allowed us to account for
      spatial autocorrelation
      (<xref alt="Clayton et al., 1993" rid="ref-clayton_spatial_1993-nb-article" ref-type="bibr">Clayton
      et al., 1993</xref>). Lastly, the inclusion of the total number of
      observations allowed us to account for sampling intensity
      biases.</p>
    </sec>
  </sec>
</sec>
<sec id="results-nb-article">
  <title>3. RESULTS</title>
  <sec id="field-population-1-nb-article">
    <title>3.1 Field population</title>
    <sec id="choice-experiment-nutritional-target-nb-article">
      <title>3.1.1 Choice experiment (nutritional target)</title>
      <p>Australian plague locust individuals from the two outbreaking
      populations regulated to a specific ratio of 1 protein : 2
      carbohydrate
      (<xref alt="Figure 2" rid="fig-field-pop-it-results-nb-article">Figure 2</xref>
      A,<xref alt="Table 1" rid="tbl-field-population-it-model-nb-article">Table 1</xref>).
      Model selection can be seen in
      <xref alt="Table 8" rid="tbl-field-population-choice-experiment-model-selection-criteria-nb-article">Table 8</xref>.
      Consumption in the two diet pairings did not differ, indicating
      non-random feeding
      (<xref alt="Supplementary Figure 3" rid="suppfig-field-pop-nutrients-nb-article">Supplementary Figure 3</xref>
      A,
      <xref alt="Table 1" rid="tbl-field-population-it-model-nb-article">Table 1</xref>).
      While the protein : carbohydrate ratio did not change, females
      consumed more food than males, likely due to being bigger overall
      (<xref alt="Supplementary Figure 3" rid="suppfig-field-pop-nutrients-nb-article">Supplementary Figure 3</xref>
      B,
      <xref alt="Table 1" rid="tbl-field-population-it-model-nb-article">Table 1</xref>).</p>
      <sec specific-use="notebook-content">
      <code language="r script">library(tidyverse)</code>
      <boxed-text>
        <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</preformat>
      </boxed-text>
      <code language="r script">library(here)</code>
      <boxed-text>
        <preformat>here() starts at /Users/ddlawton/side_projects/herbivore_nutrient_interactions</preformat>
      </boxed-text>
      <code language="r script">library(gt)

table_dat &lt;- read_csv(here('output/publication_tables/field_cage_locust_nutrient_rebalancing_model_summary.csv'))</code>
      <boxed-text>
        <preformat>Rows: 16 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (2): macronutrient, variable
dbl (4): estimate, SE, p-value, statistic

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
      </boxed-text>
      <code language="r script">table_dat  |&gt;
  arrange(macronutrient) |&gt; 
  mutate(across(where(is.numeric),~round(.,3))) |&gt;
  mutate(macronutrient = ifelse(duplicated(macronutrient), &quot;&quot;, macronutrient),
    estimate = ifelse(duplicated(estimate), &quot;&quot;, estimate),
    statistic = ifelse(duplicated(statistic), &quot;&quot;, statistic)) |&gt; 
  select(macronutrient,variable,estimate,SE,statistic,`p-value`) |&gt;
  gt() |&gt;
  sub_missing(
    columns = everything(),
    missing_text = &quot;&quot;
  )</code>
      <fig id="tbl-field-population-it-model-nb-article">
        <caption><p>Table 1: Generalized additive model results for
        macronutrient consumption (carbohydrate and protein) of two
        outbreaking populations of Australian plague locust in Mendooran
        and Guntawang. Models were selected via AIC, AICc and BIC which
        can be seen in
        <xref alt="Table 8" rid="tbl-field-population-choice-experiment-model-selection-criteria-nb-article">Table 8</xref>.
        Family: multivariate gaussian distribution, link: identity, SE:
        standard error.</p></caption>
        <table-wrap>
          <table>
            <colgroup>
              <col width="100%" />
            </colgroup>
            <tbody>
              <tr>
                <td align="center"><p specific-use="wrapper">
                  <table-wrap>
                    <table>
                      <colgroup>
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                        <col width="17%" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th id="macronutrient-nb-article" scope="col">macronutrient</th>
                          <th id="variable-nb-article" scope="col">variable</th>
                          <th id="estimate-nb-article" scope="col">estimate</th>
                          <th id="SE-nb-article" scope="col">SE</th>
                          <th id="statistic-nb-article" scope="col">statistic</th>
                          <th id="p-value-nb-article" scope="col">p-value</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td headers="macronutrient">carbohydrate</td>
                          <td headers="variable">Intercept</td>
                          <td headers="estimate">0.013</td>
                          <td headers="SE">0.004</td>
                          <td headers="statistic"><break/></td>
                          <td headers="p-value">0.001</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">male</td>
                          <td headers="estimate">-0.011</td>
                          <td headers="SE">0.004</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.009</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 2</td>
                          <td headers="estimate">0.007</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.008</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 3-4</td>
                          <td headers="estimate">0.016</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 5-6</td>
                          <td headers="estimate">0.026</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 7-9</td>
                          <td headers="estimate">0.035</td>
                          <td headers="SE">0.003</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">none</td>
                          <td headers="estimate">-0.006</td>
                          <td headers="SE">0.004</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.136</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">s(id)</td>
                          <td headers="estimate"><break/></td>
                          <td headers="SE"><break/></td>
                          <td headers="statistic">484.706</td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient">protein</td>
                          <td headers="variable">Intercept</td>
                          <td headers="estimate">0.002</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.119</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">male</td>
                          <td headers="estimate">-0.004</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.009</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 2</td>
                          <td headers="estimate">0.001</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.724</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 3-4</td>
                          <td headers="estimate">0.003</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.023</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 5-6</td>
                          <td headers="estimate"></td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">day 7-9</td>
                          <td headers="estimate"></td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.000</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">none</td>
                          <td headers="estimate">-0.001</td>
                          <td headers="SE">0.001</td>
                          <td headers="statistic"></td>
                          <td headers="p-value">0.475</td>
                        </tr>
                        <tr>
                          <td headers="macronutrient"></td>
                          <td headers="variable">s(id)</td>
                          <td headers="estimate"></td>
                          <td headers="SE"><break/></td>
                          <td headers="statistic">110.728</td>
                          <td headers="p-value">0.381</td>
                        </tr>
                      </tbody>
                    </table>
                  </table-wrap>
                </p></td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </fig>
      </sec>
    </sec>
    <sec id="no-choice-experiment-performance-curves-nb-article">
      <title>3.1.2 No choice experiment (performance curves)</title>
      <p>Australian plague locusts had higher specific mass growth rates
      and shorter development times on the 1 protein : 2 carbohydrate
      (14 protein : 28 carbohydrate) diet as compared to the other diets
      (<xref alt="Figure 2" rid="fig-field-pop-it-results-nb-article">Figure 2</xref>
      B &amp; C,
      <xref alt="Table 2" rid="tbl-field-population-no-choice-model-nb-article">Table 2</xref>,
      <xref alt="Table 9" rid="tbl-field-population-no-choice-experiment-phys-post-hoc-nb-article">Table 9</xref>).
      Development time and specific growth rate did not different
      between male and female locusts
      (<xref alt="Supplementary Figure 3" rid="suppfig-field-pop-nutrients-nb-article">Supplementary Figure 3</xref>
      C &amp; D,
      <xref alt="Table 2" rid="tbl-field-population-no-choice-model-nb-article">Table 2</xref>).</p>
      <fig id="fig-field-pop-it-results-nb-article">
        <caption><p>Figure 2: The nutritional preference (A) and
        physiological performance (B &amp; C) of C. terminifera
        individuals were collected from two marching bands of 5th
        instars.</p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_population_intake_target_figure.png" />
      </fig>
      <sec specific-use="notebook-content">
      <code language="r script">library(tidyverse)
library(here)
library(gt)

table_dat &lt;- read_csv(here('output/publication_tables/field_population_no_choice_sgr_dev_result.csv'))</code>
      <boxed-text>
        <preformat>Rows: 11 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (2): variable, model
dbl (3): estimate, SE, p-value

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
      </boxed-text>
      <code language="r script">table_dat |&gt;
  mutate(variable = gsub('initial_weight_g','initial weight (g)',variable),
    across(where(is.numeric),~round(.,3))) |&gt;
  pivot_wider(names_from = model,values_from = c(estimate,SE,`p-value`)) |&gt;
  gt() |&gt;
  tab_spanner(
    label = &quot;Development Time&quot;,
    columns = ends_with('development time'))  |&gt;
  tab_spanner(
    label = &quot;Specific Growth Rate&quot;,
    columns = ends_with('specific growth rate')) |&gt;
  cols_label(
    starts_with(&quot;est&quot;) ~ &quot;estimate&quot;,
    starts_with(&quot;SE&quot;) ~ &quot;SE&quot;,
    starts_with(&quot;p-value&quot;) ~ &quot;p-value&quot;
  ) |&gt;
  sub_missing(
    columns = everything(),
    missing_text = &quot;&quot;
  )</code>
      <fig id="tbl-field-population-no-choice-model-nb-article">
        <caption><p>Table 2: Australian plague locust physiological
        performance (specific growth rate and development time) when
        constrained to specific diets with varying protein and
        carbohydrate content. SE: standard error. Posthoc comparisons
        for both physiological performance metrics can be seen in
        <xref alt="Table 9" rid="tbl-field-population-no-choice-experiment-phys-post-hoc-nb-article">Table 9</xref>.</p></caption>
        <table-wrap>
          <table>
            <colgroup>
              <col width="100%" />
            </colgroup>
            <tbody>
              <tr>
                <td align="center"><p specific-use="wrapper">
                  <table-wrap>
                    <table>
                      <colgroup>
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                        <col width="14%" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th rowspan="2" id="variable-nb-article" scope="col">variable</th>
                          <th colspan="3" id="SpecificU0020GrowthU0020Rate-nb-article" scope="colgroup"><named-content content-type="gt_column_spanner">Specific
                          Growth Rate</named-content></th>
                          <th colspan="3" id="DevelopmentU0020Time-nb-article" scope="colgroup"><named-content content-type="gt_column_spanner">Development
                          Time</named-content></th>
                        </tr>
                        <tr>
                          <th id="estimate-nb-article" scope="col">estimate</th>
                          <th id="SE-nb-article" scope="col">SE</th>
                          <th id="p-value-nb-article" scope="col">p-value</th>
                          <th id="estimate-nb-article" scope="col">estimate</th>
                          <th id="SE-nb-article" scope="col">SE</th>
                          <th id="p-value-nb-article" scope="col">p-value</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td headers="variable">Intercept</td>
                          <td headers="estimate_specific growth rate">0.061</td>
                          <td headers="SE_specific growth rate">0.004</td>
                          <td headers="p-value_specific growth rate">0.000</td>
                          <td headers="estimate_development time">15.780</td>
                          <td headers="SE_development time">1.555</td>
                          <td headers="p-value_development time">0.000</td>
                        </tr>
                        <tr>
                          <td headers="variable">21p:21c</td>
                          <td headers="estimate_specific growth rate">-0.011</td>
                          <td headers="SE_specific growth rate">0.005</td>
                          <td headers="p-value_specific growth rate">0.040</td>
                          <td headers="estimate_development time">0.917</td>
                          <td headers="SE_development time">0.624</td>
                          <td headers="p-value_development time">0.149</td>
                        </tr>
                        <tr>
                          <td headers="variable">35p:7c</td>
                          <td headers="estimate_specific growth rate">-0.010</td>
                          <td headers="SE_specific growth rate">0.006</td>
                          <td headers="p-value_specific growth rate">0.091</td>
                          <td headers="estimate_development time">1.709</td>
                          <td headers="SE_development time">0.665</td>
                          <td headers="p-value_development time">0.013</td>
                        </tr>
                        <tr>
                          <td headers="variable">7p:35c</td>
                          <td headers="estimate_specific growth rate">-0.026</td>
                          <td headers="SE_specific growth rate">0.005</td>
                          <td headers="p-value_specific growth rate">0.000</td>
                          <td headers="estimate_development time">2.716</td>
                          <td headers="SE_development time">0.603</td>
                          <td headers="p-value_development time">0.000</td>
                        </tr>
                        <tr>
                          <td headers="variable">male</td>
                          <td headers="estimate_specific growth rate">-0.003</td>
                          <td headers="SE_specific growth rate">0.004</td>
                          <td headers="p-value_specific growth rate">0.398</td>
                          <td headers="estimate_development time">-1.615</td>
                          <td headers="SE_development time">0.829</td>
                          <td headers="p-value_development time">0.057</td>
                        </tr>
                        <tr>
                          <td headers="variable">initial weight (g)</td>
                          <td headers="estimate_specific growth rate"><break/></td>
                          <td headers="SE_specific growth rate"><break/></td>
                          <td headers="p-value_specific growth rate"><break/></td>
                          <td headers="estimate_development time">-21.048</td>
                          <td headers="SE_development time">10.407</td>
                          <td headers="p-value_development time">0.049</td>
                        </tr>
                      </tbody>
                    </table>
                  </table-wrap>
                </p></td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </fig>
      </sec>
    </sec>
  </sec>
  <sec id="field-cage-1-nb-article">
    <title>3.2 Field Cage</title>
    <p>For the first 11 days of the 14 day field cage experiment, plant
    protein and carbohydrate contents remained consistently
    protein-biased for all treatments
    (<xref alt="Figure 3" rid="fig-field-cage-time-results-nb-article">Figure 3</xref>
    A-C,
    <xref alt="Table 3" rid="tbl-field-cage-plant-nutrients-nb-article">Table 3</xref>),
    and only showed differences in protein content by the last sample
    period on December 1, which was after the end of the locust cage
    experiment. Accordingly, there was no effect of fertilizer on locust
    survival and adult proportion, though locusts in the medium level
    nitrogen fertilizer treatment were heavier than locusts in the high
    nitrogen fertilizer treatment (TukeyHSD: difference: -0.043,
    p-value: &lt; 0.001)
    ((<xref alt="Figure 3" rid="fig-field-cage-time-results-nb-article">Figure 3</xref>
    D-F,
    <xref alt="Table 4" rid="tbl-field-cage-locust-mass-nb-article">Table 4</xref>).
    Locusts that were retrieved from field cages after nine days and
    were given a choice to regulate protein and carbohydrate intake
    showed a pattern consistent with rebalancing a shortage of
    carbohydrates
    (<xref alt="Figure 4" rid="fig-field-cage-it-rebalancing-nb-article">Figure 4</xref>,
    <xref alt="Table 5" rid="tbl-field-cage-rebalancing-nb-article">Table 5</xref>,
    <xref alt="Supplementary Figure 4" rid="suppfig-field-cage-rebalancing-facet-nb-article">Supplementary Figure 4</xref>).
    Irrespective of fertilizer treatment group, locusts initially
    selected very carbohydrate biased diets, but gradually, after 9
    days, their trajectory returned close to the predicted intake target
    of 1p : 2c
    (<xref alt="Figure 4" rid="fig-field-cage-it-rebalancing-nb-article">Figure 4</xref>,
    <xref alt="Supplementary Figure 4" rid="suppfig-field-cage-rebalancing-facet-nb-article">Supplementary Figure 4</xref>).</p>
    <fig id="fig-field-cage-time-results-nb-article">
      <caption><p>Figure 3: Nitrogen addition field cage experiments
      with plant nutrient change through time (A-C) and grasshopper
      performance metrics (D-F) are shown. Dashed line represents a 1p :
      2c ratio, the solid line represents a 1p : 1c ratio.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_plant_locust_figure.png" />
    </fig>
    <fig id="fig-field-cage-it-rebalancing-nb-article">
      <caption><p>Figure 4: Nutrient imbalance redressing with
      artificial diet mixing of C. terminifera individuals taken from
      fertilized treatment cages. Colors represent treatment with large
      lines and points representing overall means. Individual time step
      targets can be seen in
      <xref alt="Supplementary Figure 4" rid="suppfig-field-cage-rebalancing-facet-nb-article">Supplementary Figure 4</xref>.</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_locust_intake_target_rebalancing.png" />
    </fig>
    <sec specific-use="notebook-content">
    <code language="r script">library(tidyverse)
library(here)
library(gt)

table_dat &lt;- read_csv(here('output/publication_tables/field_cage_plant_nutrients_model_summary.csv'))</code>
    <boxed-text>
      <preformat>Rows: 24 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (2): variable, macronutrient
dbl (5): estimate, SE, p-value, EDF, statistic

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
    </boxed-text>
    <code language="r script">table_dat  |&gt;
  arrange(macronutrient) |&gt; 
  mutate(across(where(is.numeric),~round(.,3))) |&gt;
  mutate(macronutrient = ifelse(duplicated(macronutrient), &quot;&quot;, macronutrient)) |&gt; 
  select(macronutrient,variable,estimate,SE,statistic,`p-value`) |&gt;
  gt() |&gt;
  sub_missing(
    columns = everything(),
    missing_text = &quot;&quot;
  )</code>
    <fig id="tbl-field-cage-plant-nutrients-nb-article">
      <caption><p>Table 3: Generalized additive model results for plant
      macronutrient (carbohydrate and protein) differences between
      fertilization treatment. Family: multivariate gaussian
      distribution, link: identity, SE: standard error, significance
      indicated in bold.</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="100%" />
          </colgroup>
          <tbody>
            <tr>
              <td align="center"><p specific-use="wrapper">
                <table-wrap>
                  <table>
                    <colgroup>
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                    </colgroup>
                    <thead>
                      <tr>
                        <th id="macronutrient-nb-article" scope="col">macronutrient</th>
                        <th id="variable-nb-article" scope="col">variable</th>
                        <th id="estimate-nb-article" scope="col">estimate</th>
                        <th id="SE-nb-article" scope="col">SE</th>
                        <th id="statistic-nb-article" scope="col">statistic</th>
                        <th id="p-value-nb-article" scope="col">p-value</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td headers="macronutrient">carbohydrate</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.127</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium</td>
                        <td headers="estimate">-0.020</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.005</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High</td>
                        <td headers="estimate">-0.011</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.121</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-11-25</td>
                        <td headers="estimate">-0.009</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.181</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-12-01</td>
                        <td headers="estimate">-0.012</td>
                        <td headers="SE">0.006</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.033</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-11-25</td>
                        <td headers="estimate">0.019</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.063</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-11-25</td>
                        <td headers="estimate">0.004</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.656</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-12-01</td>
                        <td headers="estimate">0.019</td>
                        <td headers="SE">0.008</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.017</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-12-01</td>
                        <td headers="estimate">0.010</td>
                        <td headers="SE">0.008</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.222</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(species)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">67.305</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(plot)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">1.643</td>
                        <td headers="p-value">0.207</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(cage)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">3.442</td>
                        <td headers="p-value">0.130</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient">protein</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.209</td>
                        <td headers="SE">0.017</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium</td>
                        <td headers="estimate">-0.001</td>
                        <td headers="SE">0.014</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.928</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High</td>
                        <td headers="estimate">-0.034</td>
                        <td headers="SE">0.014</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.014</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-11-25</td>
                        <td headers="estimate">0.026</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.014</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">2015-12-01</td>
                        <td headers="estimate">-0.049</td>
                        <td headers="SE">0.009</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-11-25</td>
                        <td headers="estimate">-0.012</td>
                        <td headers="SE">0.015</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.422</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-11-25</td>
                        <td headers="estimate">-0.023</td>
                        <td headers="SE">0.015</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.123</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">Medium:2015-12-01</td>
                        <td headers="estimate">0.008</td>
                        <td headers="SE">0.013</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.516</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">High:2015-12-01</td>
                        <td headers="estimate">0.056</td>
                        <td headers="SE">0.013</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(species)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">307.929</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(plot)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">214.489</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(cage)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">89.944</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                    </tbody>
                  </table>
                </table-wrap>
              </p></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    </sec>
    <sec specific-use="notebook-content">
    <code language="r script">library(tidyverse)
library(here)
library(knitr)
library(kableExtra)</code>
    <boxed-text>
      <preformat>
Attaching package: 'kableExtra'</preformat>
    </boxed-text>
    <boxed-text>
      <preformat>The following object is masked from 'package:dplyr':

    group_rows</preformat>
    </boxed-text>
    <code language="r script">table_dat &lt;- read_csv(here('output/publication_tables/field_cage_final_locust_mass_model_summary.csv'))</code>
    <boxed-text>
      <preformat>Rows: 6 Columns: 6</preformat>
    </boxed-text>
    <boxed-text>
      <preformat>── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (1): variable
dbl (5): estimate, SE, p-value, EDF, statistic

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
    </boxed-text>
    <code language="r script">table_dat  |&gt;
  mutate(across(where(is.numeric),~round(.,3))) |&gt;
  select(variable,estimate,SE,statistic,`p-value`) |&gt;
  gt() |&gt;
  sub_missing(
    columns = everything(),
    missing_text = &quot;&quot;
  )</code>
    <fig id="tbl-field-cage-locust-mass-nb-article">
      <caption><p>Table 4: Generalized additive model results for
      differences between final locust mass after the nitrogen
      fertilization experiment finished. Family: scaled T, link:
      identity, SE: standard error.</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="100%" />
          </colgroup>
          <tbody>
            <tr>
              <td align="center"><p specific-use="wrapper">
                <table-wrap>
                  <table>
                    <colgroup>
                      <col width="20%" />
                      <col width="20%" />
                      <col width="20%" />
                      <col width="20%" />
                      <col width="20%" />
                    </colgroup>
                    <thead>
                      <tr>
                        <th id="variable-nb-article" scope="col">variable</th>
                        <th id="estimate-nb-article" scope="col">estimate</th>
                        <th id="SE-nb-article" scope="col">SE</th>
                        <th id="statistic-nb-article" scope="col">statistic</th>
                        <th id="p-value-nb-article" scope="col">p-value</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.326</td>
                        <td headers="SE">0.007</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="variable">male</td>
                        <td headers="estimate">-0.148</td>
                        <td headers="SE">0.006</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="variable">medium</td>
                        <td headers="estimate">0.015</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.117</td>
                      </tr>
                      <tr>
                        <td headers="variable">high</td>
                        <td headers="estimate">-0.011</td>
                        <td headers="SE">0.010</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.273</td>
                      </tr>
                      <tr>
                        <td headers="variable">s(carb_mg_mg,protein_mg_mg)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">0.002</td>
                        <td headers="p-value">0.416</td>
                      </tr>
                      <tr>
                        <td headers="variable">s(cage_num)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">42.160</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                    </tbody>
                  </table>
                </table-wrap>
              </p></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    </sec>
    <sec specific-use="notebook-content">
    <code language="r script">library(tidyverse)
library(here)
library(gt)

table_dat &lt;- read_csv(here('output/publication_tables/field_cage_locust_nutrient_rebalancing_model_summary.csv'))</code>
    <boxed-text>
      <preformat>Rows: 16 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (2): macronutrient, variable
dbl (4): estimate, SE, p-value, statistic

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
    </boxed-text>
    <code language="r script">table_dat  |&gt;
  arrange(macronutrient) |&gt; 
  mutate(across(where(is.numeric),~round(.,3))) |&gt;
  mutate(macronutrient = ifelse(duplicated(macronutrient), &quot;&quot;, macronutrient)) |&gt; 
  select(macronutrient,variable,estimate,SE,statistic,`p-value`) |&gt;
  gt() |&gt;
  sub_missing(
    columns = everything(),
    missing_text = &quot;&quot;
  )</code>
    <fig id="tbl-field-cage-rebalancing-nb-article">
      <caption><p>Table 5: Generalized additive model results for
      nutrient imbalance dressing of field cage Australian plague locust
      in the control and high fertilization treatments. Model also
      included interactive terms; however, none were significant and
      left out. SE: standard error</p></caption>
      <table-wrap>
        <table>
          <colgroup>
            <col width="100%" />
          </colgroup>
          <tbody>
            <tr>
              <td align="center"><p specific-use="wrapper">
                <table-wrap>
                  <table>
                    <colgroup>
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                      <col width="17%" />
                    </colgroup>
                    <thead>
                      <tr>
                        <th id="macronutrient-nb-article" scope="col">macronutrient</th>
                        <th id="variable-nb-article" scope="col">variable</th>
                        <th id="estimate-nb-article" scope="col">estimate</th>
                        <th id="SE-nb-article" scope="col">SE</th>
                        <th id="statistic-nb-article" scope="col">statistic</th>
                        <th id="p-value-nb-article" scope="col">p-value</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td headers="macronutrient">carbohydrate</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.013</td>
                        <td headers="SE">0.004</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.001</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">male</td>
                        <td headers="estimate">-0.011</td>
                        <td headers="SE">0.004</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.009</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 2</td>
                        <td headers="estimate">0.007</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.008</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 3-4</td>
                        <td headers="estimate">0.016</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 5-6</td>
                        <td headers="estimate">0.026</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 7-9</td>
                        <td headers="estimate">0.035</td>
                        <td headers="SE">0.003</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">none</td>
                        <td headers="estimate">-0.006</td>
                        <td headers="SE">0.004</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.136</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(id)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">484.706</td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient">protein</td>
                        <td headers="variable">Intercept</td>
                        <td headers="estimate">0.002</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.119</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">male</td>
                        <td headers="estimate">-0.004</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.009</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 2</td>
                        <td headers="estimate">0.001</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.724</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 3-4</td>
                        <td headers="estimate">0.003</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.023</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 5-6</td>
                        <td headers="estimate">0.007</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">day 7-9</td>
                        <td headers="estimate">0.013</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.000</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">none</td>
                        <td headers="estimate">-0.001</td>
                        <td headers="SE">0.001</td>
                        <td headers="statistic"><break/></td>
                        <td headers="p-value">0.475</td>
                      </tr>
                      <tr>
                        <td headers="macronutrient"></td>
                        <td headers="variable">s(id)</td>
                        <td headers="estimate"><break/></td>
                        <td headers="SE"><break/></td>
                        <td headers="statistic">110.728</td>
                        <td headers="p-value">0.381</td>
                      </tr>
                    </tbody>
                  </table>
                </table-wrap>
              </p></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </fig>
    </sec>
  </sec>
  <sec id="locust-outbreaks-nb-article">
    <title>3.3 Locust outbreaks</title>
    <p>Australian plague locust outbreaks were negatively associated
    with soil nitrogen, which supports the hypothesis that nitrogen (in
    excess) acts as a limiting factor for population upsurges (Table 6,
    Fig. 5A). Australian plague locusts had a nonlinear relationship
    with soil phosphorus with outbreaks occurring more often in areas
    with approximately 4% soil phosphorus and were strongly negatively
    associated with increasing phosphorus afterwards (Fig. 5B). For both
    nutrients, the absence models had a very weak relationship with soil
    nutrient in comparison to the outbreak models, demonstrating little
    model bias due to APLC survey protocol. There were significant
    nonlinear relationships between coordinates and the total number of
    observations in all models (Supplementary Figs. 5 &amp; 6). The
    relationship between locust outbreaks and mean annual precipitation
    (e.g. nonlinear) was very different from the relationship with soil
    nitrogen (e.g. linear; Fig. 5, Supplementary Fig. 7). Soil nitrogen
    and phosphorus show weak positive correlations with woody vegetation
    cover, while mean annual precipitation exhibits high variation in
    its relationship with soil nitrogen and weak correlation with soil
    phosphorus (Supplementary Figure 8). Thus, the relationship between
    soil nitrogen and locust outbreaks cannot be fully explained by
    differences in woody vegetation.</p>
  </sec>
</sec>
<sec id="discussion-nb-article">
  <title>4. DISCUSSION</title>
  <p>We show that herbivore diet preferences remain consistent between
  spatial levels, from individual foraging behavior and physiology to
  large scale population dynamics, with locust populations negatively
  related to environmental nitrogen. Thus by going across scales, this
  study shows a consistent pattern of excess nitrogen limiting a pest
  herbivore and introduces a more nuanced view of phosphorus limitation
  on herbivore populations. Instead of the broad generalization that
  animals are always negatively or positively associated with certain
  nutrients, specific life history traits, such as energetically-costly
  migration, as well as organism-environment interactions should be
  considered. For forecasting pest populations dynamics, adding
  variables describing the nutritional quality of landscapes can inform
  seasonal scouting surveys. We hope that this study spurs future
  interest in multi-scale experiments and modeling of nutrient
  availability with animal population dynamics.</p>
  <sec id="field-populations-nb-article">
    <title>4.1 Field populations</title>
    <p>Field populations of final instar Australian plague locusts
    behaviorally regulated to a 1 protein (p) : 2 carbohydrate (c)
    nutrient ratio, which supported the fastest nymphal growth and the
    lowest development time to adulthood (Fig. 2B &amp; C), consistent
    with previous studies
    (<xref alt="Clissold et al., 2014" rid="ref-clissold_regulation_2014-nb-article" ref-type="bibr">Clissold
    et al., 2014</xref>;
    <xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021-nb-article" ref-type="bibr">Lawton
    et al., 2021</xref>). Locusts are highly mobile (Australian plague
    locusts can fly up to 500 km in a single night,
    (<xref alt="Deveson &amp; Walker, 2005" rid="ref-deveson_not_2005-nb-article" ref-type="bibr">Deveson
    &amp; Walker, 2005</xref>)) and the demand for energy via
    carbohydrates and lipids likely increases relative to protein demand
    during the later life stages of these animals.</p>
    <p>Plant nutrient content in the nitrogen fertilization treatments
    was not significantly different until the last sample period, which
    likely explains the small effect on locust growth (Fig. 3A-C). Over
    the experimental period, protein content decreased in unfertilized
    treatments while both plant protein and carbohydrate remained
    constant in the fertilized treatments. If we prolonged the
    experiment, there might have been a noticeable difference in locust
    survivorship, weight gain, and adult proportion given the shift in
    nutrients among treatments (Fig. 3D-F).</p>
    <p>Importantly, all field cage plants were protein biased (roughly
    1p : 1c to 2p : 1c ) as compared to the desired locust intake target
    of 1p : 2c. When locusts were subsampled from the field cages
    mid-experiment and given the opportunity to select carbohydrate or
    protein diets, they selected extremely carbohydrate-biased diets for
    more than a week. This behavior indicated that locusts in the small
    field cages were highly carbohydrate-limited, driving them to
    overeat carbohydrates to redress the imbalance. Interestingly,
    multiple studies have shown that the Australian nutritional
    landscape is often too protein-biased relative to what the
    Australian plague locust prefers
    (<xref alt="Lawton et al., 2020" rid="ref-lawton_woody_2020-nb-article" ref-type="bibr">Lawton
    et al., 2020</xref>,
    <xref alt="2021" rid="ref-lawton_mismatched_2021-nb-article" ref-type="bibr">2021</xref>).
    Regardless, populations are still persistent and outbreaks can occur
    at lower frequencies in these areas
    (<xref alt="Deveson, 2013" rid="ref-deveson_satellite_2013-nb-article" ref-type="bibr">Deveson,
    2013</xref>;
    <xref alt="Key, 1945" rid="ref-key_general_1945-nb-article" ref-type="bibr">Key,
    1945</xref>). How this species can achieve the optimal balance of
    nutrients within an unfavorable nutritional environment merits
    further investigation, but may include postingestive regulation
    and/or large-range foraging. Migratory locusts (Locusta migratoria)
    can choose microclimates that favor higher efficiency of
    carbohydrate or protein absorption depending on their host plant and
    nutritional status
    (<xref alt="Clissold et al., 2013" rid="ref-clissold_insect_2013-nb-article" ref-type="bibr">Clissold
    et al., 2013</xref>). For this study, we collected free-living
    locusts from the same region and a similar environment as where we
    built the field cages, yet those confined to field cages selected a
    10 x decrease in p:c (1p : 20c vs 1p : 2c). This result suggests
    that free-living locusts are able to persist in high protein regions
    by foraging over a larger range to seek out pockets of
    carbohydrate-rich plants and that the limited foraging range of the
    field cages precluded field-cage locusts from finding sufficient
    carbohydrates. Similarly, these results suggest that, while
    Australian plague locusts can persist in low numbers in nitrogen
    rich regions, those environments are unlikely to support extreme
    outbreaks due to a limitation of carbohydrate-rich resources. We
    tested this prediction using historical outbreak and large-scale
    soil nutrient modeling.</p>
  </sec>
  <sec id="historical-outbreak-modeling-nb-article">
    <title>4.2 Historical outbreak modeling</title>
    <p>This is the first time to our knowledge that terrestrial animal
    population dynamics have been modeled with nutrients at the
    continental level, allowing nutrient limitation to be tested at a
    scale not previously investigated. Locust outbreaks are associated
    with decreasing soil nitrogen (Fig. 5A), suggesting that nitrogen
    acts as a limiting factor not due to its deficit
    (<xref alt="White, 1993" rid="ref-white_inadequate_1993-nb-article" ref-type="bibr">White,
    1993</xref>) but its excess. Plants growing in high nitrogen
    environments tend to have high p:c ratios, which force locusts to
    either undereat carbohydrates (limiting their energy to support
    growth and migration) or overeat protein (which can be toxic) to
    acquire sufficient carbohydrates
    (<xref alt="Behmer, 2009" rid="ref-behmer_insect_2009-nb-article" ref-type="bibr">Behmer,
    2009</xref>;
    <xref alt="Cease, 2024" rid="ref-cease_how_2024-nb-article" ref-type="bibr">Cease,
    2024</xref>). On the other end of the performance curve, Australian
    plague locusts do have a lower p:c range that limits performance, as
    shown using artificial diets (Fig. 2B-C). However, our outbreak
    models found no lower limit (Fig 5A), suggesting that locusts do not
    often encounter environments where protein deficit limits their
    growth. This result is consistent with other research that found
    most grasses across New South Wales tend to have higher p:c ratios
    than locusts require
    (<xref alt="Lawton et al., 2021" rid="ref-lawton_mismatched_2021-nb-article" ref-type="bibr">Lawton
    et al., 2021</xref>). Even when locusts have access to low p:c
    plants it is more difficult for them to extract carbohydrate than
    protein
    (<xref alt="Clissold et al., 2006" rid="ref-clissold_paradoxical_2006-nb-article" ref-type="bibr">Clissold
    et al., 2006</xref>), further exacerbating the problem of relative
    protein excess. Interestingly, this relationship between nitrogen
    and locusts stays consistent throughout multiple spatial levels
    which suggests that it scales linearly; an uncommon characteristic
    in ecology
    (<xref alt="Levin, 1992" rid="ref-levin_problem_1992-nb-article" ref-type="bibr">Levin,
    1992</xref>;
    <xref alt="Wiens, 1989" rid="ref-wiens_spatial_1989-nb-article" ref-type="bibr">Wiens,
    1989</xref>). We also show that outbreaks are correlated with a low
    level of soil phosphorus, however, outbreaks peak at approximately
    4%, suggesting that while locusts generally do well in low
    phosphorus environments, phosphorus deficit can be limiting for
    locusts in extremely phosphorus poor soils (Fig. 5B). Because
    Australian soils are characteristically phosphorus poor
    (<xref alt="Donald, 1964" rid="ref-donald_colin_phosphorus_1964-nb-article" ref-type="bibr">Donald,
    1964</xref>), Australian animals like this locust are adapted to
    phosphorus poor environments and potentially having too much
    phosphorus is deleterious
    (<xref alt="Morton et al., 2011" rid="ref-morton_fresh_2011-nb-article" ref-type="bibr">Morton
    et al., 2011</xref>). Locust populations may be more tightly
    correlated with soil nitrogen than phosphorus because terrestrial
    herbivores require 5-50 times more nitrogen than phosphorus
    (<xref alt="Elser et al., 2000" rid="ref-elser_nutritional_2000-nb-article" ref-type="bibr">Elser
    et al., 2000</xref>), meaning they can more readily balance
    phosphorus by eating a few foods rich or poor in phosphorus but
    cannot as quickly regulate protein and carbohydrate energy because
    they make up the bulk of their required nutrients. Indeed,
    laboratory studies have revealed that short-term limitations in
    dietary phosphorus have no apparent impact on grasshopper growth
    (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016-nb-article" ref-type="bibr">Cease
    et al., 2016</xref>), suggesting that these mobile herbivores could
    seek out phosphorus-rich diets intermittently to overcome potential
    phosphorus limitation in field environments. However, in this study,
    we only tested this relationship with phosphorus at the continental
    level; further field and laboratory experiments are needed to
    explore this non-linear relationship between locust outbreaks and
    soil phosphorus. While we only looked at nitrogen and phosphorus, it
    is also important to note that animals require a suite of nutrients.
    Other nutrients such as potassium and sodium
    (<xref alt="Joern et al., 2012" rid="ref-joern_not_2012-nb-article" ref-type="bibr">Joern
    et al., 2012</xref>) warrant further investigation. Comparing locust
    outbreaks between continents would further show the relationship
    between nutrient availability and animal population dynamics. One
    excellent dataset for this would be SoilGrids
    (https://www.isric.org/explore/soilgrids) which provides soil
    nitrogen estimates globally at a 250-meter resolution.</p>
    <p>Lastly, our results suggest that forecasting efforts for locusts
    should consider the inclusion of a nutritional landscape quality
    metric like soil nitrogen. Current forecasting models use climatic
    data (e.g. rainfall and soil moisture) or vegetation growth data
    (e.g. normalized difference vegetation index, NDVI) as the major
    predictors of outbreaks
    (<xref alt="Cressman, 2013" rid="ref-cressman_role_2013-nb-article" ref-type="bibr">Cressman,
    2013</xref>). While these climatic variables are clearly important,
    adding metrics to quantify the nutritional landscape can help
    increase forecasting model accuracy in environments with highly
    variable climates.</p>
  </sec>
  <sec id="locusts-are-more-likely-to-be-limited-by-high-nitrogen-environments-than-other-grasshoppers-nb-article">
    <title>4.3 Locusts are more likely to be limited by high nitrogen
    environments than other grasshoppers</title>
    <p>A five-decade review of grasshopper responses to plant nitrogen
    content showed that grasshoppers not classified as locusts have a
    variation of negative, neutral, and positive responses to increasing
    plant nitrogen
    (<xref alt="Cease, 2024" rid="ref-cease_how_2024-nb-article" ref-type="bibr">Cease,
    2024</xref>). Looking just at field surveys, there are more reports
    of a negative correlation between plant nitrogen and non-locust
    grasshopper abundance (17 reports) relative to neutral (6 reports)
    or positive (9 reports). This pattern corroborates long-term studies
    showing that dilution of plant nitrogen is correlated with declines
    of North American grasshopper populations
    (<xref alt="Welti, Roeder, et al., 2020" rid="ref-welti_nutrient_2020-nb-article" ref-type="bibr">Welti,
    Roeder, et al., 2020</xref>). Of the studies that report
    correlations between individual grasshopper species abundance and
    plant nitrogen, most are from graminivorous (grass-feeding) species
    (11 reports), with 7 reports from mixed (grasses and forbs) or forb
    feeders
    (<xref alt="Cease, 2024" rid="ref-cease_how_2024-nb-article" ref-type="bibr">Cease,
    2024</xref>). The abundance of non-locust graminivorous species
    tended to be more positively correlated with plant nitrogen, which
    would support the hypothesis that grass-feeders are more likely to
    be nitrogen-limited because grasses tend to have lower p:c ratios
    than forbs; although this trend was not significant and
    grass-feeders also regularly showed negative responses to high plant
    nitrogen. In contrast, there was a consistent negative effect of
    high plant nitrogen on locust species, regardless of whether they
    were graminivorous or mixed feeders. Because mass specific protein
    consumption is highly correlated with growth rate in both lab and
    field populations, but carbohydrate consumption is highly influenced
    by the environment
    (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023-nb-article" ref-type="bibr">Talal
    et al., 2023</xref>), it is most likely that locusts have similar
    protein requirements as other non-locust grasshopper species, but
    have much higher carbohydrate demands, potentially to support
    migration
    (<xref alt="Raubenheimer &amp; Simpson, 1997" rid="ref-raubenheimer_integrative_1997-nb-article" ref-type="bibr">Raubenheimer
    &amp; Simpson, 1997</xref>;
    <xref alt="Talal et al., 2021" rid="ref-talal_high_2021-nb-article" ref-type="bibr">Talal
    et al., 2021</xref>,
    <xref alt="2023" rid="ref-talal_body_2023-nb-article" ref-type="bibr">2023</xref>).
    Locusts are able to meet this increased demand for carbohydrate,
    while keeping protein consumption constant, by eating larger amounts
    of low p:c plants found in low nitrogen environments. In summary,
    these studies suggest that nymphal outbreaks of all locust species
    may be negatively correlated with soil nitrogen across continental
    scales, but that the correlation between plant nitrogen and
    non-locust grasshoppers may not be significant or consistent through
    space and time.</p>
  </sec>
  <sec id="comparing-the-relationship-between-plant-macronutrients-and-herbivore-abundance-in-other-taxa-nb-article">
    <title>4.4 Comparing the relationship between plant macronutrients
    and herbivore abundance in other taxa</title>
    <p>The effect of plant protein and carbohydrate on herbivore
    populations is predicted to depend on the herbivore’s p:c intake
    target (IT) relative to its nutritional landscape (Le Gall et al.,
    2020). If there are sufficient plants on either side of the IT,
    herbivores can select from between them to achieve their IT. This
    complementary feeding has been recorded for field populations of
    blue sheep (<italic>Psuedois nayaur</italic>) in the Himalayan
    Mountains
    (<xref alt="Aryal et al., 2015" rid="ref-aryal_foods_2015-nb-article" ref-type="bibr">Aryal
    et al., 2015</xref>), Black Howler Monkeys (<italic>Alouatta
    pigra</italic>) in Yucatán (Bridgeman, 2012), and other primates
    (<xref alt="Raubenheimer &amp; Rothman, 2013" rid="ref-raubenheimer_nutritional_2013-nb-article" ref-type="bibr">Raubenheimer
    &amp; Rothman, 2013</xref>). There would be a predicted impact on
    populations if the nutritional landscape were to become more
    constricted or not overlap with the IT. For example, lab colonies of
    tobacco hornworms (Manduca sexta larvae) have an IT around 1:1 or
    sometimes slightly carbohydrate-biased
    (<xref alt="Wilson, Ruiz, &amp; Davidowitz, 2019" rid="ref-wilson_dietary_2019-nb-article" ref-type="bibr">Wilson,
    Ruiz, &amp; Davidowitz, 2019</xref>) and their host plants tend to
    be carbohydrate-biased relative to their IT Wilson, Ruiz, Duarte, et
    al.
    (<xref alt="2019" rid="ref-wilson_nutritional_2019-nb-article" ref-type="bibr">2019</xref>)].
    However, this does not seem to translate to population level
    effects, potentially due to secondary metabolites affecting growth
    more strongly than macronutrient balance and/or larvae may be able
    to compensate by overeating carbohydrates to acquire sufficient
    protein
    (<xref alt="Wilson, Ruiz, &amp; Davidowitz, 2019" rid="ref-wilson_dietary_2019-nb-article" ref-type="bibr">Wilson,
    Ruiz, &amp; Davidowitz, 2019</xref>). Overeating carbohydrates is
    not as detrimental as overeating protein, at least in the short
    term, and animals tend to be willing to overeat carbohydrates to a
    greater extent than protein
    (<xref alt="Cheng et al., 2008" rid="ref-cheng_geometry_2008-nb-article" ref-type="bibr">Cheng
    et al., 2008</xref>;
    <xref alt="Simpson &amp; Raubenheimer, 2012b" rid="ref-simpson_nature_2012-nb-article" ref-type="bibr">Simpson
    &amp; Raubenheimer, 2012b</xref>). Therefore, herbivores facing a
    nutritional landscape with a p:c generally lower than their IT
    (i.e., carbohydrate excess) may not be as negatively impacted as
    herbivores facing one higher than their IT (i.e., protein excess).
    However, there are several examples of higher localized densities of
    herbivores in response to higher plant nitrogen and protein contents
    with thrips
    (<xref alt="Brown et al., 2002" rid="ref-brown_relationship_2002-nb-article" ref-type="bibr">Brown
    et al., 2002</xref>) and spruce budworm (Choristoneura)
    (<xref alt="De Grandpré et al., 2022" rid="ref-de_grandpre_defoliation-induced_2022-nb-article" ref-type="bibr">De
    Grandpré et al., 2022</xref>) being two examples. These examples
    suggest that low p:c diets limit population growth of some
    herbivores, but more studies are needed to determine if this
    relationship is only localized or if it scales up. It may be that
    herbivore populations with lower numbers are not limited by a
    nutritional landscape at a large scale because they can
    differentially disperse locally among optimal patches, whereas
    herbivore populations with extreme numbers (i.e., irruptions) may be
    more limited by nutritionally unfavorable environments across
    scales.</p>
    <p>There is evidence for phosphorus limitation in some species, but
    limited research showing a detrimental effect of excess phosphorus
    (<xref alt="Cease et al., 2016" rid="ref-cease_dietary_2016-nb-article" ref-type="bibr">Cease
    et al., 2016</xref>). In aquatic insects such as
    <italic>Daphnia</italic> species, there is a strong positive
    association with phosphorus available and population dynamics
    (Andersen et al., 2004). However this trend is not seen in field
    cricket populations (<italic>Gryllus veletis</italic>)
    (<xref alt="Harrison et al., 2014" rid="ref-harrison_synthesis_2014-nb-article" ref-type="bibr">Harrison
    et al., 2014</xref>) and other terrestrial insects. Loaiza et al.
    (<xref alt="2011" rid="ref-loaiza2011-nb-article" ref-type="bibr">2011</xref>)
    found no effect of phosphorus fertilization (but a positive effect
    of N fertilization) on Kansas tallgrass prairie grasshopper
    population distributions, whereas Joern et al.
    (<xref alt="2012" rid="ref-joern_not_2012-nb-article" ref-type="bibr">2012</xref>)
    found consistent positive correlations between plant phosphorus and
    Nebraskan grassland grasshopper populations.</p>
    <p>Making predictions about a population’s nutritional demands can
    aid in making predictions about the relationship between nutritional
    landscapes and population dynamics. Across taxa, including fish,
    chickens, rats, cats, caribou, pigs, and dairy cattle, mass specific
    protein consumption is highly correlated with growth rate and
    decreases with age and body size
    (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023-nb-article" ref-type="bibr">Talal
    et al., 2023</xref>). In contrast, energy demand (carbohydrates and
    lipids) does not show a clear relationship with growth rate and
    instead is more affected by environment and activity
    (<xref alt="Talal et al., 2023" rid="ref-talal_body_2023-nb-article" ref-type="bibr">Talal
    et al., 2023</xref>). Therefore, an animal’s IT is predicted to be
    affected by the contrasting effects of growth (increases dietary
    p:c) and activity or stress (increases carbohydrate demand and
    therefore decreases dietary p:c), although other physiological and
    environmental factors affect p:c demand as well (see Table 1 in
    Cease
    (<xref alt="2024" rid="ref-cease_how_2024-nb-article" ref-type="bibr">2024</xref>)).
    For example, monarch butterflies have been gradually increasing
    their already-high daily energy expenditure during migration due to
    warmer temperatures caused by climate change
    (<xref alt="Parlin et al., 2023" rid="ref-parlin_cost_2023-nb-article" ref-type="bibr">Parlin
    et al., 2023</xref>). Young and fast growing herbivores with low
    activity levels would be predicted to have a high p:c IT, whereas
    older juveniles and adults (slower mass specific growth) with high
    activity levels would be predicted to have a low p:c IT. Comparative
    studies with herbivores grouped functionally, such as other highly
    migratory animals (e.g. across insects, birds, mammals, and fish),
    or by growth rate or developmental stage, would likely provide
    interesting parallels that would assist in disentangling the
    complexities of plant macronutrient-herbivore relationships.</p>
  </sec>
  <sec id="synthesis-and-application-nb-article">
    <title>4.5 Synthesis and Application</title>
    <p>Acquiring the right amount of nutrients is a critical component
    for animal growth, reproduction, and population dynamics
    (<xref alt="Doonan &amp; Slade, 1995" rid="ref-doonan_effects_1995-nb-article" ref-type="bibr">Doonan
    &amp; Slade, 1995</xref>;
    <xref alt="Hansson, 1979" rid="ref-hansson_food_1979-nb-article" ref-type="bibr">Hansson,
    1979</xref>;
    <xref alt="Keith, 1983" rid="ref-keith_role_1983-nb-article" ref-type="bibr">Keith,
    1983</xref>). However, in contrast to the conventional hypotheses
    that predict a broad positive linear relationship between
    herbivorous populations and nitrogen and phosphorus
    (<xref alt="Huberty &amp; Denno, 2006" rid="ref-huberty_consequences_2006-nb-article" ref-type="bibr">Huberty
    &amp; Denno, 2006</xref>;
    <xref alt="Mattson, 1980" rid="ref-mattson_herbivory_1980-nb-article" ref-type="bibr">Mattson,
    1980</xref>;
    <xref alt="White, 1978" rid="ref-white_importance_1978-nb-article" ref-type="bibr">White,
    1978</xref>;
    <xref alt="White, 1993" rid="ref-white_inadequate_1993-nb-article" ref-type="bibr">White,
    1993</xref>), the story is nuanced and probably most often
    non-linear. For some species, especially those with high energy
    requirements, the relationship is the opposite (negatively
    associated with nitrogen) like many locust species and the effects
    can be seen at the continental scale. Land use and Land Cover Change
    (LULCC) impact on nutritional environments has important
    implications for animal population dynamics from conservation to
    pest management. While we did not make an explicit connection
    between LULCC and locust outbreaks in Australia, our results are
    consistent with previous research showing that LULCC that decreases
    soil quality and creates low nitrogen environments increases
    physiological performance and outbreaks of locusts (reviewed in Le
    Gall et al.
    (<xref alt="2019" rid="ref-le_gall_global_2019-nb-article" ref-type="bibr">2019</xref>)).
    Most importantly, we show that this relationship is consistent
    between scales from the individual locust to continental wide
    outbreaks. As such, proper management of soil nutrients can help
    keep locust populations from reaching outbreak sizes and should be
    considered across scales, from individual locust behavior to
    continental wide plagues.</p>
  </sec>
</sec>
<sec id="references-nb-article">
  <title>5. REFERENCES</title>
</sec>
<sec id="supplementary-nb-article">
  <title>6. SUPPLEMENTARY</title>
  <fig id="suppfig-field-cage-plant-soil-nutrient-correlations-nb-article">
    <caption><p>Supplementary Figure 1: Field cage soil nitrogen content
    by treatment (A &amp; B) and regressed with plant carbohydrates and
    protein (C-F).</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_plant_and_soil_nutrient_correlations.png" />
  </fig>
  <fig id="suppfig-grid-example-nb-article">
    <caption><p>Supplementary Figure 2: Map showing how we summarized
    point observation data to a fishnet grid throughout eastern
    Australia. Entire extent can be seen in the inlet map. We summed the
    number of 4 (outbreak) observations, low presence observations
    (1-3), nil observations (0), and the total observations. Grid not at
    a 1 km2 x 1 km2 scale in this figure for demonstration purposes as
    the cells would be too small to see.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/spatial_modeling_grid_example_map.png" />
  </fig>
  <fig id="suppfig-field-pop-nutrients-nb-article">
    <caption><p>Supplementary Figure 3: Nutrient consumption for
    outbreaking field populations of C. terminifera by diet pair (A) and
    sex (B) and development time (C) specific growth rate (D) by sex.
    The P:C ratio did not differ between diet pairing and sex. Females
    consumed more diet (but kept the same ratio) than males. Big circles
    represent mean while little circles represent raw
    data.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/supplement_figure_3.png" />
  </fig>
  <fig id="suppfig-field-cage-rebalancing-facet-nb-article">
    <caption><p>Supplementary Figure 4: Individual time step intake
    targets for grasshoppers kept in both high nitrogen fertilization
    and control cages. Blue dots represent overall mean while blacks
    dots represent individual intake targets.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/field_cage_locust_intake_rebalance_day_facet_plot.png" />
  </fig>
  <fig id="suppfig-spatial-modeling-env-corr-nb-article">
    <caption><p>Supplementary Figure 5: Environmental variable
    correlations between mean annual precipitation, soil nitrogen, soil
    phosphorus, and woody vegetation pixel coverage. Mean annual
    precipitation was sourced from WorldClim V1 Bioclim, soil nitrogen
    and phosphorus was sourced from Soil and Landscape Grid of
    Australia, and woody vegetation pixel coverage was sourced from
    Global Forest Cover Change dataset. We averaged woody coverage for
    each pixel between the years 2000 and 2017. For all rasters, we
    randomly sampled 100,000 georeferenced points and extracted values.
    All values have been scaled and min-max normalized (to fall within
    [0,1]) for visual clarity. Dashed line represents a 1:1 slope and
    the blue line is a cubic spline with 10 knots.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="output/publication_figures/spatial_modeling_environment_correlation_figure.png" />
  </fig>
  <sec specific-use="notebook-content">
  <code language="r script">library(tidyverse)
library(here)
library(gt)

table_dat &lt;- read_csv(here('output/publication_tables/field_cage_plant_species_nutrient_content.csv')) </code>
  <boxed-text>
    <preformat>Rows: 33 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr  (2): treatment, species
dbl  (6): Plant C, Plant N, Plant Protein, Plant Carbohydrate, Soil NO3, Soi...
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
  </boxed-text>
  <code language="r script"># Define a mapping for the species names
species_map &lt;- c(
  &quot;Digitaria&quot; = &quot;Digitaria spp.&quot;,
  &quot;Enteropogon&quot; = &quot;Enteropogon spp.&quot;,
  &quot;Nutgrass&quot; = &quot;Cyperus spp.&quot;,
  &quot;Plaspladium&quot; = &quot;Plaspladium spp.&quot;,
  &quot;Wallaby&quot; = &quot;Rytidosperma spp.&quot;,
  &quot;Ustrostipa&quot; = &quot;Austrostipa spp.&quot;,
  &quot;unknown&quot; = &quot;unknown&quot;
)

table_dat |&gt; 
  arrange(treatment, `Soil NO3`, `Soil NO4`) |&gt; 
  mutate(across(where(is.numeric), ~round(., 3)),
    date = as.character(date)) |&gt;
  mutate(treatment = ifelse(duplicated(treatment), &quot;&quot;, treatment)) |&gt; 
  mutate(`Soil NO3` = ifelse(duplicated(`Soil NO3`), &quot;&quot;, `Soil NO3`)) |&gt;
  mutate(`Soil NO4` = ifelse(duplicated(`Soil NO4`), &quot;&quot;, `Soil NO4`)) |&gt;
  mutate(species = species_map[species]) |&gt;  # Apply species mapping
  gt() |&gt;
  tab_style(
    style = cell_text(style = &quot;italic&quot;),
    locations = cells_body(
      columns = vars(species),
      rows = species %in% c(&quot;Digitaria spp.&quot;, 
                          &quot;Enteropogon spp.&quot;, 
                          &quot;Cyperus spp.&quot;, 
                          &quot;Plaspladium spp.&quot;, 
                          &quot;Rytidosperma spp.&quot;,
                          &quot;Austrostipa spp.&quot;)
    )
  )  |&gt; 
  tab_options(table.width = pct(100),
    table.font.size = 11)</code>
  <boxed-text>
    <preformat>Warning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.</preformat>
  </boxed-text>
  <fig id="tbl-field-cage-plant-soil-nutrients-nb-article">
    <caption><p>Table 6: Field plot nutrient content for plant species
    collected from within the treatment plots but outside of the locust
    cages for three time points during the experiment. Soil nitrogen is
    also shown per each treatment. Trt = Treatment, C = carbon, N =
    Nitrogen, Prot = protein, Carb = Carbohydrates.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th id="treatment-nb-article" scope="col">treatment</th>
                      <th id="species-nb-article" scope="col">species</th>
                      <th id="date-nb-article" scope="col">date</th>
                      <th id="PlantU0020C-nb-article" scope="col">Plant C</th>
                      <th id="PlantU0020N-nb-article" scope="col">Plant N</th>
                      <th id="PlantU0020Protein-nb-article" scope="col">Plant
                      Protein</th>
                      <th id="PlantU0020Carbohydrate-nb-article" scope="col">Plant
                      Carbohydrate</th>
                      <th id="SoilU0020NO3-nb-article" scope="col">Soil NO3</th>
                      <th id="SoilU0020NO4-nb-article" scope="col">Soil NO4</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="treatment">High</td>
                      <td headers="species" style="font-style: italic">Digitaria
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.419</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.182</td>
                      <td headers="Plant Carbohydrate">0.108</td>
                      <td headers="Soil NO3">3.238</td>
                      <td headers="Soil NO4">4.207</td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.425</td>
                      <td headers="Plant N">0.030</td>
                      <td headers="Plant Protein">0.199</td>
                      <td headers="Plant Carbohydrate">0.128</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.028</td>
                      <td headers="Plant Protein">0.180</td>
                      <td headers="Plant Carbohydrate">0.120</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.024</td>
                      <td headers="Plant Protein">0.163</td>
                      <td headers="Plant Carbohydrate">0.125</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.423</td>
                      <td headers="Plant N">0.030</td>
                      <td headers="Plant Protein">0.228</td>
                      <td headers="Plant Carbohydrate">0.125</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.415</td>
                      <td headers="Plant N">0.032</td>
                      <td headers="Plant Protein">0.220</td>
                      <td headers="Plant Carbohydrate">0.131</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.227</td>
                      <td headers="Plant Carbohydrate">0.126</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Plaspladium
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.400</td>
                      <td headers="Plant N">0.029</td>
                      <td headers="Plant Protein">0.233</td>
                      <td headers="Plant Carbohydrate">0.120</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.424</td>
                      <td headers="Plant N">0.023</td>
                      <td headers="Plant Protein">0.206</td>
                      <td headers="Plant Carbohydrate">0.125</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.422</td>
                      <td headers="Plant N">0.029</td>
                      <td headers="Plant Protein">0.243</td>
                      <td headers="Plant Carbohydrate">0.112</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.419</td>
                      <td headers="Plant N">0.025</td>
                      <td headers="Plant Protein">0.217</td>
                      <td headers="Plant Carbohydrate">0.117</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment">Medium</td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.431</td>
                      <td headers="Plant N">0.042</td>
                      <td headers="Plant Protein">0.209</td>
                      <td headers="Plant Carbohydrate">0.126</td>
                      <td headers="Soil NO3">2.831</td>
                      <td headers="Soil NO4">3.385</td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.026</td>
                      <td headers="Plant Protein">0.210</td>
                      <td headers="Plant Carbohydrate">0.137</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.415</td>
                      <td headers="Plant N">0.022</td>
                      <td headers="Plant Protein">0.146</td>
                      <td headers="Plant Carbohydrate">0.124</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.424</td>
                      <td headers="Plant N">0.038</td>
                      <td headers="Plant Protein">0.213</td>
                      <td headers="Plant Carbohydrate">0.119</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.420</td>
                      <td headers="Plant N">0.029</td>
                      <td headers="Plant Protein">0.239</td>
                      <td headers="Plant Carbohydrate">0.127</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.418</td>
                      <td headers="Plant N">0.022</td>
                      <td headers="Plant Protein">0.188</td>
                      <td headers="Plant Carbohydrate">0.135</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Plaspladium
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.020</td>
                      <td headers="Plant Protein">0.243</td>
                      <td headers="Plant Carbohydrate">0.094</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.422</td>
                      <td headers="Plant N">0.037</td>
                      <td headers="Plant Protein">0.227</td>
                      <td headers="Plant Carbohydrate">0.106</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.420</td>
                      <td headers="Plant N">0.028</td>
                      <td headers="Plant Protein">0.242</td>
                      <td headers="Plant Carbohydrate">0.115</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.422</td>
                      <td headers="Plant N">0.021</td>
                      <td headers="Plant Protein">0.181</td>
                      <td headers="Plant Carbohydrate">0.116</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment">None</td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.432</td>
                      <td headers="Plant N">0.031</td>
                      <td headers="Plant Protein">0.164</td>
                      <td headers="Plant Carbohydrate">0.145</td>
                      <td headers="Soil NO3">1.387</td>
                      <td headers="Soil NO4">0.331</td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.414</td>
                      <td headers="Plant N">0.021</td>
                      <td headers="Plant Protein">0.194</td>
                      <td headers="Plant Carbohydrate">0.115</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Enteropogon
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.405</td>
                      <td headers="Plant N">0.023</td>
                      <td headers="Plant Protein">0.114</td>
                      <td headers="Plant Carbohydrate">0.130</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.425</td>
                      <td headers="Plant N">0.032</td>
                      <td headers="Plant Protein">0.228</td>
                      <td headers="Plant Carbohydrate">0.144</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.232</td>
                      <td headers="Plant Carbohydrate">0.137</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Cyperus
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.408</td>
                      <td headers="Plant N">0.026</td>
                      <td headers="Plant Protein">0.154</td>
                      <td headers="Plant Carbohydrate">0.126</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Plaspladium
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.399</td>
                      <td headers="Plant N">0.028</td>
                      <td headers="Plant Protein">0.183</td>
                      <td headers="Plant Carbohydrate">0.095</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Austrostipa
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.416</td>
                      <td headers="Plant N">0.013</td>
                      <td headers="Plant Protein">0.150</td>
                      <td headers="Plant Carbohydrate">0.104</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-11</td>
                      <td headers="Plant C">0.420</td>
                      <td headers="Plant N">0.026</td>
                      <td headers="Plant Protein">0.190</td>
                      <td headers="Plant Carbohydrate">0.124</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-11-25</td>
                      <td headers="Plant C">0.417</td>
                      <td headers="Plant N">0.027</td>
                      <td headers="Plant Protein">0.232</td>
                      <td headers="Plant Carbohydrate">0.133</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species" style="font-style: italic">Rytidosperma
                      spp.</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.418</td>
                      <td headers="Plant N">0.022</td>
                      <td headers="Plant Protein">0.142</td>
                      <td headers="Plant Carbohydrate">0.121</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                    <tr>
                      <td headers="treatment"></td>
                      <td headers="species">unknown</td>
                      <td headers="date">2015-12-01</td>
                      <td headers="Plant C">0.413</td>
                      <td headers="Plant N">0.031</td>
                      <td headers="Plant Protein">0.168</td>
                      <td headers="Plant Carbohydrate">0.101</td>
                      <td headers="Soil NO3"></td>
                      <td headers="Soil NO4"></td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  </sec>
  <sec specific-use="notebook-content">
  <code language="r script">library(tidyverse)
library(here)
library(gt)


table_dat &lt;- read_csv(here('output/publication_tables/field_cage_plant_ground_cover.csv')) </code>
  <boxed-text>
    <preformat>Rows: 3 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (1): treatment
dbl (6): plant_cover, Urochloa panicoides, Enteropogon acicularis, Austrodan...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
  </boxed-text>
  <code language="r script">table_dat |&gt; 
  pivot_longer(cols = !treatment) |&gt;
  pivot_wider(names_from = treatment, values_from = value) |&gt;
  mutate(plant = gsub('plant_cover', 'plant cover', name)) |&gt;
  select(plant, None, Medium, High) |&gt;
  gt() |&gt;
  fmt_number(decimals = 2) |&gt;
  tab_style(
    style = cell_text(style = &quot;italic&quot;),
    locations = cells_body(
      columns = vars(plant),
      rows = plant %in% c(&quot;Urochloa panicoides&quot;, 
                          &quot;Enteropogon acicularis&quot;, 
                          &quot;Austrodanthonia caespitosa&quot;, 
                          &quot;Cyperus rotundus&quot;, 
                          &quot;stipa species&quot;)
    )
  ) </code>
  <boxed-text>
    <preformat>Warning: Since gt v0.3.0, `columns = vars(...)` has been deprecated.
• Please use `columns = c(...)` instead.</preformat>
  </boxed-text>
  <fig id="tbl-field-cage-plant-ground-cover-nb-article">
    <caption><p>Table 7: Averaged plant ground cover (%) across all
    cages per treatment. Ground cover was estimated on November 11th,
    2015.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th id="plant-nb-article" scope="col">plant</th>
                      <th id="None-nb-article" scope="col">None</th>
                      <th id="Medium-nb-article" scope="col">Medium</th>
                      <th id="High-nb-article" scope="col">High</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="plant">plant cover</td>
                      <td headers="None">35.48</td>
                      <td headers="Medium">35.24</td>
                      <td headers="High">27.38</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Urochloa
                      panicoides</td>
                      <td headers="None">13.33</td>
                      <td headers="Medium">15.00</td>
                      <td headers="High">47.50</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Enteropogon
                      acicularis</td>
                      <td headers="None">60.12</td>
                      <td headers="Medium">65.48</td>
                      <td headers="High">67.38</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Austrodanthonia
                      caespitosa</td>
                      <td headers="None">15.36</td>
                      <td headers="Medium">18.33</td>
                      <td headers="High">15.24</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">Cyperus
                      rotundus</td>
                      <td headers="None">19.33</td>
                      <td headers="Medium">17.29</td>
                      <td headers="High">15.00</td>
                    </tr>
                    <tr>
                      <td headers="plant" style="font-style: italic">stipa
                      species</td>
                      <td headers="None">0.00</td>
                      <td headers="Medium">5.00</td>
                      <td headers="High">0.00</td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  </sec>
  <sec specific-use="notebook-content">
  <code language="r script">library(tidyverse)
library(here)
library(gt)


table_dat &lt;- read_csv(here('output/publication_tables/field_population_choice_experiment_model_selection_criteria.csv')) </code>
  <boxed-text>
    <preformat>Rows: 4 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (1): model
dbl (3): deltaBIC, deltaAIC, deltaAICc

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
  </boxed-text>
  <code language="r script">table_dat |&gt; 
  gt() |&gt;
  fmt_number(decimals = 2)   |&gt; 
  tab_options(table.width = pct(100),
    table.font.size = 11)</code>
  <fig id="tbl-field-population-choice-experiment-model-selection-criteria-nb-article">
    <caption><p>Table 8: Model selection criteria via Akaike information
    criterion (AIC), AIC corrected for small sample size (AICc), and
    bayesian information criterion. Model formula with the dependent
    variable on the left side and independent variables on the right
    side of the equation. s() denotes a smoothing parameter was
    estimated. For all criteria, the lower the number, more negative in
    this case, the better fit model.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th id="model-nb-article" scope="col">model</th>
                      <th id="deltaBIC-nb-article" scope="col">deltaBIC</th>
                      <th id="deltaAIC-nb-article" scope="col">deltaAIC</th>
                      <th id="deltaAICc-nb-article" scope="col">deltaAICc</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="model">macronutrient ~ population +
                      diet_pair + sex + s(initial_mass_g, k=30)</td>
                      <td headers="deltaBIC">0.01</td>
                      <td headers="deltaAIC">0.00</td>
                      <td headers="deltaAICc">0.01</td>
                    </tr>
                    <tr>
                      <td headers="model">macronutrient ~ population +
                      diet_pair + sex + initial_mass_g</td>
                      <td headers="deltaBIC">7.28</td>
                      <td headers="deltaAIC">2.81</td>
                      <td headers="deltaAICc">4.80</td>
                    </tr>
                    <tr>
                      <td headers="model">macronutrient ~ population +
                      diet_pair + sex</td>
                      <td headers="deltaBIC">0.00</td>
                      <td headers="deltaAIC">0.00</td>
                      <td headers="deltaAICc">0.00</td>
                    </tr>
                    <tr>
                      <td headers="model">macronutrient ~ 1</td>
                      <td headers="deltaBIC">2.56</td>
                      <td headers="deltaAIC">15.96</td>
                      <td headers="deltaAICc">12.28</td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  </sec>
  <sec specific-use="notebook-content">
  <code language="r script">library(tidyverse)
library(here)
library(gt)



table_dat &lt;- read_csv(here('output/publication_tables/field_population_no_choice_sgr_dev_posthoc_comparison_results.csv')) </code>
  <boxed-text>
    <preformat>Rows: 12 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (2): comparisons, model
dbl (3): estimate, SE, adjusted p-value

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
  </boxed-text>
  <code language="r script">table_dat |&gt;
  pivot_wider(names_from = model,values_from = c(estimate,SE,`adjusted p-value`)) |&gt;
  gt() |&gt;
  tab_spanner(
    label = &quot;Development Time&quot;,
    columns = ends_with('development time'))  |&gt;
  tab_spanner(
    label = &quot;Specific Growth Rate&quot;,
    columns = ends_with('specific growth rate')) |&gt;
  cols_label(
    starts_with(&quot;est&quot;) ~ &quot;estimate&quot;,
    starts_with(&quot;SE&quot;) ~ &quot;SE&quot;,
    starts_with(&quot;adjusted&quot;) ~ &quot;adjusted p-value&quot;
  ) |&gt;
  fmt_number(decimals = 3)</code>
  <fig id="tbl-field-population-no-choice-experiment-phys-post-hoc-nb-article">
    <caption><p>Table 9: Posthoc comparisons for diet treatments for C.
    terminifera individual specific growth rate and development time. SE
    = standard error.</p></caption>
    <table-wrap>
      <table>
        <colgroup>
          <col width="100%" />
        </colgroup>
        <tbody>
          <tr>
            <td align="center"><p specific-use="wrapper">
              <table-wrap>
                <table>
                  <thead>
                    <tr>
                      <th rowspan="2" id="comparisons-nb-article" scope="col">comparisons</th>
                      <th colspan="3" id="DevelopmentU0020Time-nb-article" scope="colgroup"><named-content content-type="gt_column_spanner">Development
                      Time</named-content></th>
                      <th colspan="3" id="SpecificU0020GrowthU0020Rate-nb-article" scope="colgroup"><named-content content-type="gt_column_spanner">Specific
                      Growth Rate</named-content></th>
                    </tr>
                    <tr>
                      <th id="estimate-nb-article" scope="col">estimate</th>
                      <th id="SE-nb-article" scope="col">SE</th>
                      <th id="adjustedU0020p-value-nb-article" scope="col">adjusted
                      p-value</th>
                      <th id="estimate-nb-article" scope="col">estimate</th>
                      <th id="SE-nb-article" scope="col">SE</th>
                      <th id="adjustedU0020p-value-nb-article" scope="col">adjusted
                      p-value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td headers="comparisons">14p:28c - 21p:21c</td>
                      <td headers="estimate_development time">−0.917</td>
                      <td headers="SE_development time">0.624</td>
                      <td headers="adjusted p-value_development time">0.465</td>
                      <td headers="estimate_specific growth rate">0.011</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.164</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">14p:28c - 35p:7c</td>
                      <td headers="estimate_development time">−1.709</td>
                      <td headers="SE_development time">0.664</td>
                      <td headers="adjusted p-value_development time">0.062</td>
                      <td headers="estimate_specific growth rate">0.010</td>
                      <td headers="SE_specific growth rate">0.006</td>
                      <td headers="adjusted p-value_specific growth rate">0.322</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">14p:28c - 7p:35c</td>
                      <td headers="estimate_development time">−2.716</td>
                      <td headers="SE_development time">0.603</td>
                      <td headers="adjusted p-value_development time">0.000</td>
                      <td headers="estimate_specific growth rate">0.026</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.000</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">21p:21c - 35p:7c</td>
                      <td headers="estimate_development time">−0.792</td>
                      <td headers="SE_development time">0.609</td>
                      <td headers="adjusted p-value_development time">0.567</td>
                      <td headers="estimate_specific growth rate">−0.001</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.997</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">21p:21c - 7p:35c</td>
                      <td headers="estimate_development time">−1.799</td>
                      <td headers="SE_development time">0.571</td>
                      <td headers="adjusted p-value_development time">0.014</td>
                      <td headers="estimate_specific growth rate">0.015</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.020</td>
                    </tr>
                    <tr>
                      <td headers="comparisons">35p:7c - 7p:35c</td>
                      <td headers="estimate_development time">−1.007</td>
                      <td headers="SE_development time">0.619</td>
                      <td headers="adjusted p-value_development time">0.374</td>
                      <td headers="estimate_specific growth rate">0.016</td>
                      <td headers="SE_specific growth rate">0.005</td>
                      <td headers="adjusted p-value_specific growth rate">0.029</td>
                    </tr>
                  </tbody>
                </table>
              </table-wrap>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </fig>
  </sec>
</sec>
</body>



<back>
<ref-list>
  <title></title>
  <ref id="ref-andersen_stoichiometry_2004-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Andersen</surname><given-names>Tom</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Hessen</surname><given-names>Dag O.</given-names></name>
      </person-group>
      <article-title>Stoichiometry and population dynamics</article-title>
      <source>Ecology Letters</source>
      <year iso-8601-date="2004-09">2004</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issue>9</issue>
      <issn>1461-023X, 1461-0248</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1461-0248.2004.00646.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1461-0248.2004.00646.x</pub-id>
      <fpage>884</fpage>
      <lpage>900</lpage>
    </element-citation>
  </ref>
  <ref id="ref-aryal_foods_2015-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Aryal</surname><given-names>Achyut</given-names></name>
        <name><surname>Coogan</surname><given-names>Sean C. P.</given-names></name>
        <name><surname>Ji</surname><given-names>Weihong</given-names></name>
        <name><surname>Rothman</surname><given-names>Jessica M.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>Foods, macronutrients and fibre in the diet of blue sheep ( Psuedois nayaur ) in the Annapurna Conservation Area of Nepal</article-title>
      <source>Ecology and Evolution</source>
      <year iso-8601-date="2015-09">2015</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>5</volume>
      <issue>18</issue>
      <issn>2045-7758, 2045-7758</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/ece3.1661</uri>
      <pub-id pub-id-type="doi">10.1002/ece3.1661</pub-id>
      <fpage>4006</fpage>
      <lpage>4017</lpage>
    </element-citation>
  </ref>
  <ref id="ref-harrison_synthesis_2014-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harrison</surname><given-names>Sarah J.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Godin</surname><given-names>Jean-Guy J.</given-names></name>
        <name><surname>Bertram</surname><given-names>Susan M.</given-names></name>
      </person-group>
      <article-title>Towards a synthesis of frameworks in nutritional ecology: Interacting effects of protein, carbohydrate and phosphorus on field cricket fitness</article-title>
      <source>Proceedings of the Royal Society B: Biological Sciences</source>
      <publisher-name>The Royal Society</publisher-name>
      <year iso-8601-date="2014">2014</year>
      <volume>281</volume>
      <issue>1792</issue>
      <uri>https://doi.org/10.1098/rspb.2014.0539</uri>
      <pub-id pub-id-type="doi">10.1098/rspb.2014.0539</pub-id>
      <fpage>20140539</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-raubenheimer_nutritional_2013-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
        <name><surname>Rothman</surname><given-names>Jessica M.</given-names></name>
      </person-group>
      <article-title>Nutritional Ecology of Entomophagy in Humans and Other Primates</article-title>
      <source>Annual Review of Entomology</source>
      <year iso-8601-date="2013-01">2013</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>58</volume>
      <issue>1</issue>
      <issn>0066-4170, 1545-4487</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev-ento-120710-100713</uri>
      <pub-id pub-id-type="doi">10.1146/annurev-ento-120710-100713</pub-id>
      <fpage>141</fpage>
      <lpage>160</lpage>
    </element-citation>
  </ref>
  <ref id="ref-batzli_nutritional_1986-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Batzli</surname><given-names>George O.</given-names></name>
      </person-group>
      <article-title>Nutritional Ecology of the California Vole: Effects of Food Quality on Reproduction</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1986-04">1986</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>67</volume>
      <issue>2</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.2307/1938583</uri>
      <pub-id pub-id-type="doi">10.2307/1938583</pub-id>
      <fpage>406</fpage>
      <lpage>412</lpage>
    </element-citation>
  </ref>
  <ref id="ref-behmer_insect_2009-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Behmer</surname><given-names>Spencer T.</given-names></name>
      </person-group>
      <article-title>Insect Herbivore Nutrient Regulation</article-title>
      <source>Annual Review of Entomology</source>
      <year iso-8601-date="2009-01">2009</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>54</volume>
      <issue>1</issue>
      <issn>0066-4170, 1545-4487</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev.ento.54.110807.090537</uri>
      <pub-id pub-id-type="doi">10.1146/annurev.ento.54.110807.090537</pub-id>
      <fpage>165</fpage>
      <lpage>187</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bernays_dietary_1994-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bernays</surname><given-names>E. A.</given-names></name>
        <name><surname>Bright</surname><given-names>K. L.</given-names></name>
        <name><surname>Gonzalez</surname><given-names>N.</given-names></name>
        <name><surname>Angel</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>Dietary Mixing in a Generalist Herbivore: Tests of Two Hypotheses</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1994-10">1994</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>75</volume>
      <issue>7</issue>
      <issn>00129658</issn>
      <uri>http://doi.wiley.com/10.2307/1941604</uri>
      <pub-id pub-id-type="doi">10.2307/1941604</pub-id>
      <fpage>1997</fpage>
      <lpage>2006</lpage>
    </element-citation>
  </ref>
  <ref id="ref-brosemann_nutrient_2023-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brosemann</surname><given-names>Jonah</given-names></name>
        <name><surname>Overson</surname><given-names>Rick</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Millerwise</surname><given-names>Sydney</given-names></name>
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
      </person-group>
      <article-title>Nutrient supply and accessibility in plants: Effect of protein and carbohydrates on Australian plague locust (Chortoicetes terminifera) preference and performance</article-title>
      <source>Frontiers in Insect Science</source>
      <year iso-8601-date="2023-07">2023</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>3</volume>
      <issn>2673-8600</issn>
      <uri>https://www.frontiersin.org/articles/10.3389/finsc.2023.1110518/full</uri>
      <pub-id pub-id-type="doi">10.3389/finsc.2023.1110518</pub-id>
      <fpage>1110518</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-brown_relationship_2002-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brown</surname><given-names>Alison S. Scott</given-names></name>
        <name><surname>Simmonds</surname><given-names>Monique S. J.</given-names></name>
        <name><surname>Blaney</surname><given-names>Walter M.</given-names></name>
      </person-group>
      <article-title>Relationship between nutritional composition of plant species and infestation levels of thrips</article-title>
      <source>Journal of Chemical Ecology</source>
      <year iso-8601-date="2002">2002</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>28</volume>
      <issue>12</issue>
      <issn>00980331</issn>
      <uri>http://link.springer.com/10.1023/A:1021471732625</uri>
      <pub-id pub-id-type="doi">10.1023/A:1021471732625</pub-id>
      <fpage>2399</fpage>
      <lpage>2409</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_how_2024-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>How Nutrients Mediate the Impacts of Global Change on Locust Outbreaks</article-title>
      <source>Annual Review of Entomology</source>
      <year iso-8601-date="2024-01">2024</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>69</volume>
      <issue>1</issue>
      <issn>0066-4170, 1545-4487</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev-ento-120220-110415</uri>
      <pub-id pub-id-type="doi">10.1146/annurev-ento-120220-110415</pub-id>
      <fpage>527</fpage>
      <lpage>550</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_living_2015-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Fenichel</surname><given-names>Eli P.</given-names></name>
        <name><surname>Hadrich</surname><given-names>Joleen C.</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
        <name><surname>Robinson</surname><given-names>Brian E.</given-names></name>
      </person-group>
      <article-title>Living With Locusts: Connecting Soil Nitrogen, Locust Outbreaks, Livelihoods, and Livestock Markets</article-title>
      <source>BioScience</source>
      <year iso-8601-date="2015-06">2015</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>65</volume>
      <issue>6</issue>
      <issn>1525-3244, 0006-3568</issn>
      <uri>http://academic.oup.com/bioscience/article/65/6/551/303376/Living-With-Locusts-Connecting-Soil-Nitrogen</uri>
      <pub-id pub-id-type="doi">10.1093/biosci/biv048</pub-id>
      <fpage>551</fpage>
      <lpage>558</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_heavy_2012-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Ford</surname><given-names>Colleen F.</given-names></name>
        <name><surname>Hao</surname><given-names>Shuguang</given-names></name>
        <name><surname>Kang</surname><given-names>Le</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
      </person-group>
      <article-title>Heavy Livestock Grazing Promotes Locust Outbreaks by Lowering Plant Nitrogen Content</article-title>
      <source>Science</source>
      <year iso-8601-date="2012-01">2012</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>335</volume>
      <issue>6067</issue>
      <issn>0036-8075, 1095-9203</issn>
      <uri>https://www.science.org/doi/10.1126/science.1214433</uri>
      <pub-id pub-id-type="doi">10.1126/science.1214433</pub-id>
      <fpage>467</fpage>
      <lpage>469</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_dietary_2016-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Fay</surname><given-names>Michelle</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
      </person-group>
      <article-title>Dietary phosphate affects food selection, post-ingestive P fate, and performance of a polyphagous herbivore</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2016-01">2016</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <issn>1477-9145, 0022-0949</issn>
      <uri>https://journals.biologists.com/jeb/article/doi/10.1242/jeb.126847/262050/Dietary-phosphate-affects-food-selection-post</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.126847</pub-id>
      <fpage>jeb.126847</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cease_field_2023-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Trumper</surname><given-names>Eduardo V.</given-names></name>
        <name><surname>Medina</surname><given-names>Héctor</given-names></name>
        <name><surname>Bazán</surname><given-names>Fernando Copa</given-names></name>
        <name><surname>Frana</surname><given-names>Jorge</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon</given-names></name>
        <name><surname>Joaquin</surname><given-names>Nelson</given-names></name>
        <name><surname>Learned</surname><given-names>Jennifer</given-names></name>
        <name><surname>Roca</surname><given-names>Mónica</given-names></name>
        <name><surname>Rojas</surname><given-names>Julio E.</given-names></name>
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Overson</surname><given-names>Rick P.</given-names></name>
      </person-group>
      <article-title>Field bands of marching locust juveniles show carbohydrate, not protein, limitation</article-title>
      <source>Current Research in Insect Science</source>
      <year iso-8601-date="2023">2023</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>4</volume>
      <issn>26665158</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S2666515823000185</uri>
      <pub-id pub-id-type="doi">10.1016/j.cris.2023.100069</pub-id>
      <fpage>100069</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cheng_geometry_2008-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cheng</surname><given-names>Ken</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>A Geometry of Regulatory Scaling</article-title>
      <source>The American Naturalist</source>
      <year iso-8601-date="2008-11">2008</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>172</volume>
      <issue>5</issue>
      <issn>0003-0147, 1537-5323</issn>
      <uri>https://www.journals.uchicago.edu/doi/10.1086/591686</uri>
      <pub-id pub-id-type="doi">10.1086/591686</pub-id>
      <fpage>681</fpage>
      <lpage>693</lpage>
    </element-citation>
  </ref>
  <ref id="ref-clark_influence_1974-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clark</surname><given-names>Dp</given-names></name>
      </person-group>
      <article-title>The Influence of Rainfall on the Densities of Adult Chlortoicetes Terminifera (Walker) in Central Western New South Wales, 1965-73.</article-title>
      <source>Australian Journal of Zoology</source>
      <year iso-8601-date="1974">1974</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>22</volume>
      <issue>3</issue>
      <issn>0004-959X</issn>
      <uri>http://www.publish.csiro.au/?paper=ZO9740365</uri>
      <pub-id pub-id-type="doi">10.1071/ZO9740365</pub-id>
      <fpage>365</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-clayton_spatial_1993-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clayton</surname><given-names>D G</given-names></name>
        <name><surname>Bernardinelli</surname><given-names>L</given-names></name>
        <name><surname>Montomoli</surname><given-names>C</given-names></name>
      </person-group>
      <article-title>Spatial Correlation in Ecological Analysis</article-title>
      <source>International Journal of Epidemiology</source>
      <year iso-8601-date="1993">1993</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>22</volume>
      <issue>6</issue>
      <issn>0300-5771, 1464-3685</issn>
      <uri>https://academic.oup.com/ije/article-lookup/doi/10.1093/ije/22.6.1193</uri>
      <pub-id pub-id-type="doi">10.1093/ije/22.6.1193</pub-id>
      <fpage>1193</fpage>
      <lpage>1202</lpage>
    </element-citation>
  </ref>
  <ref id="ref-clissold_insect_2013-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clissold</surname><given-names>Fiona J.</given-names></name>
        <name><surname>Coggan</surname><given-names>Nicole</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
      </person-group>
      <article-title>Insect herbivores can choose microclimates to achieve nutritional homeostasis</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2013-01">2013</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <issn>1477-9145, 0022-0949</issn>
      <uri>https://journals.biologists.com/jeb/article/doi/10.1242/jeb.078782/258075/Insect-herbivores-can-choose-microclimates-to</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.078782</pub-id>
      <fpage>jeb.078782</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-clissold_regulation_2014-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clissold</surname><given-names>Fiona J.</given-names></name>
        <name><surname>Kertesz</surname><given-names>Helena</given-names></name>
        <name><surname>Saul</surname><given-names>Amelia M.</given-names></name>
        <name><surname>Sheehan</surname><given-names>Julia L.</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
      </person-group>
      <article-title>Regulation of water and macronutrients by the Australian plague locust, Chortoicetes terminifera</article-title>
      <source>Journal of Insect Physiology</source>
      <year iso-8601-date="2014-10">2014</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>69</volume>
      <issn>00221910</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0022191014001267</uri>
      <pub-id pub-id-type="doi">10.1016/j.jinsphys.2014.06.011</pub-id>
      <fpage>35</fpage>
      <lpage>40</lpage>
    </element-citation>
  </ref>
  <ref id="ref-clissold_paradoxical_2006-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clissold</surname><given-names>F. J.</given-names></name>
        <name><surname>Sanson</surname><given-names>G. D.</given-names></name>
        <name><surname>Read</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>The paradoxical effects of nutrient ratios and supply rates on an outbreaking insect herbivore, the Australian plague locust</article-title>
      <source>Journal of Animal Ecology</source>
      <year iso-8601-date="2006-07">2006</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>75</volume>
      <issue>4</issue>
      <issn>0021-8790, 1365-2656</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-2656.2006.01122.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-2656.2006.01122.x</pub-id>
      <fpage>1000</fpage>
      <lpage>1013</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cole_influence_1978-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cole</surname><given-names>F. R.</given-names></name>
        <name><surname>Batzli</surname><given-names>G. O.</given-names></name>
      </person-group>
      <article-title>Influence of Supplemental Feeding on a Vole Population</article-title>
      <source>Journal of Mammalogy</source>
      <year iso-8601-date="1978-11">1978</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>59</volume>
      <issue>4</issue>
      <issn>1545-1542, 0022-2372</issn>
      <uri>https://academic.oup.com/jmammal/article-lookup/doi/10.2307/1380145</uri>
      <pub-id pub-id-type="doi">10.2307/1380145</pub-id>
      <fpage>809</fpage>
      <lpage>819</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cressman_role_2013-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cressman</surname><given-names>Keith</given-names></name>
      </person-group>
      <article-title>Role of remote sensing in desert locust early warning</article-title>
      <source>Journal of Applied Remote Sensing</source>
      <year iso-8601-date="2013-05">2013</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issue>1</issue>
      <issn>1931-3195</issn>
      <uri>http://remotesensing.spiedigitallibrary.org/article.aspx?doi=10.1117/1.JRS.7.075098</uri>
      <pub-id pub-id-type="doi">10.1117/1.JRS.7.075098</pub-id>
      <fpage>075098</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cullen_molecules_2017-nb-article">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Cullen</surname><given-names>Darron A.</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Latchininsky</surname><given-names>Alexandre V.</given-names></name>
        <name><surname>Ayali</surname><given-names>Amir</given-names></name>
        <name><surname>Berry</surname><given-names>Kevin</given-names></name>
        <name><surname>Buhl</surname><given-names>Camille</given-names></name>
        <name><surname>De Keyser</surname><given-names>Rien</given-names></name>
        <name><surname>Foquet</surname><given-names>Bert</given-names></name>
        <name><surname>Hadrich</surname><given-names>Joleen C.</given-names></name>
        <name><surname>Matheson</surname><given-names>Tom</given-names></name>
        <name><surname>Ott</surname><given-names>Swidbert R.</given-names></name>
        <name><surname>Poot-Pech</surname><given-names>Mario A.</given-names></name>
        <name><surname>Robinson</surname><given-names>Brian E.</given-names></name>
        <name><surname>Smith</surname><given-names>Jonathan M.</given-names></name>
        <name><surname>Song</surname><given-names>Hojun</given-names></name>
        <name><surname>Sword</surname><given-names>Gregory A.</given-names></name>
        <name><surname>Vanden Broeck</surname><given-names>Jozef</given-names></name>
        <name><surname>Verdonck</surname><given-names>Rik</given-names></name>
        <name><surname>Verlinden</surname><given-names>Heleen</given-names></name>
        <name><surname>Rogers</surname><given-names>Stephen M.</given-names></name>
      </person-group>
      <article-title>From Molecules to Management: Mechanisms and Consequences of Locust Phase Polyphenism</article-title>
      <source>Advances in Insect Physiology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>53</volume>
      <isbn>978-0-12-811833-7</isbn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0065280617300231</uri>
      <pub-id pub-id-type="doi">10.1016/bs.aiip.2017.06.002</pub-id>
      <fpage>167</fpage>
      <lpage>285</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dadd_nutritional_1961-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dadd</surname><given-names>R. H.</given-names></name>
      </person-group>
      <article-title>The nutritional requirements of locusts—IV. Requirements for vitamins of the B complex</article-title>
      <source>Journal of Insect Physiology</source>
      <year iso-8601-date="1961-02">1961</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>6</volume>
      <issue>1</issue>
      <issn>00221910</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/0022191061900865</uri>
      <pub-id pub-id-type="doi">10.1016/0022-1910(61)90086-5</pub-id>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-de_grandpre_defoliation-induced_2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>De Grandpré</surname><given-names>Louis</given-names></name>
        <name><surname>Marchand</surname><given-names>Maryse</given-names></name>
        <name><surname>Kneeshaw</surname><given-names>Daniel D.</given-names></name>
        <name><surname>Paré</surname><given-names>David</given-names></name>
        <name><surname>Boucher</surname><given-names>Dominique</given-names></name>
        <name><surname>Bourassa</surname><given-names>Stéphane</given-names></name>
        <name><surname>Gervais</surname><given-names>David</given-names></name>
        <name><surname>Simard</surname><given-names>Martin</given-names></name>
        <name><surname>Griffin</surname><given-names>Jacob M.</given-names></name>
        <name><surname>Pureswaran</surname><given-names>Deepa S.</given-names></name>
      </person-group>
      <article-title>Defoliation-induced changes in foliage quality may trigger broad-scale insect outbreaks</article-title>
      <source>Communications Biology</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>5</volume>
      <issue>1</issue>
      <issn>2399-3642</issn>
      <uri>https://www.nature.com/articles/s42003-022-03407-8</uri>
      <pub-id pub-id-type="doi">10.1038/s42003-022-03407-8</pub-id>
      <fpage>463</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deveson_satellite_2013-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Deveson</surname><given-names>Edward D.</given-names></name>
      </person-group>
      <article-title>Satellite normalized difference vegetation index data used in managing Australian plague locusts</article-title>
      <source>Journal of Applied Remote Sensing</source>
      <year iso-8601-date="2013-07">2013</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issue>1</issue>
      <issn>1931-3195</issn>
      <uri>http://remotesensing.spiedigitallibrary.org/article.aspx?doi=10.1117/1.JRS.7.075096</uri>
      <pub-id pub-id-type="doi">10.1117/1.JRS.7.075096</pub-id>
      <fpage>075096</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deveson_not_2005-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Deveson</surname><given-names>E. D.</given-names></name>
        <name><surname>Walker</surname><given-names>P. W.</given-names></name>
      </person-group>
      <article-title>Not a one-way trip: Historical distribution data for Australian plague locusts support frequent seasonal exchange migrations</article-title>
      <source>Journal of Orthoptera Research</source>
      <year iso-8601-date="2005-01">2005</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>14</volume>
      <issue>1</issue>
      <issn>1082-6467, 1937-2426</issn>
      <uri>http://www.bioone.org/doi/abs/10.1665/1082-6467%282005%2914%5B91%3ANAOTHD%5D2.0.CO%3B2</uri>
      <pub-id pub-id-type="doi">10.1665/1082-6467(2005)14[91:NAOTHD]2.0.CO;2</pub-id>
      <fpage>91</fpage>
      <lpage>105</lpage>
    </element-citation>
  </ref>
  <ref id="ref-deveson_operation_2002-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Deveson</surname><given-names>Ted</given-names></name>
        <name><surname>Hunter</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>THE OPERATION OF A GIS‐BASED DECISION SUPPORT SYSTEM FOR AUSTRALIAN LOCUST MANAGEMENT</article-title>
      <source>Insect Science</source>
      <year iso-8601-date="2002-12">2002</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>4</issue>
      <issn>1672-9609, 1744-7917</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1744-7917.2002.tb00167.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1744-7917.2002.tb00167.x</pub-id>
      <fpage>1</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-donald_colin_phosphorus_1964-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Donald</surname><given-names>Colin</given-names></name>
      </person-group>
      <article-title>Phosphorus in Australian agriculture.</article-title>
      <source>Journal of the Australian Institute of Agricultural Science</source>
      <year iso-8601-date="1964">1964</year>
      <volume>30</volume>
      <issue>75</issue>
      <fpage>195</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-doonan_effects_1995-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Doonan</surname><given-names>Terry J.</given-names></name>
        <name><surname>Slade</surname><given-names>Norman A.</given-names></name>
      </person-group>
      <article-title>Effects of Supplemental Food on Population Dynamics of Cotton Rats, Sigmodon Hispidus</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1995-04">1995</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>76</volume>
      <issue>3</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.2307/1939347</uri>
      <pub-id pub-id-type="doi">10.2307/1939347</pub-id>
      <fpage>814</fpage>
      <lpage>826</lpage>
    </element-citation>
  </ref>
  <ref id="ref-elser_nutritional_2000-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Fagan</surname><given-names>William F.</given-names></name>
        <name><surname>Denno</surname><given-names>Robert F.</given-names></name>
        <name><surname>Dobberfuhl</surname><given-names>Dean R.</given-names></name>
        <name><surname>Folarin</surname><given-names>Ayoola</given-names></name>
        <name><surname>Huberty</surname><given-names>Andrea</given-names></name>
        <name><surname>Interlandi</surname><given-names>Sebastian</given-names></name>
        <name><surname>Kilham</surname><given-names>Susan S.</given-names></name>
        <name><surname>McCauley</surname><given-names>Edward</given-names></name>
        <name><surname>Schulz</surname><given-names>Kimberly L.</given-names></name>
        <name><surname>Siemann</surname><given-names>Evan H.</given-names></name>
        <name><surname>Sterner</surname><given-names>Robert W.</given-names></name>
      </person-group>
      <article-title>Nutritional constraints in terrestrial and freshwater food webs</article-title>
      <source>Nature</source>
      <year iso-8601-date="2000-11">2000</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>408</volume>
      <issue>6812</issue>
      <issn>0028-0836, 1476-4687</issn>
      <uri>https://www.nature.com/articles/35046058</uri>
      <pub-id pub-id-type="doi">10.1038/35046058</pub-id>
      <fpage>578</fpage>
      <lpage>580</lpage>
    </element-citation>
  </ref>
  <ref id="ref-farrow_population_1982-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Farrow</surname><given-names>Ra</given-names></name>
      </person-group>
      <article-title>Population Dynamics of the Australian Plague Locust, Chortoicetes Terminifera (Walker) in Central Western New South Wales Iii. Analysis of Population Processes.</article-title>
      <source>Australian Journal of Zoology</source>
      <year iso-8601-date="1982">1982</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>30</volume>
      <issue>4</issue>
      <issn>0004-959X</issn>
      <uri>http://www.publish.csiro.au/?paper=ZO9820569</uri>
      <pub-id pub-id-type="doi">10.1071/ZO9820569</pub-id>
      <fpage>569</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-floyd_frontiers_1996-nb-article">
    <element-citation publication-type="book">
      <source>Frontiers of population ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Floyd</surname><given-names>R. B.</given-names></name>
      </person-group>
      <publisher-name>CSIRO Pub</publisher-name>
      <publisher-loc>Collingwood, VIC, Australia</publisher-loc>
      <year iso-8601-date="1996">1996</year>
      <isbn>978-0-643-05781-4</isbn>
    </element-citation>
  </ref>
  <ref id="ref-forero_conspecific_2002-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Forero</surname><given-names>M. G.</given-names></name>
        <name><surname>Tella</surname><given-names>J. L.</given-names></name>
        <name><surname>Hobson</surname><given-names>K. A.</given-names></name>
        <name><surname>Bertellotti</surname><given-names>M.</given-names></name>
        <name><surname>Blanco</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>Conspecific food competition explains variability in colony size: a test in Magellanic penguins</article-title>
      <source>Ecology</source>
      <year iso-8601-date="2002-12">2002</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>83</volume>
      <issue>12</issue>
      <issn>0012-9658</issn>
      <uri>http://doi.wiley.com/10.1890/0012-9658(2002)083[3466:CFCEVI]2.0.CO;2</uri>
      <pub-id pub-id-type="doi">10.1890/0012-9658(2002)083[3466:CFCEVI]2.0.CO;2</pub-id>
      <fpage>3466</fpage>
      <lpage>3475</lpage>
    </element-citation>
  </ref>
  <ref id="ref-giese_n_2013-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Giese</surname><given-names>M.</given-names></name>
        <name><surname>Brueck</surname><given-names>H.</given-names></name>
        <name><surname>Gao</surname><given-names>Y. Z.</given-names></name>
        <name><surname>Lin</surname><given-names>S.</given-names></name>
        <name><surname>Steffens</surname><given-names>M.</given-names></name>
        <name><surname>Kögel-Knabner</surname><given-names>I.</given-names></name>
        <name><surname>Glindemann</surname><given-names>T.</given-names></name>
        <name><surname>Susenbeth</surname><given-names>A.</given-names></name>
        <name><surname>Taube</surname><given-names>F.</given-names></name>
        <name><surname>Butterbach-Bahl</surname><given-names>K.</given-names></name>
        <name><surname>Zheng</surname><given-names>X. H.</given-names></name>
        <name><surname>Hoffmann</surname><given-names>C.</given-names></name>
        <name><surname>Bai</surname><given-names>Y. F.</given-names></name>
        <name><surname>Han</surname><given-names>X. G.</given-names></name>
      </person-group>
      <article-title>N balance and cycling of Inner Mongolia typical steppe: A comprehensive case study of grazing effects</article-title>
      <source>Ecological Monographs</source>
      <year iso-8601-date="2013-05">2013</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>83</volume>
      <issue>2</issue>
      <issn>0012-9615, 1557-7015</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/12-0114.1</uri>
      <pub-id pub-id-type="doi">10.1890/12-0114.1</pub-id>
      <fpage>195</fpage>
      <lpage>219</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gorelick_google_2017-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gorelick</surname><given-names>Noel</given-names></name>
        <name><surname>Hancher</surname><given-names>Matt</given-names></name>
        <name><surname>Dixon</surname><given-names>Mike</given-names></name>
        <name><surname>Ilyushchenko</surname><given-names>Simon</given-names></name>
        <name><surname>Thau</surname><given-names>David</given-names></name>
        <name><surname>Moore</surname><given-names>Rebecca</given-names></name>
      </person-group>
      <article-title>Google Earth Engine: Planetary-scale geospatial analysis for everyone</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2017-12">2017</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>202</volume>
      <issn>00344257</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0034425717302900</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2017.06.031</pub-id>
      <fpage>18</fpage>
      <lpage>27</lpage>
    </element-citation>
  </ref>
  <ref id="ref-granbom_food_2006-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Granbom</surname><given-names>Martin</given-names></name>
        <name><surname>Smith</surname><given-names>Henrik G.</given-names></name>
      </person-group>
      <article-title>Food Limitation During Breeding in a Heterogeneous Landscape</article-title>
      <source>The Auk</source>
      <person-group person-group-type="editor">
        <name><surname>Murphy</surname><given-names>M. T.</given-names></name>
      </person-group>
      <year iso-8601-date="2006-01">2006</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>123</volume>
      <issue>1</issue>
      <issn>1938-4254, 0004-8038</issn>
      <uri>https://academic.oup.com/auk/article/123/1/97/5562605</uri>
      <pub-id pub-id-type="doi">10.1093/auk/123.1.97</pub-id>
      <fpage>97</fpage>
      <lpage>107</lpage>
    </element-citation>
  </ref>
  <ref id="ref-grundy_soil_2015-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Grundy</surname><given-names>M. J.</given-names></name>
        <name><surname>Rossel</surname><given-names>R. A. Viscarra</given-names></name>
        <name><surname>Searle</surname><given-names>R. D.</given-names></name>
        <name><surname>Wilson</surname><given-names>P. L.</given-names></name>
        <name><surname>Chen</surname><given-names>C.</given-names></name>
        <name><surname>Gregory</surname><given-names>L. J.</given-names></name>
      </person-group>
      <article-title>Soil and Landscape Grid of Australia</article-title>
      <source>Soil Research</source>
      <year iso-8601-date="2015">2015</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>53</volume>
      <issue>8</issue>
      <issn>1838-675X</issn>
      <uri>http://www.publish.csiro.au/?paper=SR15191</uri>
      <pub-id pub-id-type="doi">10.1071/SR15191</pub-id>
      <fpage>835</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-hansson_food_1979-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hansson</surname><given-names>Lennart</given-names></name>
      </person-group>
      <article-title>Food as a limiting factor for small rodent numbers: Tests of two hypotheses</article-title>
      <source>Oecologia</source>
      <year iso-8601-date="1979-01">1979</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>37</volume>
      <issue>3</issue>
      <issn>0029-8549, 1432-1939</issn>
      <uri>http://link.springer.com/10.1007/BF00347907</uri>
      <pub-id pub-id-type="doi">10.1007/BF00347907</pub-id>
      <fpage>297</fpage>
      <lpage>314</lpage>
    </element-citation>
  </ref>
  <ref id="ref-heidorn_feeding_1987-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Heidorn</surname><given-names>T. J.</given-names></name>
        <name><surname>Joern</surname><given-names>A.</given-names></name>
      </person-group>
      <article-title>Feeding Preference and Spatial Distribution of Grasshoppers (Acrididae) in Response to Nitrogen Fertilization of Calamovilfa longifolia</article-title>
      <source>Functional Ecology</source>
      <year iso-8601-date="1987">1987</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>1</volume>
      <issue>4</issue>
      <issn>02698463</issn>
      <uri>https://www.jstor.org/stable/2389793?origin=crossref</uri>
      <pub-id pub-id-type="doi">10.2307/2389793</pub-id>
      <fpage>369</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-huberty_consequences_2006-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Huberty</surname><given-names>Andrea F.</given-names></name>
        <name><surname>Denno</surname><given-names>Robert F.</given-names></name>
      </person-group>
      <article-title>Consequences of nitrogen and phosphorus limitation for the performance of two planthoppers with divergent life-history strategies</article-title>
      <source>Oecologia</source>
      <year iso-8601-date="2006-09">2006</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>149</volume>
      <issue>3</issue>
      <issn>0029-8549, 1432-1939</issn>
      <uri>http://link.springer.com/10.1007/s00442-006-0462-8</uri>
      <pub-id pub-id-type="doi">10.1007/s00442-006-0462-8</pub-id>
      <fpage>444</fpage>
      <lpage>455</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hunter_aerial_2008-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hunter</surname><given-names>D. M.</given-names></name>
        <name><surname>McCulloch</surname><given-names>L.</given-names></name>
        <name><surname>Spurgin</surname><given-names>P. A.</given-names></name>
      </person-group>
      <article-title>Aerial detection of nymphal bands of the Australian plague locust (Chortoicetes terminifera (Walker)) (Orthoptera: Acrididae)</article-title>
      <source>Crop Protection</source>
      <year iso-8601-date="2008-01">2008</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>27</volume>
      <issue>1</issue>
      <issn>02612194</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0261219407001159</uri>
      <pub-id pub-id-type="doi">10.1016/j.cropro.2007.04.016</pub-id>
      <fpage>118</fpage>
      <lpage>123</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hunter_adaptations_2001-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hunter</surname><given-names>D. M.</given-names></name>
        <name><surname>Walker</surname><given-names>P. W.</given-names></name>
        <name><surname>Elder</surname><given-names>R. J.</given-names></name>
      </person-group>
      <article-title>Adaptations of locusts and grasshoppers to the low and variable rainfall of Australia</article-title>
      <source>Journal of Orthoptera Research</source>
      <year iso-8601-date="2001-12">2001</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>10</volume>
      <issue>2</issue>
      <issn>1082-6467, 1937-2426</issn>
      <uri>http://www.bioone.org/doi/abs/10.1665/1082-6467%282001%29010%5B0347%3AAOLAGT%5D2.0.CO%3B2</uri>
      <pub-id pub-id-type="doi">10.1665/1082-6467(2001)010[0347:AOLAGT]2.0.CO;2</pub-id>
      <fpage>347</fpage>
      <lpage>351</lpage>
    </element-citation>
  </ref>
  <ref id="ref-joern_not_2012-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
        <name><surname>Provin</surname><given-names>Tony</given-names></name>
        <name><surname>Behmer</surname><given-names>Spencer T.</given-names></name>
      </person-group>
      <article-title>Not just the usual suspects: Insect herbivore populations and communities are associated with multiple plant nutrients</article-title>
      <source>Ecology</source>
      <year iso-8601-date="2012-05">2012</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>93</volume>
      <issue>5</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/11-1142.1</uri>
      <pub-id pub-id-type="doi">10.1890/11-1142.1</pub-id>
      <fpage>1002</fpage>
      <lpage>1015</lpage>
    </element-citation>
  </ref>
  <ref id="ref-jonas_hostplant_2008-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jonas</surname><given-names>Jayne L.</given-names></name>
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
      </person-group>
      <article-title>Host‐plant quality alters grass/forb consumption by a mixed‐feeding insect herbivore, Melanoplus bivittatus (Orthoptera: Acrididae)</article-title>
      <source>Ecological Entomology</source>
      <year iso-8601-date="2008-08">2008</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>33</volume>
      <issue>4</issue>
      <issn>0307-6946, 1365-2311</issn>
      <uri>https://resjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-2311.2008.01004.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-2311.2008.01004.x</pub-id>
      <fpage>546</fpage>
      <lpage>554</lpage>
    </element-citation>
  </ref>
  <ref id="ref-keith_role_1983-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Keith</surname><given-names>Lloyd B.</given-names></name>
      </person-group>
      <article-title>Role of Food in Hare Population Cycles</article-title>
      <source>Oikos</source>
      <year iso-8601-date="1983-05">1983</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>40</volume>
      <issue>3</issue>
      <issn>00301299</issn>
      <uri>https://www.jstor.org/stable/3544311?origin=crossref</uri>
      <pub-id pub-id-type="doi">10.2307/3544311</pub-id>
      <fpage>385</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-key_general_1945-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Key</surname><given-names>K. H. L.</given-names></name>
      </person-group>
      <article-title>The general ecological characteristics of the outbreak areas and outbreak years of the Australian plague locust (Chortoicetes terminifera Walk.)</article-title>
      <year iso-8601-date="1945">1945</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <uri>https://publications.csiro.au/publications/publication/PIprocite:8058408f-539f-4540-b888-0dda1e0c113d</uri>
      <pub-id pub-id-type="doi">10.25919/RTPX-F935</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-lawton_mismatched_2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lawton</surname><given-names>Douglas</given-names></name>
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
        <name><surname>Waters</surname><given-names>Cathy</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Mismatched diets: Defining the nutritional landscape of grasshopper communities in a variable environment</article-title>
      <source>Ecosphere</source>
      <year iso-8601-date="2021-03">2021</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>12</volume>
      <issue>3</issue>
      <issn>2150-8925, 2150-8925</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3409</uri>
      <pub-id pub-id-type="doi">10.1002/ecs2.3409</pub-id>
      <fpage>e03409</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lawton_seeing_2022-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lawton</surname><given-names>Douglas</given-names></name>
        <name><surname>Scarth</surname><given-names>Peter</given-names></name>
        <name><surname>Deveson</surname><given-names>Edward</given-names></name>
        <name><surname>Piou</surname><given-names>Cyril</given-names></name>
        <name><surname>Spessa</surname><given-names>Allan</given-names></name>
        <name><surname>Waters</surname><given-names>Cathy</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Seeing the locust in the swarm: Accounting for spatiotemporal hierarchy improves ecological models of insect populations</article-title>
      <source>Ecography</source>
      <year iso-8601-date="2022-02">2022</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>2022</volume>
      <issue>2</issue>
      <issn>0906-7590, 1600-0587</issn>
      <uri>https://nsojournals.onlinelibrary.wiley.com/doi/10.1111/ecog.05763</uri>
      <pub-id pub-id-type="doi">10.1111/ecog.05763</pub-id>
      <fpage>ecog.05763</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lawton_woody_2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lawton</surname><given-names>Douglas</given-names></name>
        <name><surname>Waters</surname><given-names>Cathy</given-names></name>
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne</given-names></name>
      </person-group>
      <article-title>Woody vegetation remnants within pastures influence locust distribution: Testing bottom-up and top-down control</article-title>
      <source>Agriculture, Ecosystems &amp; Environment</source>
      <year iso-8601-date="2020-07">2020</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>296</volume>
      <issn>01678809</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S016788092030116X</uri>
      <pub-id pub-id-type="doi">10.1016/j.agee.2020.106931</pub-id>
      <fpage>106931</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-le_gall_global_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Le Gall</surname><given-names>Marion</given-names></name>
        <name><surname>Overson</surname><given-names>Rick</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne</given-names></name>
      </person-group>
      <article-title>A Global Review on Locusts (Orthoptera: Acrididae) and Their Interactions With Livestock Grazing Practices</article-title>
      <source>Frontiers in Ecology and Evolution</source>
      <year iso-8601-date="2019-07">2019</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>7</volume>
      <issn>2296-701X</issn>
      <uri>https://www.frontiersin.org/article/10.3389/fevo.2019.00263/full</uri>
      <pub-id pub-id-type="doi">10.3389/fevo.2019.00263</pub-id>
      <fpage>263</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lenhart_water_2015-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lenhart</surname><given-names>Paul A.</given-names></name>
        <name><surname>Eubanks</surname><given-names>Micky D.</given-names></name>
        <name><surname>Behmer</surname><given-names>Spencer T.</given-names></name>
      </person-group>
      <article-title>Water stress in grasslands: Dynamic responses of plants and insect herbivores</article-title>
      <source>Oikos</source>
      <year iso-8601-date="2015-03">2015</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>124</volume>
      <issue>3</issue>
      <issn>0030-1299, 1600-0706</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/oik.01370</uri>
      <pub-id pub-id-type="doi">10.1111/oik.01370</pub-id>
      <fpage>381</fpage>
      <lpage>390</lpage>
    </element-citation>
  </ref>
  <ref id="ref-levin_problem_1992-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Levin</surname><given-names>Simon A.</given-names></name>
      </person-group>
      <article-title>The Problem of Pattern and Scale in Ecology: The Robert H. MacArthur Award Lecture</article-title>
      <source>Ecology</source>
      <year iso-8601-date="1992-12">1992</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>73</volume>
      <issue>6</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.2307/1941447</uri>
      <pub-id pub-id-type="doi">10.2307/1941447</pub-id>
      <fpage>1943</fpage>
      <lpage>1967</lpage>
    </element-citation>
  </ref>
  <ref id="ref-marsh_decline_1995-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Marsh</surname><given-names>Nr</given-names></name>
        <name><surname>Adams</surname><given-names>Ma</given-names></name>
      </person-group>
      <article-title>Decline of Eucalyptus tereticornis Near Bairnsdale, Victoria: Insect Herbivory and Nitrogen Fractions in Sap and Foliage</article-title>
      <source>Australian Journal of Botany</source>
      <year iso-8601-date="1995">1995</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>43</volume>
      <issue>1</issue>
      <issn>0067-1924</issn>
      <uri>http://www.publish.csiro.au/?paper=BT9950039</uri>
      <pub-id pub-id-type="doi">10.1071/BT9950039</pub-id>
      <fpage>39</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-mattson_herbivory_1980-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mattson</surname><given-names>William J.</given-names></name>
      </person-group>
      <article-title>Herbivory in Relation to Plant Nitrogen Content</article-title>
      <source>Annual Review of Ecology and Systematics</source>
      <year iso-8601-date="1980-11">1980</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>11</volume>
      <issue>1</issue>
      <issn>0066-4162</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev.es.11.110180.001003</uri>
      <pub-id pub-id-type="doi">10.1146/annurev.es.11.110180.001003</pub-id>
      <fpage>119</fpage>
      <lpage>161</lpage>
    </element-citation>
  </ref>
  <ref id="ref-millist_nicola_benefitcost_nodate-nb-article">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Millist</surname><given-names>Ali</given-names><suffix>Nicola</suffix></name>
      </person-group>
      <article-title>Benefit–cost analysis of Australian plague locust control operations for 2010–11</article-title>
      <publisher-name>ABARES Report Prepared for the Australian Plague Locust Commission.</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <uri>https://www.agriculture.gov.au/sites/default/files/sitecollectiondocuments/animal-plant/aplc/research-papers/locust-control-11.pdf</uri>
    </element-citation>
  </ref>
  <ref id="ref-morton_fresh_2011-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Morton</surname><given-names>S. R.</given-names></name>
        <name><surname>Stafford Smith</surname><given-names>D. M.</given-names></name>
        <name><surname>Dickman</surname><given-names>C. R.</given-names></name>
        <name><surname>Dunkerley</surname><given-names>D. L.</given-names></name>
        <name><surname>Friedel</surname><given-names>M. H.</given-names></name>
        <name><surname>McAllister</surname><given-names>R. R. J.</given-names></name>
        <name><surname>Reid</surname><given-names>J. R. W.</given-names></name>
        <name><surname>Roshier</surname><given-names>D. A.</given-names></name>
        <name><surname>Smith</surname><given-names>M. A.</given-names></name>
        <name><surname>Walsh</surname><given-names>F. J.</given-names></name>
        <name><surname>Wardle</surname><given-names>G. M.</given-names></name>
        <name><surname>Watson</surname><given-names>I. W.</given-names></name>
        <name><surname>Westoby</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>A fresh framework for the ecology of arid Australia</article-title>
      <source>Journal of Arid Environments</source>
      <year iso-8601-date="2011-04">2011</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>75</volume>
      <issue>4</issue>
      <issn>01401963</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0140196310003010</uri>
      <pub-id pub-id-type="doi">10.1016/j.jaridenv.2010.11.001</pub-id>
      <fpage>313</fpage>
      <lpage>329</lpage>
    </element-citation>
  </ref>
  <ref id="ref-munoz-sabater_era5-land_2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Muñoz-Sabater</surname><given-names>Joaquín</given-names></name>
        <name><surname>Dutra</surname><given-names>Emanuel</given-names></name>
        <name><surname>Agustí-Panareda</surname><given-names>Anna</given-names></name>
        <name><surname>Albergel</surname><given-names>Clément</given-names></name>
        <name><surname>Arduini</surname><given-names>Gabriele</given-names></name>
        <name><surname>Balsamo</surname><given-names>Gianpaolo</given-names></name>
        <name><surname>Boussetta</surname><given-names>Souhail</given-names></name>
        <name><surname>Choulga</surname><given-names>Margarita</given-names></name>
        <name><surname>Harrigan</surname><given-names>Shaun</given-names></name>
        <name><surname>Hersbach</surname><given-names>Hans</given-names></name>
        <name><surname>Martens</surname><given-names>Brecht</given-names></name>
        <name><surname>Miralles</surname><given-names>Diego G.</given-names></name>
        <name><surname>Piles</surname><given-names>María</given-names></name>
        <name><surname>Rodríguez-Fernández</surname><given-names>Nemesio J.</given-names></name>
        <name><surname>Zsoter</surname><given-names>Ervin</given-names></name>
        <name><surname>Buontempo</surname><given-names>Carlo</given-names></name>
        <name><surname>Thépaut</surname><given-names>Jean-Noël</given-names></name>
      </person-group>
      <article-title>ERA5-Land: A state-of-the-art global reanalysis dataset for land applications</article-title>
      <source>Earth System Science Data</source>
      <year iso-8601-date="2021-09">2021</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>13</volume>
      <issue>9</issue>
      <issn>1866-3516</issn>
      <uri>https://essd.copernicus.org/articles/13/4349/2021/</uri>
      <pub-id pub-id-type="doi">10.5194/essd-13-4349-2021</pub-id>
      <fpage>4349</fpage>
      <lpage>4383</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nie_obligate_2015-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nie</surname><given-names>Yonggang</given-names></name>
        <name><surname>Zhang</surname><given-names>Zejun</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Wei</surname><given-names>Wei</given-names></name>
        <name><surname>Wei</surname><given-names>Fuwen</given-names></name>
      </person-group>
      <article-title>Obligate herbivory in an ancestrally carnivorous lineage: The giant panda and bamboo from the perspective of nutritional geometry</article-title>
      <source>Functional Ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Kay</surname><given-names>Adam</given-names></name>
      </person-group>
      <year iso-8601-date="2015-01">2015</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>29</volume>
      <issue>1</issue>
      <issn>0269-8463, 1365-2435</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2435.12302</uri>
      <pub-id pub-id-type="doi">10.1111/1365-2435.12302</pub-id>
      <fpage>26</fpage>
      <lpage>34</lpage>
    </element-citation>
  </ref>
  <ref id="ref-noy-meir_desert_1974-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Noy-Meir</surname><given-names>Imanuel</given-names></name>
      </person-group>
      <article-title>Desert Ecosystems: Higher Trophic Levels</article-title>
      <source>Annual Review of Ecology and Systematics</source>
      <year iso-8601-date="1974-11">1974</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>5</volume>
      <issue>1</issue>
      <issn>0066-4162</issn>
      <uri>https://www.annualreviews.org/doi/10.1146/annurev.es.05.110174.001211</uri>
      <pub-id pub-id-type="doi">10.1146/annurev.es.05.110174.001211</pub-id>
      <fpage>195</fpage>
      <lpage>214</lpage>
    </element-citation>
  </ref>
  <ref id="ref-orians_ecology_2007-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Orians</surname><given-names>Gordon H.</given-names></name>
        <name><surname>Milewski</surname><given-names>Antoni V.</given-names></name>
      </person-group>
      <article-title>Ecology of Australia: The effects of nutrient‐poor soils and intense fires</article-title>
      <source>Biological Reviews</source>
      <year iso-8601-date="2007-08">2007</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>82</volume>
      <issue>3</issue>
      <issn>1464-7931, 1469-185X</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1469-185X.2007.00017.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1469-185X.2007.00017.x</pub-id>
      <fpage>393</fpage>
      <lpage>423</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ozment_tracking_2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ozment</surname><given-names>Katerina A.</given-names></name>
        <name><surname>Welti</surname><given-names>Ellen A. R.</given-names></name>
        <name><surname>Shaffer</surname><given-names>Monica</given-names></name>
        <name><surname>Kaspari</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Tracking nutrients in space and time: Interactions between grazing lawns and drought drive abundances of tallgrass prairie grasshoppers</article-title>
      <source>Ecology and Evolution</source>
      <year iso-8601-date="2021-05">2021</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>11</volume>
      <issue>10</issue>
      <issn>2045-7758, 2045-7758</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/ece3.7435</uri>
      <pub-id pub-id-type="doi">10.1002/ece3.7435</pub-id>
      <fpage>5413</fpage>
      <lpage>5423</lpage>
    </element-citation>
  </ref>
  <ref id="ref-parlin_cost_2023-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Parlin</surname><given-names>Adam F.</given-names></name>
        <name><surname>Kendzel</surname><given-names>Mitchell J.</given-names></name>
        <name><surname>Taylor</surname><given-names>Orley R.</given-names></name>
        <name><surname>Culley</surname><given-names>Theresa M.</given-names></name>
        <name><surname>Matter</surname><given-names>Stephen F.</given-names></name>
        <name><surname>Guerra</surname><given-names>Patrick A.</given-names></name>
      </person-group>
      <article-title>The cost of movement: Assessing energy expenditure in a long-distant ectothermic migrant under climate change</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2023-11">2023</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>226</volume>
      <issue>21</issue>
      <issn>0022-0949, 1477-9145</issn>
      <uri>https://journals.biologists.com/jeb/article/226/21/jeb245296/334654/The-cost-of-movement-assessing-energy-expenditure</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.245296</pub-id>
      <fpage>jeb245296</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-perkins_dietary_2004-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perkins</surname><given-names>Marc C.</given-names></name>
        <name><surname>Woods</surname><given-names>H. Arthur</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
      </person-group>
      <article-title>Dietary phosphorus affects the growth of larval Manduca sexta</article-title>
      <source>Archives of Insect Biochemistry and Physiology</source>
      <year iso-8601-date="2004-03">2004</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>55</volume>
      <issue>3</issue>
      <issn>0739-4462, 1520-6327</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/arch.10133</uri>
      <pub-id pub-id-type="doi">10.1002/arch.10133</pub-id>
      <fpage>153</fpage>
      <lpage>168</lpage>
    </element-citation>
  </ref>
  <ref id="ref-randolph_nutritional_1995-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Randolph</surname><given-names>J. C.</given-names></name>
        <name><surname>Cameron</surname><given-names>G. N.</given-names></name>
        <name><surname>McClure</surname><given-names>P. A.</given-names></name>
      </person-group>
      <article-title>Nutritional Requirements for Reproduction in the Hispid Cotton Rat, Sigmodon hispidus</article-title>
      <source>Journal of Mammalogy</source>
      <year iso-8601-date="1995-12">1995</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>76</volume>
      <issue>4</issue>
      <issn>1545-1542, 0022-2372</issn>
      <uri>https://academic.oup.com/jmammal/article-lookup/doi/10.2307/1382603</uri>
      <pub-id pub-id-type="doi">10.2307/1382603</pub-id>
      <fpage>1113</fpage>
      <lpage>1126</lpage>
    </element-citation>
  </ref>
  <ref id="ref-raubenheimer_integrative_1997-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Raubenheimer</surname><given-names>D.</given-names></name>
        <name><surname>Simpson</surname><given-names>S. J.</given-names></name>
      </person-group>
      <article-title>Integrative models of nutrient balancing: Application to insects and vertebrates</article-title>
      <source>Nutrition Research Reviews</source>
      <year iso-8601-date="1997-01">1997</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>10</volume>
      <issue>1</issue>
      <issn>0954-4224, 1475-2700</issn>
      <uri>https://www.cambridge.org/core/product/identifier/S0954422497000103/type/journal_article</uri>
      <pub-id pub-id-type="doi">10.1079/NRR19970009</pub-id>
      <fpage>151</fpage>
      <lpage>179</lpage>
    </element-citation>
  </ref>
  <ref id="ref-schade_stoichiometric_2003-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schade</surname><given-names>John D.</given-names></name>
        <name><surname>Kyle</surname><given-names>Marcia</given-names></name>
        <name><surname>Hobbie</surname><given-names>S. E.</given-names></name>
        <name><surname>Fagan</surname><given-names>W. F.</given-names></name>
        <name><surname>Elser</surname><given-names>J. J.</given-names></name>
      </person-group>
      <article-title>Stoichiometric tracking of soil nutrients by a desert insect herbivore</article-title>
      <source>Ecology Letters</source>
      <year iso-8601-date="2003-02">2003</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>6</volume>
      <issue>2</issue>
      <issn>1461-023X, 1461-0248</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1046/j.1461-0248.2003.00409.x</uri>
      <pub-id pub-id-type="doi">10.1046/j.1461-0248.2003.00409.x</pub-id>
      <fpage>96</fpage>
      <lpage>101</lpage>
    </element-citation>
  </ref>
  <ref id="ref-simpson_compensation_1985-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Simpson</surname><given-names>S. J.</given-names></name>
        <name><surname>Abisgold</surname><given-names>J. D.</given-names></name>
      </person-group>
      <article-title>Compensation by locusts for changes in dietary nutrients: Behavioural mechanisms</article-title>
      <source>Physiological Entomology</source>
      <year iso-8601-date="1985-12">1985</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>10</volume>
      <issue>4</issue>
      <issn>0307-6962, 1365-3032</issn>
      <uri>https://resjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-3032.1985.tb00066.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-3032.1985.tb00066.x</pub-id>
      <fpage>443</fpage>
      <lpage>452</lpage>
    </element-citation>
  </ref>
  <ref id="ref-simpson_nature_2012-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <source>The Nature of Nutrition: A Unifying Framework from Animal Adaptation to Human Obesity</source>
      <publisher-name>Princeton University Press</publisher-name>
      <year iso-8601-date="2012-07">2012</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <edition>1</edition>
      <isbn>978-0-691-14565-5 978-1-4008-4280-3</isbn>
      <uri>https://academic.oup.com/princeton-scholarship-online/book/23993</uri>
      <pub-id pub-id-type="doi">10.23943/princeton/9780691145655.001.0001</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-talal_high_2021-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne</given-names></name>
        <name><surname>Farington</surname><given-names>Ruth</given-names></name>
        <name><surname>Medina</surname><given-names>Hector E.</given-names></name>
        <name><surname>Rojas</surname><given-names>Julio</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon</given-names></name>
      </person-group>
      <article-title>High carbohydrate diet ingestion increases post-meal lipid synthesis and drives respiratory exchange ratios above 1</article-title>
      <source>Journal of Experimental Biology</source>
      <year iso-8601-date="2021-02">2021</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>224</volume>
      <issue>4</issue>
      <issn>0022-0949, 1477-9145</issn>
      <uri>https://journals.biologists.com/jeb/article/224/4/jeb240010/237230/High-carbohydrate-diet-ingestion-increases-post</uri>
      <pub-id pub-id-type="doi">10.1242/jeb.240010</pub-id>
      <fpage>jeb240010</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-talal_plant_2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Youngblood</surname><given-names>Jacob P.</given-names></name>
        <name><surname>Farington</surname><given-names>Ruth</given-names></name>
        <name><surname>Trumper</surname><given-names>Eduardo V.</given-names></name>
        <name><surname>Medina</surname><given-names>Hector E.</given-names></name>
        <name><surname>Rojas</surname><given-names>Julio E.</given-names></name>
        <name><surname>Fernando Copa</surname><given-names>A.</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
      </person-group>
      <article-title>Plant carbohydrate content limits performance and lipid accumulation of an outbreaking herbivore</article-title>
      <source>Proceedings of the Royal Society B: Biological Sciences</source>
      <year iso-8601-date="2020-12">2020</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>287</volume>
      <issue>1940</issue>
      <issn>0962-8452, 1471-2954</issn>
      <uri>https://royalsocietypublishing.org/doi/10.1098/rspb.2020.2500</uri>
      <pub-id pub-id-type="doi">10.1098/rspb.2020.2500</pub-id>
      <fpage>20202500</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-talal_body_2023-nb-article">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Talal</surname><given-names>Stav</given-names></name>
        <name><surname>Harrison</surname><given-names>Jon F.</given-names></name>
        <name><surname>Farington</surname><given-names>Ruth</given-names></name>
        <name><surname>Youngblood</surname><given-names>Jacob P.</given-names></name>
        <name><surname>Medina</surname><given-names>Hector E.</given-names></name>
        <name><surname>Overson</surname><given-names>Rick</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Body mass and growth rates predict protein intake across animals</article-title>
      <year iso-8601-date="2023-06">2023</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <uri>http://biorxiv.org/lookup/doi/10.1101/2023.06.20.545784</uri>
      <pub-id pub-id-type="doi">10.1101/2023.06.20.545784</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-tyrrell_relative_1999-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tyrrell</surname><given-names>Toby</given-names></name>
      </person-group>
      <article-title>The relative influences of nitrogen and phosphorus on oceanic primary production</article-title>
      <source>Nature</source>
      <year iso-8601-date="1999-08">1999</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>400</volume>
      <issue>6744</issue>
      <issn>0028-0836, 1476-4687</issn>
      <uri>https://www.nature.com/articles/22941</uri>
      <pub-id pub-id-type="doi">10.1038/22941</pub-id>
      <fpage>525</fpage>
      <lpage>531</lpage>
    </element-citation>
  </ref>
  <ref id="ref-uvarov_grasshoppers_1977-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Uvarov</surname><given-names>Boris Petrovič</given-names></name>
      </person-group>
      <source>Grasshoppers and locusts. 2: Behaviour, ecology, biogeography population dynamics</source>
      <publisher-name>Univ. Press</publisher-name>
      <publisher-loc>Cambridge</publisher-loc>
      <year iso-8601-date="1977">1977</year>
      <isbn>978-0-85135-072-1</isbn>
    </element-citation>
  </ref>
  <ref id="ref-veran_modeling_2015-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Veran</surname><given-names>Sophie</given-names></name>
        <name><surname>Simpson</surname><given-names>Stephen J.</given-names></name>
        <name><surname>Sword</surname><given-names>Gregory A.</given-names></name>
        <name><surname>Deveson</surname><given-names>Edward</given-names></name>
        <name><surname>Piry</surname><given-names>Sylvain</given-names></name>
        <name><surname>Hines</surname><given-names>James E.</given-names></name>
        <name><surname>Berthier</surname><given-names>Karine</given-names></name>
      </person-group>
      <article-title>Modeling spatiotemporal dynamics of outbreaking species: Influence of environment and migration in a locust</article-title>
      <source>Ecology</source>
      <year iso-8601-date="2015-03">2015</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>96</volume>
      <issue>3</issue>
      <issn>0012-9658, 1939-9170</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/14-0183.1</uri>
      <pub-id pub-id-type="doi">10.1890/14-0183.1</pub-id>
      <fpage>737</fpage>
      <lpage>748</lpage>
    </element-citation>
  </ref>
  <ref id="ref-vitousek_terrestrial_2010-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vitousek</surname><given-names>Peter M.</given-names></name>
        <name><surname>Porder</surname><given-names>Stephen</given-names></name>
        <name><surname>Houlton</surname><given-names>Benjamin Z.</given-names></name>
        <name><surname>Chadwick</surname><given-names>Oliver A.</given-names></name>
      </person-group>
      <article-title>Terrestrial phosphorus limitation: Mechanisms, implications, and nitrogen–phosphorus interactions</article-title>
      <source>Ecological Applications</source>
      <year iso-8601-date="2010-01">2010</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>20</volume>
      <issue>1</issue>
      <issn>1051-0761, 1939-5582</issn>
      <uri>https://esajournals.onlinelibrary.wiley.com/doi/10.1890/08-0127.1</uri>
      <pub-id pub-id-type="doi">10.1890/08-0127.1</pub-id>
      <fpage>5</fpage>
      <lpage>15</lpage>
    </element-citation>
  </ref>
  <ref id="ref-welti_bottomup_2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Welti</surname><given-names>Ellen A. R.</given-names></name>
        <name><surname>Prather</surname><given-names>Rebecca M.</given-names></name>
        <name><surname>Sanders</surname><given-names>Nathan J.</given-names></name>
        <name><surname>De Beurs</surname><given-names>Kirsten M.</given-names></name>
        <name><surname>Kaspari</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Bottom‐up when it is not top‐down: Predators and plants control biomass of grassland arthropods</article-title>
      <source>Journal of Animal Ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Morris</surname><given-names>Rebecca</given-names></name>
      </person-group>
      <year iso-8601-date="2020-05">2020</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>89</volume>
      <issue>5</issue>
      <issn>0021-8790, 1365-2656</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2656.13191</uri>
      <pub-id pub-id-type="doi">10.1111/1365-2656.13191</pub-id>
      <fpage>1286</fpage>
      <lpage>1294</lpage>
    </element-citation>
  </ref>
  <ref id="ref-welti_nutrient_2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Welti</surname><given-names>Ellen A. R.</given-names></name>
        <name><surname>Roeder</surname><given-names>Karl A.</given-names></name>
        <name><surname>De Beurs</surname><given-names>Kirsten M.</given-names></name>
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
        <name><surname>Kaspari</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Nutrient dilution and climate cycles underlie declines in a dominant insect herbivore</article-title>
      <source>Proceedings of the National Academy of Sciences</source>
      <year iso-8601-date="2020-03">2020</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>117</volume>
      <issue>13</issue>
      <issn>0027-8424, 1091-6490</issn>
      <uri>https://pnas.org/doi/full/10.1073/pnas.1920012117</uri>
      <pub-id pub-id-type="doi">10.1073/pnas.1920012117</pub-id>
      <fpage>7271</fpage>
      <lpage>7275</lpage>
    </element-citation>
  </ref>
  <ref id="ref-white_importance_1978-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>White</surname><given-names>T. C. R.</given-names></name>
      </person-group>
      <article-title>The importance of a relative shortage of food in animal ecology</article-title>
      <source>Oecologia</source>
      <year iso-8601-date="1978">1978</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>33</volume>
      <issue>1</issue>
      <issn>0029-8549, 1432-1939</issn>
      <uri>http://link.springer.com/10.1007/BF00376997</uri>
      <pub-id pub-id-type="doi">10.1007/BF00376997</pub-id>
      <fpage>71</fpage>
      <lpage>86</lpage>
    </element-citation>
  </ref>
  <ref id="ref-white_inadequate_1993-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>White</surname><given-names>Thomas C. R.</given-names></name>
      </person-group>
      <source>The Inadequate Environment</source>
      <publisher-name>Springer Berlin Heidelberg</publisher-name>
      <publisher-loc>Berlin, Heidelberg</publisher-loc>
      <year iso-8601-date="1993">1993</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <isbn>978-3-642-78301-2 978-3-642-78299-2</isbn>
      <uri>http://link.springer.com/10.1007/978-3-642-78299-2</uri>
      <pub-id pub-id-type="doi">10.1007/978-3-642-78299-2</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-white_role_2008-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>White</surname><given-names>T. C. R.</given-names></name>
      </person-group>
      <article-title>The role of food, weather and climate in limiting the abundance of animals</article-title>
      <source>Biological Reviews</source>
      <year iso-8601-date="2008-08">2008</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>83</volume>
      <issue>3</issue>
      <issn>1464-7931, 1469-185X</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1469-185X.2008.00041.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1469-185X.2008.00041.x</pub-id>
      <fpage>227</fpage>
      <lpage>248</lpage>
    </element-citation>
  </ref>
  <ref id="ref-whitford_ecology_2002-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Whitford</surname><given-names>W. G.</given-names></name>
      </person-group>
      <source>Ecology of desert systems</source>
      <publisher-name>Academic Press</publisher-name>
      <publisher-loc>San Diego</publisher-loc>
      <year iso-8601-date="2002">2002</year>
      <isbn>978-0-12-747261-4</isbn>
    </element-citation>
  </ref>
  <ref id="ref-wiens_spatial_1989-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wiens</surname><given-names>J. A.</given-names></name>
      </person-group>
      <article-title>Spatial Scaling in Ecology</article-title>
      <source>Functional Ecology</source>
      <year iso-8601-date="1989">1989</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>3</volume>
      <issue>4</issue>
      <issn>02698463</issn>
      <uri>https://www.jstor.org/stable/2389612?origin=crossref</uri>
      <pub-id pub-id-type="doi">10.2307/2389612</pub-id>
      <fpage>385</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wilson_dietary_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wilson</surname><given-names>J. Keaton</given-names></name>
        <name><surname>Ruiz</surname><given-names>L.</given-names></name>
        <name><surname>Davidowitz</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>Dietary Protein and Carbohydrates Affect Immune Function and Performance in a Specialist Herbivore Insect ( Manduca sexta )</article-title>
      <source>Physiological and Biochemical Zoology</source>
      <year iso-8601-date="2019-01">2019</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>92</volume>
      <issue>1</issue>
      <issn>1522-2152, 1537-5293</issn>
      <uri>https://www.journals.uchicago.edu/doi/10.1086/701196</uri>
      <pub-id pub-id-type="doi">10.1086/701196</pub-id>
      <fpage>58</fpage>
      <lpage>70</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wilson_nutritional_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wilson</surname><given-names>Jerome Keaton</given-names></name>
        <name><surname>Ruiz</surname><given-names>Laura</given-names></name>
        <name><surname>Duarte</surname><given-names>Jesse</given-names></name>
        <name><surname>Davidowitz</surname><given-names>Goggy</given-names></name>
      </person-group>
      <article-title>The nutritional landscape of host plants for a specialist insect herbivore</article-title>
      <source>Ecology and Evolution</source>
      <year iso-8601-date="2019-12">2019</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>23</issue>
      <issn>2045-7758, 2045-7758</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1002/ece3.5730</uri>
      <pub-id pub-id-type="doi">10.1002/ece3.5730</pub-id>
      <fpage>13104</fpage>
      <lpage>13113</lpage>
    </element-citation>
  </ref>
  <ref id="ref-word_soil-targeted_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Word</surname><given-names>Mira L.</given-names></name>
        <name><surname>Hall</surname><given-names>Sharon J.</given-names></name>
        <name><surname>Robinson</surname><given-names>Brian E.</given-names></name>
        <name><surname>Manneh</surname><given-names>Balanding</given-names></name>
        <name><surname>Beye</surname><given-names>Alioune</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
      </person-group>
      <article-title>Soil-targeted interventions could alleviate locust and grasshopper pest pressure in West Africa</article-title>
      <source>Science of The Total Environment</source>
      <year iso-8601-date="2019-05">2019</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>663</volume>
      <issn>00489697</issn>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0048969719303560</uri>
      <pub-id pub-id-type="doi">10.1016/j.scitotenv.2019.01.313</pub-id>
      <fpage>632</fpage>
      <lpage>643</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhang_grasshoppers_2014-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Zijia</given-names></name>
        <name><surname>Elser</surname><given-names>James J.</given-names></name>
        <name><surname>Cease</surname><given-names>Arianne J.</given-names></name>
        <name><surname>Zhang</surname><given-names>Ximei</given-names></name>
        <name><surname>Yu</surname><given-names>Qiang</given-names></name>
        <name><surname>Han</surname><given-names>Xingguo</given-names></name>
        <name><surname>Zhang</surname><given-names>Guangming</given-names></name>
      </person-group>
      <article-title>Grasshoppers Regulate N:P Stoichiometric Homeostasis by Changing Phosphorus Contents in Their Frass</article-title>
      <source>PLoS ONE</source>
      <person-group person-group-type="editor">
        <name><surname>Wicker-Thomas</surname><given-names>Claude</given-names></name>
      </person-group>
      <year iso-8601-date="2014-08">2014</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>9</volume>
      <issue>8</issue>
      <issn>1932-6203</issn>
      <uri>https://dx.plos.org/10.1371/journal.pone.0103697</uri>
      <pub-id pub-id-type="doi">10.1371/journal.pone.0103697</pub-id>
      <fpage>e103697</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhou_increased_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhou</surname><given-names>Xiaolong</given-names></name>
        <name><surname>Liu</surname><given-names>Xudong</given-names></name>
        <name><surname>Zhang</surname><given-names>Pengfei</given-names></name>
        <name><surname>Guo</surname><given-names>Zhi</given-names></name>
        <name><surname>Du</surname><given-names>Guozhen</given-names></name>
      </person-group>
      <article-title>Increased community compositional dissimilarity alleviates species loss following nutrient enrichment at large spatial scales</article-title>
      <source>Journal of Plant Ecology</source>
      <year iso-8601-date="2019-03">2019</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>12</volume>
      <issue>2</issue>
      <issn>1752-993X</issn>
      <uri>https://academic.oup.com/jpe/article/12/2/376/5096732</uri>
      <pub-id pub-id-type="doi">10.1093/jpe/rty035</pub-id>
      <fpage>376</fpage>
      <lpage>386</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhu_effects_2020-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhu</surname><given-names>Hui</given-names></name>
        <name><surname>Nkurunziza</surname><given-names>Venuste</given-names></name>
        <name><surname>Wang</surname><given-names>Jingting</given-names></name>
        <name><surname>Guo</surname><given-names>Qinfeng</given-names></name>
        <name><surname>Ruan</surname><given-names>Hang</given-names></name>
        <name><surname>Wang</surname><given-names>Deli</given-names></name>
      </person-group>
      <article-title>Effects of large herbivore grazing on grasshopper behaviour and abundance in a meadow steppe</article-title>
      <source>Ecological Entomology</source>
      <year iso-8601-date="2020-12">2020</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>45</volume>
      <issue>6</issue>
      <issn>0307-6946, 1365-2311</issn>
      <uri>https://resjournals.onlinelibrary.wiley.com/doi/10.1111/een.12919</uri>
      <pub-id pub-id-type="doi">10.1111/een.12919</pub-id>
      <fpage>1357</fpage>
      <lpage>1366</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhu_negative_2019-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhu</surname><given-names>Yu</given-names></name>
        <name><surname>Zhong</surname><given-names>Zhiwei</given-names></name>
        <name><surname>Pagès</surname><given-names>Jordi F.</given-names></name>
        <name><surname>Finke</surname><given-names>Deborah</given-names></name>
        <name><surname>Wang</surname><given-names>Deli</given-names></name>
        <name><surname>Ma</surname><given-names>Quanhui</given-names></name>
        <name><surname>Hassan</surname><given-names>Nazim</given-names></name>
        <name><surname>Zhu</surname><given-names>Hui</given-names></name>
        <name><surname>Wang</surname><given-names>Ling</given-names></name>
      </person-group>
      <article-title>Negative effects of vertebrate on invertebrate herbivores mediated by enhanced plant nitrogen content</article-title>
      <source>Journal of Ecology</source>
      <person-group person-group-type="editor">
        <name><surname>Chapman</surname><given-names>Samantha</given-names></name>
      </person-group>
      <year iso-8601-date="2019-03">2019</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-09-08">2024</year><month>09</month><day>08</day></date-in-citation>
      <volume>107</volume>
      <issue>2</issue>
      <issn>0022-0477, 1365-2745</issn>
      <uri>https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2745.13100</uri>
      <pub-id pub-id-type="doi">10.1111/1365-2745.13100</pub-id>
      <fpage>901</fpage>
      <lpage>912</lpage>
    </element-citation>
  </ref>
  <ref id="ref-simpson2012-nb-article">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Simpson</surname><given-names>Stephen J</given-names></name>
        <name><surname>Raubenheimer</surname><given-names>David</given-names></name>
      </person-group>
      <source>The nature of nutrition: A unifying framework from animal adaptation to human obesity</source>
      <publisher-name>Princeton university press</publisher-name>
      <year iso-8601-date="2012">2012</year>
    </element-citation>
  </ref>
  <ref id="ref-loaiza2011-nb-article">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Loaiza</surname><given-names>Viviana</given-names></name>
        <name><surname>Jonas</surname><given-names>Jayne L.</given-names></name>
        <name><surname>Joern</surname><given-names>Anthony</given-names></name>
      </person-group>
      <article-title>Grasshoppers (Orthoptera: Acrididae) select vegetation patches in local-scale responses to foliar nitrogen but not phosphorus in native grassland: Grasshopper distribution and food quality</article-title>
      <source>Insect Science</source>
      <year iso-8601-date="2011-10">2011</year><month>10</month>
      <volume>18</volume>
      <issue>5</issue>
      <uri>https://onlinelibrary.wiley.com/doi/10.1111/j.1744-7917.2010.01376.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1744-7917.2010.01376.x</pub-id>
      <fpage>533</fpage>
      <lpage>540</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-3-nb-1">
<front-stub>
<title-group>
<article-title>Field cage nutrient analysis – Plant
nutrients</article-title>
</title-group>
</front-stub>

<body>
<sec id="cell-11fc5c0b-572c-491f-8620-463babfb2c2c-nb-1" specific-use="notebook-content">
<p>This script analyzes the grass nutrient contents (protein and
carbohydrates) for field cages</p>
<p>Please see manuscript for specific methodology.</p>
<p>This script does the following:</p>
<list list-type="order">
  <list-item>
    <label>1)</label>
    <p>analyzes differences between fertilization treatment and grass
    protein/carbohydrate content</p>
  </list-item>
  <list-item>
    <label>2)</label>
    <p>analyzes plant species and soil composition differences by
    fertilization treatment</p>
  </list-item>
  <list-item>
    <label>3)</label>
    <p>analyze plant content content with soil nitrogen content</p>
  </list-item>
  <list-item>
    <label>4)</label>
    <p>analyzes plant ground cover differences by fertilization
    treatment</p>
  </list-item>
</list>
<p>Manuscript figure preparation happens in the
<monospace>03_field_cages_intake_target_mauscript_figure_code.ipynb</monospace>
file</p>
</sec>
<sec id="cell-32b185d2-a3a2-4895-b064-e7c762312abe-nb-1" specific-use="notebook-content">
<code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;mgcv&quot;, &quot;MuMIn&quot;, &quot;multcomp&quot;, &quot;gratia&quot;, 
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;broom&quot;, &quot;knitr&quot;, &quot;janitor&quot;, 
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;GGally&quot;,&quot;tidyverse&quot;)

load_packages(packages)

i_am('README.md')

# Functions
                   
## Standard error
std &lt;- function(x) sd(x)/sqrt(length(x))


# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10,repr.matrix.max.rows=10)
</code>
<boxed-text>
  <preformat>here() starts at /home/datascience/herbivore_nutrient_interactions
  </preformat>
</boxed-text>
</sec>
<sec id="a83d6bca-a242-4b32-99f3-64380684b4db-nb-1" specific-use="notebook-content">
<sec id="section-1---plant-nutrients-over-time-by-fertilization-treatment-nb-1">
  <title>Section 1 - Plant nutrients over time by fertilization
  treatment</title>
  <sec id="read-in-data-nb-1">
    <title>read in data</title>
    </sec>
    <sec id="bd287563-6036-4f5b-a9fb-ed5773c113d8-nb-1" specific-use="notebook-content">
    <code language="r script">plant_nutrients &lt;- read_csv(here('data/raw/field_cage_experiment/Field_Cage_Nutrients_Through_Time.csv'),show_col_types = FALSE) |&gt;
    clean_names() |&gt;
    select(x1,plot,cage,treatment,species,chn_weight_mg,c_mg_mg,n_mg_mg,protein_mg_mg,carb_mg_mg,carb_prot_ratio) |&gt;
    rename(date = x1) |&gt;
    mutate(date = parse_date_time(date,orders='mdy'),
        across(c(date,plot,cage,treatment,species),~as.factor(.)),
        treatment = fct_recode(treatment, &quot;None&quot; = &quot;0&quot;, &quot;Medium&quot; = &quot;M&quot;, &quot;High&quot; = &quot;H&quot;,
                                &quot;None&quot; = '1', &quot;Medium&quot; = &quot;2&quot;, &quot;High&quot; = &quot;3&quot;),
        plot_cage = factor(paste0(plot,&quot;_&quot;,cage)))

plant_nutrients</code>
    <boxed-text>
      <preformat>New names:
• `` -&gt; `...1`</preformat>
    </boxed-text>
    <boxed-text>
      <p>A tibble: 168 × 12</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
          </colgroup>
          <thead>
            <tr>
              <th>date &lt;fct&gt;</th>
              <th>plot &lt;fct&gt;</th>
              <th>cage &lt;fct&gt;</th>
              <th>treatment &lt;fct&gt;</th>
              <th>species &lt;fct&gt;</th>
              <th>chn_weight_mg &lt;dbl&gt;</th>
              <th>c_mg_mg &lt;dbl&gt;</th>
              <th>n_mg_mg &lt;dbl&gt;</th>
              <th>protein_mg_mg &lt;dbl&gt;</th>
              <th>carb_mg_mg &lt;dbl&gt;</th>
              <th>carb_prot_ratio &lt;dbl&gt;</th>
              <th>plot_cage &lt;fct&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>2015-12-01</td>
              <td>0-1</td>
              <td>5</td>
              <td>None</td>
              <td>Nutgrass</td>
              <td>2.112</td>
              <td>0.40997</td>
              <td>0.02689</td>
              <td>0.1361</td>
              <td>0.120</td>
              <td>0.8816132</td>
              <td>0-1_5</td>
            </tr>
            <tr>
              <td>2015-12-01</td>
              <td>0-1</td>
              <td>5</td>
              <td>None</td>
              <td>Wallaby</td>
              <td>2.818</td>
              <td>0.41875</td>
              <td>0.02299</td>
              <td>0.1410</td>
              <td>0.105</td>
              <td>0.7448132</td>
              <td>0-1_5</td>
            </tr>
            <tr>
              <td>2015-12-01</td>
              <td>0-1</td>
              <td>5</td>
              <td>None</td>
              <td>Plaspladium</td>
              <td>2.170</td>
              <td>0.39406</td>
              <td>0.03146</td>
              <td>0.1509</td>
              <td>0.096</td>
              <td>0.6360841</td>
              <td>0-1_5</td>
            </tr>
            <tr>
              <td>2015-12-01</td>
              <td>0-1</td>
              <td>6</td>
              <td>None</td>
              <td>Enteropogon</td>
              <td>2.325</td>
              <td>0.40071</td>
              <td>0.02328</td>
              <td>0.0713</td>
              <td>0.171</td>
              <td>2.3998638</td>
              <td>0-1_6</td>
            </tr>
            <tr>
              <td>2015-12-01</td>
              <td>0-1</td>
              <td>6</td>
              <td>None</td>
              <td>Nutgrass</td>
              <td>2.244</td>
              <td>0.39387</td>
              <td>0.02247</td>
              <td>0.1334</td>
              <td>0.120</td>
              <td>0.8993145</td>
              <td>0-1_6</td>
            </tr>
            <tr>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
            </tr>
            <tr>
              <td>2015-11-11</td>
              <td>H-2</td>
              <td>Ext</td>
              <td>High</td>
              <td>Wallaby</td>
              <td>2.051</td>
              <td>0.42581</td>
              <td>0.02388</td>
              <td>0.2224</td>
              <td>0.131</td>
              <td>0.5890989</td>
              <td>H-2_Ext</td>
            </tr>
            <tr>
              <td>2015-11-11</td>
              <td>H-2</td>
              <td>Ext</td>
              <td>High</td>
              <td>Enteropogon</td>
              <td>2.377</td>
              <td>0.42864</td>
              <td>0.02832</td>
              <td>0.2202</td>
              <td>0.118</td>
              <td>0.5358819</td>
              <td>H-2_Ext</td>
            </tr>
            <tr>
              <td>2015-11-11</td>
              <td>H-3</td>
              <td>Ext</td>
              <td>High</td>
              <td>Nutgrass</td>
              <td>2.207</td>
              <td>0.42253</td>
              <td>0.02804</td>
              <td>0.2603</td>
              <td>0.120</td>
              <td>0.4610205</td>
              <td>H-3_Ext</td>
            </tr>
            <tr>
              <td>2015-11-11</td>
              <td>H-3</td>
              <td>Ext</td>
              <td>High</td>
              <td>Wallaby</td>
              <td>2.115</td>
              <td>0.41685</td>
              <td>0.02163</td>
              <td>0.2460</td>
              <td>0.124</td>
              <td>0.5041425</td>
              <td>H-3_Ext</td>
            </tr>
            <tr>
              <td>2015-11-11</td>
              <td>H-3</td>
              <td>Ext</td>
              <td>High</td>
              <td>Enteropogon</td>
              <td>2.237</td>
              <td>0.41712</td>
              <td>0.03325</td>
              <td>0.2093</td>
              <td>0.116</td>
              <td>0.5541557</td>
              <td>H-3_Ext</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-41491470-522e-4b0f-92dd-4c90ed5a77cb-nb-1" specific-use="notebook-content">
  </sec>
  <sec id="raw-data-visualization-nb-1">
    <title>Raw data visualization</title>
    <p>using ggpairs to be pithy..</p>
    </sec>
    <sec id="cb444ca0-e179-4e31-96a0-be3235a9ec5e-nb-1" specific-use="notebook-content">
    <code language="r script">numeric_columns &lt;- c(&quot;chn_weight_mg&quot;, &quot;c_mg_mg&quot;, &quot;n_mg_mg&quot;,&quot;protein_mg_mg&quot;,&quot;carb_mg_mg&quot;)
factor_columns &lt;- c('date','plot','treatment','species')

my_dens &lt;- function(data, mapping,...) {
  ggplot(data = data, mapping=mapping) +
    geom_density(..., alpha = 0.7, fill = NA) 
}


date_raw_graph &lt;- plant_nutrients |&gt;
    dplyr::select(!c(plot_cage,cage)) |&gt;
    ggpairs(aes(color=date),columns = numeric_columns,diag = list(continuous = my_dens))  +
    MetBrewer::scale_color_met_d(name='Kandinsky') +
    theme_pubr()

plot_raw_graph &lt;- plant_nutrients |&gt;
    dplyr::select(!c(plot_cage,cage)) |&gt;
    ggpairs(aes(color=plot),columns = numeric_columns,diag = list(continuous = my_dens))  +
    MetBrewer::scale_color_met_d(name='Homer1') +
    theme_pubr()

treatment_raw_graph &lt;- plant_nutrients |&gt;
    dplyr::select(!c(plot_cage,cage)) |&gt;
    ggpairs(aes(color=treatment),columns = numeric_columns,diag = list(continuous = my_dens))  +
    MetBrewer::scale_color_met_d(name='Derain') +
    theme_pubr()
    </code>
    </sec>
    <sec id="cell-6ae6ac60-fd83-4695-8ace-8a817c6dc75a-nb-1" specific-use="notebook-content">
    <code language="r script"># Define the output directory
output_dir &lt;- here('output/field_cage_experiment/raw_visualization/')

# List of plots and their corresponding file names
plots &lt;- list(
  &quot;plant_nutrients_date_raw_graph&quot; = date_raw_graph,
  &quot;plant_nutrients_plot_raw_graph&quot; = plot_raw_graph,
  &quot;plant_nutrients_treatment_raw_graph&quot; = treatment_raw_graph
)

# Loop through each plot and save it
for (name in names(plots)) {
  ggsave(
    filename = file.path(output_dir, paste0(name, &quot;.png&quot;)),
    plot = plots[[name]],
    width = 10, height = 10, dpi = 300
  )
}</code>
    <boxed-text>
      <preformat>Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_point()`).”</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-293c3e0d-3b37-4bec-90f0-224ee3b35098-nb-1" specific-use="notebook-content">
  </sec>
  <sec id="modeling-overview-nb-1">
    <title>Modeling Overview</title>
    <p>In this analysis, we are evaluating four Generalized Additive
    Models (GAMs) to understand the effects of fertilizer treatment and
    date on plant protein and carbohydrate content. Each model differs
    in the complexity of its random effects structure. Here is a summary
    of each model:</p>
    <sec id="model-1-full-model-with-cross-and-nested-random-effects-nb-1">
      <title>Model 1: Full Model with Cross and Nested Random
      Effects</title>
      <list list-type="bullet">
        <list-item>
          <p><bold>Fixed Effects</bold>: Includes
          <monospace>treatment</monospace> and
          <monospace>date</monospace>, as well as their interaction
          (<monospace>treatment * date</monospace>).</p>
        </list-item>
        <list-item>
          <p><bold>Random Effects</bold>:</p>
          <list list-type="bullet">
            <list-item>
              <p><monospace>s(species, bs=&quot;re&quot;)</monospace>:
              Random effect for different grass species.</p>
            </list-item>
            <list-item>
              <p><monospace>s(plot_cage, bs=&quot;re&quot;)</monospace>:
              Random effect for spatial positioning within plot
              cages.</p>
            </list-item>
          </list>
        </list-item>
        <list-item>
          <p><bold>Purpose</bold>: This model captures both the fixed
          effects of treatment and date, along with random variations
          across species and spatial positions, providing a
          comprehensive view of the variability in plant nutrient
          content.</p>
        </list-item>
      </list>
    </sec>
    <sec id="model-2-removed-spatial-nested-random-effect-nb-1">
      <title>Model 2: Removed Spatial Nested Random Effect</title>
      <list list-type="bullet">
        <list-item>
          <p><bold>Fixed Effects</bold>: Same as Model 1, including
          <monospace>treatment</monospace>, <monospace>date</monospace>,
          and their interaction.</p>
        </list-item>
        <list-item>
          <p><bold>Random Effects</bold>:</p>
          <list list-type="bullet">
            <list-item>
              <p><monospace>s(species, bs=&quot;re&quot;)</monospace>:
              Random effect for different grass species.</p>
            </list-item>
          </list>
        </list-item>
        <list-item>
          <p><bold>Purpose</bold>: This model simplifies the random
          effects structure by excluding the spatial random effect
          (<monospace>plot_cage</monospace>). It helps to assess how
          removing the spatial component affects the fit and
          interpretation of the model.</p>
        </list-item>
      </list>
    </sec>
    <sec id="model-3-no-random-effects-of-grass-species-and-spatial-positioning-nb-1">
      <title>Model 3: No Random Effects of Grass Species and Spatial
      Positioning</title>
      <list list-type="bullet">
        <list-item>
          <p><bold>Fixed Effects</bold>: Includes
          <monospace>treatment</monospace> and
          <monospace>date</monospace>, with their interaction.</p>
        </list-item>
        <list-item>
          <p><bold>Random Effects</bold>: None.</p>
        </list-item>
        <list-item>
          <p><bold>Purpose</bold>: This model serves as a baseline by
          including only the fixed effects and excluding all random
          effects. It provides a straightforward view of the impact of
          treatment and date on nutrient content without accounting for
          variability due to species or spatial positioning.</p>
        </list-item>
      </list>
    </sec>
    <sec id="model-4-intercept-only-model-nb-1">
      <title>Model 4: Intercept Only Model</title>
      <list list-type="bullet">
        <list-item>
          <p><bold>Fixed Effects</bold>: Only includes an intercept
          term.</p>
        </list-item>
        <list-item>
          <p><bold>Random Effects</bold>: None.</p>
        </list-item>
        <list-item>
          <p><bold>Purpose</bold>: This model acts as a null model or
          intercept-only model. It estimates the overall mean of the
          response variables (<monospace>carb_mg_mg</monospace> and
          <monospace>protein_mg_mg</monospace>) without considering any
          predictors. This model helps in understanding the baseline
          level of nutrient content.</p>
        </list-item>
      </list>
    </sec>
    <sec id="summary-nb-1">
      <title>Summary</title>
      <p>By comparing these models, we aim to understand how different
      levels of model complexity (in terms of random effects) impact the
      fit and interpretation of our GAMs. The results from these models
      will help us identify the most appropriate model structure for
      explaining variations in plant protein and carbohydrate
      content</p>
      </sec>
      <sec id="cell-880cbb75-0b07-456d-8ee8-c164e7c88db8-nb-1" specific-use="notebook-content">
      <code language="r script">
# model 1: full model with species, plot, and cage random effects
mod1 &lt;- gam(list(
  carb_mg_mg ~ treatment * date + s(species,bs=&quot;re&quot;) + s(plot,bs=&quot;re&quot;) + s(cage,bs=&quot;re&quot;),
  protein_mg_mg ~ treatment * date + s(species,bs=&quot;re&quot;) + s(plot,bs=&quot;re&quot;) + s(cage,bs=&quot;re&quot;)),
  family=mvn(d=2),select=TRUE, data=plant_nutrients
)


# model 2: full model with species and plot random effects
mod2 &lt;- gam(list(
  carb_mg_mg ~ treatment * date + s(species,bs=&quot;re&quot;) + s(plot,bs=&quot;re&quot;),
  protein_mg_mg ~ treatment * date + s(species,bs=&quot;re&quot;) + s(plot,bs=&quot;re&quot;)),
  family=mvn(d=2),select=TRUE, data=plant_nutrients
)



# model 3: removed spatial nested random effect
mod3 &lt;- gam(list(
  carb_mg_mg ~ treatment * date + s(species,bs=&quot;re&quot;),
  protein_mg_mg ~ treatment * date + s(species,bs=&quot;re&quot;)),
  family=mvn(d=2),select=TRUE, data=plant_nutrients
)

# model 4: no random effects of grass species and spatial positioning
mod4 &lt;- gam(list(
  carb_mg_mg ~ treatment * date,
  protein_mg_mg ~ treatment * date),
  family=mvn(d=2),select=TRUE, data=plant_nutrients
)

# model 5: intercept only model
mod5 &lt;- gam(list(
  carb_mg_mg ~ 1,
  protein_mg_mg ~ 1),
  family=mvn(d=2),select=TRUE, data=plant_nutrients
)</code>
      </sec>
      <sec id="cell-4ffe7e4c-a958-42cf-8169-25e8bd347caf-nb-1" specific-use="notebook-content">
    </sec>
  </sec>
  <sec id="model-diagnostics-nb-1">
    <title>Model Diagnostics</title>
    <p>To see how well these models fit, I will run
    <monospace>mgcv::gam.check()</monospace> on it</p>
    </sec>
    <sec id="cell-7435316b-f9cb-4c6e-b8f7-c17d12f4bde1-nb-1" specific-use="notebook-content">
    <code language="r script">gam.check(mod1)</code>
    <boxed-text>
      <preformat>
Method: REML   Optimizer: outer newton
full convergence after 21 iterations.
Gradient range [-0.0003103183,0.0006675309]
(score -1038.257 &amp; scale 1).
Hessian positive definite, eigenvalue range [0.04610883,3.930483].
Model rank =  127 / 127 

Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
indicate that k is too low, especially if edf is close to k'.

                k'   edf k-index p-value
s(species)    7.00  4.32      NA      NA
s(plot)       9.00  1.07      NA      NA
s(cage)      37.00  2.50      NA      NA
s.1(species)  7.00  5.02      NA      NA
s.1(plot)     9.00  7.42      NA      NA
s.1(cage)    37.00 13.88      NA      NA</preformat>
    </boxed-text>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="01_field_cages_plant_nutrient_analyses_files/figure-jats/cell-7-output-2.png" />
    </boxed-text>
    </sec>
    <sec id="cell-16fdf5a5-7806-4040-8910-9f654dceafab-nb-1" specific-use="notebook-content">
    <p>These diagnostic plots indicate these models are pretty well
    fit.</p>
    <p>there is some discernable relationship in the variance plot, but
    it could be worse</p>
  </sec>
  <sec id="model-selection-criteria-nb-1">
    <title>Model selection criteria</title>
    </sec>
    <sec id="cell-79d95108-b803-44ed-9670-76334e545a68-nb-1" specific-use="notebook-content">
    <code language="r script"># Model selection using AIC, BIC, and AICc
bic &lt;- BIC(mod1, mod2, mod3, mod4, mod5) |&gt;  # Bayesian Information Criterion
    mutate(deltaBIC = BIC - min(BIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,BIC,deltaBIC)

aic &lt;- AIC(mod1, mod2, mod3, mod4, mod5)  |&gt;  # Akaike Information Criterion
    mutate(deltaAIC = AIC - min(AIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,AIC,deltaAIC)

aicc &lt;- AICc(mod1, mod2, mod3, mod4, mod5)  |&gt;  # AIC adjusted for small sample size
    mutate(deltaAICc = AICc - min(AICc)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,AICc,deltaAICc)

model_selection_tables &lt;- bic |&gt;
    left_join(aic,by='model') |&gt;
    left_join(aicc,by='model') |&gt;
    mutate(experiment = 'plant_nutrients_through_time')</code>
    </sec>
    <sec id="ecae286a-6611-4ba4-b422-ce26cebc76a9-nb-1" specific-use="notebook-content">
    <code language="r script">model_selection_tables |&gt; arrange(deltaAIC)</code>
    <boxed-text>
      <p>A data.frame: 5 × 8</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
          </colgroup>
          <thead>
            <tr>
              <th>model &lt;chr&gt;</th>
              <th>BIC &lt;dbl&gt;</th>
              <th>deltaBIC &lt;dbl&gt;</th>
              <th>AIC &lt;dbl&gt;</th>
              <th>deltaAIC &lt;dbl&gt;</th>
              <th>AICc &lt;dbl&gt;</th>
              <th>deltaAICc &lt;dbl&gt;</th>
              <th>experiment &lt;chr&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>mod1</td>
              <td>-2012.394</td>
              <td>69.42298</td>
              <td>-2223.967</td>
              <td>0.000000</td>
              <td>-2130.196</td>
              <td>54.63740</td>
              <td>plant_nutrients_through_time</td>
            </tr>
            <tr>
              <td>mod2</td>
              <td>-2081.817</td>
              <td>0.00000</td>
              <td>-2214.475</td>
              <td>9.491908</td>
              <td>-2184.833</td>
              <td>0.00000</td>
              <td>plant_nutrients_through_time</td>
            </tr>
            <tr>
              <td>mod3</td>
              <td>-2059.623</td>
              <td>22.19326</td>
              <td>-2157.263</td>
              <td>66.704222</td>
              <td>-2142.409</td>
              <td>42.42384</td>
              <td>plant_nutrients_through_time</td>
            </tr>
            <tr>
              <td>mod4</td>
              <td>-2018.892</td>
              <td>62.92436</td>
              <td>-2084.496</td>
              <td>139.471257</td>
              <td>-2078.167</td>
              <td>106.66645</td>
              <td>plant_nutrients_through_time</td>
            </tr>
            <tr>
              <td>mod5</td>
              <td>-1997.612</td>
              <td>84.20478</td>
              <td>-2013.232</td>
              <td>210.735098</td>
              <td>-2012.861</td>
              <td>171.97190</td>
              <td>plant_nutrients_through_time</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-646dd85e-685f-4d7c-9ce9-bbf7bab67f92-nb-1" specific-use="notebook-content">
    <sec id="selection-criteria-did-not-agree-nb-1">
      <title>selection criteria did not agree</title>
      <p>there were significant differences between the selection
      criteria. BIC and AICc selected model 2 whereas AIC selected model
      1</p>
      <p>Lets view the estimates from both models to see where they
      agree and disagree</p>
      </sec>
      <sec id="cell-5d41d5ee-f433-4198-9d82-1cb31176062c-nb-1" specific-use="notebook-content">
      <code language="r script">selection_testing_data &lt;- plant_nutrients


# Model 1
selection_testing_data$mod1_pred_carb &lt;- predict(mod1, newdata = plant_nutrients, type = &quot;response&quot;)[, 1]
selection_testing_data$mod1_pred_protein &lt;- predict(mod1, newdata = plant_nutrients, type = &quot;response&quot;)[, 2]

# Model 2
selection_testing_data$mod2_pred_carb &lt;- predict(mod2, newdata = plant_nutrients, type = &quot;response&quot;)[, 1]
selection_testing_data$mod2_pred_protein &lt;- predict(mod2, newdata = plant_nutrients, type = &quot;response&quot;)[, 2]
      </code>
      </sec>
      <sec id="cell-35fb64fe-8f3d-4853-9427-83d8b731f716-nb-1" specific-use="notebook-content">
      <code language="r script">selection_testing_data2 &lt;- selection_testing_data |&gt;
  select(carb_mg_mg, protein_mg_mg, mod1_pred_carb, mod1_pred_protein, mod2_pred_carb, mod2_pred_protein) %&gt;%
  mutate(row = row_number()) |&gt;
  pivot_longer(
    cols = starts_with(&quot;mod1_pred&quot;) | starts_with(&quot;mod2_pred&quot;) | contains(&quot;carb&quot;) | contains(&quot;protein&quot;),
    names_to = c(&quot;type&quot;, &quot;component&quot;),
    names_pattern = &quot;(.*)_(.*)<!-- (F2ED4C6E)[nb-1]:/home/runner/work/herbivore_nutrient_interactions/herbivore_nutrient_interactions/scripts/field_cage_experiment/01_field_cages_plant_nutrient_analyses.ipynb -->quot;,
    values_to = &quot;value&quot;
  ) |&gt;
  mutate(
    component = case_when(
      type == 'carb_mg' ~ 'carb',
      type == 'protein_mg' ~ 'protein',
      TRUE ~ component
    ),
    type = case_when(
      type %in% c('carb_mg', 'protein_mg') ~ 'actual',
      TRUE ~ type
    )
  ) |&gt;
  pivot_wider(
    names_from = component,
    values_from = value
  )
      </code>
      </sec>
      <sec id="cell-7ded3157-0b10-441c-aa76-2444cf395ecd-nb-1" specific-use="notebook-content">
      <code language="r script">p1 &lt;- selection_testing_data2 |&gt;
    #filter(type != 'actual') |&gt;
    ggplot(aes(x=protein,y=carb,color=type)) + 
        geom_point() +  
        #xlim(0,.055) + ylim(0,.055) + 
        theme_pubr() + 
        ylab(&quot;Carbohydrate consumed (g)&quot;) +
        xlab(&quot;Protein consumed (g)&quot;) + 
        scale_color_met_d(name='Degas') 

p2 &lt;- selection_testing_data2 |&gt;
    #filter(type != 'actual') |&gt;
    ggplot(aes(x=type,y=carb,color=type)) + 
        geom_jitter(width=0.2,height=0) +  
        #xlim(0,.055) + ylim(0,.055) + 
        theme_pubr() + 
        ylab(&quot;Carbohydrate consumed (g)&quot;) +
        xlab(&quot;Protein consumed (g)&quot;) + 
        scale_color_met_d(name='Degas') 

p3 &lt;- selection_testing_data2 |&gt;
    #filter(type != 'actual') |&gt;
    ggplot(aes(x=type,y=protein,color=type)) + 
        geom_jitter(width=0.2,height=0) +  
        #xlim(0,.055) + ylim(0,.055) + 
        theme_pubr() + 
        ylab(&quot;Carbohydrate consumed (g)&quot;) +
        xlab(&quot;Protein consumed (g)&quot;) + 
        scale_color_met_d(name='Degas') 

(p1) / (p2 + p3)</code>
      <boxed-text>
        <graphic mimetype="image" mime-subtype="png" xlink:href="01_field_cages_plant_nutrient_analyses_files/figure-jats/cell-12-output-1.png" />
      </boxed-text>
      </sec>
      <sec id="f016cccc-db7e-4051-a1cc-1e018c8c6094-nb-1" specific-use="notebook-content">
    </sec>
    <sec id="verdict-nb-1">
      <title>verdict</title>
      <p>The predictions really dont change much. I think I will stick
      with model 1 as it better portrays the nature of the data, even if
      the predictions remain the same.</p>
    </sec>
  </sec>
  <sec id="final-model-summary-nb-1">
    <title>Final model summary</title>
    </sec>
    <sec id="cell-06b7267f-a977-44f2-933c-f3f10326b182-nb-1" specific-use="notebook-content">
    <code language="r script">summary(mod1)</code>
    <boxed-text>
      <preformat>
Family: Multivariate normal 
Link function: 

Formula:
carb_mg_mg ~ treatment * date + s(species, bs = &quot;re&quot;) + s(plot, 
    bs = &quot;re&quot;) + s(cage, bs = &quot;re&quot;)
protein_mg_mg ~ treatment * date + s(species, bs = &quot;re&quot;) + s(plot, 
    bs = &quot;re&quot;) + s(cage, bs = &quot;re&quot;)

Parametric coefficients:
                                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                       0.126994   0.007285  17.432  &lt; 2e-16 ***
treatmentMedium                  -0.020282   0.007171  -2.828  0.00468 ** 
treatmentHigh                    -0.011134   0.007171  -1.553  0.12052    
date2015-11-25                   -0.009444   0.007061  -1.338  0.18103    
date2015-12-01                   -0.012119   0.005692  -2.129  0.03323 *  
treatmentMedium:date2015-11-25    0.018556   0.009986   1.858  0.06314 .  
treatmentHigh:date2015-11-25      0.004444   0.009986   0.445  0.65626    
treatmentMedium:date2015-12-01    0.019111   0.007990   2.392  0.01677 *  
treatmentHigh:date2015-12-01      0.009762   0.007992   1.221  0.22195    
(Intercept).1                     0.208717   0.017413  11.986  &lt; 2e-16 ***
treatmentMedium.1                -0.001263   0.013893  -0.091  0.92759    
treatmentHigh.1                  -0.034405   0.013988  -2.460  0.01391 *  
date2015-11-25.1                  0.025622   0.010470   2.447  0.01439 *  
date2015-12-01.1                 -0.049307   0.009275  -5.316 1.06e-07 ***
treatmentMedium:date2015-11-25.1 -0.011900   0.014806  -0.804  0.42156    
treatmentHigh:date2015-11-25.1   -0.022822   0.014806  -1.541  0.12322    
treatmentMedium:date2015-12-01.1  0.008265   0.012712   0.650  0.51557    
treatmentHigh:date2015-12-01.1    0.056420   0.012745   4.427 9.55e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
                edf Ref.df  Chi.sq  p-value    
s(species)    4.325      6  67.305 1.72e-05 ***
s(plot)       1.067      8   1.643    0.207    
s(cage)       2.495     36   3.442    0.130    
s.1(species)  5.025      6 307.929  &lt; 2e-16 ***
s.1(plot)     7.421      8 214.489  &lt; 2e-16 ***
s.1(cage)    13.876     36  89.944 7.21e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Deviance explained = 70.4%
-REML = -1038.3  Scale est. = 1         n = 168</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-62c907be-914a-41b5-a0e4-b6a07233247c-nb-1" specific-use="notebook-content">
  </sec>
  <sec id="key-findings-nb-1">
    <title>Key Findings</title>
    <p>Plant Carbohydrate Content: The application of urea (nitrogen) as
    a medium treatment significantly reduced carbohydrate content
    compared to the control, particularly on December 1, 2015.
    Significant species-specific variation in carbohydrate content was
    observed, while plot and cage variability were not significant.</p>
    <p>Plant Protein Content: Surprisingly, despite the urea (nitrogen)
    fertilization, the high treatment reduced protein levels in plants,
    contrary to what might be expected. Significant changes in protein
    content were observed on November 25 and December 1, 2015. There
    were notable effects from species, plot, and cage variability, with
    species and plot effects being particularly strong.</p>
    <p>Overall Model Performance: The model explains 70.4% of the
    deviance in carbohydrate and protein content, indicating a very good
    fit.</p>
  </sec>
  <sec id="model-outputs-and-raw-data-nb-1">
    <title>Model outputs and raw data</title>
    <p>I am going to get the estimated marginal means for
    <monospace>treatment</monospace>,<monospace>date</monospace>, and
    <monospace>treatment:date</monospace> and output as a dataframe</p>
    <p>I will also write out to disk the model object</p>
    </sec>
    <sec id="cell-230d88e4-1dfb-44aa-ac68-ebbd1bcc9125-nb-1" specific-use="notebook-content">
    <code language="r script">
plant_nutrient_exp_preds &lt;- expand.grid(
    species = unique(plant_nutrients$species),
    treatment = unique(plant_nutrients$treatment),
    date = unique(plant_nutrients$date),
    plot = unique(plant_nutrients$plot),
    cage = unique(plant_nutrients$cage)
)


# Predict carbohydrate consumption
plant_nutrient_exp_preds$pred_carb &lt;- predict(mod3, newdata = plant_nutrient_exp_preds, type = &quot;response&quot;)[, 1]

# Predict protein consumption
plant_nutrient_exp_preds$pred_protein &lt;- predict(mod3, newdata = plant_nutrient_exp_preds, type = &quot;response&quot;)[, 2]

# Now averaging arcoss species, plot, and cage
plant_nutrient_exp_preds2 &lt;- plant_nutrient_exp_preds |&gt;
    group_by(date,treatment) |&gt;
    summarize(pred_carb = mean(pred_carb),
           pred_protein = mean(pred_protein))</code>
    <boxed-text>
      <preformat>`summarise()` has grouped output by 'date'. You can override using the
`.groups` argument.</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-0d476447-1f89-4051-a99d-9dc1d2c13a35-nb-1" specific-use="notebook-content">
    <code language="r script">write.csv(plant_nutrient_exp_preds2,here('data/processed/field_cage_experiment/plant_nutrient_predictions.csv'),row.names=FALSE)
write.csv(plant_nutrients,here('data/processed/field_cage_experiment/plant_nutrient_raw_data.csv'),row.names=FALSE)




write.csv(model_selection_tables, here(&quot;output/field_cage_experiment/plant_nutrient_model_selection_criteria_results.csv&quot;),row.names=FALSE)


# Combine the lists into a single list
models &lt;- list('mod1'= mod1, 'mod2' = mod2, 'mod3'= mod3, 'mod4'= mod4)

# Save the combined list to an RDS file
saveRDS(models, here(&quot;output/field_cage_experiment/model_objects/plant_nutrient_through_time_models.rds&quot;))</code>
    </sec>
    <sec id="be63456f-8b39-4c3a-9a7e-fdb6dba06de4-nb-1" specific-use="notebook-content">
  </sec>
</sec>
<sec id="section-2---species-specific-and-soil-nutrient-content-by-fertilization-treatment-nb-1">
  <title>Section 2 - Species-specific and soil nutrient content by
  fertilization treatment</title>
  <sec id="read-in-data-1-nb-1">
    <title>read in data</title>
    </sec>
    <sec id="cell-6691609c-b351-4f05-9787-d5811399961c-nb-1" specific-use="notebook-content">
    <code language="r script">plant_nutrients2 &lt;- read.csv(here(&quot;data/raw/field_cage_experiment/Field_Cage_Nutrients_Through_Time.csv&quot;)) |&gt;
    mutate(Treatment = fct_recode(Treatment, &quot;None&quot; = &quot;0&quot;, &quot;Medium&quot; = &quot;M&quot;, &quot;High&quot; = &quot;H&quot;,
                                &quot;None&quot; = '1', &quot;Medium&quot; = &quot;2&quot;, &quot;High&quot; = &quot;3&quot;)) |&gt; 
    clean_names() |&gt;
    as_tibble() |&gt;
    mutate(date = factor(parse_date_time(x,orders='mdy')))


soils &lt;- readxl::read_xlsx(here('data/raw/field_cage_experiment/Aus_2015_ExpPlots_soil.xlsx')) |&gt;
    clean_names() |&gt;
    select(treatment,initial_no3,initial_no4) |&gt;
    group_by(treatment) |&gt;
    summarize(mean_no3 = mean(initial_no3),
             sd_no3 = sd(initial_no3),
             mean_no4 = mean(initial_no4),
             sd_no4 = sd(initial_no4)) |&gt;
    mutate(treatment = fct_recode(treatment, &quot;None&quot; = &quot;0&quot;, &quot;Medium&quot; = &quot;M&quot;, &quot;High&quot; = &quot;H&quot;))</code>
    </sec>
    <sec id="cell-588aaea2-01db-4487-8949-281b625e7cb1-nb-1" specific-use="notebook-content">
  </sec>
  <sec id="now-combine-the-species-plant-and-soil-nutrient-data-nb-1">
    <title>Now combine the species plant and soil nutrient data</title>
    </sec>
    <sec id="a5a8085c-ec71-4bec-9070-302676ae8cc1-nb-1" specific-use="notebook-content">
    <code language="r script">

plant_species_soil_nutrient_by_treatment &lt;- plant_nutrients2  |&gt;
    select(plot,treatment,species,c_mg_mg,n_mg_mg,protein_mg_mg,carb_mg_mg,date) |&gt;
    left_join(soils,by='treatment') |&gt;
    group_by(date,treatment,species) |&gt;
    summarize(`Plant C` = mean(c_mg_mg),
              `Plant N` = mean(n_mg_mg),
              `Plant Protein` = mean(protein_mg_mg),
              `Plant Carbohydrate` = mean(carb_mg_mg),
              `Soil NO3` = first(mean_no3),
              `Soil NO4` = first(mean_no4)) |&gt;
    arrange(treatment,species,date) |&gt;
    select(treatment,species,date,`Plant C`,`Plant N`,`Plant Protein`,`Plant Carbohydrate`,`Soil NO3`,`Soil NO4`)

plant_species_soil_nutrient_by_treatment</code>
    <boxed-text>
      <preformat>`summarise()` has grouped output by 'date', 'treatment'. You can override using
the `.groups` argument.</preformat>
    </boxed-text>
    <boxed-text>
      <p>A grouped_df: 33 × 9</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
          </colgroup>
          <thead>
            <tr>
              <th>treatment &lt;fct&gt;</th>
              <th>species &lt;chr&gt;</th>
              <th>date &lt;fct&gt;</th>
              <th>Plant C &lt;dbl&gt;</th>
              <th>Plant N &lt;dbl&gt;</th>
              <th>Plant Protein &lt;dbl&gt;</th>
              <th>Plant Carbohydrate &lt;dbl&gt;</th>
              <th>Soil NO3 &lt;dbl&gt;</th>
              <th>Soil NO4 &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>None</td>
              <td>Enteropogon</td>
              <td>2015-11-11</td>
              <td>0.4319933</td>
              <td>0.03112333</td>
              <td>0.1636333</td>
              <td>0.1453333</td>
              <td>1.386671</td>
              <td>0.3312754</td>
            </tr>
            <tr>
              <td>None</td>
              <td>Enteropogon</td>
              <td>2015-11-25</td>
              <td>0.4136500</td>
              <td>0.02150000</td>
              <td>0.1935667</td>
              <td>0.1153333</td>
              <td>1.386671</td>
              <td>0.3312754</td>
            </tr>
            <tr>
              <td>None</td>
              <td>Enteropogon</td>
              <td>2015-12-01</td>
              <td>0.4054009</td>
              <td>0.02337409</td>
              <td>0.1137636</td>
              <td>0.1297727</td>
              <td>1.386671</td>
              <td>0.3312754</td>
            </tr>
            <tr>
              <td>None</td>
              <td>Nutgrass</td>
              <td>2015-11-11</td>
              <td>0.4247033</td>
              <td>0.03152667</td>
              <td>0.2279333</td>
              <td>0.1443333</td>
              <td>1.386671</td>
              <td>0.3312754</td>
            </tr>
            <tr>
              <td>None</td>
              <td>Nutgrass</td>
              <td>2015-11-25</td>
              <td>0.4170000</td>
              <td>0.02676333</td>
              <td>0.2323333</td>
              <td>0.1373333</td>
              <td>1.386671</td>
              <td>0.3312754</td>
            </tr>
            <tr>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
            </tr>
            <tr>
              <td>High</td>
              <td>Nutgrass</td>
              <td>2015-12-01</td>
              <td>0.4174471</td>
              <td>0.02656000</td>
              <td>0.2271714</td>
              <td>0.1257143</td>
              <td>3.237535</td>
              <td>4.207035</td>
            </tr>
            <tr>
              <td>High</td>
              <td>Plaspladium</td>
              <td>2015-12-01</td>
              <td>0.4003700</td>
              <td>0.02904000</td>
              <td>0.2333000</td>
              <td>0.1200000</td>
              <td>3.237535</td>
              <td>4.207035</td>
            </tr>
            <tr>
              <td>High</td>
              <td>Wallaby</td>
              <td>2015-11-11</td>
              <td>0.4241033</td>
              <td>0.02292000</td>
              <td>0.2064333</td>
              <td>0.1250000</td>
              <td>3.237535</td>
              <td>4.207035</td>
            </tr>
            <tr>
              <td>High</td>
              <td>Wallaby</td>
              <td>2015-11-25</td>
              <td>0.4218567</td>
              <td>0.02943000</td>
              <td>0.2426333</td>
              <td>0.1116667</td>
              <td>3.237535</td>
              <td>4.207035</td>
            </tr>
            <tr>
              <td>High</td>
              <td>Wallaby</td>
              <td>2015-12-01</td>
              <td>0.4193714</td>
              <td>0.02478714</td>
              <td>0.2166286</td>
              <td>0.1170000</td>
              <td>3.237535</td>
              <td>4.207035</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-7ae06cf6-db23-4110-aaf1-5ba63a00302c-nb-1" specific-use="notebook-content">
    <code language="r script">write.csv(plant_species_soil_nutrient_by_treatment,here('data/processed/field_cage_experiment/plant_species_soil_nutrient_by_treatment.csv'),row.names=FALSE)
    </code>
    </sec>
    <sec id="f9207ac4-b354-48b1-a626-5508272e7b64-nb-1" specific-use="notebook-content">
  </sec>
</sec>
<sec id="section-3---ground-cover-by-fertilization-treatment-nb-1">
  <title>Section 3 - Ground cover by fertilization treatment</title>
  <p>We need to regression soil and plant nutrients together</p>
  <list list-type="bullet">
    <list-item>
      <p>panel a: initial no3 to treatment</p>
    </list-item>
    <list-item>
      <p>panel b: initial no4 to treatment</p>
    </list-item>
    <list-item>
      <p>panel c: plant protein to no3</p>
    </list-item>
    <list-item>
      <p>panel d: plant protein to no4</p>
    </list-item>
    <list-item>
      <p>panel e: plant carbohydrate to no3</p>
    </list-item>
    <list-item>
      <p>panel f: plant carbohydrate to no4</p>
    </list-item>
  </list>
  <sec id="read-in-data-2-nb-1">
    <title>Read in data</title>
    <p>using the dataframe frames from
    <monospace>section 2</monospace></p>
    </sec>
    <sec id="ca81a011-6da5-4e5b-ac98-d431e05161ef-nb-1" specific-use="notebook-content">
    <code language="r script">plant_dat &lt;- read_csv(here('data/raw/field_cage_experiment/Field_Cage_Nutrients_Through_Time.csv'),show_col_types = FALSE) |&gt;
    clean_names() |&gt;
    select(x1,plot,cage,treatment,species,chn_weight_mg,c_mg_mg,n_mg_mg,protein_mg_mg,carb_mg_mg,carb_prot_ratio) |&gt;
    rename(date = x1) |&gt;
    mutate(date = parse_date_time(date,orders='mdy'),
        across(c(date,plot,cage,treatment,species),~as.factor(.)),
        treatment = fct_recode(treatment, &quot;None&quot; = &quot;0&quot;, &quot;Medium&quot; = &quot;M&quot;, &quot;High&quot; = &quot;H&quot;,
                                &quot;None&quot; = '1', &quot;Medium&quot; = &quot;2&quot;, &quot;High&quot; = &quot;3&quot;)) |&gt;
    dplyr::select(date,plot,treatment,protein_mg_mg,carb_mg_mg)

soils_dat_avg_treatment &lt;- readxl::read_xlsx(here('data/raw/field_cage_experiment/Aus_2015_ExpPlots_soil.xlsx')) |&gt;
    clean_names() |&gt;
    mutate(treatment = fct_recode(treatment, &quot;None&quot; = &quot;0&quot;, &quot;Medium&quot; = &quot;M&quot;, &quot;High&quot; = &quot;H&quot;)) |&gt;
    select(treatment,initial_no3,initial_no4) |&gt;
    group_by(treatment) |&gt;
    summarize(mean_no3 = mean(initial_no3,na.rm=TRUE),
              mean_no4 = mean(initial_no4,na.rm=TRUE))

soil_plant_dat &lt;- plant_dat |&gt;
    left_join(soils_dat_avg_treatment,by='treatment')
    </code>
    <boxed-text>
      <preformat>New names:
• `` -&gt; `...1`</preformat>
    </boxed-text>
    </sec>
    <sec id="f17f156c-df73-478b-bb98-228914f8486e-nb-1" specific-use="notebook-content">
    <code language="r script">soils_dat &lt;- readxl::read_xlsx(here('data/raw/field_cage_experiment/Aus_2015_ExpPlots_soil.xlsx')) |&gt;
    clean_names() |&gt;
    mutate(treatment = fct_recode(treatment, &quot;None&quot; = &quot;0&quot;, &quot;Medium&quot; = &quot;M&quot;, &quot;High&quot; = &quot;H&quot;)) |&gt;
    select(treatment,initial_no3,initial_no4) </code>
    </sec>
    <sec id="cell-87771e52-4e9e-42c1-8aca-2e236052c119-nb-1" specific-use="notebook-content">
  </sec>
  <sec id="writing-dataframes-to-disk-nb-1">
    <title>writing dataframes to disk</title>
    </sec>
    <sec id="cell-495c4661-f0e1-4d53-8b9a-98d5afc37ea8-nb-1" specific-use="notebook-content">
    <code language="r script">write.csv(soil_plant_dat,here('data/processed/field_cage_experiment/plant_soil_nutrient_data.csv'),row.names=FALSE)
write.csv(soils_dat,here('data/processed/field_cage_experiment/soil_nutrient_data'),row.names=FALSE)
    </code>
    </sec>
    <sec id="b7e51e88-05c4-468a-b8dd-04f13b202806-nb-1" specific-use="notebook-content">
  </sec>
</sec>
<sec id="section-4---ground-cover-by-fertilization-treatment-nb-1">
  <title>Section 4 - Ground cover by fertilization treatment</title>
  <sec id="data-management-overview-nb-1">
    <title>Data Management Overview</title>
    <p>This script processes ground cover survey data by:</p>
    <list list-type="order">
      <list-item>
        <p><bold>Data Import and Cleaning:</bold> Loading raw data and
        standardizing column names.</p>
      </list-item>
      <list-item>
        <p><bold>Feature Selection:</bold> Extracting relevant
        vegetation and treatment variables.</p>
      </list-item>
      <list-item>
        <p><bold>Treatment Categorization:</bold> Classifying nitrogen
        treatments into ‘None,’ ‘Medium,’ and ‘High’ categories.</p>
      </list-item>
      <list-item>
        <p><bold>Renaming:</bold> Converting common plant names to
        scientific names.</p>
      </list-item>
      <list-item>
        <p><bold>Data Transformation:</bold> Converting specific values
        and calculating means by treatment.</p>
      </list-item>
      <list-item>
        <p><bold>Handling Missing Data:</bold> Replacing missing values
        for specific species with zero.</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-50dd0861-4036-45a7-a257-a500f187c9ec-nb-1" specific-use="notebook-content">
    <code language="r script">ground_cover_by_treatment &lt;- read_csv(here('data/raw/field_cage_experiment/FieldCagePlantSurveys.xlsx - data.csv'),show_col_types = FALSE) |&gt;
    clean_names() |&gt;
    dplyr::select(n_treatment_kg_n_per_ha, liverseed_grass, enterpogam, wallaby_grass, nut_grass, stipa,plant_ground_cover_percent) |&gt;
    mutate(treatment = case_when(n_treatment_kg_n_per_ha == 0 ~ 'None', n_treatment_kg_n_per_ha == 87.5 ~ 'Medium',
                                 n_treatment_kg_n_per_ha == 175 ~ 'High')) |&gt;
    select(treatment,plant_ground_cover_percent,liverseed_grass,enterpogam,wallaby_grass,nut_grass,stipa) |&gt;
    rename(`Urochloa panicoides` = liverseed_grass,
          `Enteropogon acicularis` = enterpogam,
          `Austrodanthonia caespitosa` = wallaby_grass,
           `Cyperus rotundus` = nut_grass,
           `stipa species` = stipa,
          plant_cover = plant_ground_cover_percent) |&gt;
    mutate(across(!treatment, ~as.numeric(gsub('&lt;5','5',.)))) |&gt;
    group_by(treatment) |&gt;
    summarize(across(where(is.numeric),~mean(.,na.rm=TRUE))) |&gt;
    mutate(`stipa species` = replace_na(`stipa species`,0))</code>
    </sec>
    <sec id="d0bb90df-0a74-4b81-a656-d14b6fbb2a84-nb-1" specific-use="notebook-content">
    <code language="r script">write.csv(ground_cover_by_treatment,here('data/processed/field_cage_experiment/plant_ground_cover_by_treatment.csv'),row.names=FALSE)
    </code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-6-nb-2">
<front-stub>
<title-group>
<article-title>Field cage nutrient analysis – Locust
Physiology</article-title>
</title-group>
</front-stub>

<body>
<sec id="fab2b47b-776e-469f-a50e-e983d2b7bdcc-nb-2" specific-use="notebook-content">
<p>This script analyzes the locust data (protein and carbohydrates) for
the field cage experiments</p>
<p>Please see manuscript for specific methodology.</p>
<p>This script does the following:</p>
<list list-type="order">
  <list-item>
    <label>1)</label>
    <p>analyze locust weight, surivial, and # adult in field cages</p>
  </list-item>
  <list-item>
    <label>2)</label>
    <p>analyze locust nutrient rebalancing through time</p>
  </list-item>
</list>
<p>Manuscript figure preparation happens in the
<monospace>03_field_cages_intake_target_mauscript_figure_code.ipynb</monospace>
file</p>
</sec>
<sec id="cell-7606c69a-0e6e-4433-9278-da23a69b67a0-nb-2" specific-use="notebook-content">
<code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;mgcv&quot;, &quot;MuMIn&quot;, &quot;multcomp&quot;, &quot;gratia&quot;, 
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;broom&quot;, &quot;knitr&quot;, &quot;janitor&quot;, 
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;GGally&quot;,&quot;tidyverse&quot;)

load_packages(packages)

i_am('README.md')

# Functions
                   
## Standard error
std &lt;- function(x) sd(x)/sqrt(length(x))


# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10,repr.matrix.max.rows=10)
</code>
<boxed-text>
  <preformat>here() starts at /home/datascience/herbivore_nutrient_interactions
  </preformat>
</boxed-text>
</sec>
<sec id="f165cd48-e9ea-4f73-ad02-3e51bc5d1e5e-nb-2" specific-use="notebook-content">
<sec id="section-1---analyze-locust-weight-surivial-and-adult-in-field-cages-nb-2">
  <title>Section 1 - analyze locust weight, surivial, and # adult in
  field cages</title>
  <sec id="read-in-data-nb-2">
    <title>read in data</title>
    </sec>
    <sec id="cell-72dd8935-790b-4f76-85d6-94e67d87ee86-nb-2" specific-use="notebook-content">
    <code language="r script">adult_survival_prop &lt;- read_csv(here(&quot;data/raw/field_cage_experiment/LocustCageData_v02.xlsx - by cage.csv&quot;),show_col_types = FALSE) 

final_mass &lt;- read_csv(here(&quot;data/raw/field_cage_experiment/LocustCageData.csv&quot;),show_col_types = FALSE) |&gt;
  mutate(Treatment = fct_recode(Treatment, &quot;None&quot; = &quot;0N&quot;, &quot;Medium&quot; = &quot;MedH&quot;, &quot;High&quot; = &quot;HighN&quot;))</code>
    <boxed-text>
      <preformat>New names:
• `` -&gt; `...24`
• `` -&gt; `...25`
• `` -&gt; `...26`
• `` -&gt; `...27`
• `` -&gt; `...28`</preformat>
    </boxed-text>
    </sec>
    <sec id="f48f40e3-1ed3-4adc-9e80-7f7dcc14431b-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="now-create-two-dataframes-nb-2">
    <title>Now create two dataframes</title>
    <list list-type="bullet">
      <list-item>
        <p>survival and adult proporation at end of field cage
        experiment</p>
      </list-item>
      <list-item>
        <p>final mass of all surviving locusts at end of experiment</p>
      </list-item>
    </list>
    </sec>
    <sec id="a7775117-ac39-430f-8d05-b7e10f1f7da1-nb-2" specific-use="notebook-content">
    <code language="r script">adult_survival_prop2 &lt;- adult_survival_prop |&gt;
    dplyr::select(`N level`,cageNum,AdultProportion,SurviveProportion) |&gt;
    clean_names() |&gt;
    mutate(n_level = factor(n_level),
           treatment = fct_recode(n_level, &quot;None&quot; = '0', &quot;Medium&quot; = '87.5', &quot;High&quot; = '175')) |&gt;
    select(!n_level)</code>
    </sec>
    <sec id="cell-01e520d9-cf4a-4363-a9dc-a96694ace703-nb-2" specific-use="notebook-content">
    <code language="r script">
final_mass2 &lt;- final_mass |&gt;
    clean_names() |&gt;
    filter(!complete.cases(oedaleus_australis)) |&gt;
    select(treatment,mass_g,sex) </code>
    </sec>
    <sec id="cell-16edc6eb-3688-4e2c-a500-ffb8a2180944-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="save-to-disk-for-figure-construction-nb-2">
    <title>save to disk for figure construction</title>
    </sec>
    <sec id="d10b9b8e-c317-480b-b1ad-23ef65d5c837-nb-2" specific-use="notebook-content">
    <code language="r script">write.csv(adult_survival_prop2, here(&quot;data/raw/field_cage_experiment/adult_locust_proportion_survival_by_treatment.csv&quot;),row.names=FALSE)

write.csv(final_mass2, here(&quot;data/raw/field_cage_experiment/adult_locust_final_mass_by_treatment.csv&quot;),row.names=FALSE)
    </code>
    </sec>
    <sec id="aa0a9d72-9097-4f25-a71d-cac99a502293-nb-2" specific-use="notebook-content">
  </sec>
</sec>
<sec id="section-2---analyze-locust-nutrient-rebalancing-through-time-nb-2">
  <title>Section 2 - analyze locust nutrient rebalancing through
  time</title>
  <sec id="read-in-data-1-nb-2">
    <title>read in data</title>
    <p>We need to read in the data and conduct some significant
    management</p>
    </sec>
    <sec id="cell-27ce4f71-c48c-46e1-979c-d055df6c717f-nb-2" specific-use="notebook-content">
    <code language="r script">
# Read and clean the names
dat &lt;- suppressMessages(read_csv(here(&quot;data/raw/field_cage_experiment/Field_Cage_IT.csv&quot;),
                show_col_types = FALSE, skip = 1) |&gt;
  clean_names() |&gt;
  as_tibble())

dat |&gt; head()</code>
    <boxed-text>
      <p>A tibble: 6 × 53</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
          </colgroup>
          <thead>
            <tr>
              <th>locust_id_num &lt;dbl&gt;</th>
              <th>field_plot &lt;chr&gt;</th>
              <th>field_cage_num &lt;dbl&gt;</th>
              <th>date_collected_from_field &lt;chr&gt;</th>
              <th>color &lt;chr&gt;</th>
              <th>sex &lt;chr&gt;</th>
              <th>locust_initialmass_g &lt;dbl&gt;</th>
              <th>locusts_final_mass_g &lt;dbl&gt;</th>
              <th>notes &lt;chr&gt;</th>
              <th>molt_date &lt;chr&gt;</th>
              <th>⋯ ⋯</th>
              <th>high_prot_final_g_44 &lt;dbl&gt;</th>
              <th>x45 &lt;lgl&gt;</th>
              <th>diet_change5_start_time &lt;chr&gt;</th>
              <th>diet_change5_end_time &lt;chr&gt;</th>
              <th>high_carb_dish_num_48 &lt;dbl&gt;</th>
              <th>high_carb_initial_g_49 &lt;dbl&gt;</th>
              <th>high_carb_final_g_50 &lt;dbl&gt;</th>
              <th>high_prot_dish_num_51 &lt;dbl&gt;</th>
              <th>high_prot_initial_g_52 &lt;dbl&gt;</th>
              <th>high_prot_final_g_53 &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>101</td>
              <td>C1</td>
              <td>5</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.353</td>
              <td>0.330</td>
              <td>NA</td>
              <td>Nov 30, 2015</td>
              <td>⋯</td>
              <td>2.888</td>
              <td>NA</td>
              <td>Nov 29, 2015 8:00 PM</td>
              <td>Dec 2, 2015</td>
              <td>123</td>
              <td>2.954</td>
              <td>2.941</td>
              <td>90</td>
              <td>2.924</td>
              <td>2.9250</td>
            </tr>
            <tr>
              <td>102</td>
              <td>C1</td>
              <td>5</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>NA</td>
              <td>Dec 1, 2015</td>
              <td>⋯</td>
              <td>2.887</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>146</td>
              <td>2.868</td>
              <td>2.868</td>
              <td>85</td>
              <td>2.856</td>
              <td>2.8540</td>
            </tr>
            <tr>
              <td>103</td>
              <td>C1</td>
              <td>6</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.300</td>
              <td>NA</td>
              <td>Dead2nd day; prob no eat</td>
              <td>NA</td>
              <td>⋯</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>104</td>
              <td>C1</td>
              <td>7</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>G</td>
              <td>F</td>
              <td>0.262</td>
              <td>NA</td>
              <td>Died 1 Dec</td>
              <td>NA</td>
              <td>⋯</td>
              <td>2.932</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>106</td>
              <td>2.841</td>
              <td>2.839</td>
              <td>101</td>
              <td>2.852</td>
              <td>2.8532</td>
            </tr>
            <tr>
              <td>105</td>
              <td>H1</td>
              <td>1</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.156</td>
              <td>NA</td>
              <td>Dead2nd day; prob no eat</td>
              <td>NA</td>
              <td>⋯</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>106</td>
              <td>H1</td>
              <td>2</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.211</td>
              <td>0.328</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>2.905</td>
              <td>NA</td>
              <td>NA</td>
              <td>NA</td>
              <td>116</td>
              <td>2.894</td>
              <td>2.858</td>
              <td>58</td>
              <td>2.906</td>
              <td>2.8680</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-8179add8-a4e6-4521-9a48-b82c16ac92c1-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="data-management-step-1-nb-2">
    <title>data management step 1</title>
    <list list-type="bullet">
      <list-item>
        <p>dropping NAs</p>
      </list-item>
      <list-item>
        <p>identifying treatments based on cage number</p>
      </list-item>
      <list-item>
        <p>creating time series for locust IT (step 1-5)</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-638f947c-f7d7-4ed2-8dd1-b4aeee8896e1-nb-2" specific-use="notebook-content">
    <code language="r script">dat2 &lt;- dat |&gt;
  drop_na(locusts_final_mass_g) |&gt;
  mutate(
    sex = if_else(sex == 'B', 'M', sex),
    treatment = case_when(
      field_cage_num %in% c(1:4, 21:24, 29:32) ~ &quot;High&quot;,
      field_cage_num %in% c(9:12, 17:20, 25:28) ~ &quot;Med&quot;,
      field_cage_num %in% c(5:8, 13:16, 33:36) ~ &quot;none&quot;),
    total_c_step1 = (`high_carb_initial_g_14` - `high_carb_final_g_15`) * 0.42,
    total_p_step1 = (`high_prot_initial_g_17` - `high_prot_final_g_18`) * 0.42,
    total_c_step2 = (`high_carb_initial_g_22` - `high_carb_final_g_23`) * 0.42,
    total_p_step2 = (`high_prot_initial_g_25` - `high_prot_final_g_26`) * 0.42,
    total_c_step3 = (`high_carb_initial_g_31` - `high_carb_final_g_32`) * 0.42,
    total_p_step3 = (`high_prot_initial_g_34` - `high_prot_final_g_35`) * 0.42,
    total_c_step4 = (`high_carb_initial_g_40` - `high_carb_final_g_41`) * 0.42,
    total_p_step4 = (`high_prot_initial_g_43` - `high_prot_final_g_44`) * 0.42,
    total_c_step5 = (`high_carb_initial_g_49` - `high_carb_final_g_50`) * 0.42,
    total_p_step5 = (`high_prot_initial_g_52` - `high_prot_final_g_53`) * 0.42,
  )</code>
    </sec>
    <sec id="f404fc4f-a87f-4365-b50b-e2f4915584c0-nb-2" specific-use="notebook-content">
    <code language="r script">dat2</code>
    <boxed-text>
      <p>A tibble: 30 × 64</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
          </colgroup>
          <thead>
            <tr>
              <th>locust_id_num &lt;dbl&gt;</th>
              <th>field_plot &lt;chr&gt;</th>
              <th>field_cage_num &lt;dbl&gt;</th>
              <th>date_collected_from_field &lt;chr&gt;</th>
              <th>color &lt;chr&gt;</th>
              <th>sex &lt;chr&gt;</th>
              <th>locust_initialmass_g &lt;dbl&gt;</th>
              <th>locusts_final_mass_g &lt;dbl&gt;</th>
              <th>notes &lt;chr&gt;</th>
              <th>molt_date &lt;chr&gt;</th>
              <th>⋯ ⋯</th>
              <th>total_c_step1 &lt;dbl&gt;</th>
              <th>total_p_step1 &lt;dbl&gt;</th>
              <th>total_c_step2 &lt;dbl&gt;</th>
              <th>total_p_step2 &lt;dbl&gt;</th>
              <th>total_c_step3 &lt;dbl&gt;</th>
              <th>total_p_step3 &lt;dbl&gt;</th>
              <th>total_c_step4 &lt;dbl&gt;</th>
              <th>total_p_step4 &lt;dbl&gt;</th>
              <th>total_c_step5 &lt;dbl&gt;</th>
              <th>total_p_step5 &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>101</td>
              <td>C1</td>
              <td>5</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.353</td>
              <td>0.330</td>
              <td>NA</td>
              <td>Nov 30, 2015</td>
              <td>⋯</td>
              <td>0.00000</td>
              <td>0.00000</td>
              <td>0.01848</td>
              <td>0.00168</td>
              <td>0.00840</td>
              <td>0.00252</td>
              <td>0.00042</td>
              <td>0.00126</td>
              <td>0.00546</td>
              <td>-0.00042</td>
            </tr>
            <tr>
              <td>102</td>
              <td>C1</td>
              <td>5</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>NA</td>
              <td>Dec 1, 2015</td>
              <td>⋯</td>
              <td>0.00000</td>
              <td>0.00042</td>
              <td>0.00756</td>
              <td>0.00000</td>
              <td>0.00966</td>
              <td>0.00252</td>
              <td>0.00000</td>
              <td>0.00420</td>
              <td>0.00000</td>
              <td>0.00084</td>
            </tr>
            <tr>
              <td>106</td>
              <td>H1</td>
              <td>2</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.211</td>
              <td>0.328</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>0.00798</td>
              <td>0.00000</td>
              <td>0.01050</td>
              <td>0.00000</td>
              <td>0.03738</td>
              <td>0.00882</td>
              <td>0.02478</td>
              <td>0.01512</td>
              <td>0.01512</td>
              <td>0.01596</td>
            </tr>
            <tr>
              <td>107</td>
              <td>H1</td>
              <td>2</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>G</td>
              <td>F</td>
              <td>0.216</td>
              <td>0.313</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>0.01764</td>
              <td>0.00042</td>
              <td>0.01512</td>
              <td>0.00168</td>
              <td>0.01974</td>
              <td>0.01218</td>
              <td>0.02226</td>
              <td>0.01680</td>
              <td>0.00084</td>
              <td>0.00000</td>
            </tr>
            <tr>
              <td>108</td>
              <td>H1</td>
              <td>3</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.192</td>
              <td>0.252</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>0.01344</td>
              <td>0.00000</td>
              <td>0.01008</td>
              <td>0.00168</td>
              <td>0.01176</td>
              <td>0.00336</td>
              <td>0.02016</td>
              <td>0.00336</td>
              <td>0.01764</td>
              <td>0.00168</td>
            </tr>
            <tr>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋱</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
            </tr>
            <tr>
              <td>133</td>
              <td>C3</td>
              <td>34</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>M</td>
              <td>M</td>
              <td>0.121</td>
              <td>0.138</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>0.00252</td>
              <td>0.00000</td>
              <td>0.00420</td>
              <td>0</td>
              <td>0.00714</td>
              <td>0.00168</td>
              <td>0.00672</td>
              <td>0.00126</td>
              <td>0.00336</td>
              <td>0.00420</td>
            </tr>
            <tr>
              <td>134</td>
              <td>C3</td>
              <td>34</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.293</td>
              <td>0.213</td>
              <td>Wing buds separating</td>
              <td>Nov 30, 2015</td>
              <td>⋯</td>
              <td>0.00546</td>
              <td>0.00000</td>
              <td>0.00336</td>
              <td>0</td>
              <td>0.00252</td>
              <td>0.00042</td>
              <td>0.00126</td>
              <td>0.00084</td>
              <td>-0.83664</td>
              <td>0.00084</td>
            </tr>
            <tr>
              <td>136</td>
              <td>C3</td>
              <td>36</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>F</td>
              <td>0.231</td>
              <td>0.225</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>-0.00126</td>
              <td>0.00000</td>
              <td>0.00000</td>
              <td>0</td>
              <td>0.01764</td>
              <td>0.00168</td>
              <td>0.00588</td>
              <td>0.00126</td>
              <td>0.00042</td>
              <td>0.00042</td>
            </tr>
            <tr>
              <td>137</td>
              <td>H3</td>
              <td>31</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>G</td>
              <td>F</td>
              <td>0.215</td>
              <td>0.336</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>0.00294</td>
              <td>0.00042</td>
              <td>0.00588</td>
              <td>0</td>
              <td>0.00714</td>
              <td>0.00210</td>
              <td>0.01302</td>
              <td>0.01050</td>
              <td>0.02142</td>
              <td>0.01680</td>
            </tr>
            <tr>
              <td>138</td>
              <td>H3</td>
              <td>32</td>
              <td>Nov 23, 2015 7:00 PM</td>
              <td>B</td>
              <td>M</td>
              <td>0.134</td>
              <td>0.135</td>
              <td>NA</td>
              <td>NA</td>
              <td>⋯</td>
              <td>0.00126</td>
              <td>0.00000</td>
              <td>0.00462</td>
              <td>0</td>
              <td>0.00630</td>
              <td>0.00168</td>
              <td>0.00462</td>
              <td>0.00252</td>
              <td>0.00924</td>
              <td>0.00336</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="f2198b46-d4ec-48e5-8883-66ff657805df-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="data-management-step-2-nb-2">
    <title>data management step 2</title>
    <list list-type="bullet">
      <list-item>
        <p>filter consumption step for negative numbers</p>
      </list-item>
      <list-item>
        <p>creating a row ID</p>
      </list-item>
      <list-item>
        <p>collasping the time steps into a longer format</p>
      </list-item>
      <list-item>
        <p>recoding the time step into a simple number</p>
      </list-item>
    </list>
    </sec>
    <sec id="d58a645f-34f5-40f9-b489-2caa82e70bc6-nb-2" specific-use="notebook-content">
    <code language="r script">
dat3 &lt;- dat2|&gt;
  filter(
    total_c_step1 &gt;= 0, total_p_step1 &gt;= 0,
    total_c_step2 &gt;= 0, total_p_step2 &gt;= 0,
    total_c_step3 &gt;= 0, total_p_step3 &gt;= 0,
    total_c_step4 &gt;= 0, total_p_step4 &gt;= 0,
    total_c_step5 &gt;= 0, total_p_step5 &gt;= 0
  ) |&gt;
  mutate(id = row_number()) |&gt;
  pivot_longer(cols = c(starts_with(&quot;total_c_&quot;), starts_with(&quot;total_p_&quot;)),
               names_to = c(&quot;.value&quot;, &quot;interval&quot;), 
               names_pattern = &quot;(.*)_(.*)&quot;) |&gt; 
  select(field_plot,field_cage_num, sex,locust_initialmass_g,locusts_final_mass_g, treatment,id,interval,total_c,total_p) |&gt;
  mutate(interval = recode(interval, 
                           step1 = &quot;1&quot;, 
                           step2 = &quot;2&quot;, 
                           step3 = &quot;3&quot;, 
                           step4 = &quot;4&quot;, 
                           step5 = &quot;5&quot;),
        id = factor(id),
        treatment = factor(treatment),
        interval = factor(interval))  |&gt;
    group_by(id) |&gt;
    arrange(id,interval) %&gt;%
  mutate(
    cumulative_total_c = cumsum(total_c),
    cumulative_total_p = cumsum(total_p),
    day_interval = case_when(interval == 1 ~'Day 1',
                             interval == 2 ~'Day 2',
                             interval == 3 ~'Day 3-4',
                             interval == 4 ~'Day 5-6',
                             interval == 5 ~'Day 7-9')
  ) |&gt;
  ungroup()
    </code>
    </sec>
    <sec id="cell-93a1c969-1f53-4bf1-a406-81c616f15a14-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="raw-data-visualization-nb-2">
    <title>raw data visualization</title>
    </sec>
    <sec id="cell-1b662bc7-badf-4568-8f4b-4c24758a187f-nb-2" specific-use="notebook-content">
    <code language="r script">treatment_raw_plot &lt;- dat3 |&gt;
    ggplot(aes(x=total_p,y=total_c,color=treatment)) +
        geom_point() +
        coord_equal(ratio=1) + 
        xlab(&quot;Protein consumed (g)&quot;) + 
        ylab(&quot;Carbohydrates consumed (g)&quot;) + 
        theme_pubr() +
        geom_abline(slope = 1,linetype=1) + 
        geom_abline(slope = 2,linetype=2) + 
        facet_wrap(~day_interval) + 
        scale_color_manual(values=c(&quot;#4daf4a&quot;,&quot;#984ea3&quot;)) +
        xlim(0,0.04) +
        ylim(0,0.04)

sex_raw_plot &lt;- dat3 |&gt;
    ggplot(aes(x=total_p,y=total_c,color=sex)) +
        geom_point() +
        coord_equal(ratio=1) + 
        xlab(&quot;Protein consumed (g)&quot;) + 
        ylab(&quot;Carbohydrates consumed (g)&quot;) + 
        theme_pubr() +
        geom_abline(slope = 1,linetype=1) + 
        geom_abline(slope = 2,linetype=2) + 
        facet_wrap(~day_interval) + 
        scale_color_manual(values=c(&quot;#dd5129&quot;,&quot;#0f7ba2&quot;)) +
        xlim(0,0.04) +
        ylim(0,0.04)
    </code>
    </sec>
    <sec id="cell-6f1022b3-8e61-494b-9ba5-6c4d0521d157-nb-2" specific-use="notebook-content">
    <sec id="treatment-raw-plot-nb-2">
      <title>treatment raw plot</title>
      </sec>
      <sec id="cell-55248f19-6d1c-4946-9ff5-aa8381417318-nb-2" specific-use="notebook-content">
      <code language="r script">treatment_raw_plot</code>
      <boxed-text>
        <graphic mimetype="image" mime-subtype="png" xlink:href="02_field_cages_locust_physiology_analyses_files/figure-jats/cell-12-output-1.png" />
      </boxed-text>
      </sec>
      <sec id="cell-796afbae-297f-46f1-9e76-78904c8e9ed7-nb-2" specific-use="notebook-content">
    </sec>
    <sec id="sex-raw-plot-nb-2">
      <title>sex raw plot</title>
      </sec>
      <sec id="cell-079cde43-a4b2-4d8e-8abe-01f4ea5a362a-nb-2" specific-use="notebook-content">
      <code language="r script">sex_raw_plot</code>
      <boxed-text>
        <graphic mimetype="image" mime-subtype="png" xlink:href="02_field_cages_locust_physiology_analyses_files/figure-jats/cell-13-output-1.png" />
      </boxed-text>
      </sec>
      <sec id="cell-5e46f484-176d-4510-81b1-8c3ec443104f-nb-2" specific-use="notebook-content">
    </sec>
    <sec id="save-plots-to-disk-nb-2">
      <title>save plots to disk</title>
      </sec>
      <sec id="cell-423a7a3b-89d9-4432-ae3e-698eed3c698f-nb-2" specific-use="notebook-content">
      <code language="r script"># Define the output directory
output_dir &lt;- here('output/field_cage_experiment/raw_visualization/')

# List of plots and their corresponding file names
plots &lt;- list(
  &quot;intake_target_treatment_raw_graph&quot; = treatment_raw_plot,
  &quot;intake_target_sex_raw_graph&quot; = sex_raw_plot
)

# Loop through each plot and save it
for (name in names(plots)) {
  ggsave(
    filename = file.path(output_dir, paste0(name, &quot;.png&quot;)),
    plot = plots[[name]],
    width = 15, height = 10, dpi = 300
  )
}</code>
      </sec>
      <sec id="e247d2df-94a9-443b-9128-62d34feb34df-nb-2" specific-use="notebook-content">
    </sec>
  </sec>
  <sec id="modeling-nb-2">
    <title>Modeling</title>
    <sec id="model-comparison-overview-locust-nutrient-consumption-nb-2">
      <title>Model Comparison Overview: Locust Nutrient
      Consumption</title>
      <p>This analysis focuses on the nutrient cimulative consumption of
      carbohydrates (cumulative_total_c) and proteins
      (cumulative_total_p) by locusts over time (interval), with key
      predictors such as sex, treatment, and other covariates. The
      following six Generalized Additive Models (GAMs) are used to
      assess the impact of these factors:</p>
      <sec id="model-1-full-model-with-random-effects-for-repeated-measures-nb-2">
        <title>Model 1: Full Model with Random Effects for Repeated
        Measures</title>
        <code language="r script">mod1 &lt;- gam(list( 
  cumulative_total_c ~ sex + interval + treatment + s(id, bs=&quot;re&quot;),  
  cumulative_total_p ~ sex + interval + treatment + s(id, bs=&quot;re&quot;)),
  family=mvn(d=2), select=TRUE, data=dat3
)</code>
        <list list-type="bullet">
          <list-item>
            <p><bold>Fixed Effects</bold>: Includes
            <monospace>sex</monospace>, <monospace>interval</monospace>,
            and <monospace>treatment</monospace>.</p>
          </list-item>
          <list-item>
            <p><bold>Random Effects</bold>:</p>
            <list list-type="bullet">
              <list-item>
                <p><monospace>s(id, bs=&quot;re&quot;)</monospace>:
                Random effect to account for repeated measures on
                individual locusts (<monospace>id</monospace>), but note
                the sample size may not be sufficient for this
                structure.</p>
              </list-item>
            </list>
          </list-item>
          <list-item>
            <p><bold>Purpose</bold>: This model captures the effects of
            sex, time, and treatment while accounting for individual
            locust variability.</p>
          </list-item>
        </list>
      </sec>
      <sec id="model-2-interaction-between-interval-and-treatment-no-smooth-terms-nb-2">
        <title>Model 2: Interaction Between Interval and Treatment, No
        Smooth Terms</title>
        <code language="r script">mod2 &lt;- gam(list( 
  cumulative_total_c ~ sex + (interval) * treatment,   
  cumulative_total_p ~ sex + (interval) * treatment),
  family=mvn(d=2), select=TRUE, data=dat3
)</code>
        <list list-type="bullet">
          <list-item>
            <p><bold>Fixed Effects</bold>: Includes
            <monospace>sex</monospace>, <monospace>interval</monospace>,
            <monospace>treatment</monospace>, and their interaction.</p>
          </list-item>
          <list-item>
            <p><bold>Purpose</bold>: Simplifies the model by removing
            the smooth term for initial mass, focusing solely on the
            interaction between time and treatment.</p>
          </list-item>
        </list>
      </sec>
      <sec id="model-3-fixed-effects-for-sex-only-nb-2">
        <title>Model 3: Fixed Effects for Sex Only</title>
        <code language="r script">mod3 &lt;- gam(list( 
  cumulative_total_c ~ sex,
  cumulative_otal_p ~ sex),
  family=mvn(d=2), select=TRUE, data=dat3
)</code>
        <list list-type="bullet">
          <list-item>
            <p><bold>Fixed Effects</bold>: Only includes
            <monospace>sex</monospace>.</p>
          </list-item>
          <list-item>
            <p><bold>Purpose</bold>: This model isolates the effect of
            sex on nutrient consumption without considering time,
            treatment, or mass.</p>
          </list-item>
        </list>
      </sec>
      <sec id="model-4-fixed-effects-for-treatment-only-nb-2">
        <title>Model 4: Fixed Effects for Treatment Only</title>
        <code language="r script">mod4 &lt;- gam(list( 
  cumulative_total_c ~ treatment,
  cumulative_total_p ~ treatment),
  family=mvn(d=2), select=TRUE, data=dat3
)</code>
        <list list-type="bullet">
          <list-item>
            <p><bold>Fixed Effects</bold>: Only includes
            <monospace>treatment</monospace>.</p>
          </list-item>
          <list-item>
            <p><bold>Purpose</bold>: This model tests the direct effect
            of treatment on nutrient consumption without accounting for
            sex, time, or mass.</p>
          </list-item>
        </list>
      </sec>
      <sec id="model-5-intercept-only-model-null-model-nb-2">
        <title>Model 5: Intercept-Only Model (Null Model)</title>
        <code language="r script">mod5 &lt;- gam(list( 
  cumulative_total_c ~ 1,
  cumulative_total_p ~ 1),
  family=mvn(d=2), select=TRUE, data=dat3
)</code>
        <list list-type="bullet">
          <list-item>
            <p><bold>Fixed Effects</bold>: Only includes an intercept
            term.</p>
          </list-item>
          <list-item>
            <p><bold>Purpose</bold>: Serves as a null model, estimating
            the overall mean of carbohydrate and protein consumption
            without considering any predictors.</p>
          </list-item>
        </list>
      </sec>
    </sec>
    <sec id="summary-nb-2">
      <title>Summary</title>
      <p>By comparing these models, we can assess the influence of sex,
      treatment, interval, and initial mass on locust nutrient
      consumption. The models range from full random effects models
      (Model 1) to simplified intercept-only models (Model 6), allowing
      for a thorough exploration of the factors driving nutrient
      consumption.</p>
      </sec>
      <sec id="cell-49843240-2199-4a89-b3ea-044e9542f374-nb-2" specific-use="notebook-content">
      <code language="r script">
mod1 &lt;- gam(list( 
  cumulative_total_c ~  sex  +  interval + treatment + s(id, bs=&quot;re&quot;), 
  cumulative_total_p ~  sex + interval + treatment  + s(id, bs=&quot;re&quot;)),
  family=mvn(d=2),select=TRUE, data=dat3
)


mod2 &lt;- gam(list( 
  cumulative_total_c ~  sex + interval * treatment,   
  cumulative_total_p ~  sex + interval * treatment),
  family=mvn(d=2),select=TRUE, data=dat3
)

mod3 &lt;- gam(list( 
  cumulative_total_c ~  sex ,
  cumulative_total_p ~  sex),
  family=mvn(d=2),select=TRUE, data=dat3
)

mod4 &lt;- gam(list( 
  cumulative_total_c ~   treatment,
  cumulative_total_p ~   treatment),
  family=mvn(d=2),select=TRUE, data=dat3
)

mod5 &lt;- gam(list( 
  cumulative_total_c ~   1,
  cumulative_total_p ~   1),
  family=mvn(d=2),select=TRUE, data=dat3
)
      </code>
      </sec>
      <sec id="d117d593-564a-4aa0-b01f-50ae1f98af94-nb-2" specific-use="notebook-content">
    </sec>
    <sec id="model-diagnostics-nb-2">
      <title>Model Diagnostics</title>
      </sec>
      <sec id="cell-605271d9-0f66-4371-8827-3b4c77107dbb-nb-2" specific-use="notebook-content">
      <code language="r script">gam.check(mod1)</code>
      <boxed-text>
        <preformat>
Method: REML   Optimizer: outer newton
full convergence after 6 iterations.
Gradient range [-0.000203556,0.0005737438]
(score -954.8838 &amp; scale 1).
Hessian positive definite, eigenvalue range [1.80807,7.847553].
Model rank =  63 / 63 

Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
indicate that k is too low, especially if edf is close to k'.

          k'  edf k-index p-value
s(id)   23.0 17.6      NA      NA
s.1(id) 23.0 10.6      NA      NA</preformat>
      </boxed-text>
      <boxed-text>
        <graphic mimetype="image" mime-subtype="png" xlink:href="02_field_cages_locust_physiology_analyses_files/figure-jats/cell-16-output-2.png" />
      </boxed-text>
      </sec>
      <sec id="f706c068-a0f3-4a6a-baf9-8525467b0f56-nb-2" specific-use="notebook-content">
      <p>These diagnostic plots indicate these models could be improved.
      I think for descriptive uses these models are okay.</p>
      <p>Assuming a gaussian distribution is probably limiting here.</p>
    </sec>
    <sec id="model-selection-criteria-nb-2">
      <title>Model selection criteria</title>
      </sec>
      <sec id="cell-07bf0a70-cc86-49cc-b818-e78c55561b8f-nb-2" specific-use="notebook-content">
      <code language="r script"># Model selection using AIC, BIC, and AICc
bic &lt;- BIC(mod1, mod2, mod3, mod4, mod5) |&gt;  # Bayesian Information Criterion
    mutate(deltaBIC = BIC - min(BIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,BIC,deltaBIC)

aic &lt;- AIC(mod1, mod2, mod3, mod4, mod5)  |&gt;  # Akaike Information Criterion
    mutate(deltaAIC = AIC - min(AIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,AIC,deltaAIC)

aicc &lt;- AICc(mod1, mod2, mod3, mod4, mod5)  |&gt;  # AIC adjusted for small sample size
    mutate(deltaAICc = AICc - min(AICc)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,AICc,deltaAICc)

model_selection_tables &lt;- bic |&gt;
    left_join(aic,by='model') |&gt;
    left_join(aicc,by='model') |&gt;
    mutate(experiment = 'locust_intake_target_through_time')</code>
      </sec>
      <sec id="cell-3a9617c4-7233-4423-ae64-dfc5c9643d28-nb-2" specific-use="notebook-content">
      <code language="r script">model_selection_tables |&gt; arrange(deltaAIC)</code>
      <boxed-text>
        <p>A data.frame: 5 × 8</p>
        <table-wrap>
          <table>
            <colgroup>
              <col width="12%" />
              <col width="12%" />
              <col width="12%" />
              <col width="12%" />
              <col width="12%" />
              <col width="12%" />
              <col width="12%" />
              <col width="12%" />
            </colgroup>
            <thead>
              <tr>
                <th>model &lt;chr&gt;</th>
                <th>BIC &lt;dbl&gt;</th>
                <th>deltaBIC &lt;dbl&gt;</th>
                <th>AIC &lt;dbl&gt;</th>
                <th>deltaAIC &lt;dbl&gt;</th>
                <th>AICc &lt;dbl&gt;</th>
                <th>deltaAICc &lt;dbl&gt;</th>
                <th>experiment &lt;chr&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>mod1</td>
                <td>-1959.594</td>
                <td>0.00000</td>
                <td>-2086.993</td>
                <td>0.0000</td>
                <td>-2021.876</td>
                <td>0.00000</td>
                <td>locust_intake_target_through_time</td>
              </tr>
              <tr>
                <td>mod2</td>
                <td>-1907.268</td>
                <td>52.32555</td>
                <td>-1975.891</td>
                <td>111.1021</td>
                <td>-1961.285</td>
                <td>60.59134</td>
                <td>locust_intake_target_through_time</td>
              </tr>
              <tr>
                <td>mod3</td>
                <td>-1900.026</td>
                <td>59.56801</td>
                <td>-1919.240</td>
                <td>167.7533</td>
                <td>-1918.193</td>
                <td>103.68257</td>
                <td>locust_intake_target_through_time</td>
              </tr>
              <tr>
                <td>mod4</td>
                <td>-1895.604</td>
                <td>63.98977</td>
                <td>-1914.818</td>
                <td>172.1751</td>
                <td>-1913.772</td>
                <td>108.10433</td>
                <td>locust_intake_target_through_time</td>
              </tr>
              <tr>
                <td>mod5</td>
                <td>-1898.807</td>
                <td>60.78667</td>
                <td>-1912.532</td>
                <td>174.4619</td>
                <td>-1911.981</td>
                <td>109.89482</td>
                <td>locust_intake_target_through_time</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </boxed-text>
      </sec>
      <sec id="cell-72e17ed8-b262-43de-be1b-6e276b538012-nb-2" specific-use="notebook-content">
      <p>All model selection criteria agreed that
      <monospace>mod1</monospace> was the best model</p>
    </sec>
    <sec id="final-model-summary-nb-2">
      <title>Final Model Summary</title>
      </sec>
      <sec id="cell-5fc6af52-99ef-47bf-8f70-f8ecc70689e0-nb-2" specific-use="notebook-content">
      <code language="r script">summary(mod1)</code>
      <boxed-text>
        <preformat>
Family: Multivariate normal 
Link function: 

Formula:
cumulative_total_c ~ sex + interval + treatment + s(id, bs = &quot;re&quot;)
cumulative_total_p ~ sex + interval + treatment + s(id, bs = &quot;re&quot;)

Parametric coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.0125868  0.0036504   3.448 0.000565 ***
sexM            -0.0108931  0.0041592  -2.619 0.008818 ** 
interval2        0.0066835  0.0025232   2.649 0.008077 ** 
interval3        0.0160330  0.0025232   6.354 2.09e-10 ***
interval4        0.0259670  0.0025232  10.291  &lt; 2e-16 ***
interval5        0.0350061  0.0025232  13.874  &lt; 2e-16 ***
treatmentnone   -0.0061015  0.0040947  -1.490 0.136202    
(Intercept).1    0.0022792  0.0014613   1.560 0.118829    
sexM.1          -0.0036943  0.0014086  -2.623 0.008726 ** 
interval2.1      0.0005296  0.0014992   0.353 0.723909    
interval3.1      0.0034148  0.0014992   2.278 0.022739 *  
interval4.1      0.0071035  0.0014992   4.738 2.16e-06 ***
interval5.1      0.0125817  0.0014992   8.392  &lt; 2e-16 ***
treatmentnone.1 -0.0009902  0.0013868  -0.714 0.475224    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
          edf Ref.df Chi.sq p-value    
s(id)   17.59     20  484.7  &lt;2e-16 ***
s.1(id) 10.61     20  110.7   0.381    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Deviance explained = 73.4%
-REML = -954.88  Scale est. = 1         n = 115</preformat>
      </boxed-text>
      </sec>
      <sec id="b331a7a4-2a0c-450d-939d-64cf693a7efd-nb-2" specific-use="notebook-content">
    </sec>
    <sec id="key-findings-nb-2">
      <title>Key Findings</title>
      <list list-type="bullet">
        <list-item>
          <p><bold>Sex Effect</bold>: Males consumed significantly less
          protein and carbohydrates than females.</p>
        </list-item>
        <list-item>
          <p><bold>Time (Interval) Effect</bold>:</p>
          <list list-type="bullet">
            <list-item>
              <p>Protein consumption increased significantly in later
              intervals, especially interval 5
              (<monospace>p &lt; 0.001</monospace>).</p>
            </list-item>
            <list-item>
              <p>Carbohydrate consumption also showed increases in later
              intervals, notably in intervals 3, 4, and 5.</p>
            </list-item>
          </list>
        </list-item>
        <list-item>
          <p><bold>Fertilization Treatment</bold>: Locusts in plots
          without nitrogen fertilization consumed less protein
          (<monospace>p = 0.0285</monospace>), but the effect was not
          significant for carbohydrates.</p>
        </list-item>
        <list-item>
          <p><bold>Random Effect</bold>: There was no significant
          individual effect (<monospace>s(id)</monospace>), indicating
          individual locusts did not contribute heavily to
          variation.</p>
        </list-item>
        <list-item>
          <p><bold>Deviance Explained</bold>: The model explained 20.5%
          of the variation in nutrient consumption.</p>
        </list-item>
      </list>
    </sec>
    <sec id="model-outputs-nb-2">
      <title>Model outputs</title>
      <p>I am going to get the estimated marginal means for
      <monospace>inter</monospace>,<monospace>date</monospace>, and
      <monospace>treatment:date</monospace> and output as a
      dataframe</p>
      <p>I will write out the transformed raw data to disk</p>
      <p>I will also write out to disk the model object</p>
      </sec>
      <sec id="f2a589d4-5a2f-4b23-8a93-adc04279c11d-nb-2" specific-use="notebook-content">
      <code language="r script">

intake_target_exp_preds &lt;- expand.grid(
    sex = unique(dat3$sex),
    interval = unique(dat3$interval),
    treatment = unique(dat3$treatment),
    id= unique(dat3$id)
)

# Predict carbohydrate consumption
intake_target_exp_preds$pred_carb &lt;- predict(mod1, newdata = intake_target_exp_preds, type = &quot;response&quot;)[, 1]

# Predict protein consumption
intake_target_exp_preds$pred_protein &lt;- predict(mod1, newdata = intake_target_exp_preds, type = &quot;response&quot;)[, 2]

intake_target_exp_preds</code>
      <boxed-text>
        <p>A data.frame: 460 × 6</p>
        <table-wrap>
          <table>
            <colgroup>
              <col width="17%" />
              <col width="17%" />
              <col width="17%" />
              <col width="17%" />
              <col width="17%" />
              <col width="17%" />
            </colgroup>
            <thead>
              <tr>
                <th>sex &lt;fct&gt;</th>
                <th>interval &lt;fct&gt;</th>
                <th>treatment &lt;fct&gt;</th>
                <th>id &lt;fct&gt;</th>
                <th>pred_carb &lt;dbl&gt;</th>
                <th>pred_protein &lt;dbl&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>M</td>
                <td>1</td>
                <td>none</td>
                <td>1</td>
                <td>0.005251196</td>
                <td>0.002089128</td>
              </tr>
              <tr>
                <td>F</td>
                <td>1</td>
                <td>none</td>
                <td>1</td>
                <td>-0.005641895</td>
                <td>-0.001605175</td>
              </tr>
              <tr>
                <td>M</td>
                <td>2</td>
                <td>none</td>
                <td>1</td>
                <td>0.011934674</td>
                <td>0.002618693</td>
              </tr>
              <tr>
                <td>F</td>
                <td>2</td>
                <td>none</td>
                <td>1</td>
                <td>0.001041583</td>
                <td>-0.001075610</td>
              </tr>
              <tr>
                <td>M</td>
                <td>3</td>
                <td>none</td>
                <td>1</td>
                <td>0.021284240</td>
                <td>0.005503910</td>
              </tr>
              <tr>
                <td>⋮</td>
                <td>⋮</td>
                <td>⋮</td>
                <td>⋮</td>
                <td>⋮</td>
                <td>⋮</td>
              </tr>
              <tr>
                <td>F</td>
                <td>3</td>
                <td>High</td>
                <td>23</td>
                <td>0.01278549</td>
                <td>0.001897175</td>
              </tr>
              <tr>
                <td>M</td>
                <td>4</td>
                <td>High</td>
                <td>23</td>
                <td>0.03361250</td>
                <td>0.009280174</td>
              </tr>
              <tr>
                <td>F</td>
                <td>4</td>
                <td>High</td>
                <td>23</td>
                <td>0.02271940</td>
                <td>0.005585871</td>
              </tr>
              <tr>
                <td>M</td>
                <td>5</td>
                <td>High</td>
                <td>23</td>
                <td>0.04265163</td>
                <td>0.014758435</td>
              </tr>
              <tr>
                <td>F</td>
                <td>5</td>
                <td>High</td>
                <td>23</td>
                <td>0.03175854</td>
                <td>0.011064132</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </boxed-text>
      </sec>
      <sec id="ab4e089a-248d-4c37-8814-fd228f1a22f9-nb-2" specific-use="notebook-content">
      <code language="r script"># Now averaging arcoss species, plot, and cage
intake_target_exp_preds2 &lt;- intake_target_exp_preds |&gt;
    group_by(treatment,interval) |&gt;
    summarize(pred_carb = mean(pred_carb),
           pred_protein = mean(pred_protein))

intake_target_exp_preds2</code>
      <boxed-text>
        <preformat>`summarise()` has grouped output by 'treatment'. You can override using the
`.groups` argument.</preformat>
      </boxed-text>
      <boxed-text>
        <p>A grouped_df: 10 × 4</p>
        <table-wrap>
          <table>
            <colgroup>
              <col width="25%" />
              <col width="25%" />
              <col width="25%" />
              <col width="25%" />
            </colgroup>
            <thead>
              <tr>
                <th>treatment &lt;fct&gt;</th>
                <th>interval &lt;fct&gt;</th>
                <th>pred_carb &lt;dbl&gt;</th>
                <th>pred_protein &lt;dbl&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>High</td>
                <td>1</td>
                <td>0.007140269</td>
                <td>4.320264e-04</td>
              </tr>
              <tr>
                <td>High</td>
                <td>2</td>
                <td>0.013823747</td>
                <td>9.615916e-04</td>
              </tr>
              <tr>
                <td>High</td>
                <td>3</td>
                <td>0.023173312</td>
                <td>3.846809e-03</td>
              </tr>
              <tr>
                <td>High</td>
                <td>4</td>
                <td>0.033107225</td>
                <td>7.535505e-03</td>
              </tr>
              <tr>
                <td>High</td>
                <td>5</td>
                <td>0.042146356</td>
                <td>1.301377e-02</td>
              </tr>
              <tr>
                <td>none</td>
                <td>1</td>
                <td>0.001038814</td>
                <td>-5.581555e-04</td>
              </tr>
              <tr>
                <td>none</td>
                <td>2</td>
                <td>0.007722292</td>
                <td>-2.859025e-05</td>
              </tr>
              <tr>
                <td>none</td>
                <td>3</td>
                <td>0.017071858</td>
                <td>2.856627e-03</td>
              </tr>
              <tr>
                <td>none</td>
                <td>4</td>
                <td>0.027005771</td>
                <td>6.545323e-03</td>
              </tr>
              <tr>
                <td>none</td>
                <td>5</td>
                <td>0.036044901</td>
                <td>1.202358e-02</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </boxed-text>
      </sec>
      <sec id="cell-7cf99827-605e-4d5c-9dec-cb8c60e3d991-nb-2" specific-use="notebook-content">
      <code language="r script">write.csv(intake_target_exp_preds2,here('data/processed/field_cage_experiment/intake_target_through_time_predictions.csv'),row.names=FALSE)
write.csv(dat3,here('data/processed/field_cage_experiment/intake_target_through_time_predictions_raw_data.csv'),row.names=FALSE)


write.csv(model_selection_tables, here(&quot;output/field_cage_experiment/intake_target_through_time_model_selection_criteria_results.csv&quot;),row.names=FALSE)


# Combine the lists into a single list
models &lt;- list('mod1'= mod1, 'mod2' = mod2, 'mod3'= mod3, 'mod4'= mod4, 'mod5'= mod5)

# Save the combined list to an RDS file
saveRDS(models, here(&quot;output/field_cage_experiment/model_objects/intake_target_through_time_models.rds&quot;))</code>
      </sec>
      <sec id="b97f2c69-6245-4cf7-af5b-7959565ec765-nb-2" specific-use="notebook-content">
    </sec>
  </sec>
</sec>
<sec id="section-3---final-locust-mass-analysis-nb-2">
  <title>Section 3 - Final locust mass analysis</title>
  <p>This model looks to see if the final mass of locusts differed
  between treatments.</p>
  </sec>
  <sec id="cell-8c6f865f-026a-489a-930a-ebf0cf99e171-nb-2" specific-use="notebook-content">
  <code language="r script">locust_dat &lt;- read_csv(here('data/raw/field_cage_experiment/LocustCageData.csv'),show_col_types = FALSE) |&gt;
    clean_names() |&gt;
    filter(!complete.cases(oedaleus_australis)) |&gt;
    select(treatment,cage_num,mass_g,carb_mg_mg,protein_mg_mg,sex) |&gt;
    drop_na() |&gt;
    mutate(across(c(sex,cage_num),~factor(.)),
          treatment = factor(case_when(treatment == 'HighN' ~ 'high',
                                treatment == 'MedH' ~ 'medium',
                                TRUE ~ 'none'), levels= c('none','medium','high')))</code>
  <boxed-text>
    <preformat>New names:
• `` -&gt; `...24`
• `` -&gt; `...25`
• `` -&gt; `...26`
• `` -&gt; `...27`
• `` -&gt; `...28`</preformat>
  </boxed-text>
  </sec>
  <sec id="ef033270-5d84-4fb5-a6a1-c2773009c698-nb-2" specific-use="notebook-content">
  <code language="r script">locust_dat |&gt; glimpse()

unique(locust_dat$sex)
unique(locust_dat$treatment)
unique(locust_dat$cage_num)</code>
  <boxed-text>
    <preformat>Rows: 292
Columns: 6
$ treatment     &lt;fct&gt; high, high, high, high, high, high, high, high, high, hi…
$ cage_num      &lt;fct&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
$ mass_g        &lt;dbl&gt; 0.242, 0.314, 0.288, 0.257, 0.181, 0.115, 0.132, 0.336, …
$ carb_mg_mg    &lt;dbl&gt; 0.1210000, 0.1210000, 0.1210000, 0.1210000, 0.1210000, 0…
$ protein_mg_mg &lt;dbl&gt; 0.1729659, 0.1729659, 0.1729659, 0.1729659, 0.1729659, 0…
$ sex           &lt;fct&gt; F, F, F, F, M, M, M, F, F, M, M, M, F, F, F, F, F, F, F,…</preformat>
  </boxed-text>
  <boxed-text>
    <list list-type="order">
      <list-item>
        <p>F</p>
      </list-item>
      <list-item>
        <p>M</p>
      </list-item>
    </list>
    <p><bold>Levels</bold>: 1. ‘F’ 2. ‘M’</p>
  </boxed-text>
  <boxed-text>
    <list list-type="order">
      <list-item>
        <p>high</p>
      </list-item>
      <list-item>
        <p>none</p>
      </list-item>
      <list-item>
        <p>medium</p>
      </list-item>
    </list>
    <p><bold>Levels</bold>: 1. ‘none’ 2. ‘medium’ 3. ‘high’</p>
  </boxed-text>
  <boxed-text>
    <list list-type="order">
      <list-item>
        <p>1</p>
      </list-item>
      <list-item>
        <p>2</p>
      </list-item>
      <list-item>
        <p>3</p>
      </list-item>
      <list-item>
        <p>4</p>
      </list-item>
      <list-item>
        <p>5</p>
      </list-item>
      <list-item>
        <p>6</p>
      </list-item>
      <list-item>
        <p>7</p>
      </list-item>
      <list-item>
        <p>8</p>
      </list-item>
      <list-item>
        <p>9</p>
      </list-item>
      <list-item>
        <p>10</p>
      </list-item>
      <list-item>
        <p>11</p>
      </list-item>
      <list-item>
        <p>12</p>
      </list-item>
      <list-item>
        <p>13</p>
      </list-item>
      <list-item>
        <p>14</p>
      </list-item>
      <list-item>
        <p>15</p>
      </list-item>
      <list-item>
        <p>16</p>
      </list-item>
      <list-item>
        <p>17</p>
      </list-item>
      <list-item>
        <p>18</p>
      </list-item>
      <list-item>
        <p>19</p>
      </list-item>
      <list-item>
        <p>20</p>
      </list-item>
      <list-item>
        <p>21</p>
      </list-item>
      <list-item>
        <p>22</p>
      </list-item>
      <list-item>
        <p>23</p>
      </list-item>
      <list-item>
        <p>24</p>
      </list-item>
      <list-item>
        <p>25</p>
      </list-item>
      <list-item>
        <p>26</p>
      </list-item>
      <list-item>
        <p>27</p>
      </list-item>
      <list-item>
        <p>28</p>
      </list-item>
      <list-item>
        <p>29</p>
      </list-item>
      <list-item>
        <p>30</p>
      </list-item>
      <list-item>
        <p>31</p>
      </list-item>
      <list-item>
        <p>32</p>
      </list-item>
      <list-item>
        <p>33</p>
      </list-item>
      <list-item>
        <p>34</p>
      </list-item>
      <list-item>
        <p>35</p>
      </list-item>
      <list-item>
        <p>36</p>
      </list-item>
    </list>
    <p><bold>Levels</bold>: 1. ‘1’ 2. ‘2’ 3. ‘3’ 4. ‘4’ 5. ‘5’ 6. ‘6’ 7.
    ‘7’ 8. ‘8’ 9. ‘9’ 10. ‘10’ 11. ‘11’ 12. ‘12’ 13. ‘13’ 14. ‘14’ 15.
    ‘15’ 16. ‘16’ 17. ‘17’ 18. ‘18’ 19. ‘19’ 20. ‘20’ 21. ‘21’ 22. ‘22’
    23. ‘23’ 24. ‘24’ 25. ‘25’ 26. ‘26’ 27. ‘27’ 28. ‘28’ 29. ‘29’ 30.
    ‘30’ 31. ‘31’ 32. ‘32’ 33. ‘33’ 34. ‘34’ 35. ‘35’ 36. ‘36’</p>
  </boxed-text>
  </sec>
  <sec id="b4675ee3-f08b-41f5-84a5-a23e25c28e2a-nb-2" specific-use="notebook-content">
  <sec id="building-model-nb-2">
    <title>Building model</title>
    </sec>
    <sec id="cell-91eed4d7-74ea-4488-afbe-f9c11c3e9d00-nb-2" specific-use="notebook-content">
    <code language="r script">mod &lt;- gam(mass_g ~
               sex +
               treatment +
               s(carb_mg_mg,protein_mg_mg) +
               s(cage_num,bs='re'),
        family=scat(),
        select=TRUE,
        data=locust_dat)</code>
    </sec>
    <sec id="cell-9c3df201-7702-402d-af5f-a2c2a283f158-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="model-appraisal-nb-2">
    <title>Model appraisal</title>
    </sec>
    <sec id="dec76fb4-9740-4de3-b354-9367ebd252cb-nb-2" specific-use="notebook-content">
    <code language="r script">gratia::appraise(mod)</code>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="02_field_cages_locust_physiology_analyses_files/figure-jats/cell-26-output-1.png" />
    </boxed-text>
    </sec>
    <sec id="d0760b9d-34b7-445f-8b4d-a96247458dd7-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="model-summary-nb-2">
    <title>Model summary</title>
    </sec>
    <sec id="b345db67-6a8c-4992-a216-e0c473d04f7d-nb-2" specific-use="notebook-content">
    <code language="r script">summary(mod)</code>
    <boxed-text>
      <preformat>
Family: Scaled t(3.062,0.036) 
Link function: identity 

Formula:
mass_g ~ sex + treatment + s(carb_mg_mg, protein_mg_mg) + s(cage_num, 
    bs = &quot;re&quot;)

Parametric coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.326188   0.007210  45.243   &lt;2e-16 ***
sexM            -0.147694   0.005507 -26.820   &lt;2e-16 ***
treatmentmedium  0.014935   0.009518   1.569    0.117    
treatmenthigh   -0.011055   0.010095  -1.095    0.273    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
                                  edf Ref.df Chi.sq  p-value    
s(carb_mg_mg,protein_mg_mg)  0.001665     29  0.002    0.416    
s(cage_num)                 17.399299     33 42.160 1.78e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) =  0.617   Deviance explained = 61.6%
-REML = -427.13  Scale est. = 1         n = 292</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-0dcacec3-595b-48da-965c-952c76782afd-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="key-findings-1-nb-2">
    <title>Key Findings</title>
    <list list-type="bullet">
      <list-item>
        <p><bold>Sex Effect</bold>: Males are significantly lighter than
        females (<monospace>p &lt; 0.001</monospace>).</p>
      </list-item>
      <list-item>
        <p><bold>Fertilization Treatment</bold>:</p>
        <list list-type="bullet">
          <list-item>
            <p>No significant effect of medium or high fertilization
            treatments on locust mass
            (<monospace>p &gt; 0.1</monospace>).</p>
          </list-item>
        </list>
      </list-item>
      <list-item>
        <p><bold>Nutrient Content</bold>: The interaction between
        carbohydrate and protein content did not significantly affect
        locust mass (<monospace>p = 0.416</monospace>).</p>
      </list-item>
      <list-item>
        <p><bold>Cage Effect</bold>: Significant variability in mass was
        attributed to differences between cages
        (<monospace>p = 1.78e-05</monospace>).</p>
      </list-item>
      <list-item>
        <p><bold>Deviance Explained</bold>: The model explains 61.6% of
        the variance in locust mass.</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-7ccdaeef-afa4-4bf0-81d6-e7ec74d467cc-nb-2" specific-use="notebook-content">
  </sec>
  <sec id="model-outputs-1-nb-2">
    <title>Model outputs</title>
    <p>I dont need the estimated marginal means since there was no
    difference. I will just save the model to disk?</p>
    </sec>
    <sec id="cell-045954fb-6182-4dc3-958a-3464c241fdb4-nb-2" specific-use="notebook-content">
    <code language="r script">saveRDS(mod, here(&quot;output/field_cage_experiment/model_objects/final_locust_weight_by_field_cage_treatment_models.rds&quot;))</code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-9-nb-3">
<front-stub>
<title-group>
<article-title>Field cage plant and locust post modeling
visualization</article-title>
</title-group>
</front-stub>

<body>
<sec id="b6011be8-cc31-4070-bfbc-70e1a092b27c-nb-3" specific-use="notebook-content">
<p>Now we combined the plant nutrient and locust intake target model
estimates and raw datan together for manuscript figure and table
construction</p>
<p>We will save the figures as png and save tables as csvs</p>
</sec>
<sec id="cell-511fbce1-c59c-4748-a8bc-7ec9d34a7575-nb-3" specific-use="notebook-content">
<code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;tidyverse&quot;, &quot;mgcv&quot;,&quot;gratia&quot;, 
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;broom&quot;, &quot;knitr&quot;, &quot;janitor&quot;, 
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;GGally&quot;,&quot;patchwork&quot;)

load_packages(packages)

i_am('README.md')

# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10)
</code>
<boxed-text>
  <preformat>here() starts at /home/datascience/herbivore_nutrient_interactions
  </preformat>
</boxed-text>
</sec>
<sec id="cell-2c5443aa-f4c4-452a-a22e-e7eabffe6b4c-nb-3" specific-use="notebook-content">
<sec id="section-1---maintext-figures-and-tables-nb-3">
  <title>Section 1 - maintext figures and tables</title>
  <sec id="figure---overall-field-cage-results-nb-3">
    <title>Figure - overall field cage results</title>
    <list list-type="bullet">
      <list-item>
        <p>plant nutrient change</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-4290c0ed-9b9d-48f7-8b56-cf9278082be2-nb-3" specific-use="notebook-content">
    <code language="r script">plant_nutrients_model_estimates &lt;- read_csv(here('data/processed/field_cage_experiment/plant_nutrient_predictions.csv'),show_col_types = FALSE)
plant_nutrients &lt;- read_csv(here('data/processed/field_cage_experiment/plant_nutrient_raw_data.csv'),show_col_types = FALSE)

combined_plant_dat &lt;- plant_nutrients |&gt;
    dplyr::select(treatment,protein_mg_mg,carb_mg_mg,date) |&gt;
    left_join(plant_nutrients_model_estimates,by=c('treatment','date'))</code>
    </sec>
    <sec id="cell-9deb88e9-21e8-417c-aa67-9a72177343df-nb-3" specific-use="notebook-content">
    <list list-type="bullet">
      <list-item>
        <p>locust physiology</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-9e615cbe-254b-4ac0-9fd8-00f46da66949-nb-3" specific-use="notebook-content">
    <code language="r script">locust_prop_dat &lt;- read_csv(here(&quot;data/raw/field_cage_experiment/adult_locust_proportion_survival_by_treatment.csv&quot;),show_col_types = FALSE)

locust_mass_dat &lt;- read_csv(here(&quot;data/raw/field_cage_experiment/adult_locust_final_mass_by_treatment.csv&quot;),show_col_types = FALSE)</code>
    </sec>
    <sec id="c2d580d1-6f41-4cd9-8bdd-bd80bf8679ae-nb-3" specific-use="notebook-content">
    <p>now creating the figures</p>
    </sec>
    <sec id="b95b8712-ccdf-48da-a755-267a65914ced-nb-3" specific-use="notebook-content">
    <code language="r script">plant_nutrients_through_time_plot &lt;- combined_plant_dat |&gt;
    mutate(treatment = factor(treatment,levels=c('None','Medium','High'))) |&gt; 
    ggplot(aes(x=protein_mg_mg,y=carb_mg_mg, fill = treatment)) +
        geom_point(shape=21) +
        geom_point(aes(y=pred_carb,x=pred_protein,color = treatment),size=5,shape=21) +
        coord_equal(ratio=1) + 
        facet_wrap(~date) +
        xlim(0,0.3) + ylim(0,0.3) + 
        theme_pubr() + 
        ylab(&quot;Carbohydrate (mg/mg)&quot;) +
        xlab(&quot;Protein (mg/mg)&quot;) + 
        geom_abline(slope = 1,linetype=1,intercept=0) + 
        geom_abline(slope = 2,linetype=2,intercept=0) +
        scale_fill_manual(values = c('#74c476','#238b45','#00441b'))  +
        scale_color_manual(values = c('#74c476','#238b45','#00441b'))

    </code>
    </sec>
    <sec id="a6c13bcc-08ba-405c-b092-95288d7dea2b-nb-3" specific-use="notebook-content">
    <code language="r script">locust_final_mass_plot &lt;- locust_mass_dat |&gt;
    drop_na() |&gt;
    group_by(treatment) |&gt;
    mutate(mean_mass = mean(mass_g)) |&gt;
    ggplot(aes(x=treatment,y=mass_g,color=sex)) +
        geom_jitter(height=0,width=0.3) +
        geom_point(aes(y=mean_mass),color='black',size=2) +
        theme_pubr() +
        scale_color_manual(values = c('#1b9e77','#d95f02')) +
        ylab('mass (g)') +
        xlab('treatment')

adult_prop_figure &lt;- locust_prop_dat |&gt;
    drop_na() |&gt;
    ggplot(aes(x=treatment,y=adult_proportion)) +
        geom_boxplot(outlier.size=-1) +
        geom_jitter(height=0,width=0.3) +
        #geom_point(aes(y=mean_adult),color='black',size=10) +
        theme_pubr() +
        xlab('adult proportion') +
        xlab('treatment') +
        ylim(0,1)


survival_prop_figure &lt;- locust_prop_dat |&gt;
    drop_na() |&gt;
    ggplot(aes(x=treatment,y=survive_proportion)) +
        geom_boxplot(outlier.size=-1) +
        geom_jitter(height=0,width=0.3) +
        #geom_point(aes(y=mean_adult),color='black',size=10) +
        theme_pubr() +
        xlab('survival proportion') +
        xlab('treatment') +
        ylim(0,1)</code>
    </sec>
    <sec id="cell-1a5f984c-64b7-43a1-900e-28cbac9dae24-nb-3" specific-use="notebook-content">
    <code language="r script">field_cage_plant_locust_figure &lt;- (plant_nutrients_through_time_plot) / (locust_final_mass_plot + survival_prop_figure + adult_prop_figure) + 
  plot_annotation(tag_levels = 'A') 


field_cage_plant_locust_figure</code>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_field_cage_manuscript_figure_table_code.ipynb_files/figure-jats/cell-7-output-1.png" />
    </boxed-text>
    </sec>
    <sec id="cell-5421f09b-153a-40b7-a42f-0d4440d322a8-nb-3" specific-use="notebook-content">
    <code language="r script">ggsave(field_cage_plant_locust_figure,
       file=here('output/publication_figures/field_cage_plant_locust_figure.png'),
       width=10,height=10)</code>
    </sec>
    <sec id="a518fae9-b13a-4e87-9be6-f76469215197-nb-3" specific-use="notebook-content">
  </sec>
  <sec id="figure---field-cage-locust-nutrient-rebalancing-nb-3">
    <title>Figure - field Cage Locust Nutrient Rebalancing</title>
    </sec>
    <sec id="cell-7f860f02-ebc8-4c55-a349-67a276e93b7e-nb-3" specific-use="notebook-content">
    <code language="r script">raw_locust_data &lt;- read_csv(here('data/processed/field_cage_experiment/intake_target_through_time_predictions_raw_data.csv'),show_col_types = FALSE)
locust_model_data &lt;- read_csv(here('data/processed/field_cage_experiment/intake_target_through_time_predictions.csv'),show_col_types = FALSE) |&gt;
    group_by(treatment,interval) 

locust_model_data

raw_locust_data</code>
    <boxed-text>
      <p>A grouped_df: 10 × 4</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="25%" />
            <col width="25%" />
            <col width="25%" />
            <col width="25%" />
          </colgroup>
          <thead>
            <tr>
              <th>treatment &lt;chr&gt;</th>
              <th>interval &lt;dbl&gt;</th>
              <th>pred_carb &lt;dbl&gt;</th>
              <th>pred_protein &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>High</td>
              <td>1</td>
              <td>0.007140269</td>
              <td>4.320264e-04</td>
            </tr>
            <tr>
              <td>High</td>
              <td>2</td>
              <td>0.013823747</td>
              <td>9.615916e-04</td>
            </tr>
            <tr>
              <td>High</td>
              <td>3</td>
              <td>0.023173312</td>
              <td>3.846809e-03</td>
            </tr>
            <tr>
              <td>High</td>
              <td>4</td>
              <td>0.033107225</td>
              <td>7.535505e-03</td>
            </tr>
            <tr>
              <td>High</td>
              <td>5</td>
              <td>0.042146356</td>
              <td>1.301377e-02</td>
            </tr>
            <tr>
              <td>none</td>
              <td>1</td>
              <td>0.001038814</td>
              <td>-5.581555e-04</td>
            </tr>
            <tr>
              <td>none</td>
              <td>2</td>
              <td>0.007722292</td>
              <td>-2.859025e-05</td>
            </tr>
            <tr>
              <td>none</td>
              <td>3</td>
              <td>0.017071858</td>
              <td>2.856627e-03</td>
            </tr>
            <tr>
              <td>none</td>
              <td>4</td>
              <td>0.027005771</td>
              <td>6.545323e-03</td>
            </tr>
            <tr>
              <td>none</td>
              <td>5</td>
              <td>0.036044901</td>
              <td>1.202358e-02</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    <boxed-text>
      <p>A spec_tbl_df: 115 × 13</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
          </colgroup>
          <thead>
            <tr>
              <th>field_plot &lt;chr&gt;</th>
              <th>field_cage_num &lt;dbl&gt;</th>
              <th>sex &lt;chr&gt;</th>
              <th>locust_initialmass_g &lt;dbl&gt;</th>
              <th>locusts_final_mass_g &lt;dbl&gt;</th>
              <th>treatment &lt;chr&gt;</th>
              <th>id &lt;dbl&gt;</th>
              <th>interval &lt;dbl&gt;</th>
              <th>total_c &lt;dbl&gt;</th>
              <th>total_p &lt;dbl&gt;</th>
              <th>cumulative_total_c &lt;dbl&gt;</th>
              <th>cumulative_total_p &lt;dbl&gt;</th>
              <th>day_interval &lt;chr&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>C1</td>
              <td>5</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>none</td>
              <td>1</td>
              <td>1</td>
              <td>0.00000</td>
              <td>0.00042</td>
              <td>0.00000</td>
              <td>0.00042</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>5</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>none</td>
              <td>1</td>
              <td>2</td>
              <td>0.00756</td>
              <td>0.00000</td>
              <td>0.00756</td>
              <td>0.00042</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>5</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>none</td>
              <td>1</td>
              <td>3</td>
              <td>0.00966</td>
              <td>0.00252</td>
              <td>0.01722</td>
              <td>0.00294</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>5</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>none</td>
              <td>1</td>
              <td>4</td>
              <td>0.00000</td>
              <td>0.00420</td>
              <td>0.01722</td>
              <td>0.00714</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>5</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>none</td>
              <td>1</td>
              <td>5</td>
              <td>0.00000</td>
              <td>0.00084</td>
              <td>0.01722</td>
              <td>0.00798</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.211</td>
              <td>0.328</td>
              <td>High</td>
              <td>2</td>
              <td>1</td>
              <td>0.00798</td>
              <td>0.00000</td>
              <td>0.00798</td>
              <td>0.00000</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.211</td>
              <td>0.328</td>
              <td>High</td>
              <td>2</td>
              <td>2</td>
              <td>0.01050</td>
              <td>0.00000</td>
              <td>0.01848</td>
              <td>0.00000</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.211</td>
              <td>0.328</td>
              <td>High</td>
              <td>2</td>
              <td>3</td>
              <td>0.03738</td>
              <td>0.00882</td>
              <td>0.05586</td>
              <td>0.00882</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.211</td>
              <td>0.328</td>
              <td>High</td>
              <td>2</td>
              <td>4</td>
              <td>0.02478</td>
              <td>0.01512</td>
              <td>0.08064</td>
              <td>0.02394</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.211</td>
              <td>0.328</td>
              <td>High</td>
              <td>2</td>
              <td>5</td>
              <td>0.01512</td>
              <td>0.01596</td>
              <td>0.09576</td>
              <td>0.03990</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.216</td>
              <td>0.313</td>
              <td>High</td>
              <td>3</td>
              <td>1</td>
              <td>0.01764</td>
              <td>0.00042</td>
              <td>0.01764</td>
              <td>0.00042</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.216</td>
              <td>0.313</td>
              <td>High</td>
              <td>3</td>
              <td>2</td>
              <td>0.01512</td>
              <td>0.00168</td>
              <td>0.03276</td>
              <td>0.00210</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.216</td>
              <td>0.313</td>
              <td>High</td>
              <td>3</td>
              <td>3</td>
              <td>0.01974</td>
              <td>0.01218</td>
              <td>0.05250</td>
              <td>0.01428</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.216</td>
              <td>0.313</td>
              <td>High</td>
              <td>3</td>
              <td>4</td>
              <td>0.02226</td>
              <td>0.01680</td>
              <td>0.07476</td>
              <td>0.03108</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>2</td>
              <td>F</td>
              <td>0.216</td>
              <td>0.313</td>
              <td>High</td>
              <td>3</td>
              <td>5</td>
              <td>0.00084</td>
              <td>0.00000</td>
              <td>0.07560</td>
              <td>0.03108</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>3</td>
              <td>F</td>
              <td>0.192</td>
              <td>0.252</td>
              <td>High</td>
              <td>4</td>
              <td>1</td>
              <td>0.01344</td>
              <td>0.00000</td>
              <td>0.01344</td>
              <td>0.00000</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>3</td>
              <td>F</td>
              <td>0.192</td>
              <td>0.252</td>
              <td>High</td>
              <td>4</td>
              <td>2</td>
              <td>0.01008</td>
              <td>0.00168</td>
              <td>0.02352</td>
              <td>0.00168</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>3</td>
              <td>F</td>
              <td>0.192</td>
              <td>0.252</td>
              <td>High</td>
              <td>4</td>
              <td>3</td>
              <td>0.01176</td>
              <td>0.00336</td>
              <td>0.03528</td>
              <td>0.00504</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>3</td>
              <td>F</td>
              <td>0.192</td>
              <td>0.252</td>
              <td>High</td>
              <td>4</td>
              <td>4</td>
              <td>0.02016</td>
              <td>0.00336</td>
              <td>0.05544</td>
              <td>0.00840</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>H1</td>
              <td>3</td>
              <td>F</td>
              <td>0.192</td>
              <td>0.252</td>
              <td>High</td>
              <td>4</td>
              <td>5</td>
              <td>0.01764</td>
              <td>0.00168</td>
              <td>0.07308</td>
              <td>0.01008</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>7</td>
              <td>F</td>
              <td>0.290</td>
              <td>0.264</td>
              <td>none</td>
              <td>5</td>
              <td>1</td>
              <td>0.00924</td>
              <td>0.00042</td>
              <td>0.00924</td>
              <td>0.00042</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>7</td>
              <td>F</td>
              <td>0.290</td>
              <td>0.264</td>
              <td>none</td>
              <td>5</td>
              <td>2</td>
              <td>0.00294</td>
              <td>0.00126</td>
              <td>0.01218</td>
              <td>0.00168</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>7</td>
              <td>F</td>
              <td>0.290</td>
              <td>0.264</td>
              <td>none</td>
              <td>5</td>
              <td>3</td>
              <td>0.00714</td>
              <td>0.00210</td>
              <td>0.01932</td>
              <td>0.00378</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>7</td>
              <td>F</td>
              <td>0.290</td>
              <td>0.264</td>
              <td>none</td>
              <td>5</td>
              <td>4</td>
              <td>0.00168</td>
              <td>0.00294</td>
              <td>0.02100</td>
              <td>0.00672</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>7</td>
              <td>F</td>
              <td>0.290</td>
              <td>0.264</td>
              <td>none</td>
              <td>5</td>
              <td>5</td>
              <td>0.00042</td>
              <td>0.00126</td>
              <td>0.02142</td>
              <td>0.00798</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>8</td>
              <td>F</td>
              <td>0.255</td>
              <td>0.306</td>
              <td>none</td>
              <td>6</td>
              <td>1</td>
              <td>0.02268</td>
              <td>0.00084</td>
              <td>0.02268</td>
              <td>0.00084</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>8</td>
              <td>F</td>
              <td>0.255</td>
              <td>0.306</td>
              <td>none</td>
              <td>6</td>
              <td>2</td>
              <td>0.01260</td>
              <td>0.00000</td>
              <td>0.03528</td>
              <td>0.00084</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>8</td>
              <td>F</td>
              <td>0.255</td>
              <td>0.306</td>
              <td>none</td>
              <td>6</td>
              <td>3</td>
              <td>0.00630</td>
              <td>0.00504</td>
              <td>0.04158</td>
              <td>0.00588</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>8</td>
              <td>F</td>
              <td>0.255</td>
              <td>0.306</td>
              <td>none</td>
              <td>6</td>
              <td>4</td>
              <td>0.00126</td>
              <td>0.00294</td>
              <td>0.04284</td>
              <td>0.00882</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>C1</td>
              <td>8</td>
              <td>F</td>
              <td>0.255</td>
              <td>0.306</td>
              <td>none</td>
              <td>6</td>
              <td>5</td>
              <td>0.00966</td>
              <td>0.01176</td>
              <td>0.05250</td>
              <td>0.02058</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
              <td>⋮</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>33</td>
              <td>M</td>
              <td>0.144</td>
              <td>0.170</td>
              <td>none</td>
              <td>18</td>
              <td>1</td>
              <td>0.00084</td>
              <td>0.00000</td>
              <td>0.00084</td>
              <td>0.00000</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>33</td>
              <td>M</td>
              <td>0.144</td>
              <td>0.170</td>
              <td>none</td>
              <td>18</td>
              <td>2</td>
              <td>0.00504</td>
              <td>0.00000</td>
              <td>0.00588</td>
              <td>0.00000</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>33</td>
              <td>M</td>
              <td>0.144</td>
              <td>0.170</td>
              <td>none</td>
              <td>18</td>
              <td>3</td>
              <td>0.01134</td>
              <td>0.00210</td>
              <td>0.01722</td>
              <td>0.00210</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>33</td>
              <td>M</td>
              <td>0.144</td>
              <td>0.170</td>
              <td>none</td>
              <td>18</td>
              <td>4</td>
              <td>0.00672</td>
              <td>0.00126</td>
              <td>0.02394</td>
              <td>0.00336</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>33</td>
              <td>M</td>
              <td>0.144</td>
              <td>0.170</td>
              <td>none</td>
              <td>18</td>
              <td>5</td>
              <td>0.00462</td>
              <td>0.00084</td>
              <td>0.02856</td>
              <td>0.00420</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>F</td>
              <td>0.292</td>
              <td>0.294</td>
              <td>High</td>
              <td>19</td>
              <td>1</td>
              <td>0.00000</td>
              <td>0.00000</td>
              <td>0.00000</td>
              <td>0.00000</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>F</td>
              <td>0.292</td>
              <td>0.294</td>
              <td>High</td>
              <td>19</td>
              <td>2</td>
              <td>0.00756</td>
              <td>0.00000</td>
              <td>0.00756</td>
              <td>0.00000</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>F</td>
              <td>0.292</td>
              <td>0.294</td>
              <td>High</td>
              <td>19</td>
              <td>3</td>
              <td>0.00756</td>
              <td>0.00252</td>
              <td>0.01512</td>
              <td>0.00252</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>F</td>
              <td>0.292</td>
              <td>0.294</td>
              <td>High</td>
              <td>19</td>
              <td>4</td>
              <td>0.00000</td>
              <td>0.00126</td>
              <td>0.01512</td>
              <td>0.00378</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>F</td>
              <td>0.292</td>
              <td>0.294</td>
              <td>High</td>
              <td>19</td>
              <td>5</td>
              <td>0.00798</td>
              <td>0.00126</td>
              <td>0.02310</td>
              <td>0.00504</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>M</td>
              <td>0.174</td>
              <td>0.178</td>
              <td>High</td>
              <td>20</td>
              <td>1</td>
              <td>0.00000</td>
              <td>0.00042</td>
              <td>0.00000</td>
              <td>0.00042</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>M</td>
              <td>0.174</td>
              <td>0.178</td>
              <td>High</td>
              <td>20</td>
              <td>2</td>
              <td>0.00000</td>
              <td>0.00000</td>
              <td>0.00000</td>
              <td>0.00042</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>M</td>
              <td>0.174</td>
              <td>0.178</td>
              <td>High</td>
              <td>20</td>
              <td>3</td>
              <td>0.00756</td>
              <td>0.00210</td>
              <td>0.00756</td>
              <td>0.00252</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>M</td>
              <td>0.174</td>
              <td>0.178</td>
              <td>High</td>
              <td>20</td>
              <td>4</td>
              <td>0.01806</td>
              <td>0.00084</td>
              <td>0.02562</td>
              <td>0.00336</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>29</td>
              <td>M</td>
              <td>0.174</td>
              <td>0.178</td>
              <td>High</td>
              <td>20</td>
              <td>5</td>
              <td>0.01722</td>
              <td>0.00546</td>
              <td>0.04284</td>
              <td>0.00882</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>34</td>
              <td>M</td>
              <td>0.121</td>
              <td>0.138</td>
              <td>none</td>
              <td>21</td>
              <td>1</td>
              <td>0.00252</td>
              <td>0.00000</td>
              <td>0.00252</td>
              <td>0.00000</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>34</td>
              <td>M</td>
              <td>0.121</td>
              <td>0.138</td>
              <td>none</td>
              <td>21</td>
              <td>2</td>
              <td>0.00420</td>
              <td>0.00000</td>
              <td>0.00672</td>
              <td>0.00000</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>34</td>
              <td>M</td>
              <td>0.121</td>
              <td>0.138</td>
              <td>none</td>
              <td>21</td>
              <td>3</td>
              <td>0.00714</td>
              <td>0.00168</td>
              <td>0.01386</td>
              <td>0.00168</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>34</td>
              <td>M</td>
              <td>0.121</td>
              <td>0.138</td>
              <td>none</td>
              <td>21</td>
              <td>4</td>
              <td>0.00672</td>
              <td>0.00126</td>
              <td>0.02058</td>
              <td>0.00294</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>C3</td>
              <td>34</td>
              <td>M</td>
              <td>0.121</td>
              <td>0.138</td>
              <td>none</td>
              <td>21</td>
              <td>5</td>
              <td>0.00336</td>
              <td>0.00420</td>
              <td>0.02394</td>
              <td>0.00714</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>31</td>
              <td>F</td>
              <td>0.215</td>
              <td>0.336</td>
              <td>High</td>
              <td>22</td>
              <td>1</td>
              <td>0.00294</td>
              <td>0.00042</td>
              <td>0.00294</td>
              <td>0.00042</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>31</td>
              <td>F</td>
              <td>0.215</td>
              <td>0.336</td>
              <td>High</td>
              <td>22</td>
              <td>2</td>
              <td>0.00588</td>
              <td>0.00000</td>
              <td>0.00882</td>
              <td>0.00042</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>31</td>
              <td>F</td>
              <td>0.215</td>
              <td>0.336</td>
              <td>High</td>
              <td>22</td>
              <td>3</td>
              <td>0.00714</td>
              <td>0.00210</td>
              <td>0.01596</td>
              <td>0.00252</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>31</td>
              <td>F</td>
              <td>0.215</td>
              <td>0.336</td>
              <td>High</td>
              <td>22</td>
              <td>4</td>
              <td>0.01302</td>
              <td>0.01050</td>
              <td>0.02898</td>
              <td>0.01302</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>31</td>
              <td>F</td>
              <td>0.215</td>
              <td>0.336</td>
              <td>High</td>
              <td>22</td>
              <td>5</td>
              <td>0.02142</td>
              <td>0.01680</td>
              <td>0.05040</td>
              <td>0.02982</td>
              <td>Day 7-9</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>32</td>
              <td>M</td>
              <td>0.134</td>
              <td>0.135</td>
              <td>High</td>
              <td>23</td>
              <td>1</td>
              <td>0.00126</td>
              <td>0.00000</td>
              <td>0.00126</td>
              <td>0.00000</td>
              <td>Day 1</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>32</td>
              <td>M</td>
              <td>0.134</td>
              <td>0.135</td>
              <td>High</td>
              <td>23</td>
              <td>2</td>
              <td>0.00462</td>
              <td>0.00000</td>
              <td>0.00588</td>
              <td>0.00000</td>
              <td>Day 2</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>32</td>
              <td>M</td>
              <td>0.134</td>
              <td>0.135</td>
              <td>High</td>
              <td>23</td>
              <td>3</td>
              <td>0.00630</td>
              <td>0.00168</td>
              <td>0.01218</td>
              <td>0.00168</td>
              <td>Day 3-4</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>32</td>
              <td>M</td>
              <td>0.134</td>
              <td>0.135</td>
              <td>High</td>
              <td>23</td>
              <td>4</td>
              <td>0.00462</td>
              <td>0.00252</td>
              <td>0.01680</td>
              <td>0.00420</td>
              <td>Day 5-6</td>
            </tr>
            <tr>
              <td>H3</td>
              <td>32</td>
              <td>M</td>
              <td>0.134</td>
              <td>0.135</td>
              <td>High</td>
              <td>23</td>
              <td>5</td>
              <td>0.00924</td>
              <td>0.00336</td>
              <td>0.02604</td>
              <td>0.00756</td>
              <td>Day 7-9</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-512d6588-c7d7-41e5-ba45-6261a66b3784-nb-3" specific-use="notebook-content">
    <code language="r script">field_cage_locust_intake_rebalance_plot &lt;- raw_locust_data |&gt;
    drop_na() |&gt;
    ggplot(aes(x=cumulative_total_p,y=cumulative_total_c,group=id,color=treatment)) +
        geom_point(alpha=0.3) +
        geom_line(alpha=0.3) +
        geom_point(data = locust_model_data,
                   aes(y = pred_carb, x = pred_protein,
                       group=treatment, color=treatment), size=5) +
        geom_line(data = locust_model_data,
                   aes(y = pred_carb, x = pred_protein,
                       group=treatment, color=treatment),linewidth=1.5) +
        coord_equal(ratio=1) + 
        xlim(0,0.1) + ylim(0,0.1) + 
        theme_pubr() + 
        ylab(&quot;total carbohydrate consumed (g)&quot;) +
        xlab(&quot;total protein consumed  (g)&quot;) + 
        geom_abline(slope = 1,linetype=1,intercept=0) + 
        geom_abline(slope = 2,linetype=2,intercept=0) +
        scale_color_manual(values = c('#74c476','#00441b'))

field_cage_locust_intake_rebalance_plot</code>
    <boxed-text>
      <preformat>Warning message:
“Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 2 rows containing missing values or values outside the scale range
(`geom_line()`).”</preformat>
    </boxed-text>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_field_cage_manuscript_figure_table_code.ipynb_files/figure-jats/cell-10-output-2.png" />
    </boxed-text>
    </sec>
    <sec id="cell-78517042-ba67-485a-b2bd-36083797e53d-nb-3" specific-use="notebook-content">
    <code language="r script">ggsave(field_cage_locust_intake_rebalance_plot,
       file=here('output/publication_figures/field_cage_locust_intake_target_rebalancing.png'),
       width=5,height=5)</code>
    <boxed-text>
      <preformat>Warning message:
“Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).”
Warning message:
“Removed 2 rows containing missing values or values outside the scale range
(`geom_line()`).”</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-30c8676d-bde3-48ad-b983-3478c50f5e5a-nb-3" specific-use="notebook-content">
  </sec>
  <sec id="table---plant-nutrients-through-time-nb-3">
    <title>Table - Plant Nutrients through time</title>
    </sec>
    <sec id="cell-475cdb4b-363c-4b6c-a59b-350e809ea615-nb-3" specific-use="notebook-content">
    <code language="r script">mods &lt;- readRDS(here(&quot;output/field_cage_experiment/model_objects/plant_nutrient_through_time_models.rds&quot;))

final_mod &lt;- mods$mod1

parametric_terms &lt;- tidy(final_mod,parametric=TRUE) |&gt;
    dplyr::select(term,estimate,std.error,p.value) |&gt;
    rename(variable = term,
           SE = std.error,
           `p-value` = p.value) |&gt;
    mutate(variable = gsub('\\(|\\)|treatment|date|diet','',variable),
          macronutrient = case_when(str_detect(variable,'\\.1') ~ 'protein', TRUE ~ 'carbohydrate'),
          variable = gsub('\\.1','',variable))
nonparametric_terms &lt;- tidy(final_mod,parametric=FALSE)

nonparametric_terms  &lt;- tidy(final_mod,parametric=FALSE) |&gt;
    dplyr::select(term,edf,statistic,p.value) |&gt;
    rename(variable = term,
           EDF = edf,
           `p-value` = p.value) |&gt;
    mutate(macronutrient = case_when(str_detect(variable,'s\\.1') ~ 'protein', TRUE ~ 'carbohydrate'),
          variable = gsub('\\.1','',variable))

field_cage_plant_nutrients_model_results &lt;- bind_rows(parametric_terms,nonparametric_terms)</code>
    </sec>
    <sec id="f7b5bdc0-9547-4ee9-80e9-6cdd37fc2953-nb-3" specific-use="notebook-content">
    <code language="r script">field_cage_plant_nutrients_model_results |&gt; head(2)</code>
    <boxed-text>
      <p>A tibble: 2 × 7</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
          </colgroup>
          <thead>
            <tr>
              <th>variable &lt;chr&gt;</th>
              <th>estimate &lt;dbl&gt;</th>
              <th>SE &lt;dbl&gt;</th>
              <th>p-value &lt;dbl&gt;</th>
              <th>macronutrient &lt;chr&gt;</th>
              <th>EDF &lt;dbl&gt;</th>
              <th>statistic &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Intercept</td>
              <td>0.12699385</td>
              <td>0.007284922</td>
              <td>4.681898e-68</td>
              <td>carbohydrate</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>Medium</td>
              <td>-0.02028183</td>
              <td>0.007170558</td>
              <td>4.676868e-03</td>
              <td>carbohydrate</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="f82e0c72-33b8-4d36-b34f-63869ea0eeb3-nb-3" specific-use="notebook-content">
    <code language="r script">write.csv(field_cage_plant_nutrients_model_results,
          file=here('output/publication_tables/field_cage_plant_nutrients_model_summary.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="cell-8529c918-fd15-4a4c-82c6-11c06fabc6d4-nb-3" specific-use="notebook-content">
  </sec>
  <sec id="table---field-cage-final-locust-mass-nb-3">
    <title>Table - field cage final locust mass</title>
    </sec>
    <sec id="b8f93154-25b9-4883-8605-eca8a550b69c-nb-3" specific-use="notebook-content">
    <code language="r script">locust_mass_model &lt;- readRDS(here(&quot;output/field_cage_experiment/model_objects/final_locust_weight_by_field_cage_treatment_models.rds&quot;))</code>
    </sec>
    <sec id="bd0083ee-d997-4353-9bc6-d3b5e551f033-nb-3" specific-use="notebook-content">
    <code language="r script">parametric_terms &lt;- tidy(locust_mass_model,parametric=TRUE)  |&gt;
    dplyr::select(term,estimate,std.error,p.value) |&gt;
    rename(variable = term,
           SE = std.error,
           `p-value` = p.value) |&gt;
    mutate(variable = gsub('\\(|\\)','',variable),
           variable = gsub('treatment|sex','',variable),
           variable = case_when(variable == 'M' ~ 'male',TRUE ~ variable)) |&gt;
    dplyr::select(variable,estimate,SE,`p-value`)

nonparametric_terms  &lt;- tidy(locust_mass_model,parametric=FALSE) |&gt;
    dplyr::select(term,edf,statistic,p.value) |&gt;
    rename(variable = term,
           EDF = edf,
           `p-value` = p.value)

locust_mass_model_summary &lt;- bind_rows(parametric_terms,nonparametric_terms)</code>
    </sec>
    <sec id="cell-7e0e8699-d8bd-4ba0-b4dd-2bdd280680eb-nb-3" specific-use="notebook-content">
    <code language="r script">locust_mass_model_summary</code>
    <boxed-text>
      <p>A tibble: 6 × 6</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
          </colgroup>
          <thead>
            <tr>
              <th>variable &lt;chr&gt;</th>
              <th>estimate &lt;dbl&gt;</th>
              <th>SE &lt;dbl&gt;</th>
              <th>p-value &lt;dbl&gt;</th>
              <th>EDF &lt;dbl&gt;</th>
              <th>statistic &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Intercept</td>
              <td>0.32618758</td>
              <td>0.007209637</td>
              <td>0.000000e+00</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>male</td>
              <td>-0.14769427</td>
              <td>0.005506869</td>
              <td>1.888448e-158</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>medium</td>
              <td>0.01493507</td>
              <td>0.009518326</td>
              <td>1.166280e-01</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>high</td>
              <td>-0.01105525</td>
              <td>0.010095181</td>
              <td>2.734721e-01</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>s(carb_mg_mg,protein_mg_mg)</td>
              <td>NA</td>
              <td>NA</td>
              <td>4.164041e-01</td>
              <td>0.001665257</td>
              <td>0.001606924</td>
            </tr>
            <tr>
              <td>s(cage_num)</td>
              <td>NA</td>
              <td>NA</td>
              <td>1.783095e-05</td>
              <td>17.399298527</td>
              <td>42.160313817</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-4424b293-2929-4e4b-b7bb-4c88cd149026-nb-3" specific-use="notebook-content">
    <code language="r script">write.csv(locust_mass_model_summary,
          file=here('output/publication_tables/field_cage_final_locust_mass_model_summary.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="bfaecbc2-6804-4d87-8488-9c3a9a4df588-nb-3" specific-use="notebook-content">
  </sec>
  <sec id="table---locust-nutrient-rebalancing-model-summary-nb-3">
    <title>Table - locust nutrient rebalancing model summary</title>
    </sec>
    <sec id="cell-7ec53419-61e3-478c-932d-d9d2f128cff3-nb-3" specific-use="notebook-content">
    <code language="r script">mods &lt;- readRDS(here(&quot;output/field_cage_experiment/model_objects/intake_target_through_time_models.rds&quot;))

locust_rebalance_model &lt;- mods$mod1</code>
    </sec>
    <sec id="cell-4d2acb0b-9a91-40f4-aed4-39ef7bd19385-nb-3" specific-use="notebook-content">
    <code language="r script">summary(locust_rebalance_model)</code>
    <boxed-text>
      <preformat>
Family: Multivariate normal 
Link function: 

Formula:
cumulative_total_c ~ sex + interval + treatment + s(id, bs = &quot;re&quot;)
cumulative_total_p ~ sex + interval + treatment + s(id, bs = &quot;re&quot;)

Parametric coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      0.0125868  0.0036504   3.448 0.000565 ***
sexM            -0.0108931  0.0041592  -2.619 0.008818 ** 
interval2        0.0066835  0.0025232   2.649 0.008077 ** 
interval3        0.0160330  0.0025232   6.354 2.09e-10 ***
interval4        0.0259670  0.0025232  10.291  &lt; 2e-16 ***
interval5        0.0350061  0.0025232  13.874  &lt; 2e-16 ***
treatmentnone   -0.0061015  0.0040947  -1.490 0.136202    
(Intercept).1    0.0022792  0.0014613   1.560 0.118829    
sexM.1          -0.0036943  0.0014086  -2.623 0.008726 ** 
interval2.1      0.0005296  0.0014992   0.353 0.723909    
interval3.1      0.0034148  0.0014992   2.278 0.022739 *  
interval4.1      0.0071035  0.0014992   4.738 2.16e-06 ***
interval5.1      0.0125817  0.0014992   8.392  &lt; 2e-16 ***
treatmentnone.1 -0.0009902  0.0013868  -0.714 0.475224    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
          edf Ref.df Chi.sq p-value    
s(id)   17.59     20  484.7  &lt;2e-16 ***
s.1(id) 10.61     20  110.7   0.381    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Deviance explained = 73.4%
-REML = -954.88  Scale est. = 1         n = 115</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-1a2e7c2e-1085-4372-866d-98d8d955cb6b-nb-3" specific-use="notebook-content">
    <code language="r script">parametric &lt;- tidy(locust_rebalance_model,parametric=TRUE) |&gt;
    dplyr::select(term,estimate,std.error,p.value) |&gt;
    rename(variable = term,
           SE = std.error,
           `p-value` = p.value) |&gt;
    mutate(variable = gsub('\\(|\\)','',variable),
           macronutrient = case_when(str_detect(variable,'.1') ~ 'protein', TRUE ~ 'carbohydrate'),
           variable = gsub('.1|treatment|sex|interval|treatment','',variable),
           variable = case_when(variable == '2' ~ 'day 2',
                                variable == '3' ~ 'day 3-4',
                                variable == '4' ~ 'day 5-6',
                                variable == '5' ~ 'day 7-9',
                                variable == 'M' ~ 'male',TRUE ~ variable)) |&gt;
    dplyr::select(macronutrient,variable,estimate,SE,`p-value`)


nonparametric &lt;- tidy(locust_rebalance_model,parametric=FALSE) |&gt;
    rename(variable = term,
           EDF = edf,
           `p-value` = p.value) |&gt;
    mutate(macronutrient = case_when(str_detect(variable,'.1') ~ 'protein', TRUE ~ 'carbohydrate'),
          variable = gsub('\\.|1','',variable)) |&gt;
    dplyr::select(macronutrient,variable,statistic,`p-value`)



locust_mass_model_summary &lt;- bind_rows(parametric,nonparametric)</code>
    </sec>
    <sec id="cell-766d1c7b-0520-476d-9c70-1483e077b92c-nb-3" specific-use="notebook-content">
    <code language="r script">write.csv(locust_mass_model_summary,
          file=here('output/publication_tables/field_cage_locust_nutrient_rebalancing_model_summary.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="cell-150493d5-18ed-424b-9984-1b831ce6f999-nb-3" specific-use="notebook-content">
  </sec>
</sec>
<sec id="section-2-supplementary-figures-and-tables-nb-3">
  <title>Section 2 – supplementary figures and tables</title>
  <sec id="figure---individual-time-step-instake-targets-for-field-cage-locusts-nb-3">
    <title>Figure - individual time step instake targets for field cage
    locusts</title>
    </sec>
    <sec id="b1937f9c-1064-40c9-8e20-6310a0be2fb1-nb-3" specific-use="notebook-content">
    <code language="r script">raw_locust_data &lt;- read_csv(here('data/processed/field_cage_experiment/intake_target_through_time_predictions_raw_data.csv'),
    show_col_types = FALSE)


locust_model_data &lt;- read_csv(here('data/processed/field_cage_experiment/intake_target_through_time_predictions.csv'),
    show_col_types = FALSE)


raw_locust_data |&gt; head(1)
locust_model_data |&gt; head(1)</code>
    <boxed-text>
      <p>A tibble: 1 × 13</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
            <col width="8%" />
          </colgroup>
          <thead>
            <tr>
              <th>field_plot &lt;chr&gt;</th>
              <th>field_cage_num &lt;dbl&gt;</th>
              <th>sex &lt;chr&gt;</th>
              <th>locust_initialmass_g &lt;dbl&gt;</th>
              <th>locusts_final_mass_g &lt;dbl&gt;</th>
              <th>treatment &lt;chr&gt;</th>
              <th>id &lt;dbl&gt;</th>
              <th>interval &lt;dbl&gt;</th>
              <th>total_c &lt;dbl&gt;</th>
              <th>total_p &lt;dbl&gt;</th>
              <th>cumulative_total_c &lt;dbl&gt;</th>
              <th>cumulative_total_p &lt;dbl&gt;</th>
              <th>day_interval &lt;chr&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>C1</td>
              <td>5</td>
              <td>M</td>
              <td>0.167</td>
              <td>0.165</td>
              <td>none</td>
              <td>1</td>
              <td>1</td>
              <td>0</td>
              <td>0.00042</td>
              <td>0</td>
              <td>0.00042</td>
              <td>Day 1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    <boxed-text>
      <p>A tibble: 1 × 4</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="25%" />
            <col width="25%" />
            <col width="25%" />
            <col width="25%" />
          </colgroup>
          <thead>
            <tr>
              <th>treatment &lt;chr&gt;</th>
              <th>interval &lt;dbl&gt;</th>
              <th>pred_carb &lt;dbl&gt;</th>
              <th>pred_protein &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>High</td>
              <td>1</td>
              <td>0.007140269</td>
              <td>0.0004320264</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-7c8559be-9a77-405b-9d3e-5d9da800d5ff-nb-3" specific-use="notebook-content">
    <code language="r script">field_cage_locust_intake_rebalance_day_facet_plot &lt;- raw_locust_data |&gt;
    group_by(day_interval) |&gt;
    mutate(mean_carb = mean(total_c),mean_protein = mean(total_p)) |&gt;
    ggplot(aes(x=total_p,y=total_c)) +
        geom_point(color='black') +
        geom_point(aes(x=mean_protein,y=mean_carb),size=5,color='blue') +
        coord_equal(ratio=1) + 
        xlab(&quot;Protein consumed (g)&quot;) + 
        ylab(&quot;Carbohydrates consumed (g)&quot;) + 
        theme_pubr() +
        geom_abline(slope = 1,linetype=1) + 
        geom_abline(slope = 2,linetype=2) + 
        facet_wrap(~day_interval) + 
        xlim(0,0.04) +
        ylim(0,0.04)

field_cage_locust_intake_rebalance_day_facet_plot</code>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_field_cage_manuscript_figure_table_code.ipynb_files/figure-jats/cell-24-output-1.png" />
    </boxed-text>
    </sec>
    <sec id="cell-1e9a5dee-8c9c-4815-bf02-546d96628314-nb-3" specific-use="notebook-content">
    <code language="r script">ggsave(field_cage_locust_intake_rebalance_day_facet_plot,
       file=here('output/publication_figures/field_cage_locust_intake_rebalance_day_facet_plot.png'),
       width=15,height=10)</code>
    </sec>
    <sec id="cell-3f03a21c-509e-4d17-903c-4136aa7ce4df-nb-3" specific-use="notebook-content">
  </sec>
  <sec id="figure---field-cage-soil-n-content-by-treatment-and-plant-carbohydrate-and-protein-nb-3">
    <title>Figure - field cage soil N content by treatment and plant
    carbohydrate and protein</title>
    <p>We need to regress soil and plant nutrients together</p>
    <list list-type="bullet">
      <list-item>
        <p>panel a: initial no3 to treatment</p>
      </list-item>
      <list-item>
        <p>panel b: initial no4 to treatment</p>
      </list-item>
      <list-item>
        <p>panel c: plant protein to no3</p>
      </list-item>
      <list-item>
        <p>panel d: plant protein to no4</p>
      </list-item>
      <list-item>
        <p>panel e: plant carbohydrate to no3</p>
      </list-item>
      <list-item>
        <p>panel f: plant carbohydrate to no4</p>
      </list-item>
    </list>
    </sec>
    <sec id="d265cdc4-3938-4136-864f-19b10ab58e42-nb-3" specific-use="notebook-content">
    <code language="r script">soil_plant &lt;- read_csv(here('data/processed/field_cage_experiment/plant_soil_nutrient_data.csv'))
soil_dat &lt;- read_csv(here('data/processed/field_cage_experiment/soil_nutrient_data'))</code>
    <boxed-text>
      <preformat>Rows: 168 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr  (2): plot, treatment
dbl  (4): protein_mg_mg, carb_mg_mg, mean_no3, mean_no4
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 36 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (1): treatment
dbl (2): initial_no3, initial_no4

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</preformat>
    </boxed-text>
    </sec>
    <sec id="c08a930c-2b49-402a-b9bd-7e3d2a52c3e7-nb-3" specific-use="notebook-content">
    <code language="r script">panel_a &lt;- soil_dat |&gt;
    mutate(treatment = factor(treatment,levels=c('None','Medium','High'))) |&gt;
    ggplot(aes(x=treatment,y=initial_no4)) +
        geom_boxplot() +
        geom_jitter(width=0.25) +
        xlab('') +
        ylab('Initial Soil NO4') +
        theme_pubr()

panel_b &lt;- soil_dat |&gt;
    mutate(treatment = factor(treatment,levels=c('None','Medium','High'))) |&gt;
    ggplot(aes(x=treatment,y=initial_no3)) +
        geom_boxplot() +
        geom_jitter(width=0.25) +
        xlab('') +
        ylab('Initial Soil NO3') +
        theme_pubr()

panel_c &lt;- soil_plant |&gt;
    ggplot(aes(x=mean_no3,y=protein_mg_mg)) +
        geom_point() +
        geom_smooth(method='lm',se=FALSE,color='red',size=1.3)  +
        xlab('Initial Soil NO3') +
        ylab('Protein mg/mg') +
        theme_pubr()

panel_d &lt;- soil_plant |&gt;
    ggplot(aes(x=mean_no4,y=protein_mg_mg)) +
        geom_point() +
        geom_smooth(method='lm',se=FALSE,color='red',size=1.3)  +
        xlab('Initial Soil NO4') +
        ylab('Protein mg/mg') +
        theme_pubr()

panel_e &lt;- soil_plant |&gt;
    ggplot(aes(x=mean_no3,y=carb_mg_mg)) +
        geom_point() +
        geom_smooth(method='lm',se=FALSE,color='red',size=1.3)  +
        xlab('Initial Soil NO3') +
        ylab('Carbohydrate mg/mg') +
        theme_pubr()

panel_f &lt;- soil_plant |&gt;
    ggplot(aes(x=mean_no4,y=protein_mg_mg)) +
        geom_point() +
        geom_smooth(method='lm',se=FALSE,color='red',size=1.3)  +
        xlab('Initial Soil NO4') +
        ylab('Protein mg/mg') +
        theme_pubr()




layout &lt;- &quot;
AB
CD
EF
&quot;

plant_and_soil_nutrients &lt;- panel_a + panel_b + panel_d + panel_c + panel_f + panel_e +
  plot_layout(design = layout) + plot_annotation(tag_levels = 'a')

plant_and_soil_nutrients</code>
    <boxed-text>
      <preformat>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</preformat>
    </boxed-text>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_field_cage_manuscript_figure_table_code.ipynb_files/figure-jats/cell-27-output-2.png" />
    </boxed-text>
    </sec>
    <sec id="cell-2aea6295-0eed-418f-8d55-77eb8c61d98f-nb-3" specific-use="notebook-content">
    <code language="r script">ggsave(plant_and_soil_nutrients,
       file=here('output/publication_figures/field_cage_plant_and_soil_nutrient_correlations.png'),
       width=10,height=15)</code>
    <boxed-text>
      <preformat>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-2692efc3-d8c9-4ea3-bbc7-f2efe367da1d-nb-3" specific-use="notebook-content">
  </sec>
  <sec id="table---plant-species-nutrient-content-nb-3">
    <title>table - plant species nutrient content</title>
    </sec>
    <sec id="cell-36657598-4458-439a-9eb3-9ff33d85fca9-nb-3" specific-use="notebook-content">
    <code language="r script">dat &lt;- read_csv(here('data/processed/field_cage_experiment/plant_species_soil_nutrient_by_treatment.csv'),show_col_types = FALSE)
    </code>
    </sec>
    <sec id="e7fc5a7e-b48c-4ede-9cc6-b7b22adc3cd2-nb-3" specific-use="notebook-content">
    <code language="r script">write.csv(dat,
          file=here('output/publication_tables/field_cage_plant_species_nutrient_content.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="cell-327e9a52-21a7-4609-8eff-02acb934ccf2-nb-3" specific-use="notebook-content">
  </sec>
  <sec id="table-plant-species-ground-cover-nb-3">
    <title>table – plant species ground cover</title>
    </sec>
    <sec id="cell-5ac51f84-1aea-47cd-b55a-43c920bf7c1f-nb-3" specific-use="notebook-content">
    <code language="r script">dat &lt;- read_csv(here('data/processed/field_cage_experiment/plant_ground_cover_by_treatment.csv'),show_col_types = FALSE)
dat</code>
    <boxed-text>
      <p>A spec_tbl_df: 3 × 7</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
            <col width="14%" />
          </colgroup>
          <thead>
            <tr>
              <th>treatment &lt;chr&gt;</th>
              <th>plant_cover &lt;dbl&gt;</th>
              <th>Urochloa panicoides &lt;dbl&gt;</th>
              <th>Enteropogon acicularis &lt;dbl&gt;</th>
              <th>Austrodanthonia caespitosa &lt;dbl&gt;</th>
              <th>Cyperus rotundus &lt;dbl&gt;</th>
              <th>stipa species &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>High</td>
              <td>27.38095</td>
              <td>47.50000</td>
              <td>67.38095</td>
              <td>15.23810</td>
              <td>15.00000</td>
              <td>0</td>
            </tr>
            <tr>
              <td>Medium</td>
              <td>35.23810</td>
              <td>15.00000</td>
              <td>65.47619</td>
              <td>18.33333</td>
              <td>17.29167</td>
              <td>5</td>
            </tr>
            <tr>
              <td>None</td>
              <td>35.47619</td>
              <td>13.33333</td>
              <td>60.11905</td>
              <td>15.35714</td>
              <td>19.33333</td>
              <td>0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-7ab36a03-6063-4345-a549-b737842acab4-nb-3" specific-use="notebook-content">
    <code language="r script">write.csv(dat,
          file=here('output/publication_tables/field_cage_plant_ground_cover.csv'),
          row.names=FALSE)</code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-12-nb-4">
<front-stub>
<title-group>
<article-title>Field population statistical analyses – Choice
Experiment</article-title>
</title-group>
</front-stub>

<body>
<sec id="cell-83694d4d-3778-489c-96f4-d70a92fe2eeb-nb-4" specific-use="notebook-content">
<p>this script conducts the statistics for the Choice experiment intake
target of field caught Australian plauge locusts</p>
<p>Specifics for the experiment design can be found in the
publication.</p>
</sec>
<sec id="ad87368c-1585-4b18-a3cb-dff640216a9b-nb-4" specific-use="notebook-content">
<code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;mgcv&quot;, &quot;MuMIn&quot;, &quot;multcomp&quot;, &quot;gratia&quot;, 
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;broom&quot;, &quot;knitr&quot;, &quot;janitor&quot;, 
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;GGally&quot;,&quot;tidyverse&quot;)

load_packages(packages)

i_am('README.md')

# Functions
                   
## Standard error
std &lt;- function(x) sd(x)/sqrt(length(x))


# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10)
</code>
<boxed-text>
  <preformat>This is mgcv 1.9-1. For overview type 'help(&quot;mgcv-package&quot;)'.


Attaching package: ‘TH.data’


The following object is masked from ‘package:MASS’:

    geyser



Attaching package: ‘patchwork’


The following object is masked from ‘package:MASS’:

    area



Attaching package: ‘janitor’


The following objects are masked from ‘package:stats’:

    chisq.test, fisher.test


here() starts at /home/datascience/herbivore_nutrient_interactions

Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2

── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ stringr::boundary() masks gratia::boundary()
✖ dplyr::collapse()   masks nlme::collapse()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::lag()        masks stats::lag()
✖ dplyr::select()     masks MASS::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
here() starts at /home/datascience/herbivore_nutrient_interactions
  </preformat>
</boxed-text>
</sec>
<sec id="cell-2f4a1339-1103-4c60-933d-9fe7785263c8-nb-4" specific-use="notebook-content">
<sec id="choice-experiment-nb-4">
  <title>Choice Experiment</title>
  <sec id="data-import-nb-4">
    <title>Data import</title>
    <p>This code reads a CSV file containing IT data, cleans the column
    names, converts specific columns to factors, and removes rows with
    missing values in the <monospace>protein_consumed_g</monospace> and
    <monospace>carb_consumed_g</monospace> columns.</p>
    <p>column descriptions:</p>
    <list list-type="bullet">
      <list-item>
        <p>population: a factor with two levels Guntawang or
        Mendooran</p>
      </list-item>
      <list-item>
        <p>cage_no: the cage number for the specific locust used in the
        experiment</p>
      </list-item>
      <list-item>
        <p>diet_pair: a factor with two levels A or B: 7p:35c &amp;
        28p:14c or 7p:35c &amp; 35p:7c <italic>check if this is
        correct</italic></p>
      </list-item>
      <list-item>
        <p>sex: a factor with two levels M or F: Male or Female sex of
        the individual locust</p>
      </list-item>
      <list-item>
        <p>initial_mass_g: the starting mass for the specific locust in
        grams</p>
      </list-item>
      <list-item>
        <p>total_consumed_g: total amount of diet consumed between the
        two options for each individual</p>
      </list-item>
      <list-item>
        <p>protein_consumed_g: total amount of protein consumed for each
        individual</p>
      </list-item>
      <list-item>
        <p>carb_consumed_g: total amount of carbohydrates consumed for
        each individual</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-897c890b-13aa-4a4b-9b83-b730b001f44c-nb-4" specific-use="notebook-content">
    <code language="r script">
dat &lt;- read_csv(here(&quot;data/raw/field_populations/IT_dat.csv&quot;),show_col_types = FALSE) |&gt;
    clean_names() |&gt;
    mutate(across(c(population,sex,diet_pair,cage_no,low_p_diet,high_p_diet,notes_exclude_reason),~factor(.))) |&gt;
    drop_na(protein_consumed_g,carb_consumed_g)
           

dat |&gt; head()</code>
    <boxed-text>
      <p>A tibble: 6 × 11</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
            <col width="9%" />
          </colgroup>
          <thead>
            <tr>
              <th>cage_no &lt;fct&gt;</th>
              <th>population &lt;fct&gt;</th>
              <th>diet_pair &lt;fct&gt;</th>
              <th>sex &lt;fct&gt;</th>
              <th>initial_mass_g &lt;dbl&gt;</th>
              <th>low_p_diet &lt;fct&gt;</th>
              <th>high_p_diet &lt;fct&gt;</th>
              <th>total_consumed_g &lt;dbl&gt;</th>
              <th>protein_consumed_g &lt;dbl&gt;</th>
              <th>carb_consumed_g &lt;dbl&gt;</th>
              <th>notes_exclude_reason &lt;fct&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>Mendooran</td>
              <td>A</td>
              <td>M</td>
              <td>0.146</td>
              <td>7p:35c</td>
              <td>35p:7c</td>
              <td>0.063</td>
              <td>0.006</td>
              <td>0.021</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>2</td>
              <td>Mendooran</td>
              <td>A</td>
              <td>M</td>
              <td>0.150</td>
              <td>7p:35c</td>
              <td>35p:7c</td>
              <td>0.069</td>
              <td>0.010</td>
              <td>0.019</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>3</td>
              <td>Mendooran</td>
              <td>A</td>
              <td>F</td>
              <td>0.310</td>
              <td>7p:35c</td>
              <td>35p:7c</td>
              <td>0.075</td>
              <td>0.018</td>
              <td>0.014</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>4</td>
              <td>Mendooran</td>
              <td>A</td>
              <td>F</td>
              <td>0.201</td>
              <td>7p:35c</td>
              <td>35p:7c</td>
              <td>0.063</td>
              <td>0.004</td>
              <td>0.022</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>5</td>
              <td>Mendooran</td>
              <td>A</td>
              <td>M</td>
              <td>0.133</td>
              <td>7p:35c</td>
              <td>35p:7c</td>
              <td>0.072</td>
              <td>0.011</td>
              <td>0.019</td>
              <td>NA</td>
            </tr>
            <tr>
              <td>6</td>
              <td>Mendooran</td>
              <td>A</td>
              <td>F</td>
              <td>0.279</td>
              <td>7p:35c</td>
              <td>35p:7c</td>
              <td>0.129</td>
              <td>0.013</td>
              <td>0.042</td>
              <td>NA</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-3086431f-837a-4fd3-8e01-398724a9139f-nb-4" specific-use="notebook-content">
  </sec>
</sec>
<sec id="raw-data-visualization-nb-4">
  <title>Raw data visualization</title>
  <p>I am using <monospace>ggpairs</monospace> to make this section
  pithy</p>
  </sec>
  <sec id="cell-3d1230c6-d667-4190-b7e3-d18697c79de0-nb-4" specific-use="notebook-content">
  <code language="r script">numeric_columns &lt;- c(&quot;initial_mass_g&quot;, &quot;total_consumed_g&quot;, &quot;protein_consumed_g&quot;,&quot;carb_consumed_g&quot;)

my_dens &lt;- function(data, mapping,...) {
  ggplot(data = data, mapping=mapping) +
    geom_density(..., alpha = 0.7, fill = NA) 
}


population_raw_graph &lt;- dat |&gt;
    dplyr::select(!c(cage_no,notes_exclude_reason)) |&gt;
    ggpairs(aes(color=population,fill=population),columns = numeric_columns,diag = list(continuous = my_dens))  +
    scale_colour_manual(values=c('#e5a335','#96410e'))  +
    scale_fill_manual(values=c('#e5a335','#96410e')) +
    theme_pubr()

sex_raw_graph &lt;- dat |&gt;
    dplyr::select(!c(cage_no,notes_exclude_reason)) |&gt;
    ggpairs(aes(color=sex),columns = numeric_columns,diag = list(continuous = my_dens))  +
    scale_colour_manual(values=c('#e5a335','#96410e'))  +
    scale_fill_manual(values=c('#e5a335','#96410e')) +
    theme_pubr()

diet_pair_raw_graph &lt;- dat |&gt;
    dplyr::select(!c(cage_no,notes_exclude_reason)) |&gt;
    ggpairs(aes(color=diet_pair),columns = numeric_columns,diag = list(continuous = my_dens))  +
    scale_colour_manual(values=c('#e5a335','#96410e'))  +
    scale_fill_manual(values=c('#e5a335','#96410e')) +
    theme_pubr()
  </code>
  </sec>
  <sec id="cell-750ad3b4-230c-4b6b-9d14-12f7c84fd959-nb-4" specific-use="notebook-content">
  <p>Now save to the output location</p>
  </sec>
  <sec id="cell-7da998e2-d503-474a-96c9-45ea04910e14-nb-4" specific-use="notebook-content">
  <code language="r script"># Define the output directory
output_dir &lt;- here('output/field_populations/raw_visualization/')

# List of plots and their corresponding file names
plots &lt;- list(
  &quot;choice_experiment_population_raw_graph&quot; = population_raw_graph,
  &quot;choice_experiment_sex_raw_graph&quot; = sex_raw_graph,
  &quot;choice_experiment_diet_pair_raw_graph&quot; = diet_pair_raw_graph
)

# Loop through each plot and save it
for (name in names(plots)) {
  ggsave(
    filename = file.path(output_dir, paste0(name, &quot;.png&quot;)),
    plot = plots[[name]],
    width = 10, height = 10, dpi = 300
  )
}</code>
  </sec>
  <sec id="cell-75f153b1-5847-4c75-a2f0-a850205079ed-nb-4" specific-use="notebook-content">
  <sec id="model-building-nb-4">
    <title>Model building</title>
    <sec id="general-additive-models-gam-for-carbohydrate-and-protein-consumption-of-field-populations-nb-4">
      <title>General Additive Models (GAM) for Carbohydrate and Protein
      Consumption of Field Populations</title>
      <p>In this analysis, we are exploring the relationship between
      carbohydrate and protein consumption using General Additive Models
      (GAMs) with different explanatory variables for two field
      popualtions of locusts. Each model assumes a multivariate normal
      (MVN) distribution for the responses.</p>
    </sec>
    <sec id="model-overview-nb-4">
      <title>Model Overview</title>
      <p><bold>Model 1: Non-linear Relationship with Initial
      Mass</bold></p>
      <p>Formula: - carb_consumed_g ~ population + diet_pair + sex +
      s(initial_mass_g, k=30) - protein_consumed_g ~ population +
      diet_pair + sex + s(initial_mass_g, k=30)</p>
      <p>Description: This model allows for a non-linear relationship
      between the initial mass of the subject and the consumption of
      carbohydrates and proteins. The smoothing function
      s(initial_mass_g, k=30) captures the non-linear effects with a
      basis dimension of 30.</p>
      <p><bold>Model 2: Linear Relationship with Initial Mass</bold></p>
      <p>Formula: - carb_consumed_g ~ population + diet_pair + sex +
      initial_mass_g - protein_consumed_g ~ population + diet_pair + sex
      + initial_mass_g</p>
      <p>Description: In this model, the relationship between initial
      mass and nutrient consumption is assumed to be linear. This model
      tests whether a simpler, linear approximation can adequately
      describe the relationship.</p>
      <p><bold>Model 3: Excluding Initial Mass</bold></p>
      <p>Formula: - carb_consumed_g ~ population + sex + diet_pair -
      protein_consumed_g ~ population + sex + diet_pair</p>
      <p>Description: This model excludes the initial mass as an
      explanatory variable, focusing only on population, sex, and diet
      pair to explain the variation in carbohydrate and protein
      consumption.</p>
      <p><bold>Model 4: Null Model</bold></p>
      <p>Formula: - carb_consumed_g ~ 1 - protein_consumed_g ~ 1</p>
      <p>Description: The null model includes only an intercept, serving
      as a baseline to compare the other models. This model should
      represent the worst fit to the data, as it assumes no relationship
      between the predictors and the response variables.</p>
      <p>After fitting these models, we will compare them using the
      following criteria:</p>
      <list list-type="bullet">
        <list-item>
          <p>Akaike Information Criterion (AIC): A measure of the
          relative quality of the models for a given dataset,
          considering both goodness of fit and model complexity.</p>
        </list-item>
        <list-item>
          <p>Bayesian Information Criterion (BIC): Similar to AIC, but
          with a stronger penalty for models with more parameters.</p>
        </list-item>
        <list-item>
          <p>Corrected AIC (AICc): AIC adjusted for small sample sizes,
          ensuring a more reliable comparison when sample sizes are
          limited. By examining the AIC, BIC, and AICc values, we will
          select the best model for explaining carbohydrate and protein
          consumption.</p>
        </list-item>
      </list>
      </sec>
      <sec id="cell-6acf88f7-74e8-41cf-962a-fac4287f6329-nb-4" specific-use="notebook-content">
      <code language="r script"># Model 1: Non-linear Relationship with Initial Mass
mod1 &lt;- gam(list(
  carb_consumed_g ~ population + diet_pair + sex + s(initial_mass_g, k=30),
  protein_consumed_g ~ population + diet_pair + sex + s(initial_mass_g, k=30)
), family = mvn(d = 2), select = TRUE, data = dat)

# Model 2: Linear Relationship with Initial Mass
mod2 &lt;- gam(list(
  carb_consumed_g ~ population + diet_pair + sex + initial_mass_g,
  protein_consumed_g ~ population + diet_pair + sex + initial_mass_g
), family = mvn(d = 2), select = TRUE, data = dat)

# Model 3: Excluding Initial Mass
mod3 &lt;- gam(list(
  carb_consumed_g ~ population + diet_pair + sex,
  protein_consumed_g ~ population + diet_pair + sex
), family = mvn(d = 2), select = TRUE, data = dat)

# Model 4: NULL model (This should be the worst model)
mod4 &lt;- gam(list(
  carb_consumed_g ~ 1,
  protein_consumed_g ~ 1
), family = mvn(d = 2), select = TRUE, data = dat)
      </code>
      </sec>
      <sec id="cell-93a1fe04-4c7d-4f27-bbda-86064d7e821c-nb-4" specific-use="notebook-content">
    </sec>
  </sec>
  <sec id="model-diagnostics-nb-4">
    <title>Model Diagnostics</title>
    <p>To see how well these models fit, I will run
    <monospace>mgcv::gam.check()</monospace> on it</p>
    </sec>
    <sec id="cell-43f14dba-f6b1-4c24-abbc-5556936fea4b-nb-4" specific-use="notebook-content">
    <code language="r script">gam.check(mod1)</code>
    <boxed-text>
      <preformat>
Method: REML   Optimizer: outer newton
full convergence after 17 iterations.
Gradient range [-0.0004276099,-1.37031e-05]
(score -576.2551 &amp; scale 1).
Hessian positive definite, eigenvalue range [0.000199142,0.04150658].
Model rank =  69 / 69 

Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
indicate that k is too low, especially if edf is close to k'.

                          k'      edf k-index p-value
s(initial_mass_g)   2.90e+01 1.32e-04    0.94    0.27
s.1(initial_mass_g) 2.90e+01 9.29e-04    0.94    0.26</preformat>
    </boxed-text>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="01_field_population_intake_target_choice_diet_analysis_files/figure-jats/cell-7-output-2.png" />
    </boxed-text>
    </sec>
    <sec id="cell-79a2dead-ca91-402c-a5fc-6f3109e7552c-nb-4" specific-use="notebook-content">
    <p>These diagnostic plots indicate these models are pretty well
    fit.</p>
    <p>there is some discernable relationship in the variance plot, but
    it could be worse</p>
  </sec>
  <sec id="model-selection-nb-4">
    <title>Model selection</title>
    <p>now lets calculate the model selection criteria</p>
    </sec>
    <sec id="e775c470-7707-4b7c-bbb0-6a39a225138c-nb-4" specific-use="notebook-content">
    <code language="r script"># Model selection using AIC, BIC, and AICc
bic &lt;- BIC(mod1, mod2, mod3, mod4) |&gt;  # Bayesian Information Criterion
    mutate(deltaBIC = BIC - min(BIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,BIC,deltaBIC)

aic &lt;- AIC(mod1, mod2, mod3, mod4)  |&gt;  # Akaike Information Criterion
    mutate(deltaAIC = AIC - min(AIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,AIC,deltaAIC)

aicc &lt;- AICc(mod1, mod2, mod3, mod4)  |&gt;  # AIC adjusted for small sample size
    mutate(deltaAICc = AICc - min(AICc)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model,AICc,deltaAICc)

model_selection_tables &lt;- bic |&gt;
    left_join(aic,by='model') |&gt;
    left_join(aicc,by='model') |&gt;
    mutate(experiment = 'choice_experiment')</code>
    </sec>
    <sec id="e20d87da-19ac-4bb4-98c8-51534f36c20a-nb-4" specific-use="notebook-content">
    <code language="r script">model_selection_tables |&gt;
    arrange(deltaBIC) </code>
    <boxed-text>
      <p>A data.frame: 4 × 8</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
            <col width="12%" />
          </colgroup>
          <thead>
            <tr>
              <th>model &lt;chr&gt;</th>
              <th>BIC &lt;dbl&gt;</th>
              <th>deltaBIC &lt;dbl&gt;</th>
              <th>AIC &lt;dbl&gt;</th>
              <th>deltaAIC &lt;dbl&gt;</th>
              <th>AICc &lt;dbl&gt;</th>
              <th>deltaAICc &lt;dbl&gt;</th>
              <th>experiment &lt;chr&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>mod3</td>
              <td>-1201.021</td>
              <td>0.000000000</td>
              <td>-1225.596</td>
              <td>0.000000000</td>
              <td>-1220.964</td>
              <td>0.000000000</td>
              <td>choice_experiment</td>
            </tr>
            <tr>
              <td>mod1</td>
              <td>-1201.012</td>
              <td>0.008717714</td>
              <td>-1225.592</td>
              <td>0.003981564</td>
              <td>-1220.958</td>
              <td>0.005864869</td>
              <td>choice_experiment</td>
            </tr>
            <tr>
              <td>mod4</td>
              <td>-1198.464</td>
              <td>2.556440510</td>
              <td>-1209.635</td>
              <td>15.961079538</td>
              <td>-1208.682</td>
              <td>12.281881543</td>
              <td>choice_experiment</td>
            </tr>
            <tr>
              <td>mod2</td>
              <td>-1193.742</td>
              <td>7.279113033</td>
              <td>-1222.785</td>
              <td>2.810900024</td>
              <td>-1216.167</td>
              <td>4.797502894</td>
              <td>choice_experiment</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-8a67e20b-08d7-4ad7-b72d-ed4707fcb3f7-nb-4" specific-use="notebook-content">
    <p>Model selection criteria supports that model 3 (which excludes
    starting mass) is the most parsimonous model</p>
    <p>The model summary is below</p>
    </sec>
    <sec id="d9339990-a702-473e-ad1a-0639198264f1-nb-4" specific-use="notebook-content">
    <code language="r script">summary(mod3)</code>
    <boxed-text>
      <preformat>
Family: Multivariate normal 
Link function: 

Formula:
carb_consumed_g ~ population + diet_pair + sex
protein_consumed_g ~ population + diet_pair + sex

Parametric coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)            0.026442   0.002062  12.825  &lt; 2e-16 ***
populationMendooran   -0.001464   0.002086  -0.702    0.483    
diet_pairB             0.001173   0.002082   0.563    0.573    
sexM                  -0.010924   0.002076  -5.262 1.43e-07 ***
(Intercept).1          0.013591   0.001500   9.062  &lt; 2e-16 ***
populationMendooran.1 -0.002345   0.001517  -1.546    0.122    
diet_pairB.1           0.001592   0.001514   1.051    0.293    
sexM.1                -0.005952   0.001510  -3.941 8.12e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


Deviance explained = 19.5%
-REML = -576.26  Scale est. = 1         n = 69</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-8e9efa6f-2bb1-4f20-ac54-1107d0ac249f-nb-4" specific-use="notebook-content">
  </sec>
  <sec id="key-findings-nb-4">
    <title>Key Findings</title>
    <p>Carbohydrate Consumption: Significant negative effects are
    observed for sexM (p &lt; 0.001). The other predictors,
    populationMendooran and diet_pairB, are not significant.</p>
    <p>Protein Consumption: Significant negative effects are found for
    sexM (p &lt; 0.001). The other predictors, populationMendooran.1 and
    diet_pairB.1, do not show significant effects.</p>
    <p>Model Fit: The model explains 19.5% of the deviance.</p>
  </sec>
  <sec id="model-outputs-nb-4">
    <title>Model outputs</title>
    <p>I am going to get the estimated marginal means for
    <monospace>diet_pair</monospace>,<monospace>sex</monospace>, and
    <monospace>population</monospace></p>
    <p>I will add this as a column on the dataframe</p>
    <p>I will also write out to disk the model object</p>
    </sec>
    <sec id="cell-74361857-b48d-4b62-89df-858f92347efb-nb-4" specific-use="notebook-content">
    <code language="r script">choice_exp_preds &lt;- expand.grid(
  population = unique(dat$population),
  diet_pair = unique(dat$diet_pair),
  sex = unique(dat$sex)
)

# Predict carbohydrate consumption
choice_exp_preds$pred_carb &lt;- predict(mod3, newdata = choice_exp_preds, type = &quot;response&quot;)[, 1]

# Predict protein consumption
choice_exp_preds$pred_protein &lt;- predict(mod3, newdata = choice_exp_preds, type = &quot;response&quot;)[, 2]

choice_exp_preds</code>
    <boxed-text>
      <p>A data.frame: 8 × 5</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
          </colgroup>
          <thead>
            <tr>
              <th>population &lt;fct&gt;</th>
              <th>diet_pair &lt;fct&gt;</th>
              <th>sex &lt;fct&gt;</th>
              <th>pred_carb &lt;dbl&gt;</th>
              <th>pred_protein &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Mendooran</td>
              <td>A</td>
              <td>M</td>
              <td>0.01405383</td>
              <td>0.005294840</td>
            </tr>
            <tr>
              <td>Guntawang</td>
              <td>A</td>
              <td>M</td>
              <td>0.01551792</td>
              <td>0.007639662</td>
            </tr>
            <tr>
              <td>Mendooran</td>
              <td>B</td>
              <td>M</td>
              <td>0.01522647</td>
              <td>0.006886952</td>
            </tr>
            <tr>
              <td>Guntawang</td>
              <td>B</td>
              <td>M</td>
              <td>0.01669057</td>
              <td>0.009231775</td>
            </tr>
            <tr>
              <td>Mendooran</td>
              <td>A</td>
              <td>F</td>
              <td>0.02497786</td>
              <td>0.011246543</td>
            </tr>
            <tr>
              <td>Guntawang</td>
              <td>A</td>
              <td>F</td>
              <td>0.02644195</td>
              <td>0.013591366</td>
            </tr>
            <tr>
              <td>Mendooran</td>
              <td>B</td>
              <td>F</td>
              <td>0.02615051</td>
              <td>0.012838655</td>
            </tr>
            <tr>
              <td>Guntawang</td>
              <td>B</td>
              <td>F</td>
              <td>0.02761460</td>
              <td>0.015183478</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-2adc13ca-ecc7-40b8-9ec2-877411943fc8-nb-4" specific-use="notebook-content">
    <p>Saving the predictions and model object for later
    visualization</p>
    </sec>
    <sec id="cell-070371a9-fb19-4c81-ada7-6fd237d7bb8a-nb-4" specific-use="notebook-content">
    <code language="r script">write.csv(choice_exp_preds,here('data/processed/field_populations/choice_experiment_predictions.csv'),row.names=FALSE)


write.csv(model_selection_tables, here(&quot;output/field_populations/choice_experiment_model_selection_criteria_results.csv&quot;),row.names=FALSE)


# Combine the lists into a single list
models &lt;- list('mod1'= mod1, 'mod2' = mod2, 'mod3'= mod3, 'mod4'= mod4)

# Save the combined list to an RDS file
saveRDS(models, here(&quot;output/field_populations/model_objects/choice_experiment_models.rds&quot;))</code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-15-nb-5">
<front-stub>
<title-group>
<article-title>Field population statistical analyses</article-title>
</title-group>
</front-stub>

<body>
<sec id="d20606e4-cec5-4bfd-b42a-f47ddb080734-nb-5" specific-use="notebook-content">
<sec id="no-choice-experiment-nb-5">
  <title>no choice Experiment</title>
  <p>this script conducts the statistics for the no-choice experiment
  intake target of field caught Australian plauge locusts</p>
  <p>Specifics for the experiment design can be found in the
  publication.</p>
  <p>For this section, I (Douglas Lawton) did not calculate the specific
  growth time, this was done in excel. I will mnot reproduce it here</p>
  </sec>
  <sec id="cell-5e08cc2a-f12c-4907-b08a-1f97c269404a-nb-5" specific-use="notebook-content">
  <code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;tidyverse&quot;, &quot;mgcv&quot;, &quot;MuMIn&quot;, &quot;multcomp&quot;, &quot;gratia&quot;, 
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;broom&quot;, &quot;knitr&quot;, &quot;janitor&quot;, 
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;GGally&quot;,&quot;emmeans&quot;)

load_packages(packages)

i_am('README.md')

# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10)
  </code>
  <boxed-text>
    <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors

Attaching package: ‘nlme’


The following object is masked from ‘package:dplyr’:

    collapse


This is mgcv 1.9-1. For overview type 'help(&quot;mgcv-package&quot;)'.


Attaching package: ‘MASS’


The following object is masked from ‘package:dplyr’:

    select



Attaching package: ‘TH.data’


The following object is masked from ‘package:MASS’:

    geyser



Attaching package: ‘gratia’


The following object is masked from ‘package:stringr’:

    boundary



Attaching package: ‘patchwork’


The following object is masked from ‘package:MASS’:

    area



Attaching package: ‘janitor’


The following objects are masked from ‘package:stats’:

    chisq.test, fisher.test


here() starts at /home/datascience/herbivore_nutrient_interactions

Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2

Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'


Attaching package: ‘emmeans’


The following object is masked from ‘package:GGally’:

    pigs


here() starts at /home/datascience/herbivore_nutrient_interactions
    </preformat>
  </boxed-text>
  </sec>
  <sec id="cell-99f387df-312f-4d42-9f03-e89e74b66525-nb-5" specific-use="notebook-content">
</sec>
<sec id="data-import-nb-5">
  <title>Data import</title>
  <p>This code reads a CSV file containing no choice IT data, cleans the
  column names, converts specific columns to factors.</p>
  <p>column descriptions:</p>
  <list list-type="bullet">
    <list-item>
      <p><bold>died_experiment</bold>: Indicates whether the locust
      individual died during the experiment.</p>
    </list-item>
    <list-item>
      <p><bold>diet</bold>: Specifies the type of diet the locust
      individual was on.</p>
    </list-item>
    <list-item>
      <p><bold>diet_no</bold>: Numeric identifier for a specific diet
      dish</p>
    </list-item>
    <list-item>
      <p><bold>sex</bold>: The sex of the locust individual.</p>
    </list-item>
    <list-item>
      <p><bold>initial_weight_g</bold>: The initial weight of the locust
      individual in grams.</p>
    </list-item>
    <list-item>
      <p><bold>days1_3_total_g</bold>: Total amount consumed by the
      locust individual from days 1 to 3 in grams.</p>
    </list-item>
    <list-item>
      <p><bold>days1_6_total_g</bold>: Total amount consumed by the
      locust individual from days 1 to 6 in grams.</p>
    </list-item>
    <list-item>
      <p><bold>days1_9_total_g</bold>: Total amount consumed by the
      locust individual from days 1 to 9 in grams.</p>
    </list-item>
    <list-item>
      <p><bold>adult_mass_g</bold>: The body mass of the locust
      individual when it reached adulthood, measured in grams.</p>
    </list-item>
    <list-item>
      <p><bold>final_mass_g_dec3</bold>: The final mass of the locust
      individual at the 5th instar stage, recorded on December 3rd, in
      grams.</p>
    </list-item>
    <list-item>
      <p><bold>dev_time_if_molted_days</bold>: Development time in days
      if the locust individual molted.</p>
    </list-item>
    <list-item>
      <p><bold>time_in_5th_instar_days</bold>: Time spent in the 5th
      instar stage if the locust individual did not molt, measured in
      days.</p>
    </list-item>
    <list-item>
      <p><bold>dev_time_with_5th_instar_days</bold>: Development time
      including days spent in the 5th instar stage for locust individual
      that did not molt, measured in days.</p>
    </list-item>
    <list-item>
      <p><bold>specific_growth_rate_ln_mb</bold>: The specific growth
      rate, calculated as the growth rate normalized by initial body
      mass and time.</p>
    </list-item>
  </list>
  </sec>
  <sec id="ce40faef-3fff-429f-a012-6e1445dabb35-nb-5" specific-use="notebook-content">
  <code language="r script">no_choice &lt;- read_csv(here(&quot;data/raw/field_populations/confined_diet.csv&quot;),show_col_types = FALSE) |&gt;
    clean_names() |&gt;
    rename(
        died_experiment = died_during_experiment,
        diet = diet,
        diet_no = diet_no,
        sex = sex,
        initial_weight_g = locust_initial_weight_g,
        days1_3_total_g = days1_3_consumed_total_g,
        days1_6_total_g = days1_6_consumed_total_g,
        days1_9_total_g = days1_9_consumed_total_g,
        adult_mass_g = adult_body_mass_g,
        final_mass_g_dec3 = final_mass_g_5th_instar_recorded_on_dec_3,
        dev_time_if_molted_days = development_time_if_molted_days,
        time_in_5th_instar_days = time_in_5th_instar_if_not_molt_days,
        dev_time_with_5th_instar_days = development_time_with_days_in_5th_instar_for_those_not_yet_molted_days,
        specific_growth_rate_ln_mb = specific_growth_rate_ln_mb_final_mb_initial_time) |&gt;
    drop_na(specific_growth_rate_ln_mb)

head(no_choice)</code>
  <boxed-text>
    <p>A tibble: 6 × 15</p>
    <table-wrap>
      <table>
        <colgroup>
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
          <col width="7%" />
        </colgroup>
        <thead>
          <tr>
            <th>died_experiment &lt;dbl&gt;</th>
            <th>diet &lt;chr&gt;</th>
            <th>diet_no &lt;dbl&gt;</th>
            <th>sex &lt;chr&gt;</th>
            <th>initial_weight_g &lt;dbl&gt;</th>
            <th>days1_3_total_g &lt;dbl&gt;</th>
            <th>days1_6_total_g &lt;dbl&gt;</th>
            <th>days1_9_total_g &lt;dbl&gt;</th>
            <th>molted &lt;dbl&gt;</th>
            <th>adult_mass_g &lt;dbl&gt;</th>
            <th>final_mass_g_dec3 &lt;dbl&gt;</th>
            <th>dev_time_if_molted_days &lt;dbl&gt;</th>
            <th>time_in_5th_instar_days &lt;dbl&gt;</th>
            <th>dev_time_with_5th_instar_days &lt;dbl&gt;</th>
            <th>specific_growth_rate_ln_mb &lt;dbl&gt;</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>NA</td>
            <td>7p:35c</td>
            <td>1</td>
            <td>F</td>
            <td>0.121</td>
            <td>0.016</td>
            <td>0.082</td>
            <td>0.082</td>
            <td>NA</td>
            <td>NA</td>
            <td>0.157</td>
            <td>NA</td>
            <td>18</td>
            <td>18</td>
            <td>0.014</td>
          </tr>
          <tr>
            <td>NA</td>
            <td>7p:35c</td>
            <td>1</td>
            <td>M</td>
            <td>0.084</td>
            <td>0.038</td>
            <td>0.133</td>
            <td>0.168</td>
            <td>NA</td>
            <td>NA</td>
            <td>0.188</td>
            <td>NA</td>
            <td>17</td>
            <td>17</td>
            <td>0.049</td>
          </tr>
          <tr>
            <td>NA</td>
            <td>21p:21c</td>
            <td>3</td>
            <td>M</td>
            <td>0.074</td>
            <td>0.032</td>
            <td>0.114</td>
            <td>0.190</td>
            <td>1</td>
            <td>0.165</td>
            <td>NA</td>
            <td>15</td>
            <td>NA</td>
            <td>15</td>
            <td>0.055</td>
          </tr>
          <tr>
            <td>NA</td>
            <td>35p:7c</td>
            <td>5</td>
            <td>F</td>
            <td>0.149</td>
            <td>0.072</td>
            <td>0.162</td>
            <td>0.294</td>
            <td>NA</td>
            <td>NA</td>
            <td>0.319</td>
            <td>NA</td>
            <td>17</td>
            <td>17</td>
            <td>0.046</td>
          </tr>
          <tr>
            <td>NA</td>
            <td>7p:35c</td>
            <td>1</td>
            <td>F</td>
            <td>0.127</td>
            <td>0.028</td>
            <td>0.128</td>
            <td>0.159</td>
            <td>NA</td>
            <td>NA</td>
            <td>0.248</td>
            <td>NA</td>
            <td>17</td>
            <td>17</td>
            <td>0.040</td>
          </tr>
          <tr>
            <td>NA</td>
            <td>21p:21c</td>
            <td>3</td>
            <td>M</td>
            <td>0.091</td>
            <td>0.058</td>
            <td>0.146</td>
            <td>0.195</td>
            <td>1</td>
            <td>0.134</td>
            <td>NA</td>
            <td>13</td>
            <td>NA</td>
            <td>13</td>
            <td>0.029</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </boxed-text>
  </sec>
  <sec id="cell-22cce73c-6187-4402-8bec-5f4058a436c8-nb-5" specific-use="notebook-content">
</sec>
<sec id="raw-data-visualization-nb-5">
  <title>Raw data visualization</title>
  <p>I am using <monospace>ggpairs</monospace> to make this section
  pithy</p>
  </sec>
  <sec id="cell-89da0cad-e950-478f-85ad-d48bd8619848-nb-5" specific-use="notebook-content">
  <code language="r script">numeric_columns &lt;- c(&quot;initial_weight_g&quot;,&quot;specific_growth_rate_ln_mb&quot;,&quot;dev_time_with_5th_instar_days&quot;)

my_dens &lt;- function(data, mapping,...) {
  ggplot(data = data, mapping=mapping) +
    geom_density(..., alpha = 0.7, fill = NA) 
}


sex_raw_graph &lt;- no_choice |&gt;
    dplyr::select(!c(died_experiment,diet,diet_no,molted)) |&gt;
    ggpairs(aes(color=sex),columns = numeric_columns,diag = list(continuous = my_dens))  +
    scale_colour_manual(values=c('#e5a335','#96410e'))  +
    scale_fill_manual(values=c('#e5a335','#96410e')) +
    theme_pubr()

diet_raw_graph &lt;- no_choice |&gt;
    dplyr::select(!c(died_experiment,diet_no,molted)) |&gt;
    ggpairs(aes(color=diet),columns = numeric_columns,diag = list(continuous = my_dens))  +
    scale_colour_manual(values=c('#e5a335', '#96410e', '#556219', '#418979'))  +
    theme_pubr()
  </code>
  </sec>
  <sec id="a614b1b5-c81f-48c4-ac97-b39e69bf57e6-nb-5" specific-use="notebook-content">
  <code language="r script"># Define the output directory
output_dir &lt;- here('output/field_populations/raw_visualization/')

# List of plots and their corresponding file names
plots &lt;- list(
  &quot;no_choice_experiment_sex_raw_graph&quot; = sex_raw_graph,
  &quot;no_choice_experiment_diet_pair_raw_graph&quot; = diet_raw_graph
)

# Loop through each plot and save it
for (name in names(plots)) {
  ggsave(
    filename = file.path(output_dir, paste0(name, &quot;.png&quot;)),
    plot = plots[[name]],
    width = 10, height = 10, dpi = 300
  )
}</code>
  </sec>
  <sec id="cdfcc609-7afb-424d-8b26-a0f10c2c1d8e-nb-5" specific-use="notebook-content">
  <sec id="model-building-nb-5">
    <title>Model building</title>
    <sec id="general-additive-models-gam-for-carbohydrate-and-protein-consumption-of-field-populations-nb-5">
      <title>General Additive Models (GAM) for Carbohydrate and Protein
      Consumption of Field Populations</title>
    </sec>
    <sec id="no-choice-experiments-nb-5">
      <title>No Choice Experiments</title>
      <p>In this analysis, we are exploring the relationship between
      carbohydrate and protein consumption using General Additive Models
      (GAMs) with different explanatory variables for two field
      popualtions of locusts and no choice experiments. Each model
      assumes a gaussian distribution for the response.</p>
    </sec>
    <sec id="modeling-overview-nb-5">
      <title>Modeling Overview:</title>
      <p>We are regressing the days to fifth instar and the specific
      growth rate on the sex (male or female) and diet (four restricted
      diets). More information can be found within the methods section
      of the paper.</p>
      <p>Both dependent variables will undergo the same model selection
      criteria:</p>
      <p><bold>Model 1: Non-linear Relationship with Initial
      Mass</bold></p>
      <p>Formulas: - specific_growth_rate ~ population + diet_pair + sex
      + s(initial_weight_g, k = 15) - dev_time_with_5th_instar_days ~
      population + diet_pair + sex + s(initial_weight_g, k= 15)</p>
      <p>Description: This model allows for a non-linear relationship
      between the initial mass of the subject and the consumption of
      carbohydrates and proteins. The smoothing function
      s(initial_mass_g, k=30) captures the non-linear effects with a
      basis dimension of 30.</p>
      <p><bold>Model 2: Linear Relationship with Initial Mass</bold></p>
      <p>Formulas: - specific_growth_rate ~ population + diet_pair + sex
      + initial_weight_g - dev_time_with_5th_instar_days ~ population +
      diet_pair + sex + initial_weight_g</p>
      <p>Description: In this model, the relationship between initial
      mass and nutrient consumption is assumed to be linear. This model
      tests whether a simpler, linear approximation can adequately
      describe the relationship.</p>
      <p><bold>Model 3: Excluding Initial Mass</bold></p>
      <p>Formula: - specific_growth_rate ~ population + diet_pair + sex
      - dev_time_with_5th_instar_days ~ population + diet_pair + sex</p>
      <p>Description: This model excludes the initial mass as an
      explanatory variable, focusing only on population, sex, and diet
      pair to explain the variation in carbohydrate and protein
      consumption.</p>
      <p><bold>Model 4: Null Model</bold></p>
      <p>Formula: - specific_growth_rate ~ 1 -
      dev_time_with_5th_instar_days ~ 1</p>
      <p>Description: The null model includes only an intercept, serving
      as a baseline to compare the other models. This model should
      represent the worst fit to the data, as it assumes no relationship
      between the predictors and the response variables.</p>
      </sec>
      <sec id="c5cf1101-7ddd-4617-9fd1-60f482420b2f-nb-5" specific-use="notebook-content">
      <code language="r script"># Model 1: Non-linear Relationship with Initial Mass

sgr_mod1 &lt;-gam(specific_growth_rate_ln_mb ~ diet + sex + s(initial_weight_g,k=15), 
               data=no_choice,select=TRUE, family=gaussian())

dev_mod1 &lt;-gam(dev_time_with_5th_instar_days  ~ diet + sex + s(initial_weight_g,k=15), 
               data=no_choice,select=TRUE, family=gaussian())

# Model 2: Linear Relationship with Initial Mass

sgr_mod2 &lt;-gam(specific_growth_rate_ln_mb ~ diet + sex + initial_weight_g, 
               data=no_choice,select=TRUE, family=gaussian())

dev_mod2 &lt;-gam(dev_time_with_5th_instar_days  ~ diet + sex + initial_weight_g, 
               data=no_choice,select=TRUE, family=gaussian())

# Model 3: Excluding Initial Mass

sgr_mod3 &lt;-gam(specific_growth_rate_ln_mb ~ diet + sex, 
               data=no_choice,select=TRUE, family=gaussian())

dev_mod3 &lt;-gam(dev_time_with_5th_instar_days  ~ diet + sex, 
               data=no_choice,select=TRUE, family=gaussian())

# Model 4: Null Model

sgr_mod4 &lt;-gam(specific_growth_rate_ln_mb ~ 1, 
               data=no_choice,select=TRUE, family=gaussian())

dev_mod4 &lt;-gam(dev_time_with_5th_instar_days  ~ 1, 
               data=no_choice,select=TRUE, family=gaussian())</code>
      </sec>
      <sec id="cell-2db623ac-9039-4259-97b3-2532f89a42b2-nb-5" specific-use="notebook-content">
    </sec>
    <sec id="model-selection-nb-5">
      <title>Model Selection:</title>
      <p>After fitting these models, we will compare them using the
      following criteria:</p>
      <list list-type="bullet">
        <list-item>
          <p>Akaike Information Criterion (AIC): A measure of the
          relative quality of the models for a given dataset,
          considering both goodness of fit and model complexity.</p>
        </list-item>
        <list-item>
          <p>Bayesian Information Criterion (BIC): Similar to AIC, but
          with a stronger penalty for models with more parameters.</p>
        </list-item>
        <list-item>
          <p>Corrected AIC (AICc): AIC adjusted for small sample sizes,
          ensuring a more reliable comparison when sample sizes are
          limited. By examining the AIC, BIC, and AICc values, we will
          select the best model for explaining carbohydrate and protein
          consumption.</p>
        </list-item>
      </list>
      </sec>
      <sec id="d68fd5d1-0615-4934-a83b-6963fdaf0dd4-nb-5" specific-use="notebook-content">
      <code language="r script">
# Define the function
calculate_model_selection &lt;- function(models) {
  
  bic &lt;- BIC(models[[1]], models[[2]], models[[3]], models[[4]]) |&gt;  # Bayesian Information Criterion
    mutate(deltaBIC = BIC - min(BIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model, BIC, deltaBIC)
  
  aic &lt;- AIC(models[[1]], models[[2]], models[[3]], models[[4]])  |&gt;  # Akaike Information Criterion
    mutate(deltaAIC = AIC - min(AIC)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model, AIC, deltaAIC)
  
  aicc &lt;- AICc(models[[1]], models[[2]], models[[3]], models[[4]])  |&gt;  # AIC adjusted for small sample size
    mutate(deltaAICc = AICc - min(AICc)) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model, AICc, deltaAICc)
  
  model_selection_tables &lt;- bic |&gt;
    left_join(aic, by = 'model') |&gt;
    left_join(aicc, by = 'model')
  
  return(model_selection_tables)
}

# Apply the function to the two model sets

sgr_models &lt;- list(sgr_mod1, sgr_mod2, sgr_mod3, sgr_mod4)
dev_models &lt;- list(dev_mod1, dev_mod2, dev_mod3, dev_mod4)

sgr_model_selection &lt;- calculate_model_selection(sgr_models)
dev_model_selection &lt;- calculate_model_selection(dev_models)
      </code>
      </sec>
      <sec id="cell-79d237c5-a6cb-4ded-86aa-2cefb71384f7-nb-5" specific-use="notebook-content">
    </sec>
  </sec>
  <sec id="model-diagnostics-nb-5">
    <title>Model Diagnostics</title>
    <p>To see how well these models fit, I will run
    <monospace>mgcv::gam.check()</monospace> on it</p>
    <sec id="specific-growth-rate-diagnostic-plots-nb-5">
      <title>Specific growth rate diagnostic plots</title>
      </sec>
      <sec id="d7e235a3-c3e1-4e0a-bc77-4a52e1c9d56d-nb-5" specific-use="notebook-content">
      <code language="r script">gratia::appraise(sgr_mod1)</code>
      <boxed-text>
        <graphic mimetype="image" mime-subtype="png" xlink:href="02_field_population_intake_target_no_choice_diet_analysis_files/figure-jats/cell-8-output-1.png" />
      </boxed-text>
      </sec>
      <sec id="cell-76ee46ee-2663-44ec-90c7-1cfae8c5b7e7-nb-5" specific-use="notebook-content">
    </sec>
    <sec id="development-time-diagnostic-plots-nb-5">
      <title>Development time diagnostic plots</title>
      </sec>
      <sec id="cell-0b5b6b47-e05b-49e6-90f9-9f4681d382c6-nb-5" specific-use="notebook-content">
      <code language="r script">gratia::appraise(dev_mod1)</code>
      <boxed-text>
        <graphic mimetype="image" mime-subtype="png" xlink:href="02_field_population_intake_target_no_choice_diet_analysis_files/figure-jats/cell-9-output-1.png" />
      </boxed-text>
      </sec>
      <sec id="cell-1e0baef5-3599-4ec1-b0d8-edb5f4ee143e-nb-5" specific-use="notebook-content">
      <p>These diagnostic plots indicate these models are decently
      fit.</p>
      <p>now lets calculate the model selection criteria</p>
      </sec>
      <sec id="cell-536ad86a-41f9-40ad-8aa5-f50ac64eb174-nb-5" specific-use="notebook-content">
      <code language="r script"># Load necessary libraries
library(dplyr)
library(broom)

# Define the function
calculate_model_selection &lt;- function(models) {

  bic &lt;- BIC(models[[1]], models[[2]], models[[3]], models[[4]]) |&gt;  # Bayesian Information Criterion
    mutate(deltaBIC = BIC - min(BIC), across(where(is.numeric), ~ round(., 3))) |&gt;
    rownames_to_column('model') |&gt;
    mutate(model = model) |&gt;
    dplyr::select(model, BIC, deltaBIC)
  
  aic &lt;- AIC(models[[1]], models[[2]], models[[3]], models[[4]])  |&gt;  # Akaike Information Criterion
    mutate(deltaAIC = AIC - min(AIC), across(where(is.numeric), ~ round(., 3))) |&gt;
    rownames_to_column('model') |&gt;
    mutate(model = model) |&gt;
    dplyr::select(model, AIC, deltaAIC)
  
  aicc &lt;- AICc(models[[1]], models[[2]], models[[3]], models[[4]])  |&gt;  # AIC adjusted for small sample size
    mutate(deltaAICc = AICc - min(AICc), across(where(is.numeric), ~ round(., 3))) |&gt;
    rownames_to_column('model') |&gt;
    dplyr::select(model, AICc, deltaAICc)
  
  model_selection_tables &lt;- bic |&gt;
    left_join(aic, by = 'model') |&gt;
    left_join(aicc, by = 'model')
  
  return(model_selection_tables)
}

# Apply the function to the two model sets

sgr_models &lt;- list(sgr_mod1,sgr_mod2, sgr_mod3, sgr_mod4)
dev_models &lt;- list(dev_mod1, dev_mod2, dev_mod3, dev_mod4)

sgr_model_selection &lt;- calculate_model_selection(sgr_models) |&gt;
    mutate(experiment = 'no_choice_experiment',
           physiology_parameter = 'specific_growth_rate')

dev_model_selection &lt;- calculate_model_selection(dev_models) |&gt;
    mutate(experiment = 'no_choice_experiment',
           physiology_parameter = 'development_time')

      </code>
      </sec>
      <sec id="cell-01f35e86-f1eb-471c-afc4-98d8eec79394-nb-5" specific-use="notebook-content">
      <code language="r script"># The positioning in the list represents the model. e.g. mod1 == models[[1]]

sgr_model_selection |&gt;
    arrange(deltaAIC)

dev_model_selection |&gt;
    arrange(deltaAIC)

no_choice_experiment_model_selection_criteria_results &lt;- sgr_model_selection |&gt; 
    rbind(dev_model_selection)</code>
      <boxed-text>
        <p>A data.frame: 4 × 9</p>
        <table-wrap>
          <table>
            <colgroup>
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
            </colgroup>
            <thead>
              <tr>
                <th>model &lt;chr&gt;</th>
                <th>BIC &lt;dbl&gt;</th>
                <th>deltaBIC &lt;dbl&gt;</th>
                <th>AIC &lt;dbl&gt;</th>
                <th>deltaAIC &lt;dbl&gt;</th>
                <th>AICc &lt;dbl&gt;</th>
                <th>deltaAICc &lt;dbl&gt;</th>
                <th>experiment &lt;chr&gt;</th>
                <th>physiology_parameter &lt;chr&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>models[[1]]</td>
                <td>-292.455</td>
                <td>0.000</td>
                <td>-304.388</td>
                <td>0.000</td>
                <td>-302.601</td>
                <td>0.000</td>
                <td>no_choice_experiment</td>
                <td>specific_growth_rate</td>
              </tr>
              <tr>
                <td>models[[3]]</td>
                <td>-292.455</td>
                <td>0.000</td>
                <td>-304.388</td>
                <td>0.000</td>
                <td>-302.601</td>
                <td>0.000</td>
                <td>no_choice_experiment</td>
                <td>specific_growth_rate</td>
              </tr>
              <tr>
                <td>models[[2]]</td>
                <td>-288.514</td>
                <td>3.940</td>
                <td>-302.437</td>
                <td>1.951</td>
                <td>-300.003</td>
                <td>2.599</td>
                <td>no_choice_experiment</td>
                <td>specific_growth_rate</td>
              </tr>
              <tr>
                <td>models[[4]]</td>
                <td>-286.209</td>
                <td>6.245</td>
                <td>-290.187</td>
                <td>14.201</td>
                <td>-289.952</td>
                <td>12.649</td>
                <td>no_choice_experiment</td>
                <td>specific_growth_rate</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </boxed-text>
      <boxed-text>
        <p>A data.frame: 4 × 9</p>
        <table-wrap>
          <table>
            <colgroup>
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
              <col width="11%" />
            </colgroup>
            <thead>
              <tr>
                <th>model &lt;chr&gt;</th>
                <th>BIC &lt;dbl&gt;</th>
                <th>deltaBIC &lt;dbl&gt;</th>
                <th>AIC &lt;dbl&gt;</th>
                <th>deltaAIC &lt;dbl&gt;</th>
                <th>AICc &lt;dbl&gt;</th>
                <th>deltaAICc &lt;dbl&gt;</th>
                <th>experiment &lt;chr&gt;</th>
                <th>physiology_parameter &lt;chr&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>models[[1]]</td>
                <td>219.148</td>
                <td>0.000</td>
                <td>205.712</td>
                <td>0.000</td>
                <td>207.977</td>
                <td>0.000</td>
                <td>no_choice_experiment</td>
                <td>development_time</td>
              </tr>
              <tr>
                <td>models[[2]]</td>
                <td>219.849</td>
                <td>0.701</td>
                <td>205.926</td>
                <td>0.215</td>
                <td>208.361</td>
                <td>0.384</td>
                <td>no_choice_experiment</td>
                <td>development_time</td>
              </tr>
              <tr>
                <td>models[[3]]</td>
                <td>220.276</td>
                <td>1.128</td>
                <td>208.342</td>
                <td>2.631</td>
                <td>210.129</td>
                <td>2.152</td>
                <td>no_choice_experiment</td>
                <td>development_time</td>
              </tr>
              <tr>
                <td>models[[4]]</td>
                <td>225.279</td>
                <td>6.131</td>
                <td>221.301</td>
                <td>15.590</td>
                <td>221.537</td>
                <td>13.559</td>
                <td>no_choice_experiment</td>
                <td>development_time</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </boxed-text>
      </sec>
      <sec id="a7e9a4d2-2247-4f9a-bc08-606eeedb9536-nb-5" specific-use="notebook-content">
      <code language="r script">summary(sgr_mod1)
summary(sgr_mod3)</code>
      <boxed-text>
        <preformat>
Family: gaussian 
Link function: identity 

Formula:
specific_growth_rate_ln_mb ~ diet + sex + s(initial_weight_g, 
    k = 15)

Parametric coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.061124   0.004238  14.422  &lt; 2e-16 ***
diet21p:21c -0.011232   0.005318  -2.112   0.0398 *  
diet35p:7c  -0.010155   0.005885  -1.726   0.0907 .  
diet7p:35c  -0.026003   0.005387  -4.827  1.4e-05 ***
sexM        -0.003453   0.004051  -0.852   0.3982    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
                          edf Ref.df F p-value
s(initial_weight_g) 3.899e-07     14 0   0.727

R-sq.(adj) =  0.283   Deviance explained = 33.7%
GCV = 0.00020294  Scale est. = 0.00018415  n = 54</preformat>
      </boxed-text>
      <boxed-text>
        <preformat>
Family: gaussian 
Link function: identity 

Formula:
specific_growth_rate_ln_mb ~ diet + sex

Parametric coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.061124   0.004238  14.422  &lt; 2e-16 ***
diet21p:21c -0.011232   0.005318  -2.112   0.0398 *  
diet35p:7c  -0.010155   0.005885  -1.726   0.0907 .  
diet7p:35c  -0.026003   0.005387  -4.827  1.4e-05 ***
sexM        -0.003453   0.004051  -0.852   0.3982    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


R-sq.(adj) =  0.283   Deviance explained = 33.7%
GCV = 0.00020294  Scale est. = 0.00018415  n = 54</preformat>
      </boxed-text>
      </sec>
      <sec id="c5fc7283-7607-4f9c-a00c-77810b98e28d-nb-5" specific-use="notebook-content">
      <code language="r script">summary(dev_mod1)
summary(dev_mod2)</code>
      <boxed-text>
        <preformat>
Family: gaussian 
Link function: identity 

Formula:
dev_time_with_5th_instar_days ~ diet + sex + s(initial_weight_g, 
    k = 15)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  13.0509     0.4975  26.232  &lt; 2e-16 ***
diet21p:21c   0.8223     0.6173   1.332   0.1891    
diet35p:7c    1.6634     0.6630   2.509   0.0155 *  
diet7p:35c    2.7049     0.6027   4.488 4.46e-05 ***
sexM         -1.2721     0.7548  -1.685   0.0984 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
                       edf Ref.df     F p-value  
s(initial_weight_g) 0.7555     10 0.309  0.0487 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) =   0.31   Deviance explained = 37.2%
GCV = 2.5774  Scale est. = 2.3027    n = 54</preformat>
      </boxed-text>
      <boxed-text>
        <preformat>
Family: gaussian 
Link function: identity 

Formula:
dev_time_with_5th_instar_days ~ diet + sex + initial_weight_g

Parametric coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       15.7797     1.5548  10.149 1.56e-13 ***
diet21p:21c        0.9166     0.6244   1.468   0.1487    
diet35p:7c         1.7091     0.6645   2.572   0.0133 *  
diet7p:35c         2.7157     0.6028   4.505 4.24e-05 ***
sexM              -1.6155     0.8292  -1.948   0.0573 .  
initial_weight_g -21.0476    10.4069  -2.022   0.0487 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


R-sq.(adj) =   0.31   Deviance explained = 37.5%
GCV = 2.5906  Scale est. = 2.3027    n = 54</preformat>
      </boxed-text>
      </sec>
      <sec id="cell-4658f5aa-a86d-4f38-9522-cdd34652b05c-nb-5" specific-use="notebook-content">
    </sec>
  </sec>
  <sec id="model-selection-summary-nb-5">
    <title>model selection summary</title>
    <p>For both specific growth rate and development model selection
    criteria differed slightly.</p>
    <sec id="specific-growth-rate-nb-5">
      <title>Specific growth rate</title>
      <p>Model selection criteria could not discern between model 1
      (non-linear relationship with initial mass) and model 3 (excluding
      initial mass entirely). However inspecting the model summary, the
      paramteric parameters really dont change between the models and
      the non-linear non-parametric term is in sigificant in model 1. As
      such, I will go with the most simplistic model, which is model
      3.</p>
    </sec>
    <sec id="development-time-nb-5">
      <title>Development time</title>
      <p>Model selection criteria could not discern between model 1
      (non-linear relationship with initial mass) and model 2 (linear
      relationship with initial mass). However inspecting the model
      summary, these model coefficients ended up looking very similar. I
      will go with model 2 because it matches the results of model 1 and
      is more simplistic.</p>
    </sec>
  </sec>
  <sec id="key-findings-nb-5">
    <title>Key Findings:</title>
    <list list-type="bullet">
      <list-item>
        <p>Development Time Model: Diet composition and initial weight
        significantly impact development time. Specifically, a diet high
        in carbohydrates (7p:35c) or high in protein significantly
        extends development time as compared to the reference level of
        14p:24c), while increased initial weight shortens it. There is
        also a marginally significant trend suggesting that males may
        develop slightly faster than females. Overall, the model
        explains 37.5% of the variation in development time.</p>
      </list-item>
      <list-item>
        <p>Specific Growth Rate Model: Diet also plays a critical role
        in specific growth rate, with a high-carbohydrate diet (7p:35c)
        or high-protein diet significantly reducing growth rate as
        compared to the reference level of 14p:24c). Initial weight does
        not appear to have a significant effect on growth rate in this
        model, nor does sex. The model explains 33.7% of the variation
        in growth rate.</p>
      </list-item>
    </list>
  </sec>
  <sec id="posthoc-comparison-between-diet-pair-levels-nb-5">
    <title>Posthoc comparison between diet pair levels</title>
    </sec>
    <sec id="d6ebb33e-b82c-4610-b00d-73c742717024-nb-5" specific-use="notebook-content">
    <code language="r script">
development_time_emms &lt;- emmeans(dev_mod2, ~ diet)
development_time_contrasts &lt;- contrast(development_time_emms, method = &quot;pairwise&quot;) |&gt; tidy()

specific_growth_rate_emms &lt;- emmeans(sgr_mod3, ~ diet)
specific_growth_rate_contrasts &lt;- contrast(specific_growth_rate_emms, method = &quot;pairwise&quot;) |&gt; tidy()</code>
    </sec>
    <sec id="cell-9e269c46-6e35-4da5-8970-7bd081793860-nb-5" specific-use="notebook-content">
  </sec>
  <sec id="model-outputs-nb-5">
    <title>Model outputs</title>
    <p>I am going to get the estimated marginal means for
    <monospace>diet</monospace>,<monospace>sex</monospace>, and
    <monospace>initial_weight</monospace> for both the final models</p>
    <p>I will add this as a new dataframe</p>
    <p>I will also write out all models to disks</p>
    </sec>
    <sec id="ad629d01-92af-4739-b469-0c6c4fc8c3c2-nb-5" specific-use="notebook-content">
    <code language="r script">no_choice_exp_preds &lt;- expand.grid(
  initial_weight_g = seq(min(no_choice$initial_weight_g), max(no_choice$initial_weight_g), length.out = 10),
  diet = unique(no_choice$diet),
  sex = unique(no_choice$sex)
)

# Predict carbohydrate consumption
no_choice_exp_preds$pred_specific_growth_rate &lt;- predict(sgr_mod3, newdata = no_choice_exp_preds, type = &quot;response&quot;)

# Predict protein consumption
no_choice_exp_preds$pred_development_time &lt;- predict(dev_mod2, newdata = no_choice_exp_preds, type = &quot;response&quot;)

no_choice_exp_preds |&gt; head()</code>
    <boxed-text>
      <p>A data.frame: 6 × 5</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
            <col width="17%" />
          </colgroup>
          <thead>
            <tr>
              <th></th>
              <th>initial_weight_g &lt;dbl&gt;</th>
              <th>diet &lt;fct&gt;</th>
              <th>sex &lt;fct&gt;</th>
              <th>pred_specific_growth_rate &lt;dbl[1d]&gt;</th>
              <th>pred_development_time &lt;dbl[1d]&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1</td>
              <td>0.05500000</td>
              <td>7p:35c</td>
              <td>F</td>
              <td>0.03512082</td>
              <td>17.33781</td>
            </tr>
            <tr>
              <td>2</td>
              <td>0.07377778</td>
              <td>7p:35c</td>
              <td>F</td>
              <td>0.03512082</td>
              <td>16.94258</td>
            </tr>
            <tr>
              <td>3</td>
              <td>0.09255556</td>
              <td>7p:35c</td>
              <td>F</td>
              <td>0.03512082</td>
              <td>16.54735</td>
            </tr>
            <tr>
              <td>4</td>
              <td>0.11133333</td>
              <td>7p:35c</td>
              <td>F</td>
              <td>0.03512082</td>
              <td>16.15212</td>
            </tr>
            <tr>
              <td>5</td>
              <td>0.13011111</td>
              <td>7p:35c</td>
              <td>F</td>
              <td>0.03512082</td>
              <td>15.75690</td>
            </tr>
            <tr>
              <td>6</td>
              <td>0.14888889</td>
              <td>7p:35c</td>
              <td>F</td>
              <td>0.03512082</td>
              <td>15.36167</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="e7ec3252-c4d5-4943-88d1-6d85d1e6eb2a-nb-5" specific-use="notebook-content">
    <code language="r script"># Writing out the predictions
write.csv(no_choice_exp_preds,here('data/processed/field_populations/no_choice_experiment_predictions.csv'),row.names=FALSE)

# Writing out the model selection criteria
write.csv(no_choice_experiment_model_selection_criteria_results, here(&quot;output/field_populations/no_choice_experiment_model_selection_criteria_results.csv&quot;),row.names=FALSE)


# Writing out the contrasts for sepcific growth rate and development time
write.csv(development_time_contrasts, here(&quot;output/field_populations/no_choice_experiment_development_time_emm_contrasts.csv&quot;),row.names=FALSE)
write.csv(specific_growth_rate_contrasts, here(&quot;output/field_populations/no_choice_experiment_specific_growth_rate_emm_contrasts.csv&quot;),row.names=FALSE)


# Saving models
## Combine the lists into a single list
models &lt;- list(sgr_models = list(sgr_mod1, sgr_mod2, sgr_mod3, sgr_mod4),
               dev_models = list(dev_mod1, dev_mod2, dev_mod3, dev_mod4))

## Save the combined list to an RDS file
saveRDS(models, here(&quot;output/field_populations/model_objects/no_choice_experiment_models.rds&quot;))</code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-18-nb-6">
<front-stub>
<title-group>
<article-title>Field population Post modeling
visualization</article-title>
</title-group>
</front-stub>

<body>
<sec id="cell-0dfbd0e4-f2ab-4d09-b198-046791a2500d-nb-6" specific-use="notebook-content">
<p><bold>Choice and no choice experiments combined</bold></p>
<p>Now we combine all modeling output and data to produce the manuscript
figures</p>
</sec>
<sec id="cell-2df55bf7-1053-4f17-8e65-f465f29888b4-nb-6" specific-use="notebook-content">
<code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;tidyverse&quot;, &quot;mgcv&quot;, &quot;MuMIn&quot;, &quot;multcomp&quot;, &quot;gratia&quot;, 
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;broom&quot;, &quot;knitr&quot;, &quot;janitor&quot;, 
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;GGally&quot;,&quot;patchwork&quot;)

load_packages(packages)

i_am('README.md')

# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10)
</code>
<boxed-text>
  <preformat>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors

Attaching package: ‘nlme’


The following object is masked from ‘package:dplyr’:

    collapse


This is mgcv 1.9-1. For overview type 'help(&quot;mgcv-package&quot;)'.


Attaching package: ‘MASS’


The following object is masked from ‘package:dplyr’:

    select



Attaching package: ‘TH.data’


The following object is masked from ‘package:MASS’:

    geyser



Attaching package: ‘gratia’


The following object is masked from ‘package:stringr’:

    boundary



Attaching package: ‘patchwork’


The following object is masked from ‘package:MASS’:

    area



Attaching package: ‘janitor’


The following objects are masked from ‘package:stats’:

    chisq.test, fisher.test


here() starts at /home/datascience/herbivore_nutrient_interactions

Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2

here() starts at /home/datascience/herbivore_nutrient_interactions
  </preformat>
</boxed-text>
</sec>
<sec id="fb45d49a-674a-40f3-839b-55dee8759786-nb-6" specific-use="notebook-content">
<sec id="read-in-data-nb-6">
  <title>Read in data</title>
  <p>I am going to select columns that I will use just to keep the
  dataframes managable</p>
  </sec>
  <sec id="cell-6a691f2d-64cb-4e29-ba2d-45ff628b67be-nb-6" specific-use="notebook-content">
  <code language="r script"># Choice experiment data

choice_raw_dat &lt;- read_csv(here(&quot;data/raw/field_populations/IT_dat.csv&quot;),show_col_types = FALSE) |&gt;
    clean_names() |&gt;
    mutate(across(c(population,sex,diet_pair,cage_no,low_p_diet,high_p_diet,notes_exclude_reason),~factor(.))) |&gt;
    dplyr::select(population,diet_pair,sex,initial_mass_g,protein_consumed_g,carb_consumed_g) |&gt;
    drop_na(protein_consumed_g,carb_consumed_g)

choice_pred_dat &lt;- read_csv(here('data/processed/field_populations/choice_experiment_predictions.csv'),show_col_types = FALSE)

choice_dat &lt;- choice_raw_dat |&gt;
    left_join(choice_pred_dat,by=c('population','diet_pair','sex'))

# No choice experiment data

no_choice_raw_dat &lt;- read_csv(here(&quot;data/raw/field_populations/confined_diet.csv&quot;),show_col_types = FALSE)  |&gt;
    clean_names() |&gt;
    rename(
        diet = diet,
        sex = sex,
        initial_weight_g = locust_initial_weight_g,
        final_mass_g_dec3 = final_mass_g_5th_instar_recorded_on_dec_3,
        dev_time_with_5th_instar_days = development_time_with_days_in_5th_instar_for_those_not_yet_molted_days,
        specific_growth_rate_ln_mb = specific_growth_rate_ln_mb_final_mb_initial_time) |&gt;
    dplyr::select(diet,sex,initial_weight_g,final_mass_g_dec3,dev_time_with_5th_instar_days,specific_growth_rate_ln_mb) |&gt;
    drop_na(specific_growth_rate_ln_mb)

## I am taking the average over initial mass for simplicity sake
no_choice_pred_dat &lt;- read_csv(here('data/processed/field_populations/no_choice_experiment_predictions.csv'),show_col_types = FALSE) |&gt;
    group_by(diet,sex) |&gt;
    summarize(pred_specific_growth_rate = mean(pred_specific_growth_rate),
           pred_development_time = mean(pred_development_time))

no_choice_dat &lt;- no_choice_raw_dat |&gt;
    left_join(no_choice_pred_dat,by=c('diet','sex'))
  </code>
  <boxed-text>
    <preformat>`summarise()` has grouped output by 'diet'. You can override using the
`.groups` argument.</preformat>
  </boxed-text>
  </sec>
  <sec id="d08cf342-1833-40d0-9b5b-c85c3f1fcd86-nb-6" specific-use="notebook-content">
</sec>
<sec id="figure-2-nb-6">
  <title>Figure 2</title>
  <sec id="field-population-figure-nb-6">
    <title>Field population figure</title>
    <list list-type="bullet">
      <list-item>
        <p>panel a: choice intake target of two populations</p>
      </list-item>
      <list-item>
        <p>panel b: specific growth rate on confined ‘no-choice’
        diets</p>
      </list-item>
      <list-item>
        <p>panel c: development time on confined ‘no-choice’ diets</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-413a9067-6c17-4ad7-9ebe-6f8328277d24-nb-6" specific-use="notebook-content">
    <code language="r script">panel_a &lt;- choice_dat |&gt;
    group_by(population) |&gt;
    mutate(pred_carb = mean(pred_carb), pred_protein = mean(pred_protein)) |&gt;
    ggplot(aes(x=protein_consumed_g,y=carb_consumed_g,fill=population)) + 
        geom_point(shape=21) +  
        geom_point(aes(x = pred_protein, y = pred_carb,fill=population), size=5,shape=21) +
        coord_equal(ratio=1) + 
        xlim(0,.055) + ylim(0,.055) + 
        theme_pubr() + 
        ylab(&quot;Carbohydrate consumed (g)&quot;) +
        xlab(&quot;Protein consumed (g)&quot;) + 
        scale_fill_met_d(name='Degas') +
        geom_abline(slope = 1,linetype=1,intercept=0) + 
        geom_abline(slope = 2,linetype=2,intercept=0)


panel_b &lt;- no_choice_dat |&gt;
    group_by(diet) |&gt;
    mutate(pred_specific_growth_rate = mean(pred_specific_growth_rate),
          diet = factor(diet,levels = c(&quot;7p:35c&quot;,&quot;14p:28c&quot;,&quot;21p:21c&quot;,&quot;35p:7c&quot;))) |&gt;
    ggplot(aes(x=diet,y=specific_growth_rate_ln_mb)) +
        geom_point() +
        geom_point(aes(y=pred_specific_growth_rate),shape=23,size=5,fill=&quot;blue&quot;) +
        ylab(&quot;Specific Growth Rate&quot;) + 
        xlab(&quot;Diet&quot;) + 
        theme_pubr()


panel_c &lt;- no_choice_dat |&gt;
    group_by(diet) |&gt;
    mutate(pred_development_time = mean(pred_development_time),
          diet = factor(diet,levels = c(&quot;7p:35c&quot;,&quot;14p:28c&quot;,&quot;21p:21c&quot;,&quot;35p:7c&quot;))) |&gt;
    ggplot(aes(x=diet,y=dev_time_with_5th_instar_days)) +
        geom_point() +
        geom_point(aes(y=pred_development_time),shape=24,size=5,fill=&quot;purple&quot;) +
        ylab(&quot;Development Time (days)&quot;) + 
        xlab(&quot;Diet&quot;) +  
        theme_pubr() 
    </code>
    </sec>
    <sec id="cell-0a1f9d3b-a5e8-4891-bcc1-98ec7d0ff0c7-nb-6" specific-use="notebook-content">
    <code language="r script">
layout &lt;- &quot;
AA
BC
&quot;

figure_2 &lt;- panel_a + panel_b + panel_c + 
  plot_layout(design = layout) + plot_annotation(tag_levels = 'A')

figure_2</code>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_field_population_intake_target_manuscript_figure_table_code_files/figure-jats/cell-5-output-1.png" />
    </boxed-text>
    </sec>
    <sec id="d761f891-a6a1-4a75-b3f5-95cc582cfb6f-nb-6" specific-use="notebook-content">
    <code language="r script">ggsave(figure_2,file=here('output/publication_figures/field_population_intake_target_figure.png'),width=10,height=10)</code>
    </sec>
    <sec id="cell-72e8dd60-3781-41a9-811a-bfee2b83d6a3-nb-6" specific-use="notebook-content">
  </sec>
</sec>
<sec id="supplement-figure-3-nb-6">
  <title>Supplement Figure 3</title>
  <sec id="field-population-figure-diet-pairing-and-sex-nb-6">
    <title>Field population figure – diet pairing and sex</title>
    <list list-type="bullet">
      <list-item>
        <p>panel a: diet pair</p>
      </list-item>
      <list-item>
        <p>panel b: sex</p>
      </list-item>
      <list-item>
        <p>panel c: specific growth rate – sex</p>
      </list-item>
      <list-item>
        <p>panel d: development time – sex</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-3a4a4973-0e40-4b0f-9d12-2f6444107a5c-nb-6" specific-use="notebook-content">
    <code language="r script">panel_a &lt;- choice_dat |&gt;
    group_by(diet_pair) |&gt;
    mutate(pred_carb = mean(pred_carb), pred_protein = mean(pred_protein)) |&gt;
    ggplot(aes(x=protein_consumed_g,y=carb_consumed_g,fill=diet_pair)) + 
        geom_point(shape=21) +  
        geom_point(aes(x = pred_protein, y = pred_carb,fill=diet_pair), size=5,shape=21) +
        coord_equal(ratio=1) + 
        xlim(0,.055) + ylim(0,.055) + 
        theme_pubr() + 
        ylab(&quot;Carbohydrate consumed (g)&quot;) +
        xlab(&quot;Protein consumed (g)&quot;) + 
        scale_fill_met_d(name='Johnson') +
        geom_abline(slope = 1,linetype=1,intercept=0) + 
        geom_abline(slope = 2,linetype=2,intercept=0)

panel_b &lt;- choice_dat |&gt;
    group_by(sex) |&gt;
    mutate(pred_carb = mean(pred_carb), pred_protein = mean(pred_protein)) |&gt;
    ggplot(aes(x=protein_consumed_g,y=carb_consumed_g,fill=sex)) + 
        geom_point(shape=21) +  
        geom_point(aes(x = pred_protein, y = pred_carb,fill=sex), size=5,shape=21) +
        coord_equal(ratio=1) + 
        xlim(0,.055) + ylim(0,.055) + 
        theme_pubr() + 
        ylab(&quot;Carbohydrate consumed (g)&quot;) +
        xlab(&quot;Protein consumed (g)&quot;) + 
        scale_fill_met_d(name='Cross') +
        geom_abline(slope = 1,linetype=1,intercept=0) + 
        geom_abline(slope = 2,linetype=2,intercept=0)

panel_c &lt;- no_choice_dat |&gt;
    group_by(sex) |&gt;
    mutate(sex = case_when(sex == 'F' ~ 'female',TRUE ~ 'male'), 
           pred_development_time = mean(pred_development_time)) |&gt;
    ggplot(aes(x=sex,y=dev_time_with_5th_instar_days)) + 
        geom_jitter(width=0.1,height=0,color='grey') +  
        geom_point(aes(x = sex, y = pred_development_time), size=5) +
        theme_pubr() + 
        ylab(&quot;Development time (days)&quot;) +
        xlab(&quot;sex&quot;) 

panel_d &lt;- no_choice_dat |&gt;
    group_by(sex) |&gt;
    mutate(sex = case_when(sex == 'F' ~ 'female',TRUE ~ 'male'), 
           pred_specific_growth_rate = mean(pred_specific_growth_rate)) |&gt;
    ggplot(aes(x=sex,y=specific_growth_rate_ln_mb)) + 
        geom_jitter(width=0.1,height=0,color='grey') +  
        geom_point(aes(x = sex, y = pred_specific_growth_rate), size=5) +
        theme_pubr() + 
        ylab(&quot;Development time (days)&quot;) +
        xlab(&quot;sex&quot;) 

supplement_figure_3 &lt;- (panel_a + panel_b) / (panel_c + panel_d)  + plot_annotation(tag_levels = 'A')

supplement_figure_3</code>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_field_population_intake_target_manuscript_figure_table_code_files/figure-jats/cell-7-output-1.png" />
    </boxed-text>
    </sec>
    <sec id="cell-7ec1a088-27c0-444b-b2f9-b614cf5e3b47-nb-6" specific-use="notebook-content">
    <code language="r script">ggsave(supplement_figure_3,file=here('output/publication_figures/supplement_figure_3.png'),width=10,height=10)</code>
    </sec>
    <sec id="afc74e2c-06f8-45be-9b29-6878d7387f91-nb-6" specific-use="notebook-content">
  </sec>
</sec>
<sec id="maintext-table-1-nb-6">
  <title>Maintext Table 1</title>
  <sec id="field-population-choice-model-result-table-nb-6">
    <title>Field population choice model result table</title>
    <p>Family: multivariate gaussian distribution link: identity SE:
    standard error.</p>
    </sec>
    <sec id="dedb640b-5ddf-416a-beee-5139496acd1c-nb-6" specific-use="notebook-content">
    <code language="r script">mods &lt;- readRDS(here(&quot;output/field_populations/model_objects/choice_experiment_models.rds&quot;))

field_pop_mod &lt;- mods$mod3</code>
    </sec>
    <sec id="bf50bb64-9231-4bf2-8549-7a8d8729b94f-nb-6" specific-use="notebook-content">
    <code language="r script">field_population_choice_model_result &lt;- tidy(field_pop_mod,parametric=TRUE) |&gt;
    dplyr::select(term,estimate,std.error,p.value) |&gt;
    rename(variable = term,
           SE = std.error,
           `p-value` = p.value) |&gt;
    mutate(variable = gsub('\\(|\\)','',variable),
           macronutrient = case_when(str_detect(variable,'.1') ~ 'protein', TRUE ~ 'carbohydrate'),
           variable = gsub('.1|population|sex|diet_pair','',variable),
           variable = case_when(variable == 'B' ~ 'diet pair B',variable == 'M' ~ 'male',TRUE ~ variable)) |&gt;
    dplyr::select(macronutrient,variable,estimate,SE,`p-value`)</code>
    </sec>
    <sec id="a54f206b-0e9e-4791-a785-c85bf4ab5ff2-nb-6" specific-use="notebook-content">
    <code language="r script">field_population_choice_model_result</code>
    <boxed-text>
      <p>A tibble: 8 × 5</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
          </colgroup>
          <thead>
            <tr>
              <th>macronutrient &lt;chr&gt;</th>
              <th>variable &lt;chr&gt;</th>
              <th>estimate &lt;dbl&gt;</th>
              <th>SE &lt;dbl&gt;</th>
              <th>p-value &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>carbohydrate</td>
              <td>Intercept</td>
              <td>0.026441953</td>
              <td>0.002061730</td>
              <td>1.185902e-37</td>
            </tr>
            <tr>
              <td>carbohydrate</td>
              <td>Mendooran</td>
              <td>-0.001464095</td>
              <td>0.002085524</td>
              <td>4.826623e-01</td>
            </tr>
            <tr>
              <td>carbohydrate</td>
              <td>diet pair B</td>
              <td>0.001172648</td>
              <td>0.002081850</td>
              <td>5.732496e-01</td>
            </tr>
            <tr>
              <td>carbohydrate</td>
              <td>male</td>
              <td>-0.010924032</td>
              <td>0.002076173</td>
              <td>1.427914e-07</td>
            </tr>
            <tr>
              <td>protein</td>
              <td>Intercept</td>
              <td>0.013591366</td>
              <td>0.001499793</td>
              <td>1.278932e-19</td>
            </tr>
            <tr>
              <td>protein</td>
              <td>Mendooran</td>
              <td>-0.002344822</td>
              <td>0.001517102</td>
              <td>1.222030e-01</td>
            </tr>
            <tr>
              <td>protein</td>
              <td>diet pair B</td>
              <td>0.001592112</td>
              <td>0.001514429</td>
              <td>2.931231e-01</td>
            </tr>
            <tr>
              <td>protein</td>
              <td>male</td>
              <td>-0.005951703</td>
              <td>0.001510299</td>
              <td>8.122930e-05</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-9ae73e67-3cf5-4465-ab6a-f095356de6a6-nb-6" specific-use="notebook-content">
    <code language="r script">write.csv(field_population_choice_model_result,
          file=here('output/publication_tables/field_population_choice_model_result.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="cell-25e2f330-1a3d-4c18-9d73-3a02c2c1c583-nb-6" specific-use="notebook-content">
  </sec>
</sec>
<sec id="maintext-table-2-nb-6">
  <title>Maintext Table 2</title>
  <sec id="specific-growth-rate-and-development-time-model-results-nb-6">
    <title>Specific growth rate and development time model
    results</title>
    <p>SE: standard error, EDF: estimated degrees freedom, DF: degrees
    freedom</p>
    </sec>
    <sec id="f798d0e7-e0f9-4b2d-b877-c0ce3a9f7f47-nb-6" specific-use="notebook-content">
    <code language="r script">mods &lt;- readRDS(here(&quot;output/field_populations/model_objects/no_choice_experiment_models.rds&quot;))</code>
    </sec>
    <sec id="cell-0ed4e66a-c159-4f93-9192-748393d3e8dc-nb-6" specific-use="notebook-content">
    <code language="r script">sgr_mod &lt;- mods$sgr_models[[3]]
dev_mod &lt;- mods$dev_models[[2]]</code>
    </sec>
    <sec id="cell-2b421ecb-9dd1-4b74-b12a-99f83e3f86f6-nb-6" specific-use="notebook-content">
    <code language="r script">sgr_results &lt;- tidy(sgr_mod,parametric=TRUE) |&gt;
    dplyr::select(term,estimate,std.error,p.value) |&gt;
    rename(variable = term,
           SE = std.error,
           `p-value` = p.value) |&gt;
    mutate(variable = gsub('\\(|\\)|population|sex|diet','',variable),
           variable = gsub('M','male',variable)) |&gt;
    dplyr::select(variable,estimate,SE,`p-value`) |&gt;
    mutate(model = 'specific growth rate')

dev_results &lt;- tidy(dev_mod,parametric=TRUE) |&gt;
    dplyr::select(term,estimate,std.error,p.value) |&gt;
    rename(variable = term,
           SE = std.error,
           `p-value` = p.value) |&gt;
    mutate(variable = gsub('\\(|\\)|population|sex|diet','',variable),
           variable = gsub('M','male',variable)) |&gt;
    dplyr::select(variable,estimate,SE,`p-value`)  |&gt;
    mutate(model = 'development time')

sgr_dev_model_summary &lt;- sgr_results |&gt;
    rbind(dev_results)</code>
    </sec>
    <sec id="cell-436a5503-5a83-48a5-bdd9-c15df482fe4e-nb-6" specific-use="notebook-content">
    <code language="r script">sgr_dev_model_summary</code>
    <boxed-text>
      <p>A tibble: 11 × 5</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
            <col width="20%" />
          </colgroup>
          <thead>
            <tr>
              <th>variable &lt;chr&gt;</th>
              <th>estimate &lt;dbl&gt;</th>
              <th>SE &lt;dbl&gt;</th>
              <th>p-value &lt;dbl&gt;</th>
              <th>model &lt;chr&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Intercept</td>
              <td>0.061123569</td>
              <td>0.004238135</td>
              <td>2.916947e-19</td>
              <td>specific growth rate</td>
            </tr>
            <tr>
              <td>21p:21c</td>
              <td>-0.011231979</td>
              <td>0.005317546</td>
              <td>3.978597e-02</td>
              <td>specific growth rate</td>
            </tr>
            <tr>
              <td>35p:7c</td>
              <td>-0.010154844</td>
              <td>0.005885066</td>
              <td>9.073458e-02</td>
              <td>specific growth rate</td>
            </tr>
            <tr>
              <td>7p:35c</td>
              <td>-0.026002746</td>
              <td>0.005386856</td>
              <td>1.396135e-05</td>
              <td>specific growth rate</td>
            </tr>
            <tr>
              <td>male</td>
              <td>-0.003453088</td>
              <td>0.004051380</td>
              <td>3.981812e-01</td>
              <td>specific growth rate</td>
            </tr>
            <tr>
              <td>Intercept</td>
              <td>15.779678797</td>
              <td>1.554816364</td>
              <td>1.557738e-13</td>
              <td>development time</td>
            </tr>
            <tr>
              <td>21p:21c</td>
              <td>0.916566253</td>
              <td>0.624425728</td>
              <td>1.486664e-01</td>
              <td>development time</td>
            </tr>
            <tr>
              <td>35p:7c</td>
              <td>1.709059836</td>
              <td>0.664529283</td>
              <td>1.326766e-02</td>
              <td>development time</td>
            </tr>
            <tr>
              <td>7p:35c</td>
              <td>2.715746821</td>
              <td>0.602778043</td>
              <td>4.244680e-05</td>
              <td>development time</td>
            </tr>
            <tr>
              <td>male</td>
              <td>-1.615488891</td>
              <td>0.829235874</td>
              <td>5.725518e-02</td>
              <td>development time</td>
            </tr>
            <tr>
              <td>initial_weight_g</td>
              <td>-21.047619118</td>
              <td>10.406943803</td>
              <td>4.872002e-02</td>
              <td>development time</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-998bc4c6-ad72-4afa-9332-659047355008-nb-6" specific-use="notebook-content">
    <code language="r script">write.csv(sgr_dev_model_summary,
          file=here('output/publication_tables/field_population_no_choice_sgr_dev_result.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="cell-0a3fdbe7-d1be-485e-8d9d-556f488fe2fe-nb-6" specific-use="notebook-content">
  </sec>
</sec>
<sec id="model-selection-criteria-tables-nb-6">
  <title>Model Selection Criteria tables</title>
  <list list-type="bullet">
    <list-item>
      <p>choice experiment model selection critera table</p>
    </list-item>
    <list-item>
      <p>no choice experiment model selection critera table – specific
      growth rate</p>
    </list-item>
    <list-item>
      <p>no choice experiment model selection critera table –
      development time</p>
    </list-item>
  </list>
  <sec id="choice-experiment-table-nb-6">
    <title>Choice experiment table</title>
    </sec>
    <sec id="cell-1bf910d1-a807-445b-bffe-05490426b242-nb-6" specific-use="notebook-content">
    <code language="r script">choice_selection &lt;- read_csv(here(&quot;output/field_populations/choice_experiment_model_selection_criteria_results.csv&quot;),show_col_types = FALSE)

choice_selection_table &lt;- choice_selection |&gt;
    mutate(model = case_when(model == 'mod1' ~ 'macronutrient ~ population + diet_pair + sex + s(initial_mass_g, k=30)',
                             model == 'mod2' ~ 'macronutrient ~ population + diet_pair + sex + initial_mass_g',
                             model == 'mod3' ~ 'macronutrient ~ population + diet_pair + sex',
                             model == 'mod4' ~ 'macronutrient ~ 1'),
        across(where(is.numeric),~round(.,4))) |&gt;
    dplyr::select(model,deltaBIC,deltaAIC,deltaAICc)
    </code>
    </sec>
    <sec id="cell-265c6f49-a876-47d7-a9cb-fee3fb7be4f8-nb-6" specific-use="notebook-content">
    <code language="r script">write.csv(choice_selection_table,
          file=here('output/publication_tables/field_population_choice_experiment_model_selection_criteria.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="cell-9bbc2699-a5e5-4b15-ba63-bb83e59f0102-nb-6" specific-use="notebook-content">
  </sec>
  <sec id="no-choice-experiment-nb-6">
    <title>no choice experiment</title>
    </sec>
    <sec id="d131649b-fa63-4d0b-a841-b4bee39facad-nb-6" specific-use="notebook-content">
    <code language="r script">no_choice_selection &lt;- read_csv(here(&quot;output/field_populations/no_choice_experiment_model_selection_criteria_results.csv&quot;),show_col_types = FALSE)</code>
    </sec>
    <sec id="f23540cb-0e3f-4ce7-9f1e-c2f043d8fb99-nb-6" specific-use="notebook-content">
    <code language="r script">no_choice_selection_specific_growth_rate_table &lt;- no_choice_selection |&gt;
    filter(physiology_parameter == 'specific_growth_rate') |&gt;
    mutate(model = case_when(model == 'models[[1]]' ~ 'specific growth rate ~ population + diet_pair + sex + s(initial_mass_g, k=15)',
                             model == 'models[[2]]' ~ 'specific growth rate ~ population + diet_pair + sex + initial_mass_g',
                             model == 'models[[3]]' ~ 'specific growth rate ~ population + diet_pair + sex',
                             model == 'models[[4]]' ~ 'specific growth rate ~ 1'),
        across(where(is.numeric),~round(.,4))) |&gt;
    dplyr::select(model,deltaBIC,deltaAIC,deltaAICc)

no_choice_selection_development_time_table &lt;- no_choice_selection |&gt;
    filter(physiology_parameter == 'development_time') |&gt;
    mutate(model = case_when(model == 'models[[1]]' ~ 'development time ~ population + diet_pair + sex + s(initial_mass_g, k=15)',
                             model == 'models[[2]]' ~ 'development time ~ population + diet_pair + sex + initial_mass_g',
                             model == 'models[[3]]' ~ 'development time ~ population + diet_pair + sex',
                             model == 'models[[4]]' ~ 'development time ~ 1'),
        across(where(is.numeric),~round(.,4))) |&gt;
    dplyr::select(model,deltaBIC,deltaAIC,deltaAICc)
    </code>
    </sec>
    <sec id="b962bda1-b76c-4bd6-b3aa-aedaca91f959-nb-6" specific-use="notebook-content">
    <code language="r script">write.csv(no_choice_selection_specific_growth_rate_table,
          file=here('output/publication_tables/field_population_no_choice_specific_growth_rate_model_selection_criteria.csv'),
          row.names=FALSE)

write.csv(no_choice_selection_development_time_table,
          file=here('output/publication_tables/field_population_no_choice_development_time_model_selection_criteria.csv'),
          row.names=FALSE)</code>
    </sec>
    <sec id="cell-2ecc0a26-e2f5-4f91-a2fd-b57f22e3c1f8-nb-6" specific-use="notebook-content">
  </sec>
</sec>
<sec id="posthoc-comparisons-nb-6">
  <title>Posthoc comparisons</title>
  </sec>
  <sec id="e4cae95f-307f-4520-a264-7e8f749e64b9-nb-6" specific-use="notebook-content">
  <code language="r script">development_time_contrasts &lt;- read_csv(here(&quot;output/field_populations/no_choice_experiment_development_time_emm_contrasts.csv&quot;),show_col_types = FALSE)
specific_growth_rate_contrasts &lt;- read_csv(here(&quot;output/field_populations/no_choice_experiment_specific_growth_rate_emm_contrasts.csv&quot;),show_col_types = FALSE)
  </code>
  </sec>
  <sec id="bc10fb9a-6cff-4108-8b66-79cf4a6a6e8e-nb-6" specific-use="notebook-content">
  <code language="r script">development_time_contrasts_table &lt;- development_time_contrasts |&gt;
    dplyr::select(contrast,estimate,std.error,adj.p.value) |&gt;
    mutate(across(where(is.numeric),~round(.,4)),model = 'development time') |&gt;
    rename(comparisons = contrast,
           SE = std.error,
           `adjusted p-value` = adj.p.value) 

specific_growth_rate_contrasts_table &lt;- specific_growth_rate_contrasts |&gt;
    dplyr::select(contrast,estimate,std.error,adj.p.value) |&gt;
    mutate(across(where(is.numeric),~round(.,4)),model = 'specific growth rate')  |&gt;
    rename(comparisons = contrast,
           SE = std.error,
           `adjusted p-value` = adj.p.value)

posthoc_table &lt;- rbind(development_time_contrasts_table,specific_growth_rate_contrasts_table)</code>
  </sec>
  <sec id="cell-5bc18b75-d315-429f-b3ac-efca57faa643-nb-6" specific-use="notebook-content">
  <code language="r script">write.csv(posthoc_table,
          file=here('output/publication_tables/field_population_no_choice_sgr_dev_posthoc_comparison_results.csv'),
          row.names=FALSE)</code>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-21-nb-7">
<front-stub>
</front-stub>

<body>
<sec id="cell-6cfad1ab-3e8c-45a2-adaa-9a0d6eaadcfd-nb-7" specific-use="notebook-content">
<code language="python">import ee
import pandas as pd
import geopandas as gpd
import geemap
import os
from tqdm import tqdm
from shapely import wkt
from shapely.geometry import mapping

#ee.Authenticate()
ee.Initialize()</code>
</sec>
<sec id="cell-60b06384-943f-4428-961e-bb570bedae1f-nb-7" specific-use="notebook-content">
<code language="python">os.chdir(os.path.abspath(os.path.join(os.getcwd(), os.pardir)))</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
</sec>
<sec id="cell-10724d32-761b-46c4-aa66-190ed4ecc066-nb-7" specific-use="notebook-content">
<code language="python">os.getcwd()</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
<boxed-text>
  <preformat>'/home/datascience/herbivore_nutrient_interactions'</preformat>
</boxed-text>
</sec>
<sec id="b45a955a-5df4-458d-9957-82bf317ba662-nb-7" specific-use="notebook-content">
<code language="python">
# Path to your shapefile
shapefile_path = &quot;data/raw/survey_data/australian_plague_locut_distribution/Australia_Locust_Distribution.shp&quot;

# Read the shapefile using GeoPandas
gdf = gpd.read_file(shapefile_path)

# Convert the GeoPandas GeoDataFrame to an Earth Engine FeatureCollection
apl_map = geemap.geopandas_to_ee(gdf)

# Example of using it for further analysis in Google Earth Engine
Map = geemap.Map()
Map.centerObject(ee_fc)
Map.addLayer(ee_fc, {}, &quot;Shapefile Layer&quot;)
Map</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
<boxed-text>
  <preformat>Map(center=[0, 0], controls=(WidgetControl(options=['position', 'transparent_bg'], widget=SearchDataGUI(childr…</preformat>
</boxed-text>
</sec>
<sec id="b7ccc9b8-b884-40a4-af01-b92af9e8af0e-nb-7" specific-use="notebook-content">
<code language="python"># Australia soil grid

# Load the Australian Soil Grid image collection.
soil_collection = ee.ImageCollection(&quot;CSIRO/SLGA&quot;)

nitrogen = soil_collection.filter(ee.Filter.inList('system:index', ['NTO'])).select(['NTO_000_005_EV','NTO_005_015_EV']).mean()

avg_nitrogen = nitrogen.expression(
    '(b1 + b2) / 2', {
        'b1': nitrogen.select('NTO_000_005_EV'),
        'b2': nitrogen.select('NTO_005_015_EV')
    }
).rename('avg_nto_band').clip(apl_map)

phosphorus = soil_collection.filter(ee.Filter.inList('system:index', ['PTO'])).select(['PTO_000_005_EV','PTO_005_015_EV']).mean()

avg_phosphorus = phosphorus.expression(
    '(b1 + b2) / 2', {
        'b1': phosphorus.select('PTO_000_005_EV'),
        'b2': phosphorus.select('PTO_005_015_EV')
    }
).rename('avg_pto_band').clip(apl_map)


avg_phosphorus = avg_phosphorus.updateMask(avg_phosphorus.clip(apl_map))
avg_nitrogen = avg_nitrogen.updateMask(avg_nitrogen.clip(apl_map))</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
</sec>
<sec id="a78f8a5d-00af-4f89-bc67-b40bbed28153-nb-7" specific-use="notebook-content">
<code language="python"># Example of using it for further analysis in Google Earth Engine
Map = geemap.Map()
Map.centerObject(avg_nitrogen)
Map.addLayer(avg_nitrogen, {}, &quot;average phosphorus&quot;)
Map</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
<boxed-text>
  <preformat>Map(center=[0, 0], controls=(WidgetControl(options=['position', 'transparent_bg'], widget=SearchDataGUI(childr…</preformat>
</boxed-text>
</sec>
<sec id="acff150d-ec20-4858-8151-845d4264a2c4-nb-7" specific-use="notebook-content">
<code language="python">
# Export the clipped raster directly to a local file as a GeoTIFF
geemap.ee_export_image(
    avg_nitrogen, 
    filename = &quot;data/raw/survey_data/apl_nitrogen_raster.tif&quot;,
    region = apl_map.geometry(), 
    scale = 2000
)

print(&quot;Nitrogen Raster file saved&quot;)

# Export the clipped raster directly to a local file as a GeoTIFF
geemap.ee_export_image(
    avg_phosphorus, 
    filename=&quot;data/raw/survey_data/apl_phosphorus_raster.tif&quot;,
    region=apl_map.geometry(), 
    scale = 2000
)

print(&quot;Phophorus Raster file saved&quot;)</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
<boxed-text>
  <preformat>Generating URL ...
Downloading data from https://earthengine.googleapis.com/v1/projects/earthengine-legacy/thumbnails/c5a6a3a18275e0aa6bf709dd0be7d55a-ff7f222facc0984273b831cfc3bc506e:getPixels
Please wait ...
Data downloaded to /home/datascience/herbivore_nutrient_interactions/data/raw/survey_data/apl_nitrogen_raster.tif
Nitrogen Raster file saved
Generating URL ...
Downloading data from https://earthengine.googleapis.com/v1/projects/earthengine-legacy/thumbnails/f45544c99ee98a5c90b1d9f492ca4351-716d897dff72fc00f1dcd12dd11df845:getPixels
Please wait ...
Data downloaded to /home/datascience/herbivore_nutrient_interactions/data/raw/survey_data/apl_phosphorus_raster.tif
Phophorus Raster file saved</preformat>
</boxed-text>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-24-nb-8">
<front-stub>
<title-group>
<article-title>Point to grid conversion</article-title>
</title-group>
</front-stub>

<body>
<sec id="f0842cfa-9614-4820-91ca-5967aa8de101-nb-8" specific-use="notebook-content">
<p>This code takes the georeferenced points and related them to a
fishnet grid of 1km x 1km scale.</p>
<p>This will be for both for Australian Plague Locust and Desert
Locust</p>
</sec>
<sec id="cell-8cb97841-63d4-4070-a986-089de1d711e8-nb-8" specific-use="notebook-content">
<code language="python">import pandas as pd
import geopandas as gpd
import os</code>
</sec>
<sec id="cell-1184a69a-588f-4522-bd5a-04540769e463-nb-8" specific-use="notebook-content">
<code language="python">os.chdir(os.path.abspath(os.path.join(os.getcwd(), os.pardir)))
os.getcwd()</code>
<boxed-text>
  <preformat>'/home/datascience/herbivore_nutrient_interactions'</preformat>
</boxed-text>
</sec>
<sec id="cell-20638780-1e5a-4d63-b733-5b41a2670c7b-nb-8" specific-use="notebook-content">
<code language="python"># This function takes the point dataset and creates a sparse fishnet grid that overlaps with all points. 
# there is a user species cell size and few other handy parameters
# it defaults to parallel processing but can be turned off

# it creates a bounding box, creates a coarse grid, filters out unused grids and then within each coarse grid, it creates the fine scale grid
# at the speicifed cell size and then removes unused grids.

with open('scripts/functions/fishnet_grid_function.py') as f:
    code = f.read()

# Execute the code
exec(code)
</code>
</sec>
<sec id="cell-8fc96b44-606b-41f5-9a89-e7d7806adb4c-nb-8" specific-use="notebook-content">
<sec id="australian-plague-locust-data-nb-8">
  <title>Australian plague locust data</title>
  <p>This dataset is comprised of several species but the records are
  biased towards the more economically important species
  (e.g. australian plauge locust)</p>
</sec>
<sec id="species-identifier-nb-8">
  <title>Species identifier</title>
  <p>The <monospace>Species</monospace> column is the identifier per
  species</p>
  <list list-type="bullet">
    <list-item>
      <p>10 = no locust/grasshopper found</p>
    </list-item>
    <list-item>
      <p>11 = Australian plague locust (<italic>Chortocietes
      terminifera</italic>)</p>
    </list-item>
    <list-item>
      <p>12 = Spur-throated locust (<italic>Austracris
      guttulosa</italic>)</p>
    </list-item>
    <list-item>
      <p>15 = Small plague locust (<italic>Austroicetes
      cruciata</italic>)</p>
    </list-item>
    <list-item>
      <p>19 = Eastern plague grasshopper (<italic>Oedaleus
      australis</italic>)</p>
    </list-item>
  </list>
  <sec id="species-data-management-nb-8">
    <title>Species data management</title>
    <p>For each species, we need to combined the species specific ID
    with the <monospace>10</monospace> observations (nil-observations)
    and observations in the other species categories that are nil. This
    will provide us with all the records that a specific grasshopper
    species was present and combine it with all the nil observation
    possible.</p>
    </sec>
    <sec id="cell-19398ba1-1ad5-44d4-a42c-c26ee37c0a52-nb-8" specific-use="notebook-content">
    <code language="python">CT = pd.read_csv('data/raw/survey_data/CT.csv')
OA = pd.read_csv('data/raw/survey_data/OA.csv')
AG = pd.read_csv('data/raw/survey_data/AG.csv')
AC = pd.read_csv('data/raw/survey_data/AC.csv')

# Add a species column to each dataframe
CT['species'] = 'CT'
OA['species'] = 'OA'
AG['species'] = 'AG'
AC['species'] = 'AC'

# Combine all the dataframes
combined_df = pd.concat([CT, OA, AG, AC], ignore_index=True).drop(columns=['Longitude2', 'Latitude2','Unnamed: 0'])
combined_df</code>
    <boxed-text>
      <table-wrap>
        <table border="1">
          <thead>
            <tr style="text-align: right;">
              <th></th>
              <th>Source</th>
              <th>Date</th>
              <th>Longitude</th>
              <th>Latitude</th>
              <th>Species</th>
              <th>Data.Quality</th>
              <th>Nymph.Stage</th>
              <th>Nymph.Density</th>
              <th>Adult.Stage</th>
              <th>Adult.Density</th>
              <th>species</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>0</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.144968</td>
              <td>-24.760067</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>1</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.276912</td>
              <td>-24.473368</td>
              <td>10</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>2</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.278365</td>
              <td>-24.643177</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>3</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.367765</td>
              <td>-24.354893</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>4</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.459170</td>
              <td>-24.319528</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
            </tr>
            <tr>
              <td>303829</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.073900</td>
              <td>-25.521900</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303830</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.307100</td>
              <td>-25.209900</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303831</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.839400</td>
              <td>-25.032800</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303832</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.921900</td>
              <td>-24.971200</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303833</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>146.820000</td>
              <td>-31.751700</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-388f01d6-e1dd-4b17-8d51-6c1e367650f4-nb-8" specific-use="notebook-content">
  </sec>
</sec>
<sec id="fishnet-grid-construction-nb-8">
  <title>Fishnet grid construction</title>
  <p>I first create the sparse fishnet grid (roughly 1km x 1km) and then
  aggregate the species data to the polygons. This is done BY species
  and not between.</p>
  </sec>
  <sec id="b518e127-c4da-4ed5-a189-161cb686a630-nb-8" specific-use="notebook-content">
  <code language="python">
aplc_survey_dataframe = create_grids_parallel(
        combined_df,
        longitude_column='Longitude',
        latitude_column='Latitude',
        csv_crs='EPSG:4326',
        grid_crs='EPSG:4326',
        transformation_crs='EPSG:4326',
        final_cell_size=0.01,
        coarse_cell_size=None,
        parallel=True
    )
  </code>
  <boxed-text>
    <preformat>Processing Polygons: 100%|██████████| 1315/1315 [00:17&lt;00:00, 73.10it/s]</preformat>
  </boxed-text>
  </sec>
  <sec id="cd8ea9d3-c931-4001-81c5-983391ccfa35-nb-8" specific-use="notebook-content">
  <code language="python"># Add an index to the polygons
## this will allow us to join tables together (and make GEE easier)

aplc_survey_dataframe = gpd.GeoDataFrame(aplc_survey_dataframe)
aplc_survey_dataframe['polygon_id'] = aplc_survey_dataframe.index
aplc_survey_dataframe.set_crs(epsg=4326, inplace=True)</code>
  <boxed-text>
    <table-wrap>
      <table border="1">
        <thead>
          <tr style="text-align: right;">
            <th></th>
            <th>geometry</th>
            <th>polygon_id</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>13</td>
            <td>POLYGON ((131.66364 -28.11974, 131.66364 -28.1...</td>
            <td>13</td>
          </tr>
          <tr>
            <td>3072</td>
            <td>POLYGON ((133.20694 -26.35200, 133.20694 -26.3...</td>
            <td>3072</td>
          </tr>
          <tr>
            <td>4563</td>
            <td>POLYGON ((133.18694 -26.24757, 133.18694 -26.2...</td>
            <td>4563</td>
          </tr>
          <tr>
            <td>4620</td>
            <td>POLYGON ((133.19694 -26.07757, 133.19694 -26.0...</td>
            <td>4620</td>
          </tr>
          <tr>
            <td>4626</td>
            <td>POLYGON ((133.19694 -26.01757, 133.19694 -26.0...</td>
            <td>4626</td>
          </tr>
          <tr>
            <td>...</td>
            <td>...</td>
            <td>...</td>
          </tr>
          <tr>
            <td>2101240</td>
            <td>POLYGON ((151.10087 -27.06644, 151.10087 -27.0...</td>
            <td>2101240</td>
          </tr>
          <tr>
            <td>2101580</td>
            <td>POLYGON ((151.18087 -26.86644, 151.18087 -26.8...</td>
            <td>2101580</td>
          </tr>
          <tr>
            <td>2101656</td>
            <td>POLYGON ((151.20087 -26.90644, 151.20087 -26.8...</td>
            <td>2101656</td>
          </tr>
          <tr>
            <td>2102441</td>
            <td>POLYGON ((151.00087 -26.66200, 151.00087 -26.6...</td>
            <td>2102441</td>
          </tr>
          <tr>
            <td>2102562</td>
            <td>POLYGON ((151.03087 -26.65200, 151.03087 -26.6...</td>
            <td>2102562</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </boxed-text>
  </sec>
  <sec id="b00cb0d8-975b-4481-b829-08246f656ab0-nb-8" specific-use="notebook-content">
  <sec id="lets-summarize-the-apl-point-data-to-the-polygon-grid-data-nb-8">
    <title>Lets summarize the APL point data to the polygon grid
    data</title>
    </sec>
    <sec id="cell-9714e545-1812-4775-aab4-ed0f7c5a454c-nb-8" specific-use="notebook-content">
    <code language="python">combined_df</code>
    <boxed-text>
      <table-wrap>
        <table border="1">
          <thead>
            <tr style="text-align: right;">
              <th></th>
              <th>Source</th>
              <th>Date</th>
              <th>Longitude</th>
              <th>Latitude</th>
              <th>Species</th>
              <th>Data.Quality</th>
              <th>Nymph.Stage</th>
              <th>Nymph.Density</th>
              <th>Adult.Stage</th>
              <th>Adult.Density</th>
              <th>species</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>0</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.144968</td>
              <td>-24.760067</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>1</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.276912</td>
              <td>-24.473368</td>
              <td>10</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>2</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.278365</td>
              <td>-24.643177</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>3</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.367765</td>
              <td>-24.354893</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>4</td>
              <td>1</td>
              <td>7-Apr-17</td>
              <td>143.459170</td>
              <td>-24.319528</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>7</td>
              <td>1</td>
              <td>CT</td>
            </tr>
            <tr>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
            </tr>
            <tr>
              <td>303829</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.073900</td>
              <td>-25.521900</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303830</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.307100</td>
              <td>-25.209900</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303831</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.839400</td>
              <td>-25.032800</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303832</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>143.921900</td>
              <td>-24.971200</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
            <tr>
              <td>303833</td>
              <td>1</td>
              <td>5-Jan-00</td>
              <td>146.820000</td>
              <td>-31.751700</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>AC</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-674d1a74-aa45-4e26-a3b1-335111a9e054-nb-8" specific-use="notebook-content">
    <code language="python">columns_to_keep = ['Longitude', 'Latitude', 'Date','Species','Data.Quality','Nymph.Density','Adult.Density']
APL_dat = combined_df[columns_to_keep]
    </code>
    </sec>
    <sec id="b13906f9-6919-4226-ad4b-d9788b6036c3-nb-8" specific-use="notebook-content">
    <code language="python"># Convert DataFrame to GeoDataFrame

gdf_points = gpd.GeoDataFrame(
    APL_dat,
    geometry=gpd.points_from_xy(APL_dat.Longitude, APL_dat.Latitude)
)

gdf_points.set_crs(epsg=4326, inplace=True)
    </code>
    <boxed-text>
      <table-wrap>
        <table border="1">
          <thead>
            <tr style="text-align: right;">
              <th></th>
              <th>Longitude</th>
              <th>Latitude</th>
              <th>Date</th>
              <th>Species</th>
              <th>Data.Quality</th>
              <th>Nymph.Density</th>
              <th>Adult.Density</th>
              <th>geometry</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>0</td>
              <td>143.144968</td>
              <td>-24.760067</td>
              <td>7-Apr-17</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>1</td>
              <td>POINT (143.14497 -24.76007)</td>
            </tr>
            <tr>
              <td>1</td>
              <td>143.276912</td>
              <td>-24.473368</td>
              <td>7-Apr-17</td>
              <td>10</td>
              <td>6</td>
              <td>0</td>
              <td>0</td>
              <td>POINT (143.27691 -24.47337)</td>
            </tr>
            <tr>
              <td>2</td>
              <td>143.278365</td>
              <td>-24.643177</td>
              <td>7-Apr-17</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>1</td>
              <td>POINT (143.27837 -24.64318)</td>
            </tr>
            <tr>
              <td>3</td>
              <td>143.367765</td>
              <td>-24.354893</td>
              <td>7-Apr-17</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>1</td>
              <td>POINT (143.36776 -24.35489)</td>
            </tr>
            <tr>
              <td>4</td>
              <td>143.459170</td>
              <td>-24.319528</td>
              <td>7-Apr-17</td>
              <td>11</td>
              <td>6</td>
              <td>0</td>
              <td>1</td>
              <td>POINT (143.45917 -24.31953)</td>
            </tr>
            <tr>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
            </tr>
            <tr>
              <td>303829</td>
              <td>143.073900</td>
              <td>-25.521900</td>
              <td>5-Jan-00</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>POINT (143.07390 -25.52190)</td>
            </tr>
            <tr>
              <td>303830</td>
              <td>143.307100</td>
              <td>-25.209900</td>
              <td>5-Jan-00</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>POINT (143.30710 -25.20990)</td>
            </tr>
            <tr>
              <td>303831</td>
              <td>143.839400</td>
              <td>-25.032800</td>
              <td>5-Jan-00</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>POINT (143.83940 -25.03280)</td>
            </tr>
            <tr>
              <td>303832</td>
              <td>143.921900</td>
              <td>-24.971200</td>
              <td>5-Jan-00</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>POINT (143.92190 -24.97120)</td>
            </tr>
            <tr>
              <td>303833</td>
              <td>146.820000</td>
              <td>-31.751700</td>
              <td>5-Jan-00</td>
              <td>10</td>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>POINT (146.82000 -31.75170)</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="b979461e-3cec-4b0d-8fe6-2b6a058a46b6-nb-8" specific-use="notebook-content">
    <code language="python">joined_gdf = gpd.sjoin(gdf_points, aplc_survey_dataframe, how=&quot;left&quot;, predicate='within')
    </code>
    </sec>
    <sec id="cell-4982db06-9b18-401d-99a2-8e4fb78a5a80-nb-8" specific-use="notebook-content">
    <code language="python"># I wanted to ensure every point has an assoicated polygon_id 

## which they do

na_counts = joined_gdf.isna().sum()

print(na_counts)</code>
    <boxed-text>
      <preformat>Longitude        0
Latitude         0
Date             0
Species          0
Data.Quality     0
Nymph.Density    0
Adult.Density    0
geometry         0
index_right      0
polygon_id       0
dtype: int64</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-154aac4f-b185-43d6-9897-22eec2641829-nb-8" specific-use="notebook-content">
    <code language="python">
# Custom aggregation function to get min, median, and max dates
def date_aggregations(series):
    series = pd.to_datetime(series, format='%d-%b-%y') # converts to a datatime
    return [series.min(), series.median(), series.max()]

# aggregation function to count unique values
def count_unique_values(series):
    return series.value_counts().to_dict()

# Group by polygon geometry and aggregate the data
aggregated_gdf = joined_gdf.groupby(['Species', 'polygon_id']).agg({
    'Date': date_aggregations,
    'Longitude': 'median',
    'Latitude': 'median',
    'Data.Quality': count_unique_values,
    'Nymph.Density': count_unique_values,
    'Adult.Density': count_unique_values
}).reset_index()
    </code>
    </sec>
    <sec id="a1aecc29-106a-4d7b-bd83-c06e07c84cc5-nb-8" specific-use="notebook-content">
    <code language="python">aggregated_gdf</code>
    <boxed-text>
      <table-wrap>
        <table border="1">
          <thead>
            <tr style="text-align: right;">
              <th></th>
              <th>Species</th>
              <th>polygon_id</th>
              <th>Date</th>
              <th>Longitude</th>
              <th>Latitude</th>
              <th>Data.Quality</th>
              <th>Nymph.Density</th>
              <th>Adult.Density</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>0</td>
              <td>10</td>
              <td>13</td>
              <td>[2014-03-08 00:00:00, 2014-03-08 00:00:00, 201...</td>
              <td>131.655639</td>
              <td>-28.119211</td>
              <td>{6: 4}</td>
              <td>{0: 4}</td>
              <td>{0: 4}</td>
            </tr>
            <tr>
              <td>1</td>
              <td>10</td>
              <td>3072</td>
              <td>[2017-04-01 00:00:00, 2017-04-01 00:00:00, 201...</td>
              <td>133.206243</td>
              <td>-26.350383</td>
              <td>{6: 4}</td>
              <td>{0: 4}</td>
              <td>{0: 4}</td>
            </tr>
            <tr>
              <td>2</td>
              <td>10</td>
              <td>4563</td>
              <td>[2006-03-16 00:00:00, 2006-03-16 00:00:00, 200...</td>
              <td>133.186734</td>
              <td>-26.237582</td>
              <td>{6: 4}</td>
              <td>{0: 4}</td>
              <td>{0: 4}</td>
            </tr>
            <tr>
              <td>3</td>
              <td>10</td>
              <td>4620</td>
              <td>[2006-03-16 00:00:00, 2006-03-16 00:00:00, 200...</td>
              <td>133.195693</td>
              <td>-26.075735</td>
              <td>{6: 4}</td>
              <td>{0: 4}</td>
              <td>{0: 4}</td>
            </tr>
            <tr>
              <td>4</td>
              <td>10</td>
              <td>4626</td>
              <td>[2017-04-01 00:00:00, 2017-04-01 00:00:00, 201...</td>
              <td>133.194124</td>
              <td>-26.009872</td>
              <td>{6: 4}</td>
              <td>{0: 4}</td>
              <td>{0: 4}</td>
            </tr>
            <tr>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
              <td>...</td>
            </tr>
            <tr>
              <td>99172</td>
              <td>19</td>
              <td>2089037</td>
              <td>[2008-01-15 00:00:00, 2008-01-15 00:00:00, 200...</td>
              <td>150.841310</td>
              <td>-26.695573</td>
              <td>{6: 1}</td>
              <td>{0: 1}</td>
              <td>{2: 1}</td>
            </tr>
            <tr>
              <td>99173</td>
              <td>19</td>
              <td>2089373</td>
              <td>[2007-03-18 00:00:00, 2007-03-18 00:00:00, 200...</td>
              <td>150.927725</td>
              <td>-26.933713</td>
              <td>{6: 1}</td>
              <td>{0: 1}</td>
              <td>{2: 1}</td>
            </tr>
            <tr>
              <td>99174</td>
              <td>19</td>
              <td>2099579</td>
              <td>[2007-11-07 00:00:00, 2007-11-07 12:00:00, 200...</td>
              <td>151.075760</td>
              <td>-27.261202</td>
              <td>{6: 2}</td>
              <td>{0: 2}</td>
              <td>{1: 2}</td>
            </tr>
            <tr>
              <td>99175</td>
              <td>19</td>
              <td>2100149</td>
              <td>[2007-03-18 00:00:00, 2007-03-18 00:00:00, 200...</td>
              <td>151.215045</td>
              <td>-27.163347</td>
              <td>{6: 1}</td>
              <td>{0: 1}</td>
              <td>{3: 1}</td>
            </tr>
            <tr>
              <td>99176</td>
              <td>19</td>
              <td>2101084</td>
              <td>[2007-03-18 00:00:00, 2007-03-18 00:00:00, 200...</td>
              <td>151.054728</td>
              <td>-27.023087</td>
              <td>{6: 1}</td>
              <td>{0: 1}</td>
              <td>{2: 1}</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-220eaf11-46b0-46e3-a435-af9fcf1fdefc-nb-8" specific-use="notebook-content">
    <code language="python"># Lets count up the total number of observations in the dataframe:

# Define the aggregation functions for each column
agg_funcs = {
    'Data.Quality': 'count',  
    'Adult.Density': 'count',    
    'Nymph.Density': 'count'    
}

# Perform groupby operation and aggregate
grouped_joined_gdf = joined_gdf.groupby(['Species', 'polygon_id']).agg(agg_funcs).reset_index()

# Rename the aggregated columns
grouped_joined_gdf.rename(columns={
    'Data.Quality': 'Data Quality Total Count',
    'Adult.Density': 'Adult Density Total Count',
    'Nymph.Density': 'Nymph Density Total Count'
}, inplace=True)


# These three columns should agree with one another....
## if any rows dont -- this command filters for them
grouped_joined_gdf[
    (grouped_joined_gdf['Data Quality Total Count'] != grouped_joined_gdf['Adult Density Total Count']) |
    (grouped_joined_gdf['Data Quality Total Count'] != grouped_joined_gdf['Nymph Density Total Count']) |
    (grouped_joined_gdf['Adult Density Total Count'] != grouped_joined_gdf['Nymph Density Total Count'])
]</code>
    <boxed-text>
      <table-wrap>
        <table border="1">
          <thead>
            <tr style="text-align: right;">
              <th></th>
              <th>Species</th>
              <th>polygon_id</th>
              <th>Data Quality Total Count</th>
              <th>Adult Density Total Count</th>
              <th>Nymph Density Total Count</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-66a01f23-45b0-41f3-8efa-c2f0244c59fb-nb-8" specific-use="notebook-content">
    <code language="python">final_df = pd.merge(aggregated_gdf, grouped_joined_gdf, on=['Species', 'polygon_id'], how='left')
final_df = pd.merge(final_df, aplc_survey_dataframe, on='polygon_id', how='left')
final_df.head()
na_counts = final_df.isna().sum()

print(na_counts)</code>
    <boxed-text>
      <preformat>Species                      0
polygon_id                   0
Date                         0
Longitude                    0
Latitude                     0
Data.Quality                 0
Nymph.Density                0
Adult.Density                0
Data Quality Total Count     0
Adult Density Total Count    0
Nymph Density Total Count    0
geometry                     0
dtype: int64</preformat>
    </boxed-text>
    </sec>
    <sec id="a1527cc6-91bf-4b76-aa86-314d972120ef-nb-8" specific-use="notebook-content">
  </sec>
  <sec id="the-aplc-data-is-complete-lets-write-to-disk-nb-8">
    <title>The APLC data is complete – lets write to disk</title>
    </sec>
    <sec id="cell-53baf12a-4255-4c56-997e-b89028f78bac-nb-8" specific-use="notebook-content">
    <code language="python">final_df.to_csv('data/processed/spatial_modeling/aplc_data_aggregated_to_polygon_grid.csv')</code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-27-nb-9">
<front-stub>
<title-group>
<article-title>Environmental variable correlations</article-title>
</title-group>
</front-stub>

<body>
<sec id="b4b952d5-f86b-46c1-9b31-f8f2e9a81f8c-nb-9" specific-use="notebook-content">
<p>This script extracts nitrogen, phosphorus, woody vegetation pixel
coverage, and mean annual precipitation from google earth engine for
correlation</p>
<p>The purpose is to show how the locust outbreak model disentangled the
positive correlation between nitrogen and these variables</p>
<p>read the manuscript for further discussion</p>
<sec id="import-libraries-and-initialize-google-earth-engine-nb-9">
  <title>Import libraries and initialize google earth engine</title>
  </sec>
  <sec id="fa0b44ae-a001-41b2-bfb0-fb4051d24448-nb-9" specific-use="notebook-content">
  <code language="python">import ee
import pandas as pd
import os 
import time

# Initialize Earth Engine
ee.Initialize()
  </code>
  </sec>
  <sec id="cell-87f45436-28d1-4eae-90a4-4f39b42fbd92-nb-9" specific-use="notebook-content">
</sec>
<sec id="set-relative-work-directory-nb-9">
  <title>set relative work directory</title>
  </sec>
  <sec id="cell-526f163d-a835-487f-b6e7-fc8ba9a75d6a-nb-9" specific-use="notebook-content">
  <code language="python">os.chdir(os.path.abspath(os.path.join(os.getcwd(), os.pardir)))
os.getcwd()</code>
  <boxed-text>
    <preformat>'/home/datascience/herbivore_nutrient_interactions'</preformat>
  </boxed-text>
  </sec>
  <sec id="cell-3a58d36b-7ccd-47c1-b12e-cdc5eadb2f42-nb-9" specific-use="notebook-content">
</sec>
<sec id="load-australia-shape-nb-9">
  <title>Load Australia shape</title>
  </sec>
  <sec id="cell-5f3c01ac-f301-405e-ba0c-7b87cc1fa8c5-nb-9" specific-use="notebook-content">
  <code language="python">
# Load the countries feature collection
countries = ee.FeatureCollection(&quot;USDOS/LSIB_SIMPLE/2017&quot;)

# Filter the feature collection to get the boundary of Australia
australia = countries.filter(ee.Filter.eq('country_na', 'Australia'))
  </code>
  </sec>
  <sec id="d52e0539-250d-4095-96f7-9dc08c11f1b6-nb-9" specific-use="notebook-content">
</sec>
<sec id="load-in-rasters-nb-9">
  <title>Load in rasters</title>
  </sec>
  <sec id="cell-6e574186-71f8-474b-ad3b-561701b536b3-nb-9" specific-use="notebook-content">
  <code language="python">
# Load the two rasters
raster1 = ee.ImageCollection('CSIRO/SLGA') \
    .filter(ee.Filter.eq('attribute_code', 'NTO')) \
    .select(['NTO_000_005_EV', 'NTO_005_015_EV']).mean()

raster2 = ee.ImageCollection(&quot;NASA/MEASURES/GFCC/TC/v3&quot;) \
    .select(&quot;tree_canopy_cover&quot;) \
    .filter(ee.Filter.calendarRange(2000, 2017, 'year')).mean()

raster3 = ee.Image(&quot;WORLDCLIM/V1/BIO&quot;).select('bio12')

raster4 = ee.ImageCollection('CSIRO/SLGA') \
    .filter(ee.Filter.eq('attribute_code', 'PTO')) \
    .select(['PTO_000_005_EV', 'PTO_005_015_EV']).mean()

# Combine the temperature bands from each image into a single image
temp_bands = raster1.addBands(raster2).addBands(raster3).addBands(raster4)
  </code>
  </sec>
  <sec id="cell-8b77090a-14ab-4a79-b2fc-b346f4754ac2-nb-9" specific-use="notebook-content">
</sec>
<sec id="sample-the-australia-shapefile-nb-9">
  <title>sample the australia shapefile</title>
  </sec>
  <sec id="cell-90f8c383-453f-41ee-844e-afaf21a984d8-nb-9" specific-use="notebook-content">
  <code language="python">
# Generate random points
sample = ee.FeatureCollection.randomPoints(
        region=australia, points=100000, seed=420, maxError=1
)

# Sample the the bands using the sample point feature collection.
imgSamp = temp_bands.sampleRegions(
  collection = sample,
  scale = 30
)
  </code>
  </sec>
  <sec id="cell-53fed578-8fa3-4986-ac09-2dfb70d01d51-nb-9" specific-use="notebook-content">
</sec>
<sec id="for-loop-to-extract-data-from-google-earth-engine-nb-9">
  <title>For loop to extract data from google earth engine</title>
  </sec>
  <sec id="cell-075e31d3-8462-4648-8b70-41e6c5756786-nb-9" specific-use="notebook-content">
  <code language="python">
# Set batch size
batch_size = 500
total_points = 100000
df = pd.DataFrame()

# Process in batches of 500
for start in range(0, total_points, batch_size):
    # Define the end of the batch
    end = min(start + batch_size, total_points)

    # Get the batch of points
    batch_sample = sample.toList(batch_size, start)
    batch_sample_fc = ee.FeatureCollection(batch_sample)

    # Sample the raster data
    img_samp_batch = temp_bands.sampleRegions(
        collection=batch_sample_fc,
        scale=30
    )

    # Get the result as a list of dictionaries
    try:
        sample_dict = img_samp_batch.getInfo()['features']
        rows = [feature['properties'] for feature in sample_dict]
        df_batch = pd.DataFrame(rows)

        # Append the batch to the main DataFrame
        df = pd.concat([df, df_batch], ignore_index=True)

        print(f&quot;Processed batch {start + 1} to {end}&quot;)

        # Add a delay to avoid overwhelming the API
        time.sleep(1)

    except Exception as e:
        print(f&quot;Error processing batch {start + 1} to {end}: {e}&quot;)

# Display the DataFrame
print(df.head())</code>
  <boxed-text>
    <preformat>Processed batch 1 to 500
Processed batch 501 to 1000
Processed batch 1001 to 1500
Processed batch 1501 to 2000
Processed batch 2001 to 2500
Processed batch 2501 to 3000
Processed batch 3001 to 3500
Processed batch 3501 to 4000
Processed batch 4001 to 4500
Processed batch 4501 to 5000
Processed batch 5001 to 5500
Processed batch 5501 to 6000
Processed batch 6001 to 6500
Processed batch 6501 to 7000
Processed batch 7001 to 7500
Processed batch 7501 to 8000
Processed batch 8001 to 8500
Processed batch 8501 to 9000
Processed batch 9001 to 9500
Processed batch 9501 to 10000
Processed batch 10001 to 10500
Processed batch 10501 to 11000
Processed batch 11001 to 11500
Processed batch 11501 to 12000
Processed batch 12001 to 12500
Processed batch 12501 to 13000
Processed batch 13001 to 13500
Processed batch 13501 to 14000
Processed batch 14001 to 14500
Processed batch 14501 to 15000
Processed batch 15001 to 15500
Processed batch 15501 to 16000
Processed batch 16001 to 16500
Processed batch 16501 to 17000
Processed batch 17001 to 17500
Processed batch 17501 to 18000
Processed batch 18001 to 18500
Processed batch 18501 to 19000
Processed batch 19001 to 19500
Processed batch 19501 to 20000
Processed batch 20001 to 20500
Processed batch 20501 to 21000
Processed batch 21001 to 21500
Processed batch 21501 to 22000
Processed batch 22001 to 22500
Processed batch 22501 to 23000
Processed batch 23001 to 23500
Processed batch 23501 to 24000
Processed batch 24001 to 24500
Processed batch 24501 to 25000
Processed batch 25001 to 25500
Processed batch 25501 to 26000
Processed batch 26001 to 26500
Processed batch 26501 to 27000
Processed batch 27001 to 27500
Processed batch 27501 to 28000
Processed batch 28001 to 28500
Processed batch 28501 to 29000
Processed batch 29001 to 29500
Processed batch 29501 to 30000
Processed batch 30001 to 30500
Processed batch 30501 to 31000
Processed batch 31001 to 31500
Processed batch 31501 to 32000
Processed batch 32001 to 32500
Processed batch 32501 to 33000
Processed batch 33001 to 33500
Processed batch 33501 to 34000
Processed batch 34001 to 34500
Processed batch 34501 to 35000
Processed batch 35001 to 35500
Processed batch 35501 to 36000
Processed batch 36001 to 36500
Processed batch 36501 to 37000
Processed batch 37001 to 37500
Processed batch 37501 to 38000
Processed batch 38001 to 38500
Processed batch 38501 to 39000
Processed batch 39001 to 39500
Processed batch 39501 to 40000
Processed batch 40001 to 40500
Processed batch 40501 to 41000
Processed batch 41001 to 41500
Processed batch 41501 to 42000
Processed batch 42001 to 42500
Processed batch 42501 to 43000
Processed batch 43001 to 43500
Processed batch 43501 to 44000
Processed batch 44001 to 44500
Processed batch 44501 to 45000
Processed batch 45001 to 45500
Processed batch 45501 to 46000
Processed batch 46001 to 46500
Processed batch 46501 to 47000
Processed batch 47001 to 47500
Processed batch 47501 to 48000
Processed batch 48001 to 48500
Processed batch 48501 to 49000
Processed batch 49001 to 49500
Processed batch 49501 to 50000
Processed batch 50001 to 50500
Processed batch 50501 to 51000
Processed batch 51001 to 51500
Processed batch 51501 to 52000
Processed batch 52001 to 52500
Processed batch 52501 to 53000
Processed batch 53001 to 53500
Processed batch 53501 to 54000
Processed batch 54001 to 54500
Processed batch 54501 to 55000
Processed batch 55001 to 55500
Processed batch 55501 to 56000
Processed batch 56001 to 56500
Processed batch 56501 to 57000
Processed batch 57001 to 57500
Processed batch 57501 to 58000
Processed batch 58001 to 58500
Processed batch 58501 to 59000
Processed batch 59001 to 59500
Processed batch 59501 to 60000
Processed batch 60001 to 60500
Processed batch 60501 to 61000
Processed batch 61001 to 61500
Processed batch 61501 to 62000
Processed batch 62001 to 62500
Processed batch 62501 to 63000
Processed batch 63001 to 63500
Processed batch 63501 to 64000
Processed batch 64001 to 64500
Processed batch 64501 to 65000
Processed batch 65001 to 65500
Processed batch 65501 to 66000
Processed batch 66001 to 66500
Processed batch 66501 to 67000
Processed batch 67001 to 67500
Processed batch 67501 to 68000
Processed batch 68001 to 68500
Processed batch 68501 to 69000
Processed batch 69001 to 69500
Processed batch 69501 to 70000
Processed batch 70001 to 70500
Processed batch 70501 to 71000
Processed batch 71001 to 71500
Processed batch 71501 to 72000
Processed batch 72001 to 72500
Processed batch 72501 to 73000
Processed batch 73001 to 73500
Processed batch 73501 to 74000
Processed batch 74001 to 74500
Processed batch 74501 to 75000
Processed batch 75001 to 75500
Processed batch 75501 to 76000
Processed batch 76001 to 76500
Processed batch 76501 to 77000
Processed batch 77001 to 77500
Processed batch 77501 to 78000
Processed batch 78001 to 78500
Processed batch 78501 to 79000
Processed batch 79001 to 79500
Processed batch 79501 to 80000
Processed batch 80001 to 80500
Processed batch 80501 to 81000
Processed batch 81001 to 81500
Processed batch 81501 to 82000
Processed batch 82001 to 82500
Processed batch 82501 to 83000
Processed batch 83001 to 83500
Processed batch 83501 to 84000
Processed batch 84001 to 84500
Processed batch 84501 to 85000
Processed batch 85001 to 85500
Processed batch 85501 to 86000
Processed batch 86001 to 86500
Processed batch 86501 to 87000
Processed batch 87001 to 87500
Processed batch 87501 to 88000
Processed batch 88001 to 88500
Processed batch 88501 to 89000
Processed batch 89001 to 89500
Processed batch 89501 to 90000
Processed batch 90001 to 90500
Processed batch 90501 to 91000
Processed batch 91001 to 91500
Processed batch 91501 to 92000
Processed batch 92001 to 92500
Processed batch 92501 to 93000
Processed batch 93001 to 93500
Processed batch 93501 to 94000
Processed batch 94001 to 94500
Processed batch 94501 to 95000
Processed batch 95001 to 95500
Processed batch 95501 to 96000
Processed batch 96001 to 96500
Processed batch 96501 to 97000
Processed batch 97001 to 97500
Processed batch 97501 to 98000
Processed batch 98001 to 98500
Processed batch 98501 to 99000
Processed batch 99001 to 99500
Processed batch 99501 to 100000
   NTO_000_005_EV  NTO_005_015_EV  PTO_000_005_EV  PTO_005_015_EV  bio12  \
0        0.036264        0.032103        0.017605        0.016432    223   
1        0.031465        0.029525        0.018839        0.018417    163   
2        0.060444        0.055346        0.022199        0.021432   1050   
3        0.147743        0.118303        0.029048        0.026754    850   
4        0.048120        0.042801        0.024990        0.024281    289   

   tree_canopy_cover  
0               0.00  
1               0.00  
2              11.00  
3               5.00  
4               2.75  </preformat>
  </boxed-text>
  </sec>
  <sec id="cell-0572afc1-3e41-4dd5-87d8-bf9bdc360b75-nb-9" specific-use="notebook-content">
  <code language="python">df.to_csv('data/processed/spatial_modeling/environmental_correlation_data.csv', index=False)
  </code>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-30-nb-10">
<front-stub>
<title-group>
<article-title>Spatial modeling post modeling figure and table
construction</article-title>
</title-group>
</front-stub>

<body>
<sec id="cell-0e83583a-8f00-427a-84af-efd1dcd9d168-nb-10" specific-use="notebook-content">
<list list-type="bullet">
  <list-item>
    <p>post-modeling visualization</p>
  </list-item>
  <list-item>
    <p>environmental correlations</p>
  </list-item>
  <list-item>
    <p>soil and point map generation</p>
  </list-item>
  <list-item>
    <p>gridding example plot</p>
  </list-item>
</list>
</sec>
<sec id="d36c1a43-cc7e-42c8-bea9-169908f7da32-nb-10" specific-use="notebook-content">
<code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;tidyverse&quot;, &quot;mgcv&quot;, &quot;stars&quot;, &quot;terra&quot;,  
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;janitor&quot;, &quot;sf&quot;,&quot;tidyterra&quot;,
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;rnaturalearth&quot;)

load_packages(packages)

i_am('README.md')

# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10)
</code>
<boxed-text>
  <preformat>Installing package into ‘/home/datascience/R/x86_64-pc-linux-gnu-library/4.4’
(as ‘lib’ is unspecified)

also installing the dependencies ‘operator.tools’, ‘slippymath’, ‘formula.tools’, ‘hexbin’, ‘maptiles’, ‘metR’, ‘vdiffr’



Attaching package: ‘tidyterra’


The following object is masked from ‘package:stats’:

    filter


here() starts at /home/datascience/herbivore_nutrient_interactions
  </preformat>
</boxed-text>
</sec>
<sec id="cell-4b46a42d-4f40-4e8a-ab95-e30918010efa-nb-10" specific-use="notebook-content">
<sec id="section-1---post-spatial-modeling-visualization-nb-10">
  <title>Section 1 - Post spatial modeling visualization</title>
  <sec id="outbreak-observations-nb-10">
    <title>Outbreak observations</title>
    </sec>
    <sec id="cell-54ebe204-728a-4e56-8e25-3c84da3e40e7-nb-10" specific-use="notebook-content">
    <code language="r script"># add code here</code>
    </sec>
    <sec id="cell-942f3399-dfee-4961-a4a4-b50b4977e497-nb-10" specific-use="notebook-content">
  </sec>
  <sec id="nil-observations-nb-10">
    <title>nil observations</title>
    </sec>
    <sec id="bb50f718-d6e0-4bb7-94d8-aea41c322d6d-nb-10" specific-use="notebook-content">
    <code language="r script">#add code here</code>
    </sec>
    <sec id="ae165e80-0909-4423-bb6c-f2f6a81cd6d0-nb-10" specific-use="notebook-content">
  </sec>
</sec>
<sec id="section-2---environmental-correlations-nb-10">
  <title>Section 2 - environmental correlations</title>
  <p>This is just a randomly sampled 100k points between the soil and
  bioclim variables on google earth engine. This extraction code can be
  found here:
  <monospace>04_environmental_correlations_map_nitrogen_phosphorus_woody_cover.ipynb</monospace></p>
  <p>Specifically these correlations:</p>
  <list list-type="bullet">
    <list-item>
      <p>soil nitrogen x soil phosphorus</p>
    </list-item>
    <list-item>
      <p>soil nitrogen x woody veg</p>
    </list-item>
    <list-item>
      <p>soil nitrogen x MAP</p>
    </list-item>
    <list-item>
      <p>soil phosphorus x woody veg</p>
    </list-item>
    <list-item>
      <p>MAP x woody veg</p>
    </list-item>
  </list>
  </sec>
  <sec id="cell-4a3ff466-f65c-48e1-aa08-7fdc06148f49-nb-10" specific-use="notebook-content">
  <code language="r script"># I min-max normalize to get all variables into the same scale for plotting.

minmax &lt;- function(x, na.rm = TRUE) {
    return((x- min(x)) /(max(x)-min(x)))
}

env_dat &lt;- read_csv(here('data/processed/spatial_modeling/environmental_correlation_data.csv'),show_col_types = FALSE) |&gt;
    drop_na() |&gt;
    mutate(mean_nto = minmax((NTO_000_005_EV + NTO_005_015_EV) / 2),
           mean_pto = minmax((PTO_000_005_EV + PTO_005_015_EV) / 2),
           annual_precip = minmax(bio12),
           tree_cover = minmax(tree_canopy_cover)) |&gt;
    select(mean_pto,mean_nto,annual_precip,tree_cover)

env_dat |&gt; head()</code>
  <boxed-text>
    <p>A tibble: 6 × 4</p>
    <table-wrap>
      <table>
        <colgroup>
          <col width="25%" />
          <col width="25%" />
          <col width="25%" />
          <col width="25%" />
        </colgroup>
        <thead>
          <tr>
            <th>mean_pto &lt;dbl&gt;</th>
            <th>mean_nto &lt;dbl&gt;</th>
            <th>annual_precip &lt;dbl&gt;</th>
            <th>tree_cover &lt;dbl&gt;</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>0.04273219</td>
            <td>0.02194335</td>
            <td>0.025369979</td>
            <td>0.00000000</td>
          </tr>
          <tr>
            <td>0.04985051</td>
            <td>0.01683786</td>
            <td>0.009513742</td>
            <td>0.00000000</td>
          </tr>
          <tr>
            <td>0.06395502</td>
            <td>0.05476617</td>
            <td>0.243921776</td>
            <td>0.13455657</td>
          </tr>
          <tr>
            <td>0.09088356</td>
            <td>0.15876259</td>
            <td>0.191067653</td>
            <td>0.06116208</td>
          </tr>
          <tr>
            <td>0.07643368</td>
            <td>0.03755396</td>
            <td>0.042811839</td>
            <td>0.03363914</td>
          </tr>
          <tr>
            <td>0.10154868</td>
            <td>0.08073041</td>
            <td>0.100422833</td>
            <td>0.05504587</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </boxed-text>
  </sec>
  <sec id="c9f56150-5b6d-4cb7-b27f-6e49c0497383-nb-10" specific-use="notebook-content">
  <code language="r script">nto_pto_graph &lt;- env_dat |&gt;
    #slice_sample(n=10000) |&gt;
    ggplot(aes(x=mean_nto,y=mean_pto)) +
        geom_abline(slope=1,linetype=3,linewidth=1.4) +
        geom_point(pch=21,alpha=0.3) +
        geom_smooth(method='gam',se=FALSE,linewidth=1.4) +
        xlim(0,1) +
        ylim(0,1) +
        theme_pubr() +
        xlab('soil nitrogen') +
        ylab('soil phosphorus')

nto_woody_graph &lt;- env_dat |&gt;
    #slice_sample(n=10000) |&gt;
    ggplot(aes(x=mean_nto,y=tree_cover)) +
        geom_abline(slope=1,linetype=3,linewidth=1.4) +
        geom_point(pch=21,alpha=0.3) +
        geom_smooth(method='gam',se=FALSE,linewidth=1.4) +
        xlim(0,1) +
        ylim(0,1) +
        theme_pubr() +
        xlab('soil nitrogen') +
        ylab('woody tree cover')

nto_map_graph &lt;- env_dat |&gt;
    #slice_sample(n=10000) |&gt;
    ggplot(aes(x=mean_nto,y=annual_precip)) +
        geom_abline(slope=1,linetype=3,linewidth=1.4) +
        geom_point(pch=21,alpha=0.3) +
        geom_smooth(method='gam',se=FALSE,linewidth=1.4) +
        xlim(0,1) +
        ylim(0,1) +
        theme_pubr() +
        xlab('soil nitrogen') +
        ylab('annual precipitation')

pto_woody_graph &lt;- env_dat |&gt;
    #lice_sample(n=10000) |&gt;
    ggplot(aes(x=mean_pto,y=tree_cover)) +
        geom_abline(slope=1,linetype=3,linewidth=1.4) +
        geom_point(pch=21,alpha=0.3) +
        geom_smooth(method='gam',se=FALSE,linewidth=1.4) +
        xlim(0,1) +
        ylim(0,1) +
        theme_pubr() +
        xlab('soil phosphorus') +
        ylab('woody tree cover')

pto_map_graph &lt;- env_dat |&gt;
    #slice_sample(n=10000) |&gt;
    ggplot(aes(x=mean_pto,y=annual_precip)) +
        geom_abline(slope=1,linetype=3,linewidth=1.4) +
        geom_point(pch=21,alpha=0.3) +
        geom_smooth(method='gam',se=FALSE,linewidth=1.4) +
        xlim(0,1) +
        ylim(0,1) +
        theme_pubr() +
        xlab('soil phosphorus') +
        ylab('annual precipitation')
        </code>
  </sec>
  <sec id="aba295ce-a4ce-4937-af1e-d1a11b0e86a5-nb-10" specific-use="notebook-content">
  <code language="r script">layout &lt;- &quot;
AB
CD
E#
&quot;
env_correlation_graph &lt;- nto_pto_graph + nto_woody_graph + nto_map_graph + pto_woody_graph + pto_map_graph +
  plot_layout(design = layout) + plot_annotation(tag_levels = 'a') </code>
  </sec>
  <sec id="e765a129-03f5-478a-9893-dbc9e5a322c0-nb-10" specific-use="notebook-content">
  <code language="r script">ggsave(env_correlation_graph,file=here('output/publication_figures/spatial_modeling_environment_correlation_figure.png'),width=10,height=15)</code>
  <boxed-text>
    <preformat>`geom_smooth()` using formula = 'y ~ s(x, bs = &quot;cs&quot;)'
`geom_smooth()` using formula = 'y ~ s(x, bs = &quot;cs&quot;)'
Warning message:
“Removed 18 rows containing missing values or values outside the scale range
(`geom_smooth()`).”
`geom_smooth()` using formula = 'y ~ s(x, bs = &quot;cs&quot;)'
`geom_smooth()` using formula = 'y ~ s(x, bs = &quot;cs&quot;)'
Warning message:
“Removed 10 rows containing missing values or values outside the scale range
(`geom_smooth()`).”
`geom_smooth()` using formula = 'y ~ s(x, bs = &quot;cs&quot;)'</preformat>
  </boxed-text>
  </sec>
  <sec id="c6f9b2c1-5353-493b-bade-5ad1936f2ed6-nb-10" specific-use="notebook-content">
</sec>
<sec id="section-3---soil-and-point-map-generation-nb-10">
  <title>Section 3 - soil and point map generation</title>
  <p>This figure will combine a few figures: - raw point distribution
  through australia - soil nitrogen map clipped to the locust
  distribution - soil phosphorus map clipped to the locust
  distribution</p>
  </sec>
  <sec id="aa5f8e85-b766-42f7-97f3-e618e22f2081-nb-10" specific-use="notebook-content">
  <code language="r script">aus &lt;- ne_states(country='Australia') |&gt; 
    select(name,geometry)

point_dat &lt;- read_csv(here('data/raw/survey_data/CT.csv'),show_col_types = FALSE) |&gt;
    select(!`...1`) |&gt;
    select(Latitude,Longitude,Species) |&gt;
    st_as_sf(coords = c(&quot;Longitude&quot;, &quot;Latitude&quot;),
             crs= &quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;)

nto_rast &lt;- rast(here(&quot;data/raw/survey_data/apl_nitrogen_raster.tif&quot;))
pto_rast &lt;- rast(here(&quot;data/raw/survey_data/apl_phosphorus_raster.tif&quot;))</code>
  <boxed-text>
    <preformat>New names:
• `` -&gt; `...1`</preformat>
  </boxed-text>
  </sec>
  <sec id="cell-9e0c2188-c862-4e50-95f5-b5d336d43c5f-nb-10" specific-use="notebook-content">
  <code language="r script">nto_rast</code>
  <boxed-text>
    <preformat>class       : SpatRaster 
dimensions  : 1139, 2062, 1  (nrow, ncol, nlyr)
resolution  : 0.01796631, 0.01796631  (x, y)
extent      : 114.6789, 151.7255, -37.76517, -17.30155  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : apl_nitrogen_raster.tif 
name        : apl_nitrogen_raster </preformat>
  </boxed-text>
  </sec>
  <sec id="de0af3df-3e02-4b00-b6bd-83323d565748-nb-10" specific-use="notebook-content">
  <code language="r script">

point_map &lt;- ggplot(aus) +
    geom_sf() +
    geom_sf(data=point_dat,size = 0.25) +
    theme_void() # + theme(legend.position=&quot;none&quot;)

nto_map &lt;- ggplot(aus) +
    geom_sf(color=NA) +
    geom_spatraster(data = nto_rast, aes(fill = apl_nitrogen_raster))  +
    scale_fill_stepsn(n.breaks = 10,
                      colours = rev(terrain.colors(5)),
                      na.value = &quot;transparent&quot;,
                      trans='log',
                      name=&quot;soil nitrogen \n(log-scaled)&quot;) +
    geom_sf(data = aus,fill=NA) +
    theme_void()  #+ theme(legend.position=&quot;none&quot;)

pto_map &lt;-ggplot(aus) +
    geom_sf(color=NA) +
    geom_spatraster(data = pto_rast, aes(fill = apl_phosphorus_raster))  +
    scale_fill_stepsn(breaks= c(0.14,0.10,0.05,0.04,0.02,0.01),
                      colours = viridis::viridis(9),
                      na.value = &quot;transparent&quot;,
                      trans='log',
                      name=&quot;soil phosphorus \n(log-scaled)&quot;) +
    geom_sf(data = aus,fill=NA) +
    theme_void()  #+ theme(legend.position=&quot;none&quot;)
  </code>
  <boxed-text>
    <preformat>&lt;SpatRaster&gt; resampled to 500752 cells.
&lt;SpatRaster&gt; resampled to 500752 cells.</preformat>
  </boxed-text>
  </sec>
  <sec id="cell-74cb03cb-d63a-4f9c-8eae-5bff494985a8-nb-10" specific-use="notebook-content">
  <code language="r script">
layout2 &lt;- &quot;
AAAA
AAAA
AAAA
AAAA
BBCC
BBCC
BBCC
BBCC
&quot;
layout &lt;- &quot;
A#
BC
&quot;

locust_env_maps &lt;- point_map + nto_map + pto_map + 
    plot_annotation(tag_levels = 'a') +
    plot_layout(design = layout)

locust_env_maps</code>
  <boxed-text>
    <graphic mimetype="image" mime-subtype="png" xlink:href="06_spatial_modeling_figure_table_construction_code_files/figure-jats/cell-12-output-1.png" />
  </boxed-text>
  </sec>
  <sec id="cell-78e1c642-6aaf-47fc-a2ad-f6bce049ee3c-nb-10" specific-use="notebook-content">
  <code language="r script">asp_ratio &lt;- tmaptools::get_asp_ratio(aus)

ggsave(locust_env_maps,
       file=here('output/publication_figures/spatial_modeling_locust_env_map.png'),
       width=10*asp_ratio,height=10)</code>
  </sec>
  <sec id="cell-6d5151d4-2567-4c86-9780-71ed0f9d0e22-nb-10" specific-use="notebook-content">
</sec>
<sec id="section-4---griding-example-nb-10">
  <title>Section 4 - griding example</title>
  <p>I want to show an example gridding of the apl points</p>
  </sec>
  <sec id="cell-76abfd42-486a-43a9-88fe-e2584a0f53ea-nb-10" specific-use="notebook-content">
  <code language="r script">apl_distribution = st_read(here(&quot;data/raw/survey_data/australian_plague_locut_distribution/Australia_Locust_Distribution.shp&quot;))
apl_distribution</code>
  <boxed-text>
    <preformat>Reading layer `Australia_Locust_Distribution' from data source 
  `/home/datascience/herbivore_nutrient_interactions/data/raw/survey_data/australian_plague_locut_distribution/Australia_Locust_Distribution.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 1 feature and 5 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 114.6879 ymin: -37.75311 xmax: 151.7099 ymax: -17.30655
Geodetic CRS:  GDA94</preformat>
  </boxed-text>
  <boxed-text>
    <p>A sf: 1 × 6</p>
    <table-wrap>
      <table>
        <colgroup>
          <col width="17%" />
          <col width="17%" />
          <col width="17%" />
          <col width="17%" />
          <col width="17%" />
          <col width="17%" />
        </colgroup>
        <thead>
          <tr>
            <th>OBJECTID &lt;dbl&gt;</th>
            <th>Id &lt;dbl&gt;</th>
            <th>gridcode &lt;dbl&gt;</th>
            <th>Shape_Leng &lt;dbl&gt;</th>
            <th>Shape_Area &lt;dbl&gt;</th>
            <th>geometry &lt;POLYGON [°]&gt;</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>0</td>
            <td>2</td>
            <td>97.61508</td>
            <td>519.9037</td>
            <td>POLYGON ((150.1273 -33.2678…</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </boxed-text>
  </sec>
  <sec id="cell-48814d8d-34b6-426f-8f82-52d68ef3d989-nb-10" specific-use="notebook-content">
  <code language="r script">
# Creating a grid with cells 4000m x 4000m 
grid = st_make_grid(point_dat, cellsize = 1, 
                            what =&quot;polygons&quot;, square = T)

overall_grid_map &lt;- ggplot(aus) +
    geom_sf() +
    geom_sf(data=point_dat) +
    geom_sf(data=grid,fill=NA,color='red') +
    theme_void()  +
  theme(
    plot.background = element_rect(fill = &quot;white&quot;, color = NA)  # Set white background
  )</code>
  </sec>
  <sec id="cell-2ed19056-a4a5-4c9c-a073-8ab86132bb6f-nb-10" specific-use="notebook-content">
  <code language="r script">grid</code>
  <boxed-text>
    <preformat>POLYGON ((131.6556 -37.71413, 132.6556 -37.7141...

POLYGON ((132.6556 -37.71413, 133.6556 -37.7141...

POLYGON ((133.6556 -37.71413, 134.6556 -37.7141...

POLYGON ((134.6556 -37.71413, 135.6556 -37.7141...

POLYGON ((135.6556 -37.71413, 136.6556 -37.7141...
    </preformat>
  </boxed-text>
  <boxed-text>
    <preformat>Geometry set for 440 features 
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 131.6556 ymin: -37.71413 xmax: 151.6556 ymax: -15.71413
Geodetic CRS:  +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
First 5 geometries:</preformat>
  </boxed-text>
  </sec>
  <sec id="cell-1d60c7d8-c695-43f7-abea-cc4350f6e9ba-nb-10" specific-use="notebook-content">
  <code language="r script">nsw &lt;- aus |&gt; filter(name == 'New South Wales')</code>
  </sec>
  <sec id="cell-30c046be-f1f3-43e9-8713-2881dbb05a60-nb-10" specific-use="notebook-content">
  <code language="r script">zoomed_plot &lt;- ggplot(aus) +
    geom_sf() +
    geom_sf(data=point_dat) +
    geom_sf(data=grid,fill=NA,color='red',linewidth=2) +
    coord_sf(ylim = c(-30, -35), xlim = c(140, 146)) +
    theme_void()

zoomed_plot</code>
  <boxed-text>
    <graphic mimetype="image" mime-subtype="png" xlink:href="06_spatial_modeling_figure_table_construction_code_files/figure-jats/cell-18-output-1.png" />
  </boxed-text>
  </sec>
  <sec id="f8bb7e1f-76b1-4b8d-8788-c6377045bfaa-nb-10" specific-use="notebook-content">
  <code language="r script">overall_grid_map</code>
  <boxed-text>
    <graphic mimetype="image" mime-subtype="png" xlink:href="06_spatial_modeling_figure_table_construction_code_files/figure-jats/cell-19-output-1.png" />
  </boxed-text>
  </sec>
  <sec id="cell-86aedb65-23dc-42e1-82c8-b30006bde094-nb-10" specific-use="notebook-content">
  <code language="r script">grid_examples &lt;- zoomed_plot + overall_grid_map</code>
  </sec>
  <sec id="cell-07d29832-eebf-458b-9375-5cf685e3a801-nb-10" specific-use="notebook-content">
  <code language="r script">asp_ratio &lt;- tmaptools::get_asp_ratio(aus)

ggsave(grid_examples,
       file=here('output/publication_figures/spatial_modeling_grid_example_map.png'),
       width=10*asp_ratio,height=5)</code>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-33-nb-11">
<front-stub>
<title-group>
<article-title>Extracting GEE data to polygons</article-title>
</title-group>
</front-stub>

<body>
<sec id="cell-25103076-0cdd-4b69-a8fd-22b59b79ef30-nb-11" specific-use="notebook-content">
<p>Now we need to take the sparse fishnets and extract our remote sensed
data. to do so we will do the following:</p>
<list list-type="order">
  <list-item>
    <label>1)</label>
    <p>import all the</p>
  </list-item>
</list>
</sec>
<sec id="cell-760daf3b-8461-4a8c-8a42-f7b4ecf07981-nb-11" specific-use="notebook-content">
<code language="python">import ee
import pandas as pd
import geopandas as gpd
import geemap
import os
from tqdm import tqdm
from shapely import wkt
from shapely.geometry import mapping

#ee.Authenticate()
ee.Initialize()</code>
</sec>
<sec id="cell-14d7a189-90d3-4c7f-a622-8395205625f9-nb-11" specific-use="notebook-content">
<code language="python">os.chdir(os.path.abspath(os.path.join(os.getcwd(), os.pardir)))</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
</sec>
<sec id="cell-82c094eb-40cb-4806-a8aa-aaa1bfcc19f4-nb-11" specific-use="notebook-content">
<code language="python">os.getcwd()</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
<boxed-text>
  <preformat>'/home/datascience/herbivore_nutrient_interactions'</preformat>
</boxed-text>
</sec>
<sec id="cell-33b76e1a-2b47-4082-bf99-a3a5f74512f2-nb-11" specific-use="notebook-content">
<code language="python"># ISRIC SoilGrid

# Initialize the Earth Engine library
ee.Initialize()

# Define the list of asset paths and corresponding soil property names
soil_properties = {
    'bdod_mean': 'bdod',
    'cec_mean': 'cec',
    'cfvo_mean': 'cfvo',
    'clay_mean': 'clay',
    'nitrogen_mean': 'nitrogen',
    'ocd_mean': 'ocd',
    'ocs_mean': 'ocs',
    'phh2o_mean': 'phh2o',
    'sand_mean': 'sand',
    'soc_mean': 'soc',
    'silt_mean': 'silt'
}

# Define the depths of interest
depths = ['0-5cm', '5-15cm']

def median_first_two_depths(asset_path, property_name):
    # Load the image
    image = ee.Image(asset_path)
    
    # Handle the special case for 'ocs_mean' which has only one band
    if property_name == 'ocs':
        # Return the image directly
        median_image = image.rename([f'{property_name}_single_band'])
    else:
        # Construct the band names for other properties
        band_names = [f'{property_name}_{depth}_mean' for depth in depths]
        
        # Select the bands of interest
        selected_bands = image.select(band_names)
        
        # Compute the median of the selected bands
        median_image = selected_bands.reduce(ee.Reducer.median())
        
        # Rename the band to include the soil property name
        median_image = median_image.rename([f'{property_name}_median'])
    
    return median_image

# Create a list to hold the median images
median_images = [median_first_two_depths(f'projects/soilgrids-isric/{key}', value) for key, value in soil_properties.items()]

# Combine the median images into an ImageCollection
isric_soil_grid = ee.ImageCollection(median_images).toBands()</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
</sec>
<sec id="cell-3caa9d2d-35a0-4ce8-9899-fdf1df354bf7-nb-11" specific-use="notebook-content">
<code language="python"># Australia soil grid


# Load the Australian Soil Grid image collection.
soil_collection = ee.ImageCollection(&quot;CSIRO/SLGA&quot;)

# Define the depth ranges and prefixes
depth_ranges = ['000_005', '005_015']
prefixes = ['SOC', 'AWC', 'BDW', 'CLY', 'ECE', 'NTO', 'pHc', 'PTO', 'SLT', 'SND']

# Initialize an empty list to store the band names
selected_images_redundant = []
selected_images_final = []
# Loop through each prefix and depth range to construct the band names
for prefix in prefixes:
    for depth_range in depth_ranges:
        selected_images_final.append(f'{prefix}_{depth_range}_EV')
        selected_images_redundant.append(f'{prefix}_{prefix}_{depth_range}_EV')


# take the imageCollection
# convert to iamge with bands
# select and rename the bands

slga_image = soil_collection.toBands().select(selected_images_redundant)</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
</sec>
<sec id="cell-29c80a89-ed80-40f7-b6ca-97c04c8f1b59-nb-11" specific-use="notebook-content">
<code language="python"># Bioclim variables
bioclim = ee.Image(&quot;WORLDCLIM/V1/BIO&quot;)

# Ecoregion
ecoregion = ee.FeatureCollection(&quot;RESOLVE/ECOREGIONS/2017&quot;).select('BIOME_NAME','ECO_NAME','ECO_ID','BIOME_NUM')

# Elevation
elevation = ee.Image(&quot;USGS/SRTMGL1_003&quot;)

# woody vegetation pixel cover

woody_veg = ee.ImageCollection(&quot;NASA/MEASURES/GFCC/TC/v3&quot;).select('tree_canopy_cover').median()</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
</sec>
<sec id="cell-57ab62c3-cac1-4e55-b91c-7564406811ca-nb-11" specific-use="notebook-content">
<code language="python">ecoregions = ee.FeatureCollection('RESOLVE/ECOREGIONS/2017')</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
</sec>
<sec id="cell-43feadef-0ec1-465b-b311-4566f49f7c4a-nb-11" specific-use="notebook-content">
<code language="python">first = isric_soil_grid.addBands(elevation)
second = first.addBands(bioclim)
third = second.addBands(slga_image)
final = third.addBands(woody_veg)
final</code>
<boxed-text>
  <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
</boxed-text>
<boxed-text>
  <preformat>&lt;ee.image.Image at 0x7f06e02224a0&gt;</preformat>
</boxed-text>
</sec>
<sec id="cell-18154d41-39c6-4fa3-b386-9b34ba9eac50-nb-11" specific-use="notebook-content">
<sec id="now-that-we-have-all-the-bands-and-features-together-lets-extract-to-the-grids-nb-11">
  <title>Now that we have all the bands and features together, lets
  extract to the grids</title>
  <p>lets import both the APL and DL csvs and convert them into
  geopandas</p>
  </sec>
  <sec id="cell-903df30a-1b1c-4d10-ad0b-a7e728e72387-nb-11" specific-use="notebook-content">
  <code language="python"># create APL dataframe

apl_df = pd.read_csv('data/processed/spatial_modeling/aplc_data_aggregated_to_polygon_grid.csv')
apl_df['geometry'] = apl_df['geometry'].apply(wkt.loads)
apl_gdf = gpd.GeoDataFrame(apl_df, geometry='geometry')
  </code>
  <boxed-text>
    <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
  </boxed-text>
  </sec>
  <sec id="cell-09825960-7526-4ae0-b1b8-3d5c6482b437-nb-11" specific-use="notebook-content">
  <code language="python">
# Function to get median band values for a single polygon
def get_median_values(polygon):
    ee_polygon = ee.Geometry.Polygon(mapping(polygon)['coordinates'])
    median_values = final.reduceRegion(
        reducer=ee.Reducer.median(),
        geometry=ee_polygon,
        scale=30,  # Change this to the appropriate scale for your data
        maxPixels=1e9
    ).getInfo()
    return median_values



# Process the DataFrame in chunks
chunk_size = 50
apl_chunks = [apl_gdf[i:i + chunk_size] for i in range(0, apl_gdf.shape[0], chunk_size)]

apl_results = []

for chunk in tqdm(apl_chunks, desc=&quot;Processing chunks&quot;):
    for index, row in chunk.iterrows():
        polygon_id = row['polygon_id']  # Assuming 'polygon_id' is the column name
        polygon = row['geometry']
        median_values = get_median_values(polygon)
        median_values['geometry'] = polygon
        median_values['polygon_id'] = polygon_id  # Add polygon_id to the results
        apl_results.append(median_values)
  </code>
  <boxed-text>
    <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
  </boxed-text>
  <boxed-text>
    <preformat>Processing chunks: 100%|██████████| 1984/1984 [3:11:44&lt;00:00,  5.80s/it]  </preformat>
  </boxed-text>
  </sec>
  <sec id="cell-6092ad01-b20d-4378-b1d2-da7a7dc8affd-nb-11" specific-use="notebook-content">
  <code language="python">import ee
from shapely.geometry import mapping
from tqdm import tqdm

# Initialize Earth Engine API
ee.Initialize()

# Load the ecoregions FeatureCollection
ecoregions = ee.FeatureCollection('RESOLVE/ECOREGIONS/2017')

# Function to get median band values and ecoregion name for a single polygon
def get_median_values(polygon):
    ee_polygon = ee.Geometry.Polygon(mapping(polygon)['coordinates'])
    
    # Get median band values from the final dataset
    median_values = final.reduceRegion(
        reducer=ee.Reducer.median(),
        geometry=ee_polygon,
        scale=30,  # Adjust this scale as necessary
        maxPixels=1e9
    ).getInfo()
    
    # Get the first ecoregion that intersects with the polygon
    intersecting_ecoregion = ecoregions.filterBounds(ee_polygon).first()
    
    # Retrieve the 'ECO_NAME' property (or any relevant property) from the intersecting ecoregion
    if intersecting_ecoregion:
        ecoregion_name = intersecting_ecoregion.get('ECO_NAME').getInfo()
    else:
        ecoregion_name = 'Unknown'  # If no intersection found, use 'Unknown'
    
    # Add the ecoregion name to the median values
    median_values['ecoregion'] = ecoregion_name
    
    return median_values

# Process the DataFrame in chunks
chunk_size = 100
apl_chunks = [apl_gdf[i:i + chunk_size] for i in range(0, apl_gdf.shape[0], chunk_size)]

apl_results = []

for chunk in tqdm(apl_chunks, desc=&quot;Processing chunks&quot;):
    for index, row in chunk.iterrows():
        polygon_id = row['polygon_id']  # Assuming 'polygon_id' is the column name
        polygon = row['geometry']
        
        # Get median values and ecoregion name for the current polygon
        median_values = get_median_values(polygon)
        
        # Add additional information to the results
        median_values['geometry'] = polygon
        median_values['polygon_id'] = polygon_id
        
        apl_results.append(median_values)

# apl_results now contains median band values and the corresponding ecoregion name
  </code>
  <boxed-text>
    <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
  </boxed-text>
  <boxed-text>
    <preformat>Processing chunks: 100%|██████████| 992/992 [11:14:20&lt;00:00, 40.79s/it]  </preformat>
  </boxed-text>
  </sec>
  <sec id="eb1463c8-bb7c-40ef-9785-a0c90c245d1b-nb-11" specific-use="notebook-content">
  <code language="python">apl_results_df = pd.DataFrame(apl_results)
apl_results_df.to_csv('data/processed/spatial_modeling/apl_remote_sense_extraction.csv', index=False)</code>
  <boxed-text>
    <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
  </boxed-text>
  </sec>
  <sec id="edf676c3-e0cc-438f-9f03-f42ec0174156-nb-11" specific-use="notebook-content">
</sec>
<sec id="now-lets-relate-the-two-dataframes-together-and-serialize-nb-11">
  <title>Now lets relate the two dataframes together and
  serialize</title>
  </sec>
  <sec id="baede775-221a-4add-b49e-fb4a06736b45-nb-11" specific-use="notebook-content">
  <code language="python">apl_results_df = pd.read_csv('data/processed/spatial_modeling/apl_remote_sense_extraction.csv')

apl_survey_remote_sense_data = apl_df.merge(apl_results_df, on='polygon_id', how='left')

apl_survey_remote_sense_data.to_csv('data/processed/spatial_modeling/apl_survey_remote_sense_data.csv', index=False)</code>
  <boxed-text>
    <preformat>&lt;IPython.core.display.HTML object&gt;</preformat>
  </boxed-text>
  </sec>
  <sec id="e46bec49-e5aa-4d15-a960-80aedea99b93-nb-11" specific-use="notebook-content">
  <p>Now we have the australian plague locust dataset as a dataframe</p>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>
<sub-article article-type="notebook" id="nb-36-nb-12">
<front-stub>
<title-group>
<article-title>Australia Plauge Locust Modeling</article-title>
</title-group>
</front-stub>

<body>
<sec id="cell-0d8cbe36-ad59-4370-a936-ff744b90bed7-nb-12" specific-use="notebook-content">
<p>This section covers the spatial modeling for australian plague
locusts</p>
<list list-type="bullet">
  <list-item>
    <p>section 1: data management</p>
  </list-item>
  <list-item>
    <p>section 2: outbreak modeling</p>
  </list-item>
  <list-item>
    <p>section 3: nil-observatiom modeling</p>
  </list-item>
  <list-item>
    <p>section 4: outbreak and mean annual preciptation modeling</p>
  </list-item>
</list>
<p>We will do basic modeling and saving relevant data to disk</p>
<p>Another notebook later in the series will create mansucript figures
and tables</p>
<sec id="section-1---data-management-nb-12">
  <title>Section 1 - Data management</title>
  </sec>
  <sec id="cell-36eefa03-e030-42db-a6ea-137c85d269a9-nb-12" specific-use="notebook-content">
  <code language="r script">load_packages &lt;- function(packages) {
  # Check for uninstalled packages
  uninstalled &lt;- packages[!packages %in% installed.packages()[,&quot;Package&quot;]]
  
  # Install uninstalled packages
  if(length(uninstalled)) install.packages(uninstalled, dependencies = TRUE)

  # Load all packages
  for (pkg in packages) {
    if (!require(pkg, character.only = TRUE, quietly = TRUE)) {
      message(paste(&quot;Failed to load package:&quot;, pkg))
    }
  }
}

# List of packages to check, install, and load
packages &lt;- c(&quot;mgcv&quot;, &quot;gratia&quot;, &quot;sf&quot;,&quot;rnaturalearth&quot;,
              &quot;ggpubr&quot;, &quot;patchwork&quot;, &quot;broom&quot;, &quot;knitr&quot;, &quot;janitor&quot;, 
              &quot;here&quot;,&quot;ggpubr&quot;,&quot;MetBrewer&quot;,&quot;GGally&quot;,&quot;tidyverse&quot;)

load_packages(packages)

i_am('README.md')


# Setting R options for jupyterlab
options(repr.plot.width = 10, repr.plot.height = 10,repr.matrix.max.rows=10)
  </code>
  </sec>
  <sec id="cell-55161949-c1fd-4981-a78c-50a4fc334157-nb-12" specific-use="notebook-content">
  <sec id="read-in-data-nb-12">
    <title>read in data</title>
    <list list-type="bullet">
      <list-item>
        <p>filter species for APL</p>
      </list-item>
      <list-item>
        <p>manage data into long format</p>
      </list-item>
      <list-item>
        <p>select variables used for modeling</p>
      </list-item>
      <list-item>
        <p>create outbreak and nil observation datasets</p>
      </list-item>
    </list>
    </sec>
    <sec id="cell-5c6190fc-1e37-4272-b492-aee923195d6d-nb-12" specific-use="notebook-content">
    <code language="r script">apl_dat &lt;- read_csv(here('data/processed/spatial_modeling/apl_survey_remote_sense_data.csv'),show_col_types = FALSE)</code>
    </sec>
    <sec id="d0e60f8d-b250-4761-9eea-3b51306714ce-nb-12" specific-use="notebook-content">
    <code language="r script">apl_locust_dat &lt;- apl_dat |&gt;
    clean_names() |&gt;
  mutate(adult_density = str_remove_all(adult_density, &quot;[{}]&quot;),
         nymph_density = str_remove_all(nymph_density, &quot;[{}]&quot;)) %&gt;%
  separate_rows(adult_density, sep = &quot;, &quot;) %&gt;%
  separate(adult_density, into = c(&quot;adult_density&quot;, &quot;adult_density_count&quot;), sep = &quot;: &quot;) %&gt;%
  separate_rows(nymph_density, sep = &quot;, &quot;) %&gt;%
  separate(nymph_density, into = c(&quot;nymph_density&quot;, &quot;nymph_density_count&quot;), sep = &quot;: &quot;) %&gt;%
  mutate(across(c(adult_density, adult_density_count, nymph_density, nymph_density_count), as.numeric)) |&gt; 
  distinct() |&gt;
  group_by(polygon_id,species) |&gt;
  mutate(total_observations = n()) 
    </code>
    </sec>
    <sec id="cell-3bb3a465-727d-4420-a97c-a03e818aedaa-nb-12" specific-use="notebook-content">
    <code language="r script">unique(apl_locust_dat$ecoregion)</code>
    <boxed-text>
      <list list-type="order">
        <list-item>
          <p>‘Great Victoria desert’</p>
        </list-item>
        <list-item>
          <p>‘Central Ranges xeric scrub’</p>
        </list-item>
        <list-item>
          <p>‘Tirari-Sturt stony desert’</p>
        </list-item>
        <list-item>
          <p>‘Simpson desert’</p>
        </list-item>
        <list-item>
          <p>‘Great Sandy-Tanami desert’</p>
        </list-item>
        <list-item>
          <p>‘Mitchell Grass Downs’</p>
        </list-item>
        <list-item>
          <p>‘Carpentaria tropical savanna’</p>
        </list-item>
        <list-item>
          <p>‘Flinders-Lofty montane woodlands’</p>
        </list-item>
        <list-item>
          <p>‘Murray-Darling woodlands and mallee’</p>
        </list-item>
        <list-item>
          <p>‘Southeast Australia temperate savanna’</p>
        </list-item>
        <list-item>
          <p>‘Naracoorte woodlands’</p>
        </list-item>
        <list-item>
          <p>‘Southeast Australia temperate forests’</p>
        </list-item>
        <list-item>
          <p>‘Eastern Australia mulga shrublands’</p>
        </list-item>
        <list-item>
          <p>‘Brigalow tropical savanna’</p>
        </list-item>
        <list-item>
          <p>‘Eastern Australian temperate forests’</p>
        </list-item>
        <list-item>
          <p>‘Eyre and York mallee’</p>
        </list-item>
      </list>
    </boxed-text>
    </sec>
    <sec id="cell-4b325f54-6fda-45f3-baa5-a92c67553bfc-nb-12" specific-use="notebook-content">
    <code language="r script">apl_outbreak_dat &lt;- apl_locust_dat |&gt;
    ungroup() |&gt;
    filter(species == 11 &amp; nymph_density == 4) |&gt;
    select(polygon_id,longitude,latitude,nymph_density,nymph_density_count,nymph_density_total_count,
           nto_nto_000_005_ev,nto_nto_005_015_ev,pto_pto_005_015_ev,pto_pto_000_005_ev,ecoregion) |&gt;
    group_by(polygon_id) |&gt;
    mutate(nitrogen = sum(nto_nto_005_015_ev,nto_nto_000_005_ev)/2, 
           phosphorus = sum(pto_pto_005_015_ev,pto_pto_000_005_ev)/2,
          ecoregion = factor(ecoregion)) |&gt;
    select(!c(nto_nto_000_005_ev,nto_nto_005_015_ev,pto_pto_005_015_ev,pto_pto_000_005_ev))  |&gt;
    distinct()

apl_nil_dat &lt;- apl_locust_dat |&gt;
    ungroup() |&gt;
    filter(species == 11 &amp; nymph_density == 0) |&gt;
    select(polygon_id,longitude,latitude,nymph_density,nymph_density_count,nymph_density_total_count,
           nto_nto_000_005_ev,nto_nto_005_015_ev,pto_pto_005_015_ev,pto_pto_000_005_ev,ecoregion) |&gt;
    group_by(polygon_id) |&gt;
    mutate(nitrogen = sum(nto_nto_005_015_ev,nto_nto_000_005_ev)/2, 
           phosphorus = sum(pto_pto_005_015_ev,pto_pto_000_005_ev)/2,
          ecoregion = factor(ecoregion)) |&gt;
    select(!c(nto_nto_000_005_ev,nto_nto_005_015_ev,pto_pto_005_015_ev,pto_pto_000_005_ev)) |&gt;
    distinct()</code>
    </sec>
    <sec id="cell-1a6244cb-11b2-4ecd-8eba-54e98b9ae872-nb-12" specific-use="notebook-content">
    <sec id="save-to-disk-for-further-use-nb-12">
      <title>save to disk for further use</title>
      </sec>
      <sec id="d67be167-e540-4b56-a406-a250036f9e0c-nb-12" specific-use="notebook-content">
      <code language="r script">
write.csv(apl_outbreak_dat,here('data/processed/spatial_modeling/spatial_modeling_locust_outbreak_model_data.csv'),row.names=FALSE)

write.csv(apl_nil_dat,here('data/processed/spatial_modeling/spatial_modeling_locust_nil_model_data.csv'),row.names=FALSE)
      </code>
      </sec>
      <sec id="d678e636-48ed-429b-bc59-932894c74996-nb-12" specific-use="notebook-content">
    </sec>
  </sec>
</sec>
<sec id="section-2---outbreak-modeling-nb-12">
  <title>Section 2 - outbreak modeling</title>
  </sec>
  <sec id="cell-79f223b0-6203-499c-81fc-d63ab543546b-nb-12" specific-use="notebook-content">
  <code language="r script">outbreak_data &lt;- read_csv(here('data/processed/spatial_modeling/spatial_modeling_locust_outbreak_model_data.csv'),
                          show_col_types = FALSE) |&gt;
    mutate(ecoregion = factor(ecoregion)) |&gt;
    filter(nymph_density_total_count &lt;= 50)</code>
  </sec>
  <sec id="cell-70443302-50a8-470f-ab5f-4aa6b9f36dc9-nb-12" specific-use="notebook-content">
  <code language="r script">summary(outbreak_data)</code>
  <boxed-text>
    <preformat>   polygon_id        longitude        latitude      nymph_density
 Min.   : 162921   Min.   :137.0   Min.   :-37.57   Min.   :4    
 1st Qu.: 437692   1st Qu.:139.7   1st Qu.:-34.45   1st Qu.:4    
 Median :1009186   Median :143.0   Median :-32.53   Median :4    
 Mean   : 985052   Mean   :142.9   Mean   :-32.25   Mean   :4    
 3rd Qu.:1494327   3rd Qu.:146.0   3rd Qu.:-31.04   3rd Qu.:4    
 Max.   :2092645   Max.   :151.3   Max.   :-21.08   Max.   :4    
                                                                 
 nymph_density_count nymph_density_total_count
 Min.   : 1.000      Min.   : 1.000           
 1st Qu.: 1.000      1st Qu.: 1.000           
 Median : 1.000      Median : 1.000           
 Mean   : 1.545      Mean   : 2.302           
 3rd Qu.: 1.000      3rd Qu.: 2.000           
 Max.   :24.000      Max.   :50.000           
                                              
                                 ecoregion       nitrogen      
 Southeast Australia temperate savanna:1969   Min.   :0.02707  
 Murray-Darling woodlands and mallee  :1406   1st Qu.:0.05658  
 Flinders-Lofty montane woodlands     : 950   Median :0.07913  
 Tirari-Sturt stony desert            : 584   Mean   :0.09421  
 Southeast Australia temperate forests: 508   3rd Qu.:0.11555  
 Simpson desert                       : 469   Max.   :0.61003  
 (Other)                              : 754                    
   phosphorus     
 Min.   :0.01107  
 1st Qu.:0.02561  
 Median :0.03092  
 Mean   :0.03699  
 3rd Qu.:0.03700  
 Max.   :0.23102  
                  </preformat>
  </boxed-text>
  </sec>
  <sec id="cell-91a0773c-2fba-4020-8eb9-e61280afe0c4-nb-12" specific-use="notebook-content">
  <sec id="raw-data-visualization-nb-12">
    <title>Raw data visualization</title>
    </sec>
    <sec id="b5702d11-6d0b-45b5-a1f7-1be5569ffec0-nb-12" specific-use="notebook-content">
    <code language="r script">head(outbreak_data,1)
nrow(outbreak_data)</code>
    <boxed-text>
      <p>A tibble: 1 × 9</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
          </colgroup>
          <thead>
            <tr>
              <th>polygon_id &lt;dbl&gt;</th>
              <th>longitude &lt;dbl&gt;</th>
              <th>latitude &lt;dbl&gt;</th>
              <th>nymph_density &lt;dbl&gt;</th>
              <th>nymph_density_count &lt;dbl&gt;</th>
              <th>nymph_density_total_count &lt;dbl&gt;</th>
              <th>ecoregion &lt;fct&gt;</th>
              <th>nitrogen &lt;dbl&gt;</th>
              <th>phosphorus &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>162921</td>
              <td>137.1195</td>
              <td>-33.36002</td>
              <td>4</td>
              <td>1</td>
              <td>1</td>
              <td>Eyre and York mallee</td>
              <td>0.07035461</td>
              <td>0.02197414</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    <boxed-text>
      <p>6640</p>
    </boxed-text>
    </sec>
    <sec id="af683292-2cda-413b-bc4f-015dc18d6fcb-nb-12" specific-use="notebook-content">
    <code language="r script">aus &lt;- ne_states(country = 'Australia')


map_dat &lt;- outbreak_data |&gt;
    select(polygon_id,latitude,longitude,nymph_density_count) |&gt;
    st_as_sf(coords = c('longitude','latitude'),
                   crs= &quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;)

outbreak_point_map &lt;- aus |&gt;
    ggplot() +
        geom_sf() +
        geom_sf(data=map_dat) +
        theme_void() 
    </code>
    </sec>
    <sec id="cell-497620e7-b5d5-431d-8ec3-5a60f7e68b57-nb-12" specific-use="notebook-content">
    <code language="r script">nto_plot &lt;- outbreak_data |&gt;
    ggplot(aes(x=nitrogen,y=nymph_density_count)) +
        geom_point(pch=21,alpha=0.3,size=0.6) +
        geom_smooth() +
        theme_pubr()

pto_plot &lt;- outbreak_data |&gt;
    ggplot(aes(x=phosphorus,y=nymph_density_count)) +
        geom_point(pch=21,alpha=0.3,size=0.6) +
        geom_smooth() +
        theme_pubr()

nto_plot + pto_plot</code>
    <boxed-text>
      <preformat>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = &quot;cs&quot;)'
`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = &quot;cs&quot;)'</preformat>
    </boxed-text>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_australian_plague_locust_raw_data_visualization_files/figure-jats/cell-12-output-2.png" />
    </boxed-text>
    </sec>
    <sec id="cell-981d0b76-9db7-48e8-9f42-ed4c47672a93-nb-12" specific-use="notebook-content">
  </sec>
  <sec id="modeling-nb-12">
    <title>Modeling</title>
    </sec>
    <sec id="cell-0bf2bae7-b866-4f91-8875-e6df81fa2401-nb-12" specific-use="notebook-content">
    <code language="r script">head(outbreak_data,1)
summary(outbreak_data)</code>
    <boxed-text>
      <p>A tibble: 1 × 9</p>
      <table-wrap>
        <table>
          <colgroup>
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
            <col width="11%" />
          </colgroup>
          <thead>
            <tr>
              <th>polygon_id &lt;dbl&gt;</th>
              <th>longitude &lt;dbl&gt;</th>
              <th>latitude &lt;dbl&gt;</th>
              <th>nymph_density &lt;dbl&gt;</th>
              <th>nymph_density_count &lt;dbl&gt;</th>
              <th>nymph_density_total_count &lt;dbl&gt;</th>
              <th>ecoregion &lt;fct&gt;</th>
              <th>nitrogen &lt;dbl&gt;</th>
              <th>phosphorus &lt;dbl&gt;</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>162921</td>
              <td>137.1195</td>
              <td>-33.36002</td>
              <td>4</td>
              <td>1</td>
              <td>1</td>
              <td>Eyre and York mallee</td>
              <td>0.07035461</td>
              <td>0.02197414</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    <boxed-text>
      <preformat>   polygon_id        longitude        latitude      nymph_density
 Min.   : 162921   Min.   :137.0   Min.   :-37.57   Min.   :4    
 1st Qu.: 437692   1st Qu.:139.7   1st Qu.:-34.45   1st Qu.:4    
 Median :1009186   Median :143.0   Median :-32.53   Median :4    
 Mean   : 985052   Mean   :142.9   Mean   :-32.25   Mean   :4    
 3rd Qu.:1494327   3rd Qu.:146.0   3rd Qu.:-31.04   3rd Qu.:4    
 Max.   :2092645   Max.   :151.3   Max.   :-21.08   Max.   :4    
                                                                 
 nymph_density_count nymph_density_total_count
 Min.   : 1.000      Min.   : 1.000           
 1st Qu.: 1.000      1st Qu.: 1.000           
 Median : 1.000      Median : 1.000           
 Mean   : 1.545      Mean   : 2.302           
 3rd Qu.: 1.000      3rd Qu.: 2.000           
 Max.   :24.000      Max.   :50.000           
                                              
                                 ecoregion       nitrogen      
 Southeast Australia temperate savanna:1969   Min.   :0.02707  
 Murray-Darling woodlands and mallee  :1406   1st Qu.:0.05658  
 Flinders-Lofty montane woodlands     : 950   Median :0.07913  
 Tirari-Sturt stony desert            : 584   Mean   :0.09421  
 Southeast Australia temperate forests: 508   3rd Qu.:0.11555  
 Simpson desert                       : 469   Max.   :0.61003  
 (Other)                              : 754                    
   phosphorus     
 Min.   :0.01107  
 1st Qu.:0.02561  
 Median :0.03092  
 Mean   :0.03699  
 3rd Qu.:0.03700  
 Max.   :0.23102  
                  </preformat>
    </boxed-text>
    </sec>
    <sec id="cell-619439a7-a11b-496b-97e8-d7d3ce2e6eb2-nb-12" specific-use="notebook-content">
    <code language="r script">mod1 &lt;- bam(nymph_density_count ~
               s(nitrogen,k=15) +
               s(phosphorus,k=15) +
               s(nymph_density_total_count,k=10) +
               te(longitude,latitude,bs=c('gp','gp'),k=150) +
               s(ecoregion,bs='re'),
           select = TRUE,
           discrete = TRUE,
           nthreads = 20,
          family =tw(),
          data = outbreak_data)</code>
    <boxed-text>
      <preformat>Warning message in smooth.construct.tensor.smooth.spec(object, dk$data, dk$knots):
“reparameterization unstable for margin: not done”
Warning message in smooth.construct.tensor.smooth.spec(object, dk$data, dk$knots):
“reparameterization unstable for margin: not done”</preformat>
    </boxed-text>
    </sec>
    <sec id="cell-0a8b8ec5-b2b9-476d-8ad3-57df266fcbe5-nb-12" specific-use="notebook-content">
    <code language="r script">
# Save the combined list to an RDS file
saveRDS(mod1, here(&quot;output/spatial_modeling/model_objects/locust_outbreak_model.rds&quot;))</code>
    </sec>
    <sec id="a18d41b9-4b60-4893-8c13-c1f545f9b113-nb-12" specific-use="notebook-content">
    <code language="r script">1+1</code>
    </sec>
    <sec id="cell-884535db-9f99-45e2-aae3-733221bfba5c-nb-12" specific-use="notebook-content">
    <code language="r script">k.check(mod2)</code>
    <boxed-text>
      <p>A matrix: 3 × 4 of type dbl</p>
      <table-wrap>
        <table>
          <thead>
            <tr>
              <th></th>
              <th>k’</th>
              <th>edf</th>
              <th>k-index</th>
              <th>p-value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>s(nitrogen)</td>
              <td>24</td>
              <td>3.878831</td>
              <td>0.9708085</td>
              <td>0.525</td>
            </tr>
            <tr>
              <td>s(phosphorus)</td>
              <td>24</td>
              <td>3.387436</td>
              <td>0.9723253</td>
              <td>0.640</td>
            </tr>
            <tr>
              <td>s(ecoregion)</td>
              <td>11</td>
              <td>9.356158</td>
              <td>NA</td>
              <td>NA</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-3eb2ef29-e3a9-43bf-a4e7-a33b3c855742-nb-12" specific-use="notebook-content">
    <code language="r script">outbreak_mods &lt;- readRDS(here(&quot;output/spatial_modeling/model_objects/locust_outbreak_models.rds&quot;))</code>
    </sec>
    <sec id="fbb3bccd-a340-4ce3-a455-6216436bf543-nb-12" specific-use="notebook-content">
    <code language="r script">concurvity(mod2)</code>
    <boxed-text>
      <p>A matrix: 3 × 4 of type dbl</p>
      <table-wrap>
        <table>
          <thead>
            <tr>
              <th></th>
              <th>para</th>
              <th>s(nitrogen)</th>
              <th>s(phosphorus)</th>
              <th>s(ecoregion)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>worst</td>
              <td>1</td>
              <td>0.9644620</td>
              <td>0.9576279</td>
              <td>1.0000000</td>
            </tr>
            <tr>
              <td>observed</td>
              <td>1</td>
              <td>0.8783724</td>
              <td>0.3167688</td>
              <td>0.4652133</td>
            </tr>
            <tr>
              <td>estimate</td>
              <td>1</td>
              <td>0.9207552</td>
              <td>0.9055319</td>
              <td>0.4150108</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
    </sec>
    <sec id="cell-4ebcff8b-76ea-49dd-99ee-40b9e586faa9-nb-12" specific-use="notebook-content">
    <code language="r script">gratia::appraise(mod1)</code>
    <boxed-text>
      <graphic mimetype="image" mime-subtype="png" xlink:href="03_australian_plague_locust_raw_data_visualization_files/figure-jats/cell-20-output-1.png" />
    </boxed-text>
    </sec>
    <sec id="f006d248-85f7-4d6a-9bec-3b8de9c34d7c-nb-12" specific-use="notebook-content">
  </sec>
</sec>
<sec id="section-3-nil-observatiom-modeling-nb-12">
  <title>section 3: nil-observatiom modeling</title>
  </sec>
  <sec id="c3c74097-bbfd-4af3-a1e1-e4bec1c1d31e-nb-12" specific-use="notebook-content">
  <code language="r script">nil_data &lt;- read_csv(here('data/processed/spatial_modeling/spatial_modeling_locust_nil_model_data.csv'),
                          show_col_types = FALSE)  |&gt;
    mutate(ecoregion = factor(ecoregion))</code>
  </sec>
  <sec id="e2534793-dd68-4489-869e-3ebe545372e2-nb-12" specific-use="notebook-content">
  <code language="r script">mod1 &lt;- bam(nymph_density_count ~
               s(nitrogen,k=25) +
               s(phosphorus,k=25) +
               s(nymph_density_total_count,k=25) +
               te(longitude,latitude,bs=c('tp','tp'),k=25) +
               s(ecoregion,bs='re'),
           select = TRUE,
           discrete = TRUE,
           nthreads = 20,
          family = tw(),
          data = nil_data)

mod2 &lt;- bam(nymph_density_count ~
               s(nitrogen,k=25) +
               s(phosphorus,k=25) +
               s(ecoregion,bs='re'),
           select = TRUE,
           discrete = TRUE,
           nthreads = 20,
          family = tw(),
          data = nil_data)

mod3 &lt;- bam(nymph_density_count ~
               s(nymph_density_total_count,k=25) +
               te(longitude,latitude,bs=c('tp','tp'),k=25) +
               s(ecoregion,bs='re'),
           select = TRUE,
           discrete = TRUE,
           nthreads = 20,
          family = tw(),
          data = nil_data)

mod4 &lt;- gam(nymph_density_count ~ 1,
          family = tw(),
          data = nil_data)
  </code>
  </sec>
  <sec id="cell-52cf85b8-0f0b-4acd-9666-8611673ce2fb-nb-12" specific-use="notebook-content">
  <code language="r script"># Combine the lists into a single list
models &lt;- list('mod1'= mod1, 'mod2' = mod2, 'mod3'= mod3, 'mod4'= mod4)

# Save the combined list to an RDS file
saveRDS(models, here(&quot;output/spatial_modeling/model_objects/locust_nil_models.rds&quot;))</code>
  </sec>
  <sec id="eadaa188-66e5-453f-953b-945a0879a4b6-nb-12" specific-use="notebook-content">
  <code language="r script">gratia::appraise(models$mod1)</code>
  <boxed-text>
    <graphic mimetype="image" mime-subtype="png" xlink:href="03_australian_plague_locust_raw_data_visualization_files/figure-jats/cell-24-output-1.png" />
  </boxed-text>
  </sec>
  <sec id="cell-13a5e67b-49e8-4f98-ae09-045085e00c3a-nb-12" specific-use="notebook-content">
  <code language="r script">summary(models$mod1)</code>
  <boxed-text>
    <preformat>
Family: Tweedie(p=1.99) 
Link function: log 

Formula:
nymph_density_count ~ s(nitrogen, k = 25) + s(phosphorus, k = 25) + 
    s(nymph_density_total_count, k = 25) + te(longitude, latitude, 
    bs = c(&quot;tp&quot;, &quot;tp&quot;), k = 25) + s(ecoregion, bs = &quot;re&quot;)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.81871    0.02318   78.45   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Approximate significance of smooth terms:
                                 edf Ref.df        F p-value    
s(nitrogen)                   10.320     24   12.757  &lt;2e-16 ***
s(phosphorus)                  7.853     24    8.971  &lt;2e-16 ***
s(nymph_density_total_count)  23.754     24 3246.948  &lt;2e-16 ***
te(longitude,latitude)       137.248    569    3.167  &lt;2e-16 ***
s(ecoregion)                   2.866     14    0.397  0.0263 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) =  0.856   Deviance explained = 88.7%
fREML = -7958.7  Scale est. = 0.03559   n = 33975</preformat>
  </boxed-text>
  </sec>
  <sec id="f00542e1-3ec4-4eef-81f1-c1c958186fbb-nb-12" specific-use="notebook-content">
  <code language="r script">1+1</code>
  <boxed-text>
    <p>2</p>
  </boxed-text>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>

</article>